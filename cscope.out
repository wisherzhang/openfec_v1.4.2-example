cscope 15 $HOME/other/openfec/openfec_v1_4_2_zz_pthread_version0/openfec_v1_4_2/openfec_v1.4.2 -q 0000002049 0000564328
	@CMakeFiles/3.5.1/CompilerIdC/CMakeCCompilerId.c

1 #ifdeà
__ılu¥lus


5 #ià
defšed
(
__18CXX
)

6 
	#ID_VOID_MAIN


	)

13 #ià
defšed
(
__INTEL_COMPILER
è|| defšed(
__ICC
)

14 
	#COMPILER_ID
 "IÁ–"

	)

15 #ià
defšed
(
_MSC_VER
)

16 
	#SIMULATE_ID
 "MSVC"

	)

19 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__INTEL_COMPILER
/100)

	)

20 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__INTEL_COMPILER
/10 % 10)

	)

21 #ià
defšed
(
__INTEL_COMPILER_UPDATE
)

22 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__INTEL_COMPILER_UPDATE
)

	)

24 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__INTEL_COMPILER
 % 10)

	)

26 #ià
defšed
(
__INTEL_COMPILER_BUILD_DATE
)

28 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__INTEL_COMPILER_BUILD_DATE
)

	)

30 #ià
defšed
(
_MSC_VER
)

32 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

33 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

36 #–ià
defšed
(
__PATHCC__
)

37 
	#COMPILER_ID
 "P©hSÿË"

	)

38 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PATHCC__
)

	)

39 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PATHCC_MINOR__
)

	)

40 #ià
defšed
(
__PATHCC_PATCHLEVEL__
)

41 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PATHCC_PATCHLEVEL__
)

	)

44 #–ià
defšed
(
__BORLANDC__
è&& defšed(
__CODEGEARC_VERSION__
)

45 
	#COMPILER_ID
 "Emb¬ÿd”o"

	)

46 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>24 & 0x00FF)

	)

47 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__CODEGEARC_VERSION__
>>16 & 0x00FF)

	)

48 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__CODEGEARC_VERSION__
 & 0xFFFF)

	)

50 #–ià
defšed
(
__BORLANDC__
)

51 
	#COMPILER_ID
 "BÜÏnd"

	)

53 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__BORLANDC__
>>8)

	)

54 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__BORLANDC__
 & 0xFF)

	)

56 #–ià
defšed
(
__WATCOMC__
) && __WATCOMC__ < 1200

57 
	#COMPILER_ID
 "W©com"

	)

59 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__WATCOMC__
 / 100)

	)

60 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__WATCOMC__
 / 10è% 10)

	)

61 #ià(
__WATCOMC__
 % 10) > 0

62 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__WATCOMC__
 % 10)

	)

65 #–ià
defšed
(
__WATCOMC__
)

66 
	#COMPILER_ID
 "O³nW©com"

	)

68 
	#COMPILER_VERSION_MAJOR
 
	`DEC
((
__WATCOMC__
 - 1100è/ 100)

	)

69 
	#COMPILER_VERSION_MINOR
 
	`DEC
((
__WATCOMC__
 / 10è% 10)

	)

70 #ià(
__WATCOMC__
 % 10) > 0

71 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__WATCOMC__
 % 10)

	)

74 #–ià
defšed
(
__SUNPRO_C
)

75 
	#COMPILER_ID
 "SunPro"

	)

76 #ià
__SUNPRO_C
 >= 0x5100

78 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_C
>>12)

	)

79 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_C
>>4 & 0xFF)

	)

80 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_C
 & 0xF)

	)

83 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__SUNPRO_C
>>8)

	)

84 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__SUNPRO_C
>>4 & 0xF)

	)

85 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__SUNPRO_C
 & 0xF)

	)

88 #–ià
defšed
(
__HP_cc
)

89 
	#COMPILER_ID
 "HP"

	)

91 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__HP_cc
/10000)

	)

92 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__HP_cc
/100 % 100)

	)

93 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__HP_cc
 % 100)

	)

95 #–ià
defšed
(
__DECC
)

96 
	#COMPILER_ID
 "Com·q"

	)

98 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__DECC_VER
/10000000)

	)

99 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__DECC_VER
/100000 % 100)

	)

100 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__DECC_VER
 % 10000)

	)

102 #–ià
defšed
(
__IBMC__
è&& defšed(
__COMPILER_VER__
)

103 
	#COMPILER_ID
 "zOS"

	)

105 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMC__
/100)

	)

106 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMC__
/10 % 10)

	)

107 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMC__
 % 10)

	)

109 #–ià
defšed
(
__IBMC__
è&& !defšed(
__COMPILER_VER__
) && __IBMC__ >= 800

110 
	#COMPILER_ID
 "XL"

	)

112 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMC__
/100)

	)

113 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMC__
/10 % 10)

	)

114 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMC__
 % 10)

	)

116 #–ià
defšed
(
__IBMC__
è&& !defšed(
__COMPILER_VER__
) && __IBMC__ < 800

117 
	#COMPILER_ID
 "Visu®Age"

	)

119 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__IBMC__
/100)

	)

120 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__IBMC__
/10 % 10)

	)

121 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__IBMC__
 % 10)

	)

123 #–ià
defšed
(
__PGI
)

124 
	#COMPILER_ID
 "PGI"

	)

125 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__PGIC__
)

	)

126 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__PGIC_MINOR__
)

	)

127 #ià
defšed
(
__PGIC_PATCHLEVEL__
)

128 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__PGIC_PATCHLEVEL__
)

	)

131 #–ià
defšed
(
_CRAYC
)

132 
	#COMPILER_ID
 "C¿y"

	)

133 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_RELEASE_MAJOR
)

	)

134 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_RELEASE_MINOR
)

	)

136 #–ià
defšed
(
__TI_COMPILER_VERSION__
)

137 
	#COMPILER_ID
 "TI"

	)

139 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000000)

	)

140 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__TI_COMPILER_VERSION__
/1000 % 1000)

	)

141 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__TI_COMPILER_VERSION__
 % 1000)

	)

143 #–ià
defšed
(
__FUJITSU
è|| defšed(
__FCC_VERSION
è|| defšed(
__fcc_v”siÚ
)

144 
	#COMPILER_ID
 "Fuj™su"

	)

146 #–ià
defšed
(
__TINYC__
)

147 
	#COMPILER_ID
 "TšyCC"

	)

149 #–ià
defšed
(
__SCO_VERSION__
)

150 
	#COMPILER_ID
 "SCO"

	)

152 #–ià
defšed
(
__şªg__
è&& defšed(
__­¶e_bud_v”siÚ__
)

153 
	#COMPILER_ID
 "AµËCÏng"

	)

154 #ià
defšed
(
_MSC_VER
)

155 
	#SIMULATE_ID
 "MSVC"

	)

157 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__şªg_majÜ__
)

	)

158 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__şªg_mšÜ__
)

	)

159 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__şªg_·tchËv–__
)

	)

160 #ià
defšed
(
_MSC_VER
)

162 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

163 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

165 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
__­¶e_bud_v”siÚ__
)

	)

167 #–ià
defšed
(
__şªg__
)

168 
	#COMPILER_ID
 "CÏng"

	)

169 #ià
defšed
(
_MSC_VER
)

170 
	#SIMULATE_ID
 "MSVC"

	)

172 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__şªg_majÜ__
)

	)

173 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__şªg_mšÜ__
)

	)

174 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__şªg_·tchËv–__
)

	)

175 #ià
defšed
(
_MSC_VER
)

177 
	#SIMULATE_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

178 
	#SIMULATE_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

181 #–ià
defšed
(
__GNUC__
)

182 
	#COMPILER_ID
 "GNU"

	)

183 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__GNUC__
)

	)

184 #ià
defšed
(
__GNUC_MINOR__
)

185 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__GNUC_MINOR__
)

	)

187 #ià
defšed
(
__GNUC_PATCHLEVEL__
)

188 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__GNUC_PATCHLEVEL__
)

	)

191 #–ià
defšed
(
_MSC_VER
)

192 
	#COMPILER_ID
 "MSVC"

	)

194 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_MSC_VER
 / 100)

	)

195 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_MSC_VER
 % 100)

	)

196 #ià
defšed
(
_MSC_FULL_VER
)

197 #ià
_MSC_VER
 >= 1400

199 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 100000)

	)

202 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_MSC_FULL_VER
 % 10000)

	)

205 #ià
defšed
(
_MSC_BUILD
)

206 
	#COMPILER_VERSION_TWEAK
 
	`DEC
(
_MSC_BUILD
)

	)

209 #–ià
defšed
(
__VISUALDSPVERSION__
è|| defšed(
__ADSPBLACKFIN__
è|| defšed(
__ADSPTS__
è|| defšed(
__ADSP21000__
)

210 
	#COMPILER_ID
 "ADSP"

	)

211 #ià
defšed
(
__VISUALDSPVERSION__
)

213 
	#COMPILER_VERSION_MAJOR
 
	`HEX
(
__VISUALDSPVERSION__
>>24)

	)

214 
	#COMPILER_VERSION_MINOR
 
	`HEX
(
__VISUALDSPVERSION__
>>16 & 0xFF)

	)

215 
	#COMPILER_VERSION_PATCH
 
	`HEX
(
__VISUALDSPVERSION__
>>8 & 0xFF)

	)

218 #–ià
defšed
(
__IAR_SYSTEMS_ICC__
 ) || defšed(
__IAR_SYSTEMS_ICC
)

219 
	#COMPILER_ID
 "IAR"

	)

221 #–ià
defšed
(
__ARMCC_VERSION
)

222 
	#COMPILER_ID
 "ARMCC"

	)

223 #ià
__ARMCC_VERSION
 >= 1000000

225 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCC_VERSION
/1000000)

	)

226 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCC_VERSION
/10000 % 100)

	)

227 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCC_VERSION
 % 10000)

	)

230 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
__ARMCC_VERSION
/100000)

	)

231 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
__ARMCC_VERSION
/10000 % 10)

	)

232 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
__ARMCC_VERSION
 % 10000)

	)

236 #–ià
defšed
(
SDCC
)

237 
	#COMPILER_ID
 "SDCC"

	)

239 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
SDCC
/100)

	)

240 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
SDCC
/10 % 10)

	)

241 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
SDCC
 % 10)

	)

243 #–ià
defšed
(
_SGI_COMPILER_VERSION
è|| defšed(
_COMPILER_VERSION
)

244 
	#COMPILER_ID
 "MIPS´o"

	)

245 #ià
defšed
(
_SGI_COMPILER_VERSION
)

247 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_SGI_COMPILER_VERSION
/100)

	)

248 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_SGI_COMPILER_VERSION
/10 % 10)

	)

249 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_SGI_COMPILER_VERSION
 % 10)

	)

252 
	#COMPILER_VERSION_MAJOR
 
	`DEC
(
_COMPILER_VERSION
/100)

	)

253 
	#COMPILER_VERSION_MINOR
 
	`DEC
(
_COMPILER_VERSION
/10 % 10)

	)

254 
	#COMPILER_VERSION_PATCH
 
	`DEC
(
_COMPILER_VERSION
 % 10)

	)

261 #–ià
defšed
(
__sgi
)

262 
	#COMPILER_ID
 "MIPS´o"

	)

264 #–ià
defšed
(
__hpux
è|| defšed(
__hpua
)

265 
	#COMPILER_ID
 "HP"

	)

268 
	#COMPILER_ID
 ""

	)

275 cÚ¡* 
	gšfo_comp”
 = "INFO" ":" "comp”[" 
COMPILER_ID
 "]";

276 #ifdeà
SIMULATE_ID


277 cÚ¡* 
	gšfo_simuÏ‹
 = "INFO" ":" "simuÏ‹[" 
SIMULATE_ID
 "]";

280 #ifdeà
__QNXNTO__


281 cÚ¡* 
	gqnxÁo
 = "INFO" ":" "qnxnto[]";

284 #ià
defšed
(
__CRAYXE
è|| defšed(
__CRAYXC
)

285 cÚ¡ *
	gšfo_üay
 = "INFO" ":" "compiler_wrapper[CrayPrgEnv]";

288 
	#STRINGIFY_HELPER
(
X
è#X

	)

289 
	#STRINGIFY
(
X
è
	`STRINGIFY_HELPER
(X)

	)

292 #ià
defšed
(
__lšux
è|| defšed(
__lšux__
è|| defšed(
lšux
)

293 
	#PLATFORM_ID
 "Lšux"

	)

295 #–ià
defšed
(
__CYGWIN__
)

296 
	#PLATFORM_ID
 "Cygwš"

	)

298 #–ià
defšed
(
__MINGW32__
)

299 
	#PLATFORM_ID
 "MšGW"

	)

301 #–ià
defšed
(
__APPLE__
)

302 
	#PLATFORM_ID
 "D¬wš"

	)

304 #–ià
defšed
(
_WIN32
è|| defšed(
__WIN32__
è|| defšed(
WIN32
)

305 
	#PLATFORM_ID
 "Wšdows"

	)

307 #–ià
defšed
(
__F»eBSD__
è|| defšed(
__F»eBSD
)

308 
	#PLATFORM_ID
 "F»eBSD"

	)

310 #–ià
defšed
(
__N‘BSD__
è|| defšed(
__N‘BSD
)

311 
	#PLATFORM_ID
 "N‘BSD"

	)

313 #–ià
defšed
(
__O³nBSD__
è|| defšed(
__OPENBSD
)

314 
	#PLATFORM_ID
 "O³nBSD"

	)

316 #–ià
defšed
(
__sun
è|| defšed(
sun
)

317 
	#PLATFORM_ID
 "SunOS"

	)

319 #–ià
defšed
(
_AIX
è|| defšed(
__AIX
è|| defšed(
__AIX__
è|| defšed(
__aix
è|| defšed(
__aix__
)

320 
	#PLATFORM_ID
 "AIX"

	)

322 #–ià
defšed
(
__sgi
è|| defšed(
__sgi__
è|| defšed(
_SGI
)

323 
	#PLATFORM_ID
 "IRIX"

	)

325 #–ià
defšed
(
__hpux
è|| defšed(
__hpux__
)

326 
	#PLATFORM_ID
 "HP-UX"

	)

328 #–ià
defšed
(
__HAIKU__
)

329 
	#PLATFORM_ID
 "Haiku"

	)

331 #–ià
defšed
(
__BeOS
è|| defšed(
__BEOS__
è|| defšed(
_BEOS
)

332 
	#PLATFORM_ID
 "BeOS"

	)

334 #–ià
defšed
(
__QNX__
è|| defšed(
__QNXNTO__
)

335 
	#PLATFORM_ID
 "QNX"

	)

337 #–ià
defšed
(
__Œu64
è|| defšed(
_Œu64
è|| defšed(
__TRU64__
)

338 
	#PLATFORM_ID
 "Tru64"

	)

340 #–ià
defšed
(
__riscos
è|| defšed(
__riscos__
)

341 
	#PLATFORM_ID
 "RISCos"

	)

343 #–ià
defšed
(
__sšix
è|| defšed(
__sšix__
è|| defšed(
__SINIX__
)

344 
	#PLATFORM_ID
 "SINIX"

	)

346 #–ià
defšed
(
__UNIX_SV__
)

347 
	#PLATFORM_ID
 "UNIX_SV"

	)

349 #–ià
defšed
(
__bsdos__
)

350 
	#PLATFORM_ID
 "BSDOS"

	)

352 #–ià
defšed
(
_MPRAS
è|| defšed(
MPRAS
)

353 
	#PLATFORM_ID
 "MP-RAS"

	)

355 #–ià
defšed
(
__osf
è|| defšed(
__osf__
)

356 
	#PLATFORM_ID
 "OSF1"

	)

358 #–ià
defšed
(
_SCO_SV
è|| defšed(
SCO_SV
è|| defšed(
sco_sv
)

359 
	#PLATFORM_ID
 "SCO_SV"

	)

361 #–ià
defšed
(
__uÉrix
è|| defšed(
__uÉrix__
è|| defšed(
_ULTRIX
)

362 
	#PLATFORM_ID
 "ULTRIX"

	)

364 #–ià
defšed
(
__XENIX__
è|| defšed(
_XENIX
è|| defšed(
XENIX
)

365 
	#PLATFORM_ID
 "X’ix"

	)

367 #–ià
defšed
(
__WATCOMC__
)

368 #ià
defšed
(
__LINUX__
)

369 
	#PLATFORM_ID
 "Lšux"

	)

371 #–ià
defšed
(
__DOS__
)

372 
	#PLATFORM_ID
 "DOS"

	)

374 #–ià
defšed
(
__OS2__
)

375 
	#PLATFORM_ID
 "OS2"

	)

377 #–ià
defšed
(
__WINDOWS__
)

378 
	#PLATFORM_ID
 "Wšdows3x"

	)

381 
	#PLATFORM_ID
 ""

	)

385 
	#PLATFORM_ID
 ""

	)

394 #ià
defšed
(
_WIN32
è&& defšed(
_MSC_VER
)

395 #ià
defšed
(
_M_IA64
)

396 
	#ARCHITECTURE_ID
 "IA64"

	)

398 #–ià
defšed
(
_M_X64
è|| defšed(
_M_AMD64
)

399 
	#ARCHITECTURE_ID
 "x64"

	)

401 #–ià
defšed
(
_M_IX86
)

402 
	#ARCHITECTURE_ID
 "X86"

	)

404 #–ià
defšed
(
_M_ARM
)

405 #ià
_M_ARM
 == 4

406 
	#ARCHITECTURE_ID
 "ARMV4I"

	)

407 #–ià
_M_ARM
 == 5

408 
	#ARCHITECTURE_ID
 "ARMV5I"

	)

410 
	#ARCHITECTURE_ID
 "ARMV" 
	`STRINGIFY
(
_M_ARM
)

	)

413 #–ià
defšed
(
_M_MIPS
)

414 
	#ARCHITECTURE_ID
 "MIPS"

	)

416 #–ià
defšed
(
_M_SH
)

417 
	#ARCHITECTURE_ID
 "SHx"

	)

420 
	#ARCHITECTURE_ID
 ""

	)

423 #–ià
defšed
(
__WATCOMC__
)

424 #ià
defšed
(
_M_I86
)

425 
	#ARCHITECTURE_ID
 "I86"

	)

427 #–ià
defšed
(
_M_IX86
)

428 
	#ARCHITECTURE_ID
 "X86"

	)

431 
	#ARCHITECTURE_ID
 ""

	)

435 
	#ARCHITECTURE_ID
 ""

	)

439 
	#DEC
(
n
) \

440 ('0' + (((
n
) / 10000000)%10)), \

441 ('0' + (((
n
) / 1000000)%10)), \

442 ('0' + (((
n
) / 100000)%10)), \

443 ('0' + (((
n
) / 10000)%10)), \

444 ('0' + (((
n
) / 1000)%10)), \

445 ('0' + (((
n
) / 100)%10)), \

446 ('0' + (((
n
) / 10)%10)), \

447 ('0' + ((
n
è% 10))

	)

450 
	#HEX
(
n
) \

451 ('0' + ((
n
)>>28 & 0xF)), \

452 ('0' + ((
n
)>>24 & 0xF)), \

453 ('0' + ((
n
)>>20 & 0xF)), \

454 ('0' + ((
n
)>>16 & 0xF)), \

455 ('0' + ((
n
)>>12 & 0xF)), \

456 ('0' + ((
n
)>>8 & 0xF)), \

457 ('0' + ((
n
)>>4 & 0xF)), \

458 ('0' + ((
n
è& 0xF))

	)

461 #ifdeà
COMPILER_VERSION_MAJOR


462 cÚ¡ 
	gšfo_v”siÚ
[] = {

465 
COMPILER_VERSION_MAJOR
,

466 #ifdeà
COMPILER_VERSION_MINOR


467 '.', 
COMPILER_VERSION_MINOR
,

468 #ifdeà
COMPILER_VERSION_PATCH


469 '.', 
COMPILER_VERSION_PATCH
,

470 #ifdeà
COMPILER_VERSION_TWEAK


471 '.', 
COMPILER_VERSION_TWEAK
,

479 #ifdeà
SIMULATE_VERSION_MAJOR


480 cÚ¡ 
	gšfo_simuÏ‹_v”siÚ
[] = {

483 
SIMULATE_VERSION_MAJOR
,

484 #ifdeà
SIMULATE_VERSION_MINOR


485 '.', 
SIMULATE_VERSION_MINOR
,

486 #ifdeà
SIMULATE_VERSION_PATCH


487 '.', 
SIMULATE_VERSION_PATCH
,

488 #ifdeà
SIMULATE_VERSION_TWEAK


489 '.', 
SIMULATE_VERSION_TWEAK
,

500 cÚ¡* 
	gšfo_¶©fÜm
 = "INFO" ":" "¶©fÜm[" 
PLATFORM_ID
 "]";

501 cÚ¡* 
	gšfo_¬ch
 = "INFO" ":" "¬ch[" 
ARCHITECTURE_ID
 "]";

506 cÚ¡ * 
	gšfo_Ïnguage_dŸËù_deçuÉ
 = "INFO" ":" "dialect_default["

507 #ià!
defšed
(
__STDC_VERSION__
)

509 #–ià
__STDC_VERSION__
 >= 201000L

511 #–ià
__STDC_VERSION__
 >= 199901L

519 #ifdeà
ID_VOID_MAIN


520 
	$maš
(è{
	}
}

522 
	$maš
(
¬gc
, * 
¬gv
[])

524 
»quœe
 = 0;

525 
»quœe
 +ğ
šfo_comp”
[
¬gc
];

526 
»quœe
 +ğ
šfo_¶©fÜm
[
¬gc
];

527 
»quœe
 +ğ
šfo_¬ch
[
¬gc
];

528 #ifdeà
COMPILER_VERSION_MAJOR


529 
»quœe
 +ğ
šfo_v”siÚ
[
¬gc
];

531 #ifdeà
SIMULATE_ID


532 
»quœe
 +ğ
šfo_simuÏ‹
[
¬gc
];

534 #ifdeà
SIMULATE_VERSION_MAJOR


535 
»quœe
 +ğ
šfo_simuÏ‹_v”siÚ
[
¬gc
];

537 #ià
	`defšed
(
__CRAYXE
è|| defšed(
__CRAYXC
)

538 
»quœe
 +ğ
šfo_üay
[
¬gc
];

540 
»quœe
 +ğ
šfo_Ïnguage_dŸËù_deçuÉ
[
¬gc
];

541 ()
¬gv
;

542  
»quœe
;

543 
	}
}

	@CMakeFiles/feature_tests.c

2 cÚ¡ 
	gã©u»s
[] = {"\n"

4 #ià(
__GNUC__
 * 100 + 
__GNUC_MINOR__
) >= 404

11 #ià(
__GNUC__
 * 100 + 
__GNUC_MINOR__
è>ğ404 && 
defšed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L

18 #ià(
__GNUC__
 * 100 + 
__GNUC_MINOR__
è>ğ406 && 
defšed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 201000L

25 #ià(
__GNUC__
 * 100 + 
__GNUC_MINOR__
è>ğ404 && 
defšed
(
__STDC_VERSION__
) && __STDC_VERSION__ >= 199901L

34 
	$maš
(
¬gc
, ** 
¬gv
è{ (ïrgv;  
ã©u»s
[¬gc]; 
	}
}

	@applis/eperftool/blocking_struct.c

34 
	~"•”áoŞ.h
"

37 
UINT32
 
doubË_to_şo£¡_št
 (
v®ue
);

45 
	$of_compu‹_blockšg_¡ruù
 (
UINT32
 
B
,

46 
UINT32
 
L
,

47 
UINT32
 
E
,

48 
of_blockšg_¡ruù_t
 *
bs
)

50 
UINT32
 
T
;

51 
A
;

52 
A_äaùiÚ
;

54 
T
 = (
UINT32
)
	`û
(()
L
 / ()
E
);

55 
bs
->
nb_blocks
 = (
INT32
)
	`û
(()
T
 / ()
B
);

56 
A
 = ()
T
/()
bs
->
nb_blocks
;

57 
bs
->
A_Ïrge
 = (
UINT32
)
	`û
(()
A
);

58 
bs
->
A_sm®l
 = (
UINT32
)
	`æoÜ
(()
A
);

59 
A_äaùiÚ
 = 
A
 - 
bs
->
A_sm®l
;

60 
bs
->
I
 = 
	`doubË_to_şo£¡_št
(
A_äaùiÚ
 * ()bs->
nb_blocks
);

62 
	`´štf
("of_compute_blocking_struct: B=%d, L=%d,T= %d E=%d\n\t\tnb_blocks=%d, I=%d, A_large=%d, A_small=%d\n",

63 
B
, 
L
, 
T
, 
E
, 
bs
->
nb_blocks
, bs->
I
, bs->
A_Ïrge
, bs->
A_sm®l
);

65 
	`ASSERT
(
bs
->
A_Ïrge
 <ğ
B
);

66 
	}
}

75 
UINT32


76 
	$doubË_to_şo£¡_št
 (
v®ue
)

78 
û_v®ue
;

79 
æoÜ_v®ue
;

80 
abs_diff1
;

81 
abs_diff2
;

83 
û_v®ue
 = 
	`û
(
v®ue
);

84 
æoÜ_v®ue
 = 
	`æoÜ
(
v®ue
);

85 
abs_diff1
 = 
	`çbs
(
v®ue
 - 
û_v®ue
);

86 
abs_diff2
 = 
	`çbs
(
v®ue
 - 
æoÜ_v®ue
);

87 ià(
abs_diff1
 < 
abs_diff2
) {

88  ((
UINT32
)
û_v®ue
);

90  ((
UINT32
)
æoÜ_v®ue
);

92 
	}
}

	@applis/eperftool/blocking_struct.h

39 
	sof_blockšg_¡ruù
 {

40 
UINT32
 
	mnb_blocks
;

42 
UINT32
 
	mI
;

45 
UINT32
 
	mA_Ïrge
;

47 
UINT32
 
	mA_sm®l
;

49 } 
	tof_blockšg_¡ruù_t
;

63 
of_compu‹_blockšg_¡ruù
 (
UINT32
 
B
,

64 
UINT32
 
L
,

65 
UINT32
 
E
,

66 
of_blockšg_¡ruù_t
 *
bs
);

	@applis/eperftool/callbacks.c

34 
	~"•”áoŞ.h
"

36 
UINT32
 
	gnb_decoded_¤c_symb_ÿÎback_ÿÎs
 = 0;

39 * 
	$decode_sourû_symbŞ_ÿÎback
(*
cÚ‹xt
, 
size
, 
esi
)

41 
	`OF_TRACE_LVL
(1, ("¤øsymbŞ c®lback:ƒs˜%˜decoded\n", 
esi
))

42 
nb_decoded_¤c_symb_ÿÎback_ÿÎs
++;

43  
	`m®loc
(
size
);

44 
	}
}

	@applis/eperftool/callbacks.h

33 #iâdeà
CALLBACKS_H


34 
	#CALLBACKS_H


	)

38 
UINT32
 
nb_decoded_¤c_symb_ÿÎback_ÿÎs
;

42 * 
decode_sourû_symbŞ_ÿÎback
(*
cÚ‹xt
,
size
, 
esi
);

	@applis/eperftool/codec_instance_mgmt.c

37 
	~"•”áoŞ.h
"

39 
	~"../../¤c/lib_commÚ/of_İ’ãc_­i.h
"

41 
of_£ssiÚ_t
 *

42 
	$ü—‹_ªd_š™_codec_š¡ªû
 (
of_codec_id_t
 
codec_id
,

43 
UINT32
 
’c_dec_ty³
,

44 
UINT32
 
k
,

45 
UINT32
 
n
,

46 
block_cb_t
 *
blk
)

48 
of_£ssiÚ_t
 *
£s
;

53 ià(
	`of_ü—‹_codec_š¡ªû
(&
£s
, 
codec_id
, 
’c_dec_ty³
, 
of_v”bos™y
è!ğ
OF_STATUS_OK
) {

54 
	`OF_PRINT_ERROR
(("ERROR: of_ü—‹_codec_š¡ªû(èçed fÜ codec_id %d\n", 
codec_id
))

55 
”rÜ
;

58 #ifdeà
OF_USE_REED_SOLOMON_CODEC


59 ià(
codec_id
 =ğ
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
)

61 
of_rs_·¿m‘”s_t
 
·¿ms
;

62 
·¿ms
.
nb_sourû_symbŞs
 = 
k
;

63 
·¿ms
.
nb_»·œ_symbŞs
 = 
n
 - 
k
;

64 
·¿ms
.
’codšg_symbŞ_Ëngth
 = 
symbŞ_size
;

65 ià(
	`of_£t_ãc_·¿m‘”s
(
£s
, (
of_·¿m‘”s_t
*)&
·¿ms
è!ğ
OF_STATUS_OK
) {

66 
	`OF_PRINT_ERROR
(("ERROR: of_£t_ãc_·¿m‘”s(èçed fÜ codec_id %d\n", 
codec_id
))

67 
”rÜ
;

71 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


72 ià(
codec_id
 =ğ
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
)

74 
of_rs_2_m_·¿m‘”s_t
 
·¿ms
;

75 
·¿ms
.
nb_sourû_symbŞs
 = 
k
;

76 
·¿ms
.
nb_»·œ_symbŞs
 = 
n
 - 
k
;

77 
·¿ms
.
’codšg_symbŞ_Ëngth
 = 
symbŞ_size
;

78 
·¿ms
.
m
 = 
rs_m_·¿m
;

79 ià(
	`of_£t_ãc_·¿m‘”s
(
£s
, (
of_·¿m‘”s_t
*)&
·¿ms
è!ğ
OF_STATUS_OK
) {

80 
	`OF_PRINT_ERROR
(("ERROR: of_£t_ãc_·¿m‘”s(èçed fÜ codec_id %d\n", 
codec_id
))

81 
”rÜ
;

85 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


86 ià(
codec_id
 =ğ
OF_CODEC_LDPC_STAIRCASE_STABLE
)

88 
of_ldpc_·¿m‘”s
 
·¿ms
;

89 
·¿ms
.
nb_sourû_symbŞs
 = 
k
;

90 
·¿ms
.
nb_»·œ_symbŞs
 = 
n
 - 
k
;

91 
·¿ms
.
’codšg_symbŞ_Ëngth
 = 
symbŞ_size
;

92 ià(
’c_dec_ty³
 =ğ
OF_ENCODER
) {

93 ià(
sugge¡ed_£ed
 != 0) {

95 
·¿ms
.
´ng_£ed
 = 
sugge¡ed_£ed
;

98 
·¿ms
.
´ng_£ed
 = 
	`my¿nd
();

100 
·¿ms
.
N1
 = 
ldpc_N1
;

101 
blk
->
ldpc_£ed
 = 
·¿ms
.
´ng_£ed
;

102 
blk
->
ldpc_N1
 = 
·¿ms
.
N1
;

104 
·¿ms
.
´ng_£ed
 = 
blk
->
ldpc_£ed
;

105 
·¿ms
.
N1
 = 
blk
->
ldpc_N1
;

107 ià(
	`of_£t_ãc_·¿m‘”s
(
£s
, (
of_·¿m‘”s_t
*)&
·¿ms
è!ğ
OF_STATUS_OK
) {

108 
	`OF_PRINT_ERROR
(("ERROR: of_£t_ãc_·¿m‘”s(èçed fÜ codec_id %d\n", 
codec_id
))

109 
”rÜ
;

113 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


114 ià(
codec_id
 =ğ
OF_CODEC_2D_PARITY_MATRIX_STABLE
)

116 
of_2d_·r™y_·¿m‘”s_t
 
·¿ms
;

117 
·¿ms
.
nb_sourû_symbŞs
 = 
k
;

118 
·¿ms
.
nb_»·œ_symbŞs
 = 
n
 - 
k
;

119 
·¿ms
.
’codšg_symbŞ_Ëngth
 = 
symbŞ_size
;

120 ià(
	`of_£t_ãc_·¿m‘”s
(
£s
, (
of_·¿m‘”s_t
*)&
·¿ms
è!ğ
OF_STATUS_OK
) {

121 
	`OF_PRINT_ERROR
(("ERROR: of_£t_ãc_·¿m‘”s(èçed fÜ codec_id %d\n", 
codec_id
))

122 
”rÜ
;

127 
	`OF_PRINT_ERROR
(("ERROR: FEC codeø%d‚Ù suµÜ‹d!\n", 
codec_id
))

128 
”rÜ
;

130 ià(
u£_ÿÎback
) {

131 
	`of_£t_ÿÎback_funùiÚs
(
£s
, 
decode_sourû_symbŞ_ÿÎback
, 
NULL
, NULL);

134  
£s
;

136 
”rÜ
:

137  (
of_£ssiÚ_t
 *)
NULL
;

138 
	}
}

	@applis/eperftool/codec_instance_mgmt.h

35 #iâdeà
CODEC_INSTANCE_MGMT


36 
	#CODEC_INSTANCE_MGMT


	)

53 
of_£ssiÚ_t
 *

54 
ü—‹_ªd_š™_codec_š¡ªû
 (
of_codec_id_t
 
codec_id
,

55 
UINT32
 
’c_dec_ty³
,

56 
UINT32
 
k
,

57 
UINT32
 
n
,

58 
block_cb
 *
blk
);

	@applis/eperftool/command_line.c

35 
	~"•”áoŞ.h
"

46 
boŞ
 
	gupd©ed_tÙ_nb_sourû_symbŞs
 = 
çl£
;

47 
boŞ
 
	gupd©ed_tÙ_nb_»·œ_symbŞs
 = 
çl£
;

48 
boŞ
 
	gupd©ed_code_¿‹
 = 
çl£
;

49 
boŞ
 
	gupd©ed_objeù_size
 = 
çl£
;

50 
boŞ
 
	gupd©ed_symbŞ_size
 = 
çl£
;

51 
boŞ
 
	gupd©ed_m©rix_fe
 = 
çl£
;

56 
	$´štU§ge
 (*
cmdName
)

58 
	`´štf
("U§ge: % [İtiÚs]\n", 
cmdName
);

59 
	`´štf
("SOURCE/REPAIR SPECIFICATION METHOD 1\n");

60 
	`´štf
(" -tot_src=<n> or -k=<n>\n");

61 
	`´štf
(" s‘htÙ®‚umb” oàsourû symbŞ tØÀ(deçuÉ %d).\n", 
DFLT_TOT_NB_SOURCE
);

62 
	`´štf
(" This isƒquivalento k (code dimension) whenhere is‡ single block\n");

63 
	`´štf
(" -tot_rep=<n> or -r=<n>\n");

64 
	`´štf
(" s‘htÙ®‚umb” oà»·œ symbŞ tØÀ(deçuÉ %d). \n", 
DFLT_TOT_NB_REPAIR
);

65 
	`´štf
(" This isƒqualo‚-k (code†ength - code dimension) whenhere is\n");

66 
	`´štf
("‡ single block. If -tot_rep/-k is used, -rate must‚ot be used.\n");

67 
	`´štf
(" -rate=<n> set code„ate (i.e. k/n)o‚ (floating…oint value) (default %.3f).\n",

68 ()
DFLT_TOT_NB_SOURCE
 / ()(DFLT_TOT_NB_SOURCE + 
DFLT_TOT_NB_REPAIR
));

69 
	`´štf
(" If -rate is used, -tot_rep/-k must‚ot be used.\n");

70 
	`´štf
(" -symb_sz=<n>\n");

71 
	`´štf
(" s‘hsymbŞ siztØÀ(deçuÉ %d)\n", 
DFLT_SYMBOL_SZ
);

72 
	`´štf
(" -obj_sz=<n> set object sizeo‚ bytes\n");

73 
	`´štf
("\n");

74 
	`´štf
("GENERAL PURPOSE OPTIONS:\n");

75 
	`´štf
(" -h[elp]his help\n");

76 
	`´štf
(" -v=<n> set verbosityo‚ (only {0, 1, 2}‡re‡ccepted)\n");

77 
	`´štf
(" -find_min_overhead\n");

78 
	`´štf
(" findhe minimum code overhead. Thisest implies†aunching several\n");

79 
	`´štf
(" decoding instances, with‡‚umber of„eceived…acketshat is increased,\n");

80 
	`´štf
(" starting from k, until decoding succeeds. Limitedo‡ single block,‡nd\n");

81 
	`´štf
(" -seed must be specifiedo keephe same code‡nd…kt†osses (default: false).\n");

82 
	`´štf
("\n");

83 
	`´štf
("CODE/CODEC RELATED OPTIONS:\n");

84 
	`´štf
(" -codec=<n> sethe code/codec:\n");

85 #ifdeà
OF_USE_REED_SOLOMON_CODEC


86 
	`´štf
(" %d: RS ov” GF(2^8è¡abË codec\n", 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
);

88 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


89 
	`´štf
(" %d: RS ov” GF(2^mè(w™h m=4 o¸8), sbË codec\n", 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
);

91 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


92 
	`´štf
(" %d: LDPC-Sœÿ£ sbË codeø(deçuÉ)\n", 
OF_CODEC_LDPC_STAIRCASE_STABLE
);

94 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


95 
	`´štf
(" %d: 2D…¬™y check m©rix sbË codec\n", 
OF_CODEC_2D_PARITY_MATRIX_STABLE
);

97 #ifdeà 
OF_USE_LDPC_FROM_FILE_CODEC


98 
	`´štf
(" %d: LDPC, w™h‡ bš¬y H m©rix s³cif›d iÀ¨fe,‡dvªûd codec\n", 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
);

100 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


101 
	`´štf
(" -rs_m=<n> s‘hm…¬am‘” oàRS ov” GF(2^mècode tØÀ(deçuÉ %d)\n", 
DFLT_RS_M_PARAM
);

103 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


104 
	`´štf
(" -ldpc_N1=<n> s‘hLDPC N1…¬am‘”ØÀ(deçuÉ %d)\n", 
DFLT_LDPC_N1
);

105 
	`´štf
(" (only with LDPC-Staircase codecs)\n");

107 
	`´štf
(" -use_callbacks\n");

108 
	`´štf
("ƒperftool‡llocates memory for decoded source symbols (otherwisehe\n");

109 
	`´štf
(" codec‡llocates it)\n");

110 
	`´štf
("\n");

111 
	`´štf
("TRANSMISSION RELATED OPTIONS:\n");

112 
	`´štf
(" -loss=<n>[:<n1>:<n2>|:<n1>]\n");

113 
	`´štf
(" sethe†oss model‡nd‡ssociated…robabilities/numbers when‡pplicable:\n");

114 
	`´štf
(" -loss=0‚o†oss (default)\n");

115 
	`´štf
(" -loss=1 or -loss=1:<n1>:<n2>\n");

116 
	`´štf
(" simulate„andom†osses usingwo state markov model\n");

117 
	`´štf
("‚1:†os ´obab™y iÀOK s‹ (š‹g”, deçuÉ %i)\n", 
P_LOSS_WHEN_OK
);

118 
	`´štf
("‚2: sucûs ´obab™y iÀNOK s‹ (š‹g”, deçuÉ %i)\n", 
P_SUCCESS_WHEN_LOSSES
);

119 
	`´štf
(" -loss=2:<n1>:<n2> simulate„andom†osses by specifyinghearget†oss\n");

120 
	`´štf
("…robabilityƒxpressed in…ercent (floating…oint value)\n");

121 
	`´štf
(" -loss=3:<n1> simulate„andom†osses by specifyinghearget‚umber\n");

122 
	`´štf
(" of†osses (ratherhan…robability)\n");

123 
	`´štf
(" -loss=4„andomly choose one…acketo send out ofhe‚…ossibles\n");

124 
	`´štf
("‡tƒach step, with…ossible duplicates (overwritesransmissionype)\n");

125 
	`´štf
(" -loss=5:<n1> simulate„eception ofhe firstarget‚umber of…ackets‡ndrim whatever follows\n");

126 
	`´štf
(" (WARNING:his is‡‚umber of…acketso„eceive,‚otoƒrase)\n");

127 
	`´štf
(" -tx_type=<n>\n");

128 
	`´štf
(" setheransmissionype:\n");

129 
	`´štf
(" 0:„andomly send‡ll source +„epair symbols (default)\n");

130 
	`´štf
(" 1:„andomly send‡ few source symbols (not‚ecessarily„eceived) +‡ll„epair symbols\n");

131 
	`´štf
(" 2:„andomly send few src symbols first (always„eceived),hen„andomly‡ll„epair symbols\n");

132 
	`´štf
(" 3:„andomly send only„epair symbols (non systematic)\n");

133 
	`´štf
(" 4: sequentially send‡ll src symbols first,hen„epair symbols\n");

134 
	`´štf
(" 5: sequentially send‡ll„epair symbols first,hen src symbols\n");

135 
	`´štf
(" 6: sequentially send‡ll src symbols first,hen„andomly„epair symbols\n");

136 
	`´štf
(" 7: sequentially send‡ll„epair symbols first,hen„andomly src symbols\n");

137 
	`´štf
(" 8: simulate broadcastx + unicast„epair: send‡ll„epair„andomly, subject\n");

138 
	`´štf
("o…acket†osses,hen sendhe first <rx_src_nb> source…ackets sequentially,\n");

139 
	`´štf
("‚ot, subjecto‡ny†oss (3G connection)\n");

141 
	`´štf
(" -seed=<n> setshe global PRNG seedo‚ (to„eproduceƒxperiments).\n");

142 
	`´štf
(" Guarantieshe same matrix is created (LDPC-*),he sameransmission order is\n");

143 
	`´štf
(" used‡ndhe same†osses occur\n");

144 
	`´štf
(" -rx_src_ratio=<n>\n");

145 
	`´štf
("…ercentage of„eceived source symbols when -t1 or -t2 is used\n");

146 
	`´štf
(" -rx_src_nb=<n>\n");

147 
	`´štf
("‚umber of„eceived source symbols when -t1 or -t2 is used\n");

148 #ifdeà 
READ_MATRIX_FILE


149 
	`´štf
("I/O RELATED OPTIONS:\n");

150 
	`´štf
(" -matrix_file=<file_name>\n");

151 
	`´štf
(" sethe…ath ofhe file containinghe…arity check matrix\n");

153 
	`´štf
("\nExamples:\n");

154 
	`´štf
("*‡ basicƒxample first, with default code‡ndransmission…arameters:\n");

155 
	`´štf
("\ˆ% -v=1\n", 
cmdName
);

156 
	`´štf
("*woƒxamples, one with Reed-Solomon,he other with LDPC-Staircase\n");

157 
	`´štf
(" (NB: comparehe speed...):\n");

158 
	`´štf
("\ˆ% -codec=1 -tÙ_¤c=5000 -tÙ_»p=2500 -tx_ty³=0\n", 
cmdName
);

159 
	`´štf
("\ˆ% -codec=3 -tÙ_¤c=5000 -tÙ_»p=2500 -tx_ty³=0\n", 
cmdName
);

160 
	`´štf
("*‡hirdƒxample, with LDPC-Staircase, specifyinghe object size (inhis case‡ big 20MBytes\n");

161 
	`´štf
(" object),he code„ate (2/3)‡ndheransmission…arameters in such‡ wayorigger ML\n");

162 
	`´štf
(" decoding) (look‡the inefficiency„atio, < 1%%)\n");

163 
	`´štf
("\ˆ% -codec=3 -obj_sz=20992000 -¿‹=0.666 -tx_ty³=0 -loss=2:33.0 -£ed=1\n", 
cmdName
);

164 
	`ex™
(0);

165 
	}
}

169 
of_¡©us_t
 
	$·r£_commªd_lše
 (
¬gc
, *
¬gv
[])

171 
c
;

172 *
O±Li¡
 = "c:f:k:r:l:s:t:u:v:h:o:m:n:";

173 #ià
	`defšed
(
WIN32
)

174 *
İrg
 = 
NULL
;

177 ià(
¬gc
 < 1)

178 
	`´štU§ge
(
¬gv
[0]);

180 #ifdeà
WIN32


181 (
c
 = 
	`G‘O±iÚ
(
¬gc
, 
¬gv
, 
O±Li¡
, &
İrg
)) != 0)

183 (
c
 = 
	`g‘İt
(
¬gc
, 
¬gv
, 
O±Li¡
)è!ğ
EOF
)

186 
c
) {

188 ià(!
	`¡ºcmp
(
İrg
, "odec=", 5è&& 
	`isdig™
(()*(optarg + 5))) {

189 
codec_id
 = (
of_codec_id_t
)
	`©oi
(
İrg
 + 5);

191 
	`OF_PRINT_ERROR
(("bad‡rgum’ˆ-c%s\n", 
İrg
))

192  
OF_STATUS_FATAL_ERROR
;

197 ià(!
	`¡ºcmp
(
İrg
, "ind_min_overhead", 16)) {

198 
fšd_mš_ov”h—d_mode
 = 
Œue
;

200 
	`OF_PRINT_ERROR
(("bad‡rgum’ˆ-f%s\n", 
İrg
))

201  
OF_STATUS_FATAL_ERROR
;

206 ià(!
	`¡ºcmp
(
İrg
, "=", 1è&& 
	`isdig™
(()*(optarg + 1))) {

207 
tÙ_nb_sourû_symbŞs
 = 
	`©oi
(
İrg
 + 1);

208 
upd©ed_tÙ_nb_sourû_symbŞs
 = 
Œue
;

210 
	`OF_PRINT_ERROR
(("bad‡rgum’ˆ-k%s\n", 
İrg
))

211  
OF_STATUS_FATAL_ERROR
;

216 ià(!
	`¡ºcmp
(
İrg
, "=", 1è&& 
	`isdig™
(()*(optarg + 1))) {

217 
tÙ_nb_»·œ_symbŞs
 = 
	`©oi
(
İrg
 + 1);

218 
upd©ed_tÙ_nb_»·œ_symbŞs
 = 
Œue
;

219 } ià(!
	`¡ºcmp
(
İrg
, "©e=", 4è&& 
	`isdig™
(()*(optarg + 4))) {

220 
code_¿‹
 = 
	`©of
(
İrg
 + 4);

221 
ãc_¿tio
 = 1.0 / 
code_¿‹
;

222 
upd©ed_code_¿‹
 = 
Œue
;

223 } ià(!
	`¡ºcmp
(
İrg
, "s_m=", 4è&& 
	`isdig™
(()*(optarg + 4))) {

224 
rs_m_·¿m
 = 
	`©oi
(
İrg
 + 4);

225 } ià(!
	`¡ºcmp
(
İrg
, "x_¤c_¿tio=", 12è&& 
	`isdig™
(()*(optarg + 12))) {

226 
¤c_pkt_¿tio
 = 
	`©oi
(
İrg
 + 12);

227 
u£_¤c_pkt_¿tio
 = 
Œue
;

228 } ià(!
	`¡ºcmp
(
İrg
, "x_¤c_nb=", 9è&& 
	`isdig™
(()*(optarg + 9))) {

229 
¤c_pkt_nb
 = 
	`©oi
(
İrg
 + 9);

230 
u£_¤c_pkt_¿tio
 = 
çl£
;

232 
	`OF_PRINT_ERROR
(("bad‡rgum’ˆ-r%s\n", 
İrg
))

233  
OF_STATUS_FATAL_ERROR
;

238 ià(!
	`¡ºcmp
(
İrg
, "oss=0", 5)) {

239 
loss_mod–
 = 0;

240 } ià(!
	`¡ºcmp
(
İrg
, "oss=1:", 6)) {

241 
tmp_¡r
[256];

242 *
p
;

243 
	`¡ºıy
(
tmp_¡r
, 
İrg
 + 6, (tmp_str));

244 ià((
p
 = 
	`¡rchr
(
tmp_¡r
, ':')è!ğ
NULL
) {

245 *
p
 = '\0';

246 
p_sucûss_wh’_los£s
 = ()
	`©oi
(
p
 + 1);

247 
p_loss_wh’_ok
 = (è
	`©oi
(
tmp_¡r
 + 1);

249 
loss_mod–
 = 1;

250 } ià(!
	`¡ºcmp
(
İrg
, "oss=2:", 6) ) {

251 
tmp_¡r
[256];

252 *
p
 = 
NULL
;

253 
	`¡ºıy
(
tmp_¡r
, 
İrg
 + 6, (tmp_str));

254 
	`OF_PRINT_LVL
(2, ("p_loss %f max_loss_piece %d… %smp_str %s optarg %s\n",

255 
p_loss
, 
max_loss_p›û
, 
p
, 
tmp_¡r
, 
İrg
))

256 ià((
p
 = 
	`¡rchr
(
tmp_¡r
, ':')è!ğ
NULL
) {

257 
	`OF_PRINT_LVL
(2,("p_loss %f max_loss_piece %d… %smp_str %s optarg %s\n",

258 
p_loss
, 
max_loss_p›û
, 
p
 + 1, 
tmp_¡r
 , 
İrg
))

259 *
p
 = '\0';

260 
max_loss_p›û
 = 
	`©oi
(
p
 + 1);

261 
p_loss
 = ()
	`©of
(
tmp_¡r
 );

262 
	`OF_PRINT_LVL
(2,("p_loss %f max_loss_piece %d… %smp_str %s\n",

263 
p_loss
, 
max_loss_p›û
, 
p
, 
tmp_¡r
))

267 
loss_mod–
 = 2;

268 } ià(!
	`¡ºcmp
(
İrg
, "oss=3:", 6è&& 
	`isdig™
(()*(optarg + 6))) {

269 
loss_mod–
 = 3;

270 
nb_loss
 = 
	`©oi
(
İrg
 + 6);

271 } ià(!
	`¡ºcmp
(
İrg
, "oss=4", 5)) {

272 
loss_mod–
 = 4;

273 } ià(!
	`¡ºcmp
(
İrg
, "oss=5:", 6è&& 
	`isdig™
(()*(optarg + 6))) {

274 
loss_mod–
 = 5;

275 
Œim_aá”_this_nb_rx_pkts
 = 
	`©oi
(
İrg
 + 6);

276 } ià(!
	`¡ºcmp
(
İrg
, "dpc_N1=", 7è&& 
	`isdig™
(()*(optarg + 7))) {

277 
ldpc_N1
 = 
	`©oi
(
İrg
 + 7);

279 
	`OF_PRINT_ERROR
(("bad‡rgum’ˆ-l%s\n", 
İrg
))

280  
OF_STATUS_FATAL_ERROR
;

283 #ifdeà
READ_MATRIX_FILE


285 ià(!
	`¡ºcmp
(
İrg
, "atrix_file=", 11) ) {

286 
tmp_¡r
[1024];

288 
	`¡ºıy
(
tmp_¡r
, 
İrg
+11, (tmp_str));

289 
	`´štf
("tmp_¡¸: \"%s\" \n", 
tmp_¡r
);

290 
ldpc_m©rix_fe_Çme
 = (*)
	`m®loc
((
tmp_¡r
));

291 
	`¡ºıy
(
ldpc_m©rix_fe_Çme
, 
tmp_¡r
, (tmp_str));

292 
upd©ed_m©rix_fe
 = 
Œue
;

294 
	`OF_PRINT_ERROR
(("bad‡rgum’ˆ-m%s\n", 
İrg
))

295  
OF_STATUS_FATAL_ERROR
;

301 ià(!
	`¡ºcmp
(
İrg
, "ymb_sz=", 1è&& 
	`isdig™
(()*(optarg + 7))) {

302 
symbŞ_size
 = 
	`©oi
(
İrg
 + 7);

303 
upd©ed_symbŞ_size
 = 
Œue
;

304 } ià(!
	`¡ºcmp
(
İrg
, "“d=", 4è&& 
	`isdig™
(()*(optarg + 4))) {

305 
sugge¡ed_£ed
 = 
	`©oi
(
İrg
 + 4);

307 
	`OF_PRINT_ERROR
(("bad‡rgum’ˆ-s%s\n", 
İrg
))

308  
OF_STATUS_FATAL_ERROR
;

313 ià(!
	`¡ºcmp
(
İrg
, "Ù_¤c=", 7è&& 
	`isdig™
(()*(optarg + 7))) {

314 
tÙ_nb_sourû_symbŞs
 = 
	`©oi
(
İrg
 + 7);

315 
upd©ed_tÙ_nb_sourû_symbŞs
 = 
Œue
;

316 } ià(!
	`¡ºcmp
(
İrg
, "Ù_»p=", 7è&& 
	`isdig™
(()*(optarg + 7))) {

317 
tÙ_nb_»·œ_symbŞs
 = 
	`©oi
(
İrg
 + 7);

318 
upd©ed_tÙ_nb_»·œ_symbŞs
 = 
Œue
;

319 } ià(!
	`¡ºcmp
(
İrg
, "x_ty³=", 7è&& 
	`isdig™
(()*(optarg + 7))) {

321 
tx_mode
 = (
tx_mode_t
)
	`©oi
(
İrg
 + 7);

322 } ià(!
	`¡ºcmp
(
İrg
, "mpmax_k=", 8è&& 
	`isdig™
(()*(optarg + 8))) {

324 
tmpmax_k
 = 
	`©oi
(
İrg
 + 8);

327 
	`OF_PRINT_ERROR
(("bad‡rgum’ˆ-t%s\n", 
İrg
))

328  
OF_STATUS_FATAL_ERROR
;

332 ià(!
	`¡ºcmp
(
İrg
, "se_callbacks", 12) ) {

333 
u£_ÿÎback
 = 
Œue
;

337 ià(!
	`¡ºcmp
(
İrg
, "=", 1è&& 
	`isdig™
(()*(optarg + 1))) {

338 
of_v”bos™y
 = 
	`©oi
(
İrg
 + 1);

339 ià(
of_v”bos™y
 != 0 && of_verbosity != 1 && of_verbosity != 2) {

340 
	`OF_PRINT_ERROR
(("bad‡rgum’ˆ-v%s, v®uouˆoà¿ng(Úly {0, 1, 2}‡»‡cû±ed)\n", 
İrg
))

341  
OF_STATUS_FATAL_ERROR
;

344 
	`OF_PRINT_ERROR
(("bad‡rgum’ˆ-v%s\n", 
İrg
))

345  
OF_STATUS_FATAL_ERROR
;

350 ià(!
	`¡ºcmp
(
İrg
, "bj_sz=", 6è&& 
	`isdig™
(()*(optarg + 6))) {

351 
objeù_size
 = 
	`©oi
(
İrg
 + 6);

352 
upd©ed_objeù_size
 = 
Œue
;

354 
	`OF_PRINT_ERROR
(("bad‡rgum’ˆ-o%s\n", 
İrg
))

355  
OF_STATUS_FATAL_ERROR
;

360 
	`´štU§ge
(
¬gv
[0]);

369 ià(
c
 != '?') {

370 
	`årštf
(
¡d”r
, "ERROR, bad‡rgument\n");

372 
	`´štU§ge
(
¬gv
[0]);

376  
OF_STATUS_OK
;

377 
	}
}

380 
of_¡©us_t


381 
	$fšish_š™_commªd_lše_·¿ms
 ()

384 ià(
upd©ed_tÙ_nb_sourû_symbŞs
 && 
upd©ed_objeù_size
) {

385 
	`OF_PRINT_ERROR
(("ERROR: cannot specify bothot_nb_source_symbols‡nd object_size\n"))

386 
”rÜ
;

388 ià(
upd©ed_tÙ_nb_»·œ_symbŞs
 && 
upd©ed_objeù_size
) {

389 
	`OF_PRINT_ERROR
(("ERROR: cannot specify both updated_tot_nb_repair_symbols‡nd object_size\n"))

390 
”rÜ
;

392 ià(
upd©ed_tÙ_nb_»·œ_symbŞs
 && 
upd©ed_code_¿‹
) {

393 
	`OF_PRINT_ERROR
(("ERROR: cannot specify bothot_nb_repair_symbols‡nd code_rate\n"))

394 
”rÜ
;

396 ià(
upd©ed_tÙ_nb_»·œ_symbŞs
 && 
upd©ed_code_¿‹
) {

397 
	`OF_PRINT_ERROR
(("ERROR: cannot specify bothot_nb_repair_symbols‡nd code_rate\n"))

398 
”rÜ
;

400 ià(
upd©ed_m©rix_fe
 && (
upd©ed_code_¿‹
 || 
upd©ed_tÙ_nb_sourû_symbŞs
 || 
upd©ed_tÙ_nb_»·œ_symbŞs
 || 
upd©ed_objeù_size
 || updated_code_rate )) {

405 ià(
upd©ed_symbŞ_size
 && (
symbŞ_size
 == 0)) {

406 
	`OF_PRINT_ERROR
(("ERROR: invalid symbol size 0 (must be >= 1).\n"))

407 
”rÜ
;

409 ià(
upd©ed_code_¿‹
 && ((
code_¿‹
 <= 0.0) || (code_rate > 1.0))) {

410 
	`OF_PRINT_ERROR
(("ERROR: inv®id cod¿‹ %f<n>\n", 
code_¿‹
))

411 
”rÜ
;

413 ià(
upd©ed_objeù_size
 && !(
objeù_size
 % 
symbŞ_size
 == 0))

415 
	`OF_PRINT_ERROR
(("ERROR: objeù siz(%dèmu¡ b¨muÉË oàsymbŞ siz(%d).\n", 
objeù_size
, 
symbŞ_size
))

416 
”rÜ
;

419 ià(
upd©ed_objeù_size
) {

420 
tÙ_nb_sourû_symbŞs
 = (
UINT32
)(()
objeù_size
 / ()
symbŞ_size
);

421 
tÙ_nb_’codšg_symbŞs
 = (
UINT32
)
	`û
(()
tÙ_nb_sourû_symbŞs
 / 
code_¿‹
);

422 
tÙ_nb_»·œ_symbŞs
 = 
tÙ_nb_’codšg_symbŞs
 - 
tÙ_nb_sourû_symbŞs
;

423 
code_¿‹
 = ()
tÙ_nb_sourû_symbŞs
 / ()
tÙ_nb_’codšg_symbŞs
;

424 } ià(
upd©ed_tÙ_nb_sourû_symbŞs
) {

425 
tÙ_nb_’codšg_symbŞs
 = 
tÙ_nb_sourû_symbŞs
 + 
tÙ_nb_»·œ_symbŞs
;

426 
objeù_size
 = 
tÙ_nb_sourû_symbŞs
 * 
symbŞ_size
;

427 
code_¿‹
 = ()
tÙ_nb_sourû_symbŞs
 / ()(
tÙ_nb_’codšg_symbŞs
);

429 #ifdeà
READ_MATRIX_FILE


430 ià(
upd©ed_m©rix_fe
) {

433 if(
	`of_g‘_pck_m©rix_dim’siÚs_äom_fe
(
ldpc_m©rix_fe_Çme
, &
tÙ_nb_»·œ_symbŞs
, &
tÙ_nb_’codšg_symbŞs
è!ğ
OF_STATUS_OK
){

434 
	`OF_PRINT_ERROR
(("ERROR: cannot„ead…ck matrix dimension from file\n"))

435 
”rÜ
;

437 
tÙ_nb_sourû_symbŞs
 = 
tÙ_nb_’codšg_symbŞs
 - 
tÙ_nb_»·œ_symbŞs
;

438 
objeù_size
 = 
tÙ_nb_sourû_symbŞs
 * 
symbŞ_size
;

439 
code_¿‹
 = ()
tÙ_nb_sourû_symbŞs
 / ()(
tÙ_nb_’codšg_symbŞs
);

442 ià(
upd©ed_symbŞ_size
 && !
upd©ed_tÙ_nb_sourû_symbŞs
 && !
upd©ed_objeù_size
) {

443 
objeù_size
 = 
tÙ_nb_sourû_symbŞs
 * 
symbŞ_size
;

445 ià(
upd©ed_code_¿‹
 && !
upd©ed_tÙ_nb_sourû_symbŞs
 && !
upd©ed_objeù_size
) {

446 
tÙ_nb_’codšg_symbŞs
 = (
UINT32
)
	`û
(()
tÙ_nb_sourû_symbŞs
 / 
code_¿‹
);

447 
tÙ_nb_»·œ_symbŞs
 = 
tÙ_nb_’codšg_symbŞs
 - 
tÙ_nb_sourû_symbŞs
;

449 ià(
upd©ed_tÙ_nb_»·œ_symbŞs
 && !
upd©ed_tÙ_nb_sourû_symbŞs
 && !
upd©ed_objeù_size
) {

450 
tÙ_nb_’codšg_symbŞs
 = 
tÙ_nb_sourû_symbŞs
 +ot_nb_source_symbols;

451 
code_¿‹
 = ()
tÙ_nb_sourû_symbŞs
 / ()(
tÙ_nb_’codšg_symbŞs
);

453 
ãc_¿tio
 = 1.0 / 
code_¿‹
;

454 ià(
fšd_mš_ov”h—d_mode
 =ğ
Œue
) {

457 
Œim_aá”_this_nb_rx_pkts
 = 
tÙ_nb_sourû_symbŞs
;

458 ià(
sugge¡ed_£ed
 == 0) {

459 
	`OF_PRINT_ERROR
(("ERROR: seed must be specified in find_min_overhead mode\n"))

460 
”rÜ
;

463 
	`OF_PRINT
(("tot_nb_source_symbols=%iot_nb_repair_symbols=%i symbol_size=%i†dpc_N1=%i„s_m=%i ",

464 
tÙ_nb_sourû_symbŞs
, 
tÙ_nb_»·œ_symbŞs
, 
symbŞ_size
, 
ldpc_N1
, 
rs_m_·¿m
))

465 
	`OF_PRINT
(("codec_id=%d\n",
codec_id
))

467 
tx_mode
)

470 
	`OF_PRINT
(("transmission_type=randomly_send_all_source_and_repair_symbols\n"))

473 
	`OF_PRINT
(("transmission_type=randomly_send_a_few_source_symbols_and_repair_symbols\n"))

476 
	`OF_PRINT
(("transmission_type=randomly_send_a_few_src_symbols_first_then_randomly_all_repair_symbols\n"))

479 
	`OF_PRINT
(("transmission_type=randomly_send_only_repair_symbols\n"))

482 
	`OF_PRINT
(("transmission_type=sequentially_send_all_src_symbols_first_then_repair_symbols\n"))

485 
	`OF_PRINT
(("transmission_type=sequentially_send_all_repair_symbols_first_then_src_symbols\n"))

488 
	`OF_PRINT
(("transmission_type=sequentially_send_all_src_symbols_first_then_randomly_src_symbols\n"))

491 
	`OF_PRINT
(("transmission_type=sequentially_send_all_repair_symbols_first_then_randomly_src_symbols\n"))

494 
	`OF_PRINT
(("simulate broadcastransmission with unicast„epair\n"))

499  
OF_STATUS_OK
;

501 
”rÜ
:

502  
OF_STATUS_ERROR
;

503 
	}
}

	@applis/eperftool/defaults.h

45 
	#DFLT_TOT_NB_SOURCE
 2000

	)

49 
	#DFLT_TOT_NB_REPAIR
 1000

	)

52 
	#DFLT_SYMBOL_SZ
 1024

	)

55 
	#DFLT_VERBOSITY
 0

	)

63 
	#DFLT_RS_M_PARAM
 8

	)

66 
	#DFLT_LDPC_N1
 5

	)

69 
	#DFLT_CODE_RATE_LDPC_STAIRCASE_FOR_GLDPC
 0.5

	)

72 
	#MAX_N_FOR_RS_GF_2_8
 255

	)

75 
	#MAX_N_FOR_RS_GF_2_16
 65535

	)

82 
	#CHECK_INTEGRITY
 1

	)

88 
	#P_LOSS_WHEN_OK
 1

	)

93 
	#P_SUCCESS_WHEN_LOSSES
 25

	)

	@applis/eperftool/eperftool.c

37 
	~"•”áoŞ.h
"

40 
´št_·¿ms
();

43 
	$Of_SaveFe
(* 
feName
, **
pBuf
, 
symbŞSize
, 
tÙ®SymbŞ
)

45 
FILE
* 
pFe
 = 
NULL
;

46 
UINT32
 
s32R‘
 = 0;

47 
UINT32
 
i
 = 0;

48 
UINT32
 
j
 = 0;

49 *
psymb
 = 
NULL
;

51 
pFe
 = 
	`fİ’
(
feName
, "ab");

52 ià(
pFe
 =ğ
NULL
 || 
pBuf
 == NULL)

54 
	`OF_PRINT
(("open fileƒrr…File 0x%p…Buf 0x%p\n",

55 
pFe
, 
pBuf
));

58 if(1 =ğ
tÙ®SymbŞ
){

60 
	`fwr™e
(*
pBuf
, 
symbŞSize
, 1, 
pFe
);

61 
	`fæush
(
pFe
);

64 
i
 = 0; i < 
tÙ®SymbŞ
; i++)

66 
psymb
 = 
pBuf
[
i
];

68 
	`fwr™e
(
psymb
, 
symbŞSize
, 1, 
pFe
);

69 
	`fæush
(
pFe
);

73 
	`fşo£
(
pFe
);

76 
	}
}

81 
	$maš
 (
¬gc
,

82 **
¬gv
 )

84 
of_¡©us_t
 
»t
;

85 
INT32
 
dec_¡©us
;

90 #ifdeà
WIN32


91 
	`Qu”yP”fÜmªûF»qu’cy
(&
äeq
);

94 
»t
 = 
	`·r£_commªd_lše
(
¬gc
, 
¬gv
);

95 ià(
»t
 !ğ
OF_STATUS_OK
) {

96 
	`OF_PRINT_ERROR
(("ERROR,…arse_command_line() failed\n"))

97 
”rÜ
;

99 
»t
 = 
	`fšish_š™_commªd_lše_·¿ms
();

100 ià(
»t
 !ğ
OF_STATUS_OK
) {

101 
	`OF_PRINT_ERROR
(("ERROR, finish_init_command_line_params() failed\n"))

102 
”rÜ
;

104 ià(
of_v”bos™y
 > 0) {

105 
	`´št_·¿ms
();

107 ià(
fšd_mš_ov”h—d_mode
 =ğ
çl£
) {

108 
	`OF_PRINT_LVL
(2,("enter start_enc_dec_test \r\n"))

109 
dec_¡©us
 = 
	`¡¬t_’c_dec_‹¡
 ();

110 
	`OF_PRINT_LVL
(2,("Ëav¡¬t_’c_dec_‹¡ dec_¡©u %d\r\n", 
dec_¡©us
))

111 ià(
dec_¡©us
 < 0) {

112 
”rÜ
;

115 
	#DEFAULT_INCREMENT_TO_FIND_MIN_OVERHEAD
 50

	)

116 
INT32
 
low”_bound_w™h_çu»
;

117 
INT32
 
uµ”_bound_w™h_sucûss
;

118 
bak
, 
Ãw
;

146 
	`ASSERT
(
Œim_aá”_this_nb_rx_pkts
 > 0);

148 
low”_bound_w™h_çu»
 = 
tÙ_nb_sourû_symbŞs
 - 1;

149 
uµ”_bound_w™h_sucûss
 = -1;

150 
Œim_aá”_this_nb_rx_pkts
 = 
tÙ_nb_sourû_symbŞs
; ; ) {

151 
	`OF_PRINT_LVL
(2,("===> (1)est with %d„ecvd symbols (overhead %d)‡nd %d†ost symbols... ",

152 
Œim_aá”_this_nb_rx_pkts
,rim_aá”_this_nb_rx_pkt - 
tÙ_nb_sourû_symbŞs
,

153 
tÙ_nb_’codšg_symbŞs
 - 
Œim_aá”_this_nb_rx_pkts
))

154 ià(
of_v”bos™y
 == 0) {

156 
	`fæush
(
¡dout
);

157 
bak
 = 
	`dup
(1);

158 
Ãw
 = 
	`İ’
("/dev/nuÎ", 
O_WRONLY
);

159 
	`dup2
(
Ãw
, 1);

160 
	`şo£
(
Ãw
);

163 
	`OF_PRINT_LVL
(2,("enter start_enc_dec_test %d %d %d \r\n",

164 
tÙ_nb_sourû_symbŞs
,

165 
Œim_aá”_this_nb_rx_pkts
,

166 
tÙ_nb_’codšg_symbŞs
));

167 
dec_¡©us
 = 
	`¡¬t_’c_dec_‹¡
 ();

168 
	`OF_PRINT_LVL
(2,("leave start_enc_dec_test %d %d %d dec_status %d\r\n",

169 
tÙ_nb_sourû_symbŞs
,

170 
Œim_aá”_this_nb_rx_pkts
,

171 
tÙ_nb_’codšg_symbŞs
,

172 
dec_¡©us
));

173 ià(
of_v”bos™y
 == 0) {

175 
	`fæush
(
¡dout
);

176 
	`dup2
(
bak
, 1);

177 
	`şo£
(
bak
);

178 
	`OF_PRINT
(("\t%s\n", 
dec_¡©us
 == 0 ? "OK" : "failed"))

180 
	`OF_PRINT
(("\n"))

182 ià(
dec_¡©us
 == 0) {

184 
uµ”_bound_w™h_sucûss
 = 
Œim_aá”_this_nb_rx_pkts
;

187 ià(
dec_¡©us
 < 0) {

188 
”rÜ
;

191 
low”_bound_w™h_çu»
 = 
Œim_aá”_this_nb_rx_pkts
;

192 ià(
Œim_aá”_this_nb_rx_pkts
 =ğ
tÙ_nb_’codšg_symbŞs
) {

195 
	`OF_PRINT_ERROR
(("ERROR,‡llests failedo find min overhead,ƒven‡fter„eceiving %d symbols\n",

196 
Œim_aá”_this_nb_rx_pkts
))

197 
”rÜ
;

200 
Œim_aá”_this_nb_rx_pkts
 +ğ
DEFAULT_INCREMENT_TO_FIND_MIN_OVERHEAD
;

201 
Œim_aá”_this_nb_rx_pkts
 = 
	`mš
Ñrim_aá”_this_nb_rx_pkts, 
tÙ_nb_’codšg_symbŞs
);

205 
	`ASSERT
(
uµ”_bound_w™h_sucûss
 != -1);

206 ià(
uµ”_bound_w™h_sucûss
 =ğ
low”_bound_w™h_çu»
 + 1) {

208 
	`ASSERT
(
Œim_aá”_this_nb_rx_pkts
 =ğ
uµ”_bound_w™h_sucûss
);

210 
Œim_aá”_this_nb_rx_pkts
 = 
low”_bound_w™h_çu»
 + 1;

211 
Œim_aá”_this_nb_rx_pkts
 <ğ
uµ”_bound_w™h_sucûss
;

212 
Œim_aá”_this_nb_rx_pkts
++) {

213 
	`OF_PRINT
(("===> (2)est with %d„ecvd symbols (overhead %d)‡nd %d†ost symbols... ",

214 
Œim_aá”_this_nb_rx_pkts
,rim_aá”_this_nb_rx_pkt - 
tÙ_nb_sourû_symbŞs
,

215 
tÙ_nb_’codšg_symbŞs
 - 
Œim_aá”_this_nb_rx_pkts
))

216 ià(
of_v”bos™y
 == 0) {

218 
	`fæush
(
¡dout
);

219 
bak
 = 
	`dup
(1);

220 
Ãw
 = 
	`İ’
("/dev/nuÎ", 
O_WRONLY
);

221 
	`dup2
(
Ãw
, 1);

222 
	`şo£
(
Ãw
);

225 
dec_¡©us
 = 
	`¡¬t_’c_dec_‹¡
 ();

226 ià(
of_v”bos™y
 == 0) {

228 
	`fæush
(
¡dout
);

229 
	`dup2
(
bak
, 1);

230 
	`şo£
(
bak
);

231 
	`OF_PRINT
(("\t%s\n", 
dec_¡©us
 == 0 ? "OK" : "failed"))

233 
	`OF_PRINT
(("\n"))

235 ià(
dec_¡©us
 == 0) {

239 ià(
dec_¡©us
 < 0) {

240 
”rÜ
;

244 ià(
of_v”bos™y
 == 0) {

246 
	`OF_PRINT_LVL
(2,("enter start_enc_dec_test\r\n"))

247 
dec_¡©us
 = 
	`¡¬t_’c_dec_‹¡
 ();

248 
	`OF_PRINT_LVL
(2,("leave start_enc_dec_test dec_status %d\r\n",

249 
dec_¡©us
))

250 
	`ASSERT
(
dec_¡©us
 == 0);

254 
	`ASSERT
(
Œim_aá”_this_nb_rx_pkts
 > 0);

255 
Œim_aá”_this_nb_rx_pkts
 <ğ
tÙ_nb_’codšg_symbŞs
) {

258 
	`OF_PRINT
(("===>est with %d„ecvd symbols‡nd %d†ost symbols...\n",

259 
Œim_aá”_this_nb_rx_pkts
, 
tÙ_nb_’codšg_symbŞs
 -rim_after_this_nb_rx_pkts))

260 
dec_¡©us
 = 
	`¡¬t_’c_dec_‹¡
 ();

261 ià(
dec_¡©us
 == 0) {

265 ià(
dec_¡©us
 < 0) {

266 
”rÜ
;

268 
Œim_aá”_this_nb_rx_pkts
++;

274 
”rÜ
:

275 
	`OF_PRINT
(("decoding_status=2\n"))

277 
	}
}

282 
	$¡¬t_’c_dec_‹¡
 ()

284 
of_¡©us_t
 
»t
;

285 
INT32
 
dec_¡©us
 = -1;

288 
»t
 = 
	`š™_£nd”
();

289 ià(
»t
 !ğ
OF_STATUS_OK
) {

290 
	`OF_PRINT_ERROR
(("ERROR, init_sender() failed\n"))

291 
”rÜ
;

293 
»t
 = 
	`š™_»ûiv”
();

294 ià(
»t
 !ğ
OF_STATUS_OK
) {

295 
	`OF_PRINT_ERROR
(("ERROR, init_receiver() failed\n"))

296 
”rÜ
;

298 
»t
 = 
	`š™_tx_simuÏtÜ
();

299 ià(
»t
 !ğ
OF_STATUS_OK
) {

300 
	`OF_PRINT_ERROR
(("ERROR, init_tx_simulator() failed\n"))

301 
”rÜ
;

304 #ifdeà
OF_DEBUG


309 
	`´št_·¿ms
();

310 
	`´št_rx_¡©s
();

313 
»t
 = 
	`’code
();

314 ià(
»t
 !ğ
OF_STATUS_OK
) {

315 
	`OF_PRINT_ERROR
(("ERROR,ƒncode() failed\n"))

316 
”rÜ
;

319 
»t
 = 
	`»ûive_ªd_decode
();

320 
»t
)

322 
OF_STATUS_ERROR
:

323 
OF_STATUS_FATAL_ERROR
:

324 
	`şo£_tx_simuÏtÜ
();

325 
	`OF_PRINT_ERROR
(("ERROR,„eceive_and_decode() failed\n"))

326 
”rÜ
;

327 
OF_STATUS_FAILURE
:

328 
	`OF_PRINT
(("eperf_tool: decoding failure\n"))

329 
	`OF_PRINT
(("decoding_status=1\n"))

330 
dec_¡©us
 = 1;

332 
OF_STATUS_OK
:

333 
	`OF_PRINT
(("eperf_tool: decoding ok\n"))

334 
	`OF_PRINT
(("decoding_status=0\n"))

335 
dec_¡©us
 = 0;

338 
»t
 = 
	`şo£_tx_simuÏtÜ
();

339 ià(
»t
 !ğ
OF_STATUS_OK
) {

340 
	`OF_PRINT_ERROR
(("ERROR, close_tx_simulator() failed\n"))

341 
”rÜ
;

344  
dec_¡©us
;

346 
”rÜ
:

347 
	`OF_PRINT
(("decoding_status=2\n"))

349 
	}
}

353 
	$´št_´—mbË
 (*
commªd_lše
)

355 *
v”siÚ
;

356 *
cİyrights
;

358 
	`OF_PRINT
(("%s", 
commªd_lše
))

359 
	`OF_PRINT
(("eperf_tool:‡nƒxtended AL-FEC…erformanceƒvaluationool\n"))

362 
	`of_mÜe_about
((
of_£ssiÚ_t
*)
NULL
, &
v”siÚ
, &
cİyrights
);

363 
	`OF_PRINT
(("%s\n", 
v”siÚ
))

364 
	}
}

368 
	$´št_·¿ms
()

370 
	`OF_TRACE_LVL
(1, ("eperftool…arams:\n"))

371 
	`OF_TRACE_LVL
(1, ("\tcodec_id:\t\t%i\n", 
codec_id
))

372 
	`OF_TRACE_LVL
(1, ("\‰Ù_nb_sourû_symbŞs:\t%i\n", 
tÙ_nb_sourû_symbŞs
))

373 
	`OF_TRACE_LVL
(1, ("\‰Ù_nb_»·œ_symbŞs:\t%i\n", 
tÙ_nb_»·œ_symbŞs
))

374 
	`OF_TRACE_LVL
(1, ("\tcode_¿‹:\t\t%f\n", 
code_¿‹
))

375 
	`OF_TRACE_LVL
(1, ("\tãc_¿tio:\t\t%f\n", 
ãc_¿tio
))

376 
	`OF_TRACE_LVL
(1, ("\t¤c_pkt_¿tio:\t\t%i\n", 
¤c_pkt_¿tio
))

377 
	`OF_TRACE_LVL
(1, ("\tu£_¤c_pkt_¿tio:\t%s\n", 
u£_¤c_pkt_¿tio
 ? "true" : "false"))

378 
	`OF_TRACE_LVL
(1, ("\t¤c_pkt_nb:\t\t%i\n", 
¤c_pkt_nb
))

379 
	`OF_TRACE_LVL
(1, ("\tobjeù_size:\t\t%˜by‹s\n", 
objeù_size
))

380 
	`OF_TRACE_LVL
(1, ("\tsymbŞ_size:\t\t%˜by‹s\n", 
symbŞ_size
))

381 
	`OF_TRACE_LVL
(1, ("\tsugge¡ed_£ed:\t\t%i\n", 
sugge¡ed_£ed
))

382 
	`OF_TRACE_LVL
(1, ("\oss_mod–:\t\t%i\n", 
loss_mod–
))

383 
	`OF_TRACE_LVL
(1, ("\dpc_N1:\t\t%i\n", 
ldpc_N1
))

384 
	`OF_TRACE_LVL
(1, ("\_sucûss_wh’_los£s:\t%f\n", 
p_sucûss_wh’_los£s
))

385 
	`OF_TRACE_LVL
(1, ("\_loss_wh’_ok:\t\t%f\n", 
p_loss_wh’_ok
))

386 
	`OF_TRACE_LVL
(1, ("\_loss:\t\t\t%f\n", 
p_loss
))

387 
	`OF_TRACE_LVL
(1, ("\Šb_loss:\t\t%i\n", 
nb_loss
))

388 
	`OF_TRACE_LVL
(1, ("\‰rim_aá”_this_nb_rx_pkts:\t\t%i\n", 
Œim_aá”_this_nb_rx_pkts
))

390 
	}
}

	@applis/eperftool/eperftool.h

37 
	~<¡dio.h
>

38 
	~<¡dlib.h
>

39 
	~<m©h.h
>

40 
	~<¡ršg.h
>

41 
	~<uni¡d.h
>

42 
	~<fú.h
>

44 #ifdeà
WIN32


45 
	~<Wšsock2.h
>

46 
	~<wšdows.h
>

48 
	~<uni¡d.h
>

49 
	~<ùy³.h
>

50 
	~<sys/ty³s.h
>

51 
	~<sys/sock‘.h
>

52 
	~<Ãtš‘/š.h
>

53 
	~<¬·/š‘.h
>

54 
	~<sys/time.h
>

57 
	#OF_USE_ENCODER


	)

58 
	#OF_USE_DECODER


	)

59 
	~"../../¤c/lib_commÚ/of_İ’ãc_­i.h
"

60 
	~"../../¤c/lib_commÚ/of_mem.h
"

62 #ifdeà
WIN32


63 
	~"../¤c/g‘İt.h
"

66 
	~"deçuÉs.h
"

67 
	~"blockšg_¡ruù.h
"

68 
	~"ÿÎbacks.h
"

71 
	#mš
(
a
,
b
è(×è<ğ(bè? (aè: (b))

	)

72 
	#max
(
a
,
b
è(×è< (bè? (bè: (a))

	)

80 
	mTX_MODE_ALL_RANDOM
 = 0,

81 
	mTX_MODE_FEW_SRC_SYMBOLS
,

82 
	mTX_MODE_FEW_SRC_SYMBOLS_FIRST
,

83 
	mTX_MODE_NON_SYSTEMATIC
,

84 
	mTX_MODE_SEQUENTIAL
,

85 
	mTX_MODE_INVERSE_SEQUENTIAL
,

86 
	mTX_MODE_SEQUENTIAL_SRC_THEN_RANDOM_REPAIR
,

87 
	mTX_MODE_SEQUENTIAL_REPAIR_THEN_RANDOM_SRC
,

88 
	mTX_MODE_SIMUL_BCAST_WITH_UNICAST_REPAIR
,

89 
	mTX_MODE_BLOCK_SEQUENTIAL
,

91 } 
	ttx_mode_t
;

97 
	sblock_cb
 {

98 
UINT32
 
	msbn
;

99 
UINT32
 
	mk
;

100 
UINT32
 
	mn
;

102 
UINT32
 
	mfœ¡_¤c_symbŞ_idx
;

104 
UINT32
 
	mfœ¡_»·œ_symbŞ_idx
;

110 
boŞ
 
	mis_decoded
;

112 
boŞ
 
	mis_abªdÚed
;

114 
UINT32
 
	mnb_symbŞs_»ûived
;

116 
of_£ssiÚ_t
 *
	m£s
;

121 
UINT32
 
	mldpc_£ed
;

122 
UINT32
 
	mldpc_N1
;

123 
boŞ
 
	mldpc_dÚt_£nd_Ï¡_»·œ
;

125 } 
	tblock_cb_t
;

131 
	ssymbŞ_cb
 {

132 
UINT32
 
	mesi
;

133 
UINT32
 
	msbn
;

134 } 
	tsymbŞ_cb_t
;

137 
	~"glob®s.h
"

138 
	~"codec_š¡ªû_mgmt.h
"

149 
¡¬t_’c_dec_‹¡
 ();

154 
´št_´—mbË
 (*
commªd_lše
);

156 
of_¡©us_t
 
·r£_commªd_lše
 (
INT32
 
¬gc
, *
¬gv
[]);

163 
of_¡©us_t
 
fšish_š™_commªd_lše_·¿ms
 ();

165 
of_¡©us_t
 
š™_´ng_w™h_£ed
 (
UINT32
 
sugge¡ed_£ed
);

167 
of_¡©us_t
 
š™_£nd”
 ();

169 
of_¡©us_t
 
’code
 ();

171 
of_¡©us_t
 
š™_»ûiv”
 ();

173 
of_¡©us_t
 
»ûive_ªd_decode
 ();

175 
of_¡©us_t
 
š™_tx_simuÏtÜ
 ();

177 
symbŞ_cb_t
 * 
g‘_Ãxt_symbŞ_»ûived
 ();

179 
of_¡©us_t
 
şo£_tx_simuÏtÜ
 ();

181 #ifdeà
OF_DEBUG


182 
´št_rx_¡©s
 ();

185 
of_¡©us_t
 
´št_u§ge
 (*
cmdName
);

193 
UINT32
 
my¿nd
 ();

	@applis/eperftool/globals.c

36 
	~"•”áoŞ.h
"

45 
UINT32
 
	gtÙ_nb_sourû_symbŞs
 = 
DFLT_TOT_NB_SOURCE
;

49 
UINT32
 
	gtÙ_nb_»·œ_symbŞs
 = 
DFLT_TOT_NB_REPAIR
;

53 
UINT32
 
	gtÙ_nb_’codšg_symbŞs
 = 
DFLT_TOT_NB_SOURCE
 + 
DFLT_TOT_NB_REPAIR
;

56 
UINT32
 
	gsymbŞ_size
 = 
DFLT_SYMBOL_SZ
;

59 
UINT32
 
	gobjeù_size
 = 
DFLT_TOT_NB_SOURCE
 * 
DFLT_SYMBOL_SZ
;

62 
UINT32
 
	gtmpmax_k
 = 
MAX_N_FOR_RS_GF_2_8
;

65 
	gcode_¿‹
 = ()
DFLT_TOT_NB_SOURCE
 / ()(DFLT_TOT_NB_SOURCE + 
DFLT_TOT_NB_REPAIR
);

66 
	gãc_¿tio
 = ()(
DFLT_TOT_NB_SOURCE
 + 
DFLT_TOT_NB_REPAIR
) / ()DFLT_TOT_NB_SOURCE;

74 
UINT16
 
	grs_m_·¿m
 = 
DFLT_RS_M_PARAM
;

77 
UINT32
 
	gldpc_N1
 = 
DFLT_LDPC_N1
;

80 *
	gldpc_m©rix_fe_Çme
 = 
NULL
;

83 
of_codec_id_t
 
	gcodec_id
 = 
OF_CODEC_LDPC_STAIRCASE_STABLE
;

85 
tx_mode_t
 
	gtx_mode
 = 
TX_MODE_ALL_RANDOM
;

87 
UINT32
 
	gsugge¡ed_£ed
 = 0;

89 
INT32
 
	gmax_decodšg_¡•s
 = -1;

91 
UINT32
 
	gmax_loss_p›û
 = 1;

93 
boŞ
 
	gfšd_mš_ov”h—d_mode
 = 
çl£
;

97 
boŞ
 
	gu£_ÿÎback
=
çl£
;

102 
boŞ
 
	gu£_¤c_pkt_¿tio
ğ
Œue
;

104 
UINT32
 
	g¤c_pkt_¿tio
 = 20;

105 
UINT32
 
	g¤c_pkt_nb
 = 0;

107 
UINT32
 
	gloss_mod–
 = 0;

108 
UINT32
 
	gtx_simul_loss
 = 0;

109 
INT32
 
	gŒim_aá”_this_nb_rx_pkts
 = -1;

112 
	gp_loss_wh’_ok
 = 
P_LOSS_WHEN_OK
;

113 
	gp_sucûss_wh’_los£s
 = 
P_SUCCESS_WHEN_LOSSES
;

115 
	gp_loss
 = 
P_LOSS
;

117 
UINT32
 
	gnb_loss
 = 
NB_LOSS
;

123 #ifdeà
WIN32


124 
LARGE_INTEGER
 
	gtv0
;

125 
LARGE_INTEGER
 
	gtv1
;

126 
LARGE_INTEGER
 
	gäeq
;

128 
timev®
 
	gtv0
;

129 
timev®
 
	gtv1
;

130 
timev®
 
	gtv_d–
;

134 
of_blockšg_¡ruù_t
 
	gbs
;

135 
UINT32
 
	gmax_k
;

136 
UINT32
 
	gmax_n
;

137 
UINT32
 
	gtÙ_nb_blocks
;

138 
UINT32
 
	gk_fÜ_this_blk
;

164 **
	gÜig_symb
;

169 **
	gava_symb
;

179 
block_cb_t
 *
	gblk_cb_b
;

189 
symbŞ_cb_t
 *
	gsymb_cb_b
;

	@applis/eperftool/globals.h

35 #iâdef 
GLOBALS_H


36 
	#GLOBALS_H


	)

44 
UINT32
 
tÙ_nb_sourû_symbŞs
;

48 
UINT32
 
tÙ_nb_»·œ_symbŞs
;

52 
UINT32
 
tÙ_nb_’codšg_symbŞs
;

55 
UINT32
 
symbŞ_size
;

58 
UINT32
 
objeù_size
;

60 
UINT32
 
tmpmax_k
;

63 
code_¿‹
;

64 
ãc_¿tio
;

72 
UINT16
 
rs_m_·¿m
;

75 
UINT32
 
ldpc_N1
;

78 *
ldpc_m©rix_fe_Çme
;

80 
UINT32
 
qc_ldpc_exp_çùÜ
;

83 
of_codec_id_t
 
codec_id
;

86 
tx_mode_t
 
tx_mode
;

89 
UINT32
 
sugge¡ed_£ed
;

92 
INT32
 
max_decodšg_¡•s
;

94 
UINT32
 
max_loss_p›û
;

98 
boŞ
 
fšd_mš_ov”h—d_mode
;

105 
boŞ
 
u£_ÿÎback
;

111 
boŞ
 
u£_¤c_pkt_¿tio
;

114 
UINT32
 
¤c_pkt_¿tio
;

117 
UINT32
 
¤c_pkt_nb
;

120 
UINT32
 
loss_mod–
;

123 
UINT32
 
tx_simul_loss
;

127 
INT32
 
Œim_aá”_this_nb_rx_pkts
;

130 
p_loss_wh’_ok
;

131 
p_sucûss_wh’_los£s
;

133 
	#P_LOSS
 0

	)

134 
p_loss
;

135 
	#NB_LOSS
 0

	)

136 
UINT32
 
nb_loss
;

142 #ifdeà
WIN32


143 
LARGE_INTEGER
 
tv0
;

144 
LARGE_INTEGER
 
tv1
;

145 
LARGE_INTEGER
 
äeq
;

147 
timev®
 
tv0
;

148 
timev®
 
tv1
;

149 
timev®
 
tv_d–
;

153 
of_blockšg_¡ruù_t
 
bs
;

154 
UINT32
 
max_k
;

155 
UINT32
 
max_n
;

156 
UINT32
 
tÙ_nb_blocks
;

185 **
Üig_symb
;

190 **
ava_symb
;

200 
block_cb_t
 *
blk_cb_b
;

210 
symbŞ_cb_t
 *
symb_cb_b
;

	@applis/eperftool/receiver.c

37 
	~"•”áoŞ.h
"

38 
	~<uni¡d.h
>

40 
of_¡©us_t


41 
	$š™_»ûiv”
 ()

46 ià((
ava_symb
 = (**)
	`ÿÎoc
(
tÙ_nb_’codšg_symbŞs
, (*))è=ğ
NULL
) {

47 
no_mem
;

55 ià(!(
’codšg_symbŞs_b
 = (**)
	`m®loc
(
bs
.
A_Ïrge
 * (*)))) {

56 
no_mem
;

59  
OF_STATUS_OK
;

61 
no_mem
:

62  
OF_STATUS_ERROR
;

63 
	}
}

66 
of_¡©us_t


67 
	$»ûive_ªd_decode
 ()

70 
block_cb_t
 *
blk
;

71 
UINT32
 
sbn
;

76 
UINT32
 
tÙ_nb_»cvd_symbŞs
;

77 
UINT32
 
tÙ_nb_decoded_blocks
;

78 
UINT32
 
Ãw_symb_idx
;

79 
symbŞ_cb_t
 *
Ãw_symb_cb
;

81 
tÙ_nb_»cvd_symbŞs
 = 0;

82 
tÙ_nb_decoded_blocks
 = 0;

83 #ifdeà
WIN32


84 
	`Qu”yP”fÜmªûCouÁ”
(&
tv0
);

85 
	`OF_PRINT
(("decodšg_¡¬t=%lI64f\n", ()
tv0
.
QuadP¬t
/()
äeq
.QuadPart))

87 
	`g‘timeofday
(&
tv0
, 
NULL
);

88 
	`OF_PRINT
(("decodšg_¡¬t=%ld.%d\n", 
tv0
.
tv_£c
,v0.
tv_u£c
))

91 (
Ãw_symb_cb
 = 
	`g‘_Ãxt_symbŞ_»ûived
()è!ğ
NULL
) {

93 
blk
 = &
blk_cb_b
[
Ãw_symb_cb
->
sbn
];

98 ià((
blk
->
ldpc_dÚt_£nd_Ï¡_»·œ
è&& (
Ãw_symb_cb
->
esi
 =ğblk->
n
 - 1)) {

101 
	`OF_TRACE_LVL
(1, ("»ûive_ªd_decode: sk³d†a¡„•aœ (esi=%d)\n", 
Ãw_symb_cb
->
esi
))

105 
tÙ_nb_»cvd_symbŞs
++;

106 ià(
Ãw_symb_cb
->
esi
 < 
blk
->
k
) {

107 
Ãw_symb_idx
 = 
blk
->
fœ¡_¤c_symbŞ_idx
 + 
Ãw_symb_cb
->
esi
;

108 
	`OF_TRACE_LVL
(1, ("receive_and_decode:‚ew source symbol‡vailable (sbn=%d,ƒsi=%d)‚ew_symb_idx = %d\n",

109 
Ãw_symb_cb
->
sbn
,‚ew_symb_cb->
esi
, 
Ãw_symb_idx
))

111 
Ãw_symb_idx
 = 
blk
->
fœ¡_»·œ_symbŞ_idx
 + (
Ãw_symb_cb
->
esi
 - blk->
k
);

112 
	`OF_TRACE_LVL
(1, ("receive_and_decode:‚ew„epair symbol‡vailable (sbn=%d,ƒsi=%d)‚ew_symb_idx = %d\n",

113 
Ãw_symb_cb
->
sbn
,‚ew_symb_cb->
esi
, 
Ãw_symb_idx
))

115 ià(
blk
->
is_decoded
 || blk->
is_abªdÚed
) {

119 
ava_symb
[
Ãw_symb_idx
] = 
Üig_symb
[new_symb_idx];

120 
blk
->
nb_symbŞs_»ûived
++;

121 ià(
blk
->
£s
 =ğ
NULL
) {

127 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


128 ià(
codec_id
 =ğ
OF_CODEC_LDPC_FROM_FILE_ADVANCED
) {

129 ià(
	`of_ü—‹_codec_š¡ªû
(&
blk
->
£s
, 
codec_id
, 
OF_DECODER
, 
of_v”bos™y
è!ğ
OF_STATUS_OK
) {

130 
	`OF_PRINT_ERROR
(("ERROR: of_ü—‹_codec_š¡ªû(èçed fÜ codec_id %d\n", 
codec_id
))

131 
”rÜ
;

133 
of_ldpc_ff_·¿m‘”s_t
 
·¿ms
;

134 
·¿ms
.
’codšg_symbŞ_Ëngth
 = 
symbŞ_size
;

135 
·¿ms
.
pchk_fe
 = 
ldpc_m©rix_fe_Çme
;

137 
·¿ms
.
nb_sourû_symbŞs
 = 1;

139 
·¿ms
.
nb_»·œ_symbŞs
 = 1;

140 ià(
	`of_£t_ãc_·¿m‘”s
(
blk
->
£s
, (
of_·¿m‘”s_t
*)&
·¿ms
è!ğ
OF_STATUS_OK
) {

141 
	`OF_PRINT_ERROR
(("ERROR: of_set_fec_parameters() failed\n"))

142 
”rÜ
;

148 
blk
->
£s
 = 
	`ü—‹_ªd_š™_codec_š¡ªû
(
codec_id
, 
OF_DECODER
, blk->
k
, blk->
n
, blk);

149 ià(
blk
->
£s
 =ğ
NULL
) {

150 
	`OF_PRINT_ERROR
(("ERROR: c»©e_ªd_š™_codec_š¡ªû(èçed fÜ codec_id %d/OF_ENCODER\n", 
codec_id
))

151 
”rÜ
;

156 ià(
	`of_decode_w™h_Ãw_symbŞ
(
blk
->
£s
, 
ava_symb
[
Ãw_symb_idx
], 
NULL
, 
Ãw_symb_cb
->
esi
è=ğ
OF_STATUS_ERROR
) {

158 
	`of_»Ëa£_codec_š¡ªû
(
blk
->
£s
);

159 
	`OF_PRINT_ERROR
(("receive_and_decode: ERROR: of_decode_with_new_symbol() failed\n"))

160 
”rÜ
;

163 ià((
blk
->
nb_symbŞs_»ûived
 >ğblk->
k
è&& (
	`of_is_decodšg_com¶‘e
(blk->
£s
è=ğ
Œue
)) {

167 
tÙ_nb_decoded_blocks
++;

168 
	`OF_TRACE_LVL
(1, ("receive_and_decode: block sbn = %d decoded,otal of %d blocks decoded‡fter„eceiving %d symbols\n",

169 
blk
->
sbn
, 
tÙ_nb_decoded_blocks
, 
tÙ_nb_»cvd_symbŞs
))

172 ià(
	`of_g‘_sourû_symbŞs_b
(
blk
->
£s
, (**)&(
ava_symb
[blk->
fœ¡_¤c_symbŞ_idx
])è!ğ
OF_STATUS_OK
) {

173 
	`OF_PRINT_ERROR
(("ERROR: of_release_codec_instance() failed\n"))

174 
”rÜ
;

177 ià(
	`of_»Ëa£_codec_š¡ªû
(
blk
->
£s
è!ğ
OF_STATUS_OK
) {

178 
	`OF_PRINT_ERROR
(("ERROR: of_release_codec_instance() failed\n"))

179 
”rÜ
;

181 
blk
->
£s
 = 
NULL
;

182 
blk
->
is_decoded
 = 
Œue
;

183 
	`u¦“p
(100);

185 ià(
tÙ_nb_decoded_blocks
 =ğ
tÙ_nb_blocks
) {

187 
	`OF_TRACE_LVL
(1, ("receive_and_decode: done,he %d blocks have been decoded‡fter„eceiving %d symbols\n",

188 
tÙ_nb_blocks
, 
tÙ_nb_»cvd_symbŞs
))

193 ià(
tÙ_nb_decoded_blocks
 < 
tÙ_nb_blocks
) {

199 
sbn
 = 0, 
blk
 = 
blk_cb_b
; sbÀ< 
tÙ_nb_blocks
; sbn++, blk++) {

200 
of_¡©us_t
 
»t
;

201 ià(
blk
->
is_decoded
 =ğ
Œue
 || blk->
is_abªdÚed
 ==rue) {

204 ià(
blk
->
nb_symbŞs_»ûived
 < blk->
k
) {

207 
	`OF_TRACE_LVL
(0, ("»ûive_ªd_decode: block sbÀğ%d decoded faed\n", 
sbn
))

210 
	`ASSERT
(
blk
->
£s
);

211 
»t
 = 
	`of_fšish_decodšg
(
blk
->
£s
);

212 ià(
»t
 =ğ
OF_STATUS_ERROR
 ||„‘ =ğ
OF_STATUS_FATAL_ERROR
) {

213 
	`OF_PRINT_ERROR
(("ERROR: of_fšish_decodšg(èçed w™hƒ¼Ü (%d)\n", 
»t
))

214 ià(
	`of_»Ëa£_codec_š¡ªû
(
blk
->
£s
è!ğ
OF_STATUS_OK
) {

215 
	`OF_PRINT_ERROR
(("ERROR: of_release_codec_instance() failed\n"))

216 
”rÜ
;

218 
blk
->
£s
 = 
NULL
;

221 ià((
blk
->
nb_symbŞs_»ûived
 >ğblk->
k
è&& (
	`of_is_decodšg_com¶‘e
(blk->
£s
è=ğ
Œue
)) {

225 
tÙ_nb_decoded_blocks
++;

226 
	`OF_TRACE_LVL
(1, ("»ûive_ªd_decode: block sbÀğ%d decoded‡á” c®lšg of_fšish_decodšg()\n", 
sbn
))

229 ià(
	`of_g‘_sourû_symbŞs_b
(
blk
->
£s
, (**)&(
ava_symb
[blk->
fœ¡_¤c_symbŞ_idx
])è!ğ
OF_STATUS_OK
) {

230 
	`OF_PRINT_ERROR
(("ERROR: of_get_source_symbols_tab() failed\n"))

231 
”rÜ
;

234 ià(
	`of_»Ëa£_codec_š¡ªû
(
blk
->
£s
è!ğ
OF_STATUS_OK
) {

235 
	`OF_PRINT_ERROR
(("ERROR: of_release_codec_instance() failed\n"))

236 
”rÜ
;

238 
blk
->
£s
 = 
NULL
;

239 
blk
->
is_decoded
 = 
Œue
;

241 ià(
tÙ_nb_decoded_blocks
 =ğ
tÙ_nb_blocks
) {

243 
	`OF_TRACE_LVL
(1, ("receive_and_decode: done,he %d blocks have been decoded‡fter„eceiving %d symbols\n",

244 
tÙ_nb_blocks
, 
tÙ_nb_»cvd_symbŞs
))

251 
	`OF_TRACE_LVL
(1, ("»ûive_ªd_decode: block sbnğ%d decodšg faed‡á” c®lšg of_fšish_decodšg()\n", 
sbn
))

254 ià(
	`of_g‘_sourû_symbŞs_b
(
blk
->
£s
, (**)&(
ava_symb
[blk->
fœ¡_¤c_symbŞ_idx
])è!ğ
OF_STATUS_OK
) {

255 
	`OF_PRINT_ERROR
(("ERROR: of_get_source_symbols_tab() failed\n"))

256 
”rÜ
;

259 ià(
	`of_»Ëa£_codec_š¡ªû
(
blk
->
£s
è!ğ
OF_STATUS_OK
) {

260 
	`OF_PRINT_ERROR
(("ERROR: of_release_codec_instance() failed\n"))

261 
”rÜ
;

263 
blk
->
£s
 = 
NULL
;

264 
blk
->
is_decoded
 = 
çl£
;

268 ià(
tÙ_nb_decoded_blocks
 =ğ
tÙ_nb_blocks
) {

271 #ifdeà
WIN32


272 
	`Qu”yP”fÜmªûCouÁ”
(&
tv1
);

273 
	`OF_PRINT
(("decoding_end=%I64f decoding_time=%I64f‚b_received_symbols=%d inefficiency_ratio=%.6f\n",

274 ()
tv1
.
QuadP¬t
/()
äeq
.QuadPart,

275 ()(
tv1
.
QuadP¬t
-
tv0
.QuadP¬t)/()
äeq
.QuadPart,

276 
tÙ_nb_»cvd_symbŞs
, (éÙ_nb_»cvd_symbŞs/()
tÙ_nb_sourû_symbŞs
))

278 
	`g‘timeofday
(&
tv1
, 
NULL
);

279 
	`tim”sub
(&
tv1
, &
tv0
, &
tv_d–
);

280 
	`OF_PRINT
(("decoding_end=%ld.%d decoding_time=%ld.%06d‚b_received_symbols=%d inefficiency_ratio=%.6f\n",

281 
tv1
.
tv_£c
,v1.
tv_u£c
,

282 
tv_d–
.
tv_£c
,v_d–.
tv_u£c
,

283 
tÙ_nb_»cvd_symbŞs
, (éÙ_nb_»cvd_symbŞs/()
tÙ_nb_sourû_symbŞs
))

285 #ifdeà
CHECK_INTEGRITY


291 
boŞ
 
š‹gr™y
 = 
Œue
;

292 
	`OF_TRACE_LVL
(1, ("receive_and_decode:‚ow checking object integrity...\n"))

293 
Ãw_symb_idx
 = 0;‚ew_symb_idx < 
tÙ_nb_sourû_symbŞs
;‚ew_symb_idx++) {

298 ià(
Üig_symb
[
Ãw_symb_idx
] =ğ
NULL
)

300 
	`OF_PRINT_ERROR
(("Üig_symb[%d] NULL wh”— decodšg i fšished.\n", 
Ãw_symb_idx
))

301 
š‹gr™y
 = 
çl£
;

303 ià(
ava_symb
[
Ãw_symb_idx
] =ğ
NULL
)

305 
	`OF_PRINT_ERROR
(("ava_symb[%d] NULL wh”— decodšg i fšished.\n", 
Ãw_symb_idx
))

306 
š‹gr™y
 = 
çl£
;

308 ià(
	`memcmp
(
Üig_symb
[
Ãw_symb_idx
], 
ava_symb
[Ãw_symb_idx], 
symbŞ_size
) != 0 ) {

309 
	`OF_PRINT_ERROR
(("»ûive_ªd_decode: ERROR: symbŞ %d„eûived/»buˆdÛ¢\'ˆm©ch origš®\n", 
Ãw_symb_idx
))

310 
š‹gr™y
 = 
çl£
;

314 ià(
š‹gr™y
 =ğ
çl£
)

315 
”rÜ
;

316 
	`OF_TRACE_LVL
(1, ("receive_and_decode: finished,‡ll source symbols‡re okay :-) ...\n"))

319 
	`OF_PRINT
(("receive_and_decode: WARNING: decoding integrity is‚ot checked (set CHECK_INTEGRITY forhat)\n"))

322 #ifdeà
WIN32


323 
	`Qu”yP”fÜmªûCouÁ”
(&
tv1
);

324 
	`OF_PRINT
(("decoding_end=%I64f decoding_time=%I64f‚b_received_symbols=%d inefficiency_ratio=%.6f\n",

325 ()
tv1
.
QuadP¬t
/()
äeq
.QuadPart,

326 ()(
tv1
.
QuadP¬t
-
tv0
.QuadP¬t)/()
äeq
.QuadPart,

327 
tÙ_nb_»cvd_symbŞs
, (éÙ_nb_»cvd_symbŞs/()
tÙ_nb_sourû_symbŞs
))

329 
	`g‘timeofday
(&
tv1
, 
NULL
);

330 
	`tim”sub
(&
tv1
, &
tv0
, &
tv_d–
);

331 
	`OF_PRINT
(("decoding_end=%ld.%d decoding_time=%ld.%06d‚b_received_symbols=%d inefficiency_ratio=%.6f\n",

332 
tv1
.
tv_£c
,v1.
tv_u£c
,

333 
tv_d–
.
tv_£c
,v_d–.
tv_u£c
,

334 
tÙ_nb_»cvd_symbŞs
, (éÙ_nb_»cvd_symbŞs/()
tÙ_nb_sourû_symbŞs
))

337 
	`OF_PRINT
(("FAILURE, did‚ot manageo finish decodingƒven‡fterot_nb_decoded_blocks %d„eceiving %d symbols, inefficiency_ratio>%.6f\n",

338 
tÙ_nb_decoded_blocks
, 
tÙ_nb_»cvd_symbŞs
, (éÙ_nb_»cvd_symbŞ / ()
tÙ_nb_sourû_symbŞs
))

340 ià(
u£_ÿÎback
) {

341 
	`OF_TRACE_LVL
(1, ("decode_source_symbol_callback has been called %iimes\n",

342 
nb_decoded_¤c_symb_ÿÎback_ÿÎs
))

349 
Ãw_symb_idx
 = 0;‚ew_symb_idx < 
tÙ_nb_sourû_symbŞs
;‚ew_symb_idx++) {

350 ià((
ava_symb
[
Ãw_symb_idx
] !ğ
NULL
) &&

351 (
ava_symb
[
Ãw_symb_idx
] !ğ
Üig_symb
[new_symb_idx])) {

353 
	`ä“
(
ava_symb
[
Ãw_symb_idx
]);

354 
ava_symb
[
Ãw_symb_idx
] = 
NULL
;

357 
	`ä“
(
ava_symb
);

359 
Ãw_symb_idx
 = 0;‚ew_symb_idx < 
tÙ_nb_’codšg_symbŞs
;‚ew_symb_idx++) {

360 
	`ä“
(
Üig_symb
[
Ãw_symb_idx
]);

361 
Üig_symb
[
Ãw_symb_idx
] = 
NULL
;

363 
	`ä“
(
Üig_symb
);

364 
	`ä“
(
blk_cb_b
);

365 
	`ä“
(
symb_cb_b
);

366 ià(
tÙ_nb_decoded_blocks
 !ğ
tÙ_nb_blocks
)

368  
OF_STATUS_FAILURE
;

372  
OF_STATUS_OK
;

375 
”rÜ
:

381 
Ãw_symb_idx
 = 0;‚ew_symb_idx < 
tÙ_nb_sourû_symbŞs
;‚ew_symb_idx++) {

382 ià((
ava_symb
[
Ãw_symb_idx
] !ğ
NULL
) &&

383 (
ava_symb
[
Ãw_symb_idx
] !ğ
Üig_symb
[new_symb_idx])) {

385 
	`ä“
(
ava_symb
[
Ãw_symb_idx
]);

386 
ava_symb
[
Ãw_symb_idx
] = 
NULL
;

389 
	`ä“
(
ava_symb
);

391 
Ãw_symb_idx
 = 0;‚ew_symb_idx < 
tÙ_nb_’codšg_symbŞs
;‚ew_symb_idx++) {

392 
	`ä“
(
Üig_symb
[
Ãw_symb_idx
]);

394 
	`ä“
(
Üig_symb
);

395 
	`ä“
(
blk_cb_b
);

396 
	`ä“
(
symb_cb_b
);

397  
OF_STATUS_ERROR
;

398 
	}
}

	@applis/eperftool/sender.c

37 
	~"•”áoŞ.h
"

38 
	~<uni¡d.h
>

44 **
	g’codšg_symbŞs_b
;

49 
of_¡©us_t


50 
	$š™_£nd”
 ()

52 
of_£ssiÚ_t
 *
£s
;

53 
block_cb_t
 *
blk
;

54 
UINT32
 
sbn
;

55 
UINT32
 
k
;

56 
UINT32
 
n
;

57 
UINT32
 
esi
;

58 
UINT32
 
¤c_idx
;

59 
UINT32
 
»p_idx
;

60 
symbŞ_cb_t
 *
¤c_symb_cb
;

61 
symbŞ_cb_t
 *
»p_symb_cb
;

62 
UINT32
 
tmp_max_k
;

63 
UINT32
 
max_n_4_ªy_blk
;

67 #ifdeà
WIN32


68 
	`Qu”yP”fÜmªûCouÁ”
(&
tv0
);

69 
	`OF_PRINT
(("š™_¡¬t=%lI64f\n", ()
tv0
.
QuadP¬t
/()
äeq
.QuadPart))

71 
	`g‘timeofday
(&
tv0
, 
NULL
);

72 
	`OF_PRINT
(("š™_¡¬t=%ld.%d\n", 
tv0
.
tv_£c
,v0.
tv_u£c
))

78 ià(
	`of_ü—‹_codec_š¡ªû
(&
£s
, 
codec_id
, 
OF_ENCODER
, 
of_v”bos™y
è!ğ
OF_STATUS_OK
) {

79 
	`OF_PRINT_ERROR
(("init_sender: ERROR: of_create_codec_instance() failed\n"))

80 
”rÜ
;

82 ià(
codec_id
 =ğ
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
) {

83 ià(
	`of_£t_cÚŒŞ_·¿m‘”
(
£s
, 
OF_RS_CTRL_SET_FIELD_SIZE
, (*)&
rs_m_·¿m
, Ôs_m_·¿m)è!ğ
OF_STATUS_OK
) {

84 
	`OF_PRINT_ERROR
(("init_sender: ERROR: of_set_control_parameter() failed\n"))

85 
”rÜ
;

88 ià(
	`of_g‘_cÚŒŞ_·¿m‘”
(
£s
, 
OF_CTRL_GET_MAX_K
, (*)&
max_k
, (max_k)è!ğ
OF_STATUS_OK
) {

89 
	`OF_PRINT_ERROR
(("init_sender: ERROR: of_get_control_parameter() failed\n"))

90 
”rÜ
;

92 ià(
	`of_g‘_cÚŒŞ_·¿m‘”
(
£s
, 
OF_CTRL_GET_MAX_N
, (*)&
max_n
, (max_n)è!ğ
OF_STATUS_OK
) {

93 
	`OF_PRINT_ERROR
(("init_sender: ERROR: of_get_control_parameter() failed\n"))

94 
”rÜ
;

96 ià(
	`of_»Ëa£_codec_š¡ªû
(
£s
è!ğ
OF_STATUS_OK
) {

97 
	`OF_PRINT_ERROR
(("init_sender: ERROR: of_release_codec_instance() failed\n"))

98 
”rÜ
;

101 #ifdeà
WIN32


102 
	`Qu”yP”fÜmªûCouÁ”
(&
tv1
);

103 
	`OF_PRINT
(("init_end=%I64f init_time=%I64f\n",

104 ()
tv1
.
QuadP¬t
 / ()
äeq
.QuadPart,

105 ()(
tv1
.
QuadP¬t
-
tv0
.QuadP¬tè/ ()
äeq
.QuadPart ))

107 
	`g‘timeofday
(&
tv1
, 
NULL
);

108 
	`tim”sub
(&
tv1
, &
tv0
, &
tv_d–
);

109 
	`OF_PRINT
(("init_end=%ld.%d init_time=%ld.%06d\n",

110 
tv1
.
tv_£c
,v1.
tv_u£c
, 
tv_d–
.tv_sec,v_delta.tv_usec))

121 
	`OF_TRACE_LVL
(1,("init_sender: codeid %d coderate %.3f max_n %d max_k %d object_size %d symbol_size %d \r\n",

122 
codec_id
, 
code_¿‹
, 
max_n
, 
max_k
, 
objeù_size
, 
symbŞ_size
))

123 
tmp_max_k
 = (
UINT32
)
	`æoÜ
(()
max_n
 * 
code_¿‹
);

124 
tmp_max_k
 = 
	`mš
(
tmpmax_k
,mp_max_k);

125 
max_k
 = 
	`mš
(
tmp_max_k
, max_k);

126 
max_k
 = 
	`max
(1, max_k);

127 
	`OF_TRACE_LVL
(1,("š™_£nd”:mp_max_k %d max_k %d \r\n", 
tmp_max_k
, 
max_k
))

128 
max_n
 = 
	`mš
((
UINT32
)(()
max_k
 / 
code_¿‹
), max_n);

129 
max_n
 = 
	`max
(1, max_n);

131 
	`of_compu‹_blockšg_¡ruù
(
max_k
, 
objeù_size
, 
symbŞ_size
, &
bs
);

132 
tÙ_nb_blocks
 = 
bs
.
nb_blocks
;

137 
tÙ_nb_’codšg_symbŞs
 = (
bs
.
I
 * ()
	`æoÜ
(()(bs.
A_Ïrge
è/ 
code_¿‹
)) +

138 ((
bs
.
nb_blocks
 - bs.
I
è* ()
	`æoÜ
(()(bs.
A_sm®l
è/ 
code_¿‹
));

140 
	`ASSERT
(
tÙ_nb_’codšg_symbŞs
 <ğ
tÙ_nb_sourû_symbŞs
 + 
tÙ_nb_»·œ_symbŞs
);

141 
tÙ_nb_»·œ_symbŞs
 = 
tÙ_nb_’codšg_symbŞs
 - 
tÙ_nb_sourû_symbŞs
;

143 
	`OF_PRINT
(("Blocking_struct:tot_nb_source_symbols=%d,ot_nb_repair_symbols=%d,ot_nb_encoding_symbols=%d, code_rate=%.3f, I=%d,ot_nb_blocks=%d, A_large=%d, A_small=%d\n",

144 
tÙ_nb_sourû_symbŞs
, 
tÙ_nb_»·œ_symbŞs
, 
tÙ_nb_’codšg_symbŞs
, 
code_¿‹
,

145 
bs
.
I
, 
tÙ_nb_blocks
, bs.
A_Ïrge
, bs.
A_sm®l
))

147 
	`OF_PRINT_LVL
(1, ("Blocking_struct:\n\ttot_nb_source_symbols=%d,ot_nb_repair_symbols=%d,ot_nb_encoding_symbols=%d, code_rate=%.3f\n\tI=%d,ot_nb_blocks=%d, A_large=%d, A_small=%d\n",

148 
tÙ_nb_sourû_symbŞs
, 
tÙ_nb_»·œ_symbŞs
, 
tÙ_nb_’codšg_symbŞs
, 
code_¿‹
,

149 
bs
.
I
, 
tÙ_nb_blocks
, bs.
A_Ïrge
, bs.
A_sm®l
))

154 ià((
tÙ_nb_blocks
 > 1è&& (
Œim_aá”_this_nb_rx_pkts
 >= 0))

156 
	`OF_PRINT_ERROR
(("ERROR:here‡re multiple blocks, which is‚ot supported in -find_min_overhead or -loss=5:nb modeso‡void hazardous„esults!\n"))

157 
”rÜ
;

163 ià((
Üig_symb
 = (**)
	`ÿÎoc
(
tÙ_nb_’codšg_symbŞs
, (*))è=ğ
NULL
) {

164 
	`OF_PRINT_ERROR
(("init_sender: ERROR: out of memory\n"))

165 
no_mem
;

168 
¤c_idx
 = 0; src_idx < 
tÙ_nb_sourû_symbŞs
; src_idx++) {

169 *
symb
;

170 
UINT32
 
i
;

175 ià((
symb
 = (*)
	`ÿÎoc
(1, 
symbŞ_size
)è=ğ
NULL
) {

176 
	`OF_PRINT_ERROR
(("init_sender: ERROR: out of memory\n"))

177 
no_mem
;

179 
Üig_symb
[
¤c_idx
] = 
symb
;

183 
i
 = 0; i < 
symbŞ_size
; i++) {

184 
symb
[
i
] = ()
	`¿nd
();

187 *(
UINT32
 *)
symb
 = (UINT32)
¤c_idx
;

188 
	`u¦“p
(100);

192 
	`Of_SaveFe
("/mÁ/Üig_’c0", 
Üig_symb
, 
symbŞ_size
, 
tÙ_nb_sourû_symbŞs
);

194 
»p_idx
 = 
tÙ_nb_sourû_symbŞs
;„•_idx < 
tÙ_nb_’codšg_symbŞs
;„ep_idx++) {

195 
Üig_symb
[
»p_idx
] = (*)
	`ÿÎoc
(1, 
symbŞ_size
);

196 ià(
Üig_symb
[
»p_idx
] =ğ
NULL
) {

197 
	`OF_PRINT_ERROR
(("init_sender: ERROR: out of memory\n"))

198 
no_mem
;

205 ià(!(
blk_cb_b
 = (
block_cb_t
*)
	`ÿÎoc
(
tÙ_nb_blocks
, (block_cb_t)))) {

206 
	`OF_PRINT_ERROR
(("init_sender: ERROR: out of memory\n"))

207 
no_mem
;

209 ià(!(
symb_cb_b
 = (
symbŞ_cb_t
*)
	`ÿÎoc
(
tÙ_nb_’codšg_symbŞs
, (symbol_cb_t)))) {

210 
	`OF_PRINT_ERROR
(("init_sender: ERROR: out of memory\n"))

211 
no_mem
;

214 
¤c_idx
 = 0;

215 
¤c_symb_cb
 = 
symb_cb_b
;

216 
»p_idx
 = 
tÙ_nb_sourû_symbŞs
;

217 
»p_symb_cb
 = &(
symb_cb_b
[
tÙ_nb_sourû_symbŞs
]);

218 
max_n_4_ªy_blk
 = 0;

219 
sbn
 = 0, 
blk
 = 
blk_cb_b
; sbÀ< 
tÙ_nb_blocks
; sbn++, blk++) {

220 ià(
sbn
 < (
UINT32
)
bs
.
I
) {

221 
k
 = 
bs
.
A_Ïrge
;

223 
k
 = 
bs
.
A_sm®l
;

225 
n
 = (
UINT32
)
	`æoÜ
(()
k
 / 
code_¿‹
);

226 
max_n_4_ªy_blk
 = (
n
 < max_n_4_any_blk) ? max_n_4_any_blk :‚;

228 
blk
->
sbn
 = sbn;

229 
blk
->
k
 = k;

230 
blk
->
n
 =‚;

231 
blk
->
fœ¡_¤c_symbŞ_idx
 = 
¤c_idx
;

232 
blk
->
fœ¡_»·œ_symbŞ_idx
 = 
»p_idx
;

233 
blk
->
is_decoded
 = 
çl£
;

234 
blk
->
nb_symbŞs_»ûived
 = 0;

235 
	`OF_TRACE_LVL
(1, ("init_sender: block: sbn=%d, k=%d,‚=%d, first_src_symbol_idx=%d, 1st_rep_symbol_idx=%d\n",

236 
sbn
, 
blk
->
k
, blk->
n
,

237 
blk
->
fœ¡_¤c_symbŞ_idx
, blk->
fœ¡_»·œ_symbŞ_idx
))

239 
esi
 = 0;ƒs˜< 
k
;ƒsi++, 
¤c_symb_cb
++, 
¤c_idx
++) {

240 
¤c_symb_cb
->
esi
 =ƒsi;

241 
¤c_symb_cb
->
sbn
 = sbn;

244 
esi
 = 
k
;ƒs˜< 
n
;ƒsi++, 
»p_symb_cb
++, 
»p_idx
++) {

245 
»p_symb_cb
->
esi
 =ƒsi;

246 
»p_symb_cb
->
sbn
 = sbn;

248 
	`u¦“p
(100);

255 ià(!(
’codšg_symbŞs_b
 = (**)
	`ÿÎoc
(
max_n_4_ªy_blk
, (*)))) {

256 
	`OF_PRINT_ERROR
(("init_sender: ERROR: out of memory\n"))

257 
no_mem
;

259  
OF_STATUS_OK
;

260 
no_mem
:

261 
”rÜ
:

262  
OF_STATUS_ERROR
;

263 
	}
}

266 
of_¡©us_t


267 
	$’code
 ()

269 
of_£ssiÚ_t
 *
£s
;

270 
block_cb_t
 *
blk
;

271 
UINT32
 
sbn
;

272 
UINT32
 
k
;

273 
UINT32
 
n
;

274 
UINT32
 
esi
;

275 
UINT32
 
i
;

281 #ifdeà
WIN32


282 
	`Qu”yP”fÜmªûCouÁ”
(&
tv0
);

283 
	`OF_PRINT
(("’codšg_¡¬t=%lI64f\n", ()
tv0
.
QuadP¬t
 / ()
äeq
.QuadPart))

285 
	`g‘timeofday
(&
tv0
, 
NULL
);

286 
	`OF_PRINT
(("’codšg_¡¬t=%ld.%d\n", 
tv0
.
tv_£c
,v0.
tv_u£c
))

288 
sbn
 = 0, 
blk
 = 
blk_cb_b
; sbÀ< 
tÙ_nb_blocks
; sbn++, blk++) {

289 
k
 = 
blk
->k;

290 
n
 = 
blk
->n;

294 
esi
 = 0;ƒs˜< 
k
;ƒsi++) {

295 
’codšg_symbŞs_b
[
esi
] = (*)(
Üig_symb
[
blk
->
fœ¡_¤c_symbŞ_idx
 +ƒsi]);

297 ; 
esi
 < 
n
;ƒsi++) {

298 
’codšg_symbŞs_b
[
esi
] = (*)(
Üig_symb
[
blk
->
fœ¡_»·œ_symbŞ_idx
 + (es˜- 
k
)]);

305 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


306 ià(
codec_id
 =ğ
OF_CODEC_LDPC_FROM_FILE_ADVANCED
)

308 ià(
	`of_ü—‹_codec_š¡ªû
(&
£s
, 
codec_id
, 
OF_ENCODER
, 
of_v”bos™y
è!ğ
OF_STATUS_OK
) {

309 
	`OF_PRINT_ERROR
(("ERROR: of_ü—‹_codec_š¡ªû(èçed fÜ codec_id %d\n", 
codec_id
))

310 
”rÜ
;

312 
of_ldpc_ff_·¿m‘”s_t
 
·¿ms
;

313 
·¿ms
.
’codšg_symbŞ_Ëngth
 = 
symbŞ_size
;

314 
·¿ms
.
pchk_fe
 = 
ldpc_m©rix_fe_Çme
;

315 ià(
	`of_£t_ãc_·¿m‘”s
(
£s
, (
of_·¿m‘”s_t
*)&
·¿ms
è!ğ
OF_STATUS_OK
) {

316 
	`OF_PRINT_ERROR
(("ERROR: of_£t_ãc_·¿m‘”s(èçed fÜ codec_id %d\n", 
codec_id
))

317 
”rÜ
;

319 
k
 = 
·¿ms
.
nb_sourû_symbŞs
;

320 
n
 = 
·¿ms
.
nb_sourû_symbŞs
 +…¬ams.
nb_»·œ_symbŞs
;

324 
£s
 = 
	`ü—‹_ªd_š™_codec_š¡ªû
(
codec_id
, 
OF_ENCODER
, 
k
, 
n
, 
blk
);

325 ià(
£s
 =ğ
NULL
) {

326 
	`OF_PRINT_ERROR
(("ERROR: c»©e_ªd_š™_codec_š¡ªû(èçed fÜ codec_id %d/OF_ENCODER\n", 
codec_id
))

327 
”rÜ
;

333 
esi
 = 
k
;ƒs˜< 
n
;ƒsi++) {

334 ià(
	`of_bud_»·œ_symbŞ
(
£s
, 
’codšg_symbŞs_b
, 
NULL
, 
esi
,

335 
symbŞ_size
 , 0è!ğ
OF_STATUS_OK
) {

336 
	`OF_PRINT_ERROR
(("ERROR: of_build_repair_symbol() failed\n"))

337 
”rÜ
;

344 
blk
->
ldpc_dÚt_£nd_Ï¡_»·œ
 = 
çl£
;

345 ià(
codec_id
 =ğ
OF_CODEC_LDPC_STAIRCASE_STABLE
) {

346 
boŞ
 
lib_§ys_™s_nuÎ
;

348 ià(
	`of_g‘_cÚŒŞ_·¿m‘”
(
£s
, 
OF_CRTL_LDPC_STAIRCASE_IS_LAST_SYMBOL_NULL
,

349 (*)&
lib_§ys_™s_nuÎ
, Öib_§ys_™s_nuÎ)è!ğ
OF_STATUS_OK
) {

350 
	`OF_PRINT_ERROR
(("ERROR: of_get_control_parameter() failed\n"))

351 
”rÜ
;

353 ià(
lib_§ys_™s_nuÎ
) {

354 
	`OF_PRINT
(("LDPC-Sœÿ£, N1=%d,†a¡„•aœ symbŞ i nuÎ, dØnÙ s’d it\n", 
blk
->
ldpc_N1
))

355 
blk
->
ldpc_dÚt_£nd_Ï¡_»·œ
 = 
Œue
;

357 #ifdeà
OF_DEBUG


358 ià(
lib_§ys_™s_nuÎ
 =ğ
Œue
) {

360 *
z”osymb
;

362 ià((
z”osymb
 = (*)
	`ÿÎoc
(1, 
symbŞ_size
)è=ğ
NULL
) {

363 
	`OF_PRINT_ERROR
(("ERROR: out of memory\n"))

364 
”rÜ
;

366 ià(
	`memcmp
(
’codšg_symbŞs_b
[
n
-1], 
z”osymb
, 
symbŞ_size
) != 0) {

367 
	`ASSERT
(0);

369 
	`OF_PRINT
(("LDPC-Staircase:†ast„epair is indeed‚ull!\n"))

370 
	`ä“
(
z”osymb
);

374 ià(
	`of_»Ëa£_codec_š¡ªû
(
£s
è!ğ
OF_STATUS_OK
) {

375 
	`OF_PRINT_ERROR
(("ERROR: of_release_codec_instance() failed\n"))

376 
”rÜ
;

378 
	`u¦“p
(100);

380 #ifdeà
WIN32


381 
	`Qu”yP”fÜmªûCouÁ”
(&
tv1
);

382 
	`OF_PRINT
(("encoding_end=%I64fƒncoding_time=%I64f\n",

383 ()
tv1
.
QuadP¬t
/()
äeq
.QuadPart,

384 ()(
tv1
.
QuadP¬t
-
tv0
.QuadP¬t)/()
äeq
.QuadPart ))

386 
	`g‘timeofday
(&
tv1
, 
NULL
);

387 
	`tim”sub
(&
tv1
, &
tv0
, &
tv_d–
);

388 
	`OF_PRINT
(("encoding_end=%ld.%dƒncoding_time=%ld.%06d\n",

389 
tv1
.
tv_£c
,v1.
tv_u£c
, 
tv_d–
.tv_sec,v_delta.tv_usec))

392 
	`ä“
(
’codšg_symbŞs_b
);

393  
OF_STATUS_OK
;

395 
”rÜ
:

396  
OF_STATUS_ERROR
;

397 
	}
}

	@applis/eperftool/tx_simulator.c

35 
	~"•”áoŞ.h
"

41 
¿ndomize_¬¿y
 (
UINT32
 *
¬¿y
, UINT32 
¬¿y_Ën
);

43 
UINT32
 
defše_symbŞ_tx_Üd”
 (UINT32 *
¬¿y
);

45 
boŞ
* 
ü—‹_loss_¬¿y_äom_”asu»_´oba
 (
UINT32
 
size
, UINT32 
avgsize
, 
desœed_loss_´oba
);

47 
boŞ
* 
ü—‹_loss_¬¿y_äom_”asu»_nb
 (
UINT32
 
size
, UINT32 
desœed_loss_nb
);

49 
boŞ
* 
ü—‹_loss_¬¿y_äom_m¬kov_mod–
 (
UINT32
 
size
);

52 
UINT32
* 
	gtx_Üd”_b
 = 
NULL
;

55 
boŞ
* 
	gis_lo¡_b
 = 
NULL
;

58 
UINT32
 
	gtÙ_nb_»cvd_symbŞs
;

61 
UINT32
 
	gÃxt_idx
 = 0;

64 
	gÃxt
 = 1;

66 
	$my¤ªd
 (
UINT32
 
£ed
)

68 
Ãxt
 = 
£ed
;

69 
	}
}

73 
UINT32
 
	$my¿nd
 ()

75 
Ãxt
 =‚ext * 1103515245 + 12345;

76 (
Ãxt
 & 0x7fffffff);

77 
	}
}

80 
of_¡©us_t


81 
	$š™_tx_simuÏtÜ
()

83 
UINT32
 
i
;

86 
	`š™_´ng_w™h_£ed
(
sugge¡ed_£ed
);

91 ià((
tx_Üd”_b
 = (
UINT32
*)
	`ÿÎoc
(
tÙ_nb_’codšg_symbŞs
, (UINT32))è=ğ
NULL
) {

92 
	`OF_PRINT_ERROR
(("no mem\n"))

93 
”rÜ
;

95 ià((
max_decodšg_¡•s
 = 
	`defše_symbŞ_tx_Üd”
(
tx_Üd”_b
)) == 0) {

96 
	`OF_PRINT_ERROR
(("ERROR, define_symbol_tx_order() failed\n"))

97 
”rÜ
;

99 
	`OF_PRINT
((" max_decoding_steps %d†oss_model %d max_loss_piece %d…_loss %f\n",

100 
max_decodšg_¡•s
, 
loss_mod–
, 
max_loss_p›û
, 
p_loss
))

107 
loss_mod–
) {

110 
is_lo¡_b
 = 
	`ü—‹_loss_¬¿y_äom_”asu»_nb
(
max_decodšg_¡•s
, 0);

113 
is_lo¡_b
 = 
	`ü—‹_loss_¬¿y_äom_m¬kov_mod–
(
max_decodšg_¡•s
);

116 
is_lo¡_b
 = 
	`ü—‹_loss_¬¿y_äom_”asu»_´oba
(
max_decodšg_¡•s
, 
max_loss_p›û
, 
p_loss
);

119 ià(
tx_mode
 =ğ
TX_MODE_SIMUL_BCAST_WITH_UNICAST_REPAIR
) {

122 ià(
nb_loss
 > 
tÙ_nb_»·œ_symbŞs
) {

123 
	`OF_PRINT_ERROR
(("number of desired†osses (%d) cannotƒxceed‚umber of„epair symbols (%d)\n",

124 
nb_loss
, 
tÙ_nb_»·œ_symbŞs
))

125 
”rÜ
;

127 
	`OF_PRINT
(("number of desired†osses (%d) cannotƒxceed‚umber of„epair symbols (%d)\n",

128 
nb_loss
, 
tÙ_nb_»·œ_symbŞs
))

129 
is_lo¡_b
 = 
	`ü—‹_loss_¬¿y_äom_”asu»_nb
(
tÙ_nb_»·œ_symbŞs
, 
nb_loss
);

130 
i
 = 0; i < 
¤c_pkt_nb
; i++) {

131 
is_lo¡_b
[
tÙ_nb_»·œ_symbŞs
 + 
i
] = 
çl£
;

134 ià(
nb_loss
 > 
max_decodšg_¡•s
) {

135 
	`OF_PRINT_ERROR
(("number of desired†osses (%d) cannotƒxceedotal‚umber of symbolshat could be„eceived (%d)\n",

136 
nb_loss
, 
max_decodšg_¡•s
))

137 
”rÜ
;

139 
is_lo¡_b
 = 
	`ü—‹_loss_¬¿y_äom_”asu»_nb
(
max_decodšg_¡•s
, 
nb_loss
);

143 
is_lo¡_b
 = 
	`ü—‹_loss_¬¿y_äom_”asu»_nb
(
max_decodšg_¡•s
, 0);

147 ià(
Œim_aá”_this_nb_rx_pkts
 > 
max_decodšg_¡•s
) {

148 
	`OF_PRINT_ERROR
(("number of symbolso„eceive (%d) cannotƒxceedotal‚umber of symbolshat could be„eceived (%d)\n",

149 
Œim_aá”_this_nb_rx_pkts
, 
max_decodšg_¡•s
))

150 
”rÜ
;

152 
is_lo¡_b
 = 
	`ü—‹_loss_¬¿y_äom_”asu»_nb
(
max_decodšg_¡•s
, 0);

153 
i
 = 
Œim_aá”_this_nb_rx_pkts
; i < 
max_decodšg_¡•s
; i++) {

154 
is_lo¡_b
[
i
] = 
Œue
;

158 
	`OF_PRINT_ERROR
(("los mod– (%dèi nÙ suµÜ‹d\n", 
loss_mod–
))

159 
”rÜ
;

163 
tÙ_nb_»cvd_symbŞs
 = 0;

164 
Ãxt_idx
 = 0;

165 
	`OF_TRACE_LVL
(1, ("š™_tx_simuÏtÜ: %d symbŞ ÿÀb»ûived\n", 
max_decodšg_¡•s
))

166  
OF_STATUS_OK
;

168 
”rÜ
:

169  
OF_STATUS_ERROR
;

170 
	}
}

173 
of_¡©us_t


174 
	$şo£_tx_simuÏtÜ
 ()

176 ià(
ldpc_m©rix_fe_Çme
)

178 
	`ä“
(
ldpc_m©rix_fe_Çme
);

179 
ldpc_m©rix_fe_Çme
=
NULL
;

181 ià(
is_lo¡_b
) {

182 
	`ä“
(
is_lo¡_b
);

183 
is_lo¡_b
 = 
NULL
;

185 ià(
tx_Üd”_b
) {

186 
	`ä“
(
tx_Üd”_b
);

187 
tx_Üd”_b
 = 
NULL
;

189 ià(
ldpc_m©rix_fe_Çme
)

191 
	`ä“
(
ldpc_m©rix_fe_Çme
);

192 
ldpc_m©rix_fe_Çme
=
NULL
;

194  
OF_STATUS_OK
;

195 
	}
}

203 
symbŞ_cb_t
 *

204 
	$g‘_Ãxt_symbŞ_»ûived
 ()

206 
symbŞ_cb_t
 *
symb
;

208 
Ãxt_idx
 < 
max_decodšg_¡•s
) {

209 ià(
is_lo¡_b
[
Ãxt_idx
] =ğ
Œue
) {

211 
Ãxt_idx
++;

215 ià((
fšd_mš_ov”h—d_mode
 =ğ
Œue
) &&

216 (
tÙ_nb_»cvd_symbŞs
 >ğ
Œim_aá”_this_nb_rx_pkts
)) {

220 
tÙ_nb_»cvd_symbŞs
++;

221 ià(
loss_mod–
 == 4)

223 
symb
 = &(
symb_cb_b
[
tx_Üd”_b
[
	`my¿nd
(è% 
max_decodšg_¡•s
]]);

227 
symb
 = &(
symb_cb_b
[
tx_Üd”_b
[
Ãxt_idx
]]);

229 
	`OF_TRACE_LVL
(1, ("%s:‚ext_idx: %u,x_order_tab: %u, symbƒsi: %u, sbn: %u\n",

230 
__FUNCTION__
, 
Ãxt_idx
, 
tx_Üd”_b
[Ãxt_idx], 
symb
->
esi
, symb->
sbn
))

231 
Ãxt_idx
++;

232  
symb
;

235 
	`OF_TRACE_LVL
(1, ("%s:‚o symbol‡vailable‡ny more‡fter„eceiving %d symbols...\n",

236 
__FUNCTION__
, 
tÙ_nb_»cvd_symbŞs
))

237  
NULL
;

238 
	}
}

245 
	$¿ndomize_¬¿y
 (
UINT32
 *
¬¿y
,

246 
UINT32
 
¬¿y_Ën
)

248 
UINT32
 
backup
 = 0;

249 
UINT32
 
¿nd_idx
 = 0;

250 
UINT32
 
i
;

252 
i
 = 0; i < 
¬¿y_Ën
; i++ ) {

253 
¬¿y
[
i
] = i;

255 
i
 = 0; i < 
¬¿y_Ën
; i++) {

256 
backup
 = 
¬¿y
[
i
];

257 
¿nd_idx
 = 
	`my¿nd
(è% 
¬¿y_Ën
;

258 
¬¿y
[
i
] =‡¼ay[
¿nd_idx
];

259 
¬¿y
[
¿nd_idx
] = 
backup
;

261 
	}
}

264 
UINT32


265 
	$defše_symbŞ_tx_Üd”
 (
UINT32
 *
¬¿y
)

267 
UINT32
 
max_¡•s
;

268 
UINT32
 
i
;

270 
tx_mode
) {

271 
TX_MODE_ALL_RANDOM
:

272 
	`OF_TRACE_LVL
(1, ("Randomly send‡ll source +„epair symbols...\n"))

273 
max_¡•s
 = 
tÙ_nb_’codšg_symbŞs
;

274 
	`¿ndomize_¬¿y
(
¬¿y
, 
max_¡•s
);

277 
TX_MODE_FEW_SRC_SYMBOLS
: {

278 
UINT32
 *
¿nd_¤c_idx
;

279 
UINT32
 
nb_¤c_cÚsid”ed
;

280 
UINT32
 
off£t
;

281 
UINT32
 
idx
;

284 ià(
u£_¤c_pkt_¿tio
) {

285 
nb_¤c_cÚsid”ed
 = (
UINT32
)(()
¤c_pkt_¿tio
 / 100 * ()
tÙ_nb_sourû_symbŞs
);

287 
nb_¤c_cÚsid”ed
 = 
¤c_pkt_nb
;

289 
max_¡•s
 = 
tÙ_nb_»·œ_symbŞs
 + 
nb_¤c_cÚsid”ed
;

290 ià((
¿nd_¤c_idx
 = (
UINT32
*)
	`ÿÎoc
(
nb_¤c_cÚsid”ed
, ())è=ğ
NULL
) {

291 
no_mem
;

293 
	`OF_TRACE_LVL
(1, ("Randomly send %d source symbols (not‚ecessarily„eceived)‡nd‡llhe„epair symbols in‡„andom order...\n",

294 
nb_¤c_cÚsid”ed
))

295 
	`¿ndomize_¬¿y
(
¿nd_¤c_idx
, 
nb_¤c_cÚsid”ed
);

296 
	`¿ndomize_¬¿y
(
¬¿y
, 
max_¡•s
);

297 
off£t
 = 
tÙ_nb_’codšg_symbŞs
 - 
max_¡•s
;

298 
i
 = 0; i < 
max_¡•s
; i++ ) {

299 
idx
 = 
¬¿y
[
i
];

300 ià(
idx
 < 
nb_¤c_cÚsid”ed
) {

302 
¬¿y
[
i
] = 
¿nd_¤c_idx
[
idx
];

305 
¬¿y
[
i
] +ğ
off£t
;

308 
	`ä“
(
¿nd_¤c_idx
);

312 
TX_MODE_FEW_SRC_SYMBOLS_FIRST
: {

315 
UINT32
 *
¿nd_¤c_idx
;

316 
UINT32
 
nb_¤c_cÚsid”ed
;

318 ià(
u£_¤c_pkt_¿tio
) {

319 
nb_¤c_cÚsid”ed
 = (
UINT32
)(()
¤c_pkt_¿tio
 / 100 * ()
tÙ_nb_sourû_symbŞs
);

321 
nb_¤c_cÚsid”ed
 = 
¤c_pkt_nb
;

323 
max_¡•s
 = 
tÙ_nb_»·œ_symbŞs
 + 
nb_¤c_cÚsid”ed
;

324 ià((
¿nd_¤c_idx
 = (
UINT32
*)
	`ÿÎoc
(
nb_¤c_cÚsid”ed
, (UINT32))è=ğ
NULL
) {

325 
no_mem
;

327 
	`OF_TRACE_LVL
(1, ("Randomly send %d source symbols first (always„eceived),hen„andomly‡ll„epair symbols...\n",

328 
nb_¤c_cÚsid”ed
))

329 
	`¿ndomize_¬¿y
(
¿nd_¤c_idx
, 
nb_¤c_cÚsid”ed
);

330 
	`¿ndomize_¬¿y
(
¬¿y
 + 
nb_¤c_cÚsid”ed
, 
tÙ_nb_»·œ_symbŞs
);

331 
i
 = 0; i < 
max_¡•s
; i++) {

332 ià(
i
 < 
nb_¤c_cÚsid”ed
) {

334 
¬¿y
[
i
] = 
¿nd_¤c_idx
[i];

337 
¬¿y
[
i
] +ğ
tÙ_nb_sourû_symbŞs
;

340 
	`ä“
(
¿nd_¤c_idx
);

344 
TX_MODE_NON_SYSTEMATIC
:

345 
	`OF_TRACE_LVL
(1, ("Randomly send only„epair symbols (non systematic)...\n"))

346 
max_¡•s
 = 
tÙ_nb_»·œ_symbŞs
;

347 
	`¿ndomize_¬¿y
(
¬¿y
, 
max_¡•s
);

348 
i
 = 0; i < 
max_¡•s
; i++ ) {

349 
¬¿y
[
i
] +ğ
tÙ_nb_sourû_symbŞs
;

353 
TX_MODE_SEQUENTIAL
:

354 
	`OF_TRACE_LVL
(1, ("Sequentially send‡ll source symbols first,hen„epair symbols...\n"))

355 
max_¡•s
 = 
tÙ_nb_’codšg_symbŞs
;

356 
i
 = 0; i < 
max_¡•s
; i++ ) {

357 
¬¿y
[
i
] = i;

361 
TX_MODE_INVERSE_SEQUENTIAL
:

362 
	`OF_TRACE_LVL
(1, ("Sequentially send‡ll„epair symbols first,hen source symbols...\n"))

363 
max_¡•s
 = 
tÙ_nb_’codšg_symbŞs
;

364 
i
 = 0; i < 
max_¡•s
; i++ ) {

365 ià(
i
 < 
tÙ_nb_»·œ_symbŞs
) {

366 
¬¿y
[
i
] = i + 
tÙ_nb_sourû_symbŞs
;

369 
¬¿y
[
i
] = i - 
tÙ_nb_»·œ_symbŞs
;

374 
TX_MODE_SEQUENTIAL_SRC_THEN_RANDOM_REPAIR
:

375 
	`OF_TRACE_LVL
(1, ("Sequentially send‡ll source symbols first,hen„andomly„epair symbols...\n"))

376 
max_¡•s
 = 
tÙ_nb_’codšg_symbŞs
;

377 
	`¿ndomize_¬¿y
(
¬¿y
 + 
tÙ_nb_sourû_symbŞs
, 
tÙ_nb_»·œ_symbŞs
);

378 
i
 = 0; i < 
max_¡•s
; i++ ) {

379 ià(
i
 < 
tÙ_nb_sourû_symbŞs
) {

380 
¬¿y
[
i
] = i;

383 
¬¿y
[
i
] +ğ
tÙ_nb_sourû_symbŞs
;

388 
TX_MODE_SEQUENTIAL_REPAIR_THEN_RANDOM_SRC
:

389 
	`OF_TRACE_LVL
(1, ("Sequentially send‡ll„epair symbols first,hen„andomly source symbols...\n"))

390 
max_¡•s
 = 
tÙ_nb_’codšg_symbŞs
;

391 
	`¿ndomize_¬¿y
(
¬¿y
 + 
tÙ_nb_»·œ_symbŞs
, 
tÙ_nb_sourû_symbŞs
);

392 
i
 = 0; i < 
max_¡•s
; i++ ) {

393 ià(
i
 < 
tÙ_nb_»·œ_symbŞs
) {

394 
¬¿y
[
i
] = i + 
tÙ_nb_sourû_symbŞs
;

399 
TX_MODE_SIMUL_BCAST_WITH_UNICAST_REPAIR
: {

404 
UINT32
 *
¤c_idx
;

405 
UINT32
 
nb_¤c_cÚsid”ed
;

406 
UINT32
 
i
;

408 ià(
u£_¤c_pkt_¿tio
) {

410 
	`OF_PRINT_ERROR
(("ERROR, use -rx_src_nb=<n>o specify‚umber ofƒrasures inx_mode TX_MODE_SIMUL_BCAST_WITH_UNICAST_REPAIR\n"))

411 
”rÜ
;

413 
nb_¤c_cÚsid”ed
 = 
¤c_pkt_nb
;

415 
max_¡•s
 = 
tÙ_nb_»·œ_symbŞs
 + 
nb_¤c_cÚsid”ed
;

416 ià((
¤c_idx
 = (
UINT32
*)
	`ÿÎoc
(
nb_¤c_cÚsid”ed
, (UINT32))è=ğ
NULL
) {

417 
no_mem
;

419 
	`OF_TRACE_LVL
(1, ("simulate broadcastx + unicast„epair (send‡ll„epair„andomly, subjecto…acket†osses,hen sendhe first %d source…ackets sequentially,‚ot subjecto‡ny†oss (3G connection)\n",

420 
nb_¤c_cÚsid”ed
))

421 
i
 = 0; i < 
nb_¤c_cÚsid”ed
; i++ ) {

422 
¤c_idx
[
i
] = i;

424 
	`¿ndomize_¬¿y
(
¬¿y
, 
tÙ_nb_»·œ_symbŞs
);

425 
i
 = 0; i < 
max_¡•s
; i++) {

426 ià(
i
 < 
tÙ_nb_»·œ_symbŞs
) {

428 
¬¿y
[
i
] +ğ
tÙ_nb_sourû_symbŞs
;

431 
¬¿y
[
i
] = 
¤c_idx
[˜- 
tÙ_nb_»·œ_symbŞs
];

434 
	`ä“
(
¤c_idx
);

437 
TX_MODE_BLOCK_SEQUENTIAL
:{

438 
	`OF_TRACE_LVL
(2, ("simulate broadcast TX_MODE_BLOCK_SEQUENTIAL\n"))

439 
max_¡•s
 = 
tÙ_nb_’codšg_symbŞs
;

440 
UINT32
 
j
 = 0;

442 
i
 = 0; i < 
tÙ_nb_’codšg_symbŞs
; i++) {

443 
UINT32
 
n
 = 
blk_cb_b
[
j
].n;

444 
UINT32
 
k
 = 
blk_cb_b
[
j
].k;

445 ià(
i
 % 
n
 < 
k
) {

446 
¬¿y
[
i
] = i%
n
 + 
j
*
k
;

449 
¬¿y
[
i
] = i%
n
 - 
k
 + 
j
*Ò -kè+ 
tÙ_nb_sourû_symbŞs
;

451 if((
i
+1è% 
n
 == 0 )

453 
j
 ++;

462 
TX_MODE_PKT_INTERLEAVING
:

463 
UINT32
 
j
;

464 
	`OF_TRACE_LVL
(1, ("Send source‡nd„epair symbol in‡n interleaved way...\n"))

465 
max_¡•s
 = 
tÙ_nb_’codšg_symbŞs
;

466 
i
 = 0; i < (
UINT32
)
	`æoÜ
(()
bs
.
A_Ïrge
 * 
ãc_¿tio
); i++ ) {

467 
UINT32
 
k
 = 0;

468 
UINT32
 
k_fÜ_this_blk
;

469 
UINT32
 
idx
 = 
i
;

470 
UINT32
 
»·œ_idx
 = 
tÙ_nb_sourû_symbŞs
;

471 
j
 = 0; j < (
UINT32
)
bs
.
nb_blocks
; j++ ) {

472 ià(
j
 < (
UINT32
)
bs
.
I
) {

473 
k_fÜ_this_blk
 = 
bs
.
A_Ïrge
;

475 
k_fÜ_this_blk
 = 
bs
.
A_sm®l
;

477 ià(
i
 < 
k_fÜ_this_blk
) {

478 
¬¿y
[
k
] = 
idx
;

479 
	`´štf
("k=%i,¬¿y[%i]=%i\n",
k
,k,
¬¿y
[k]);

480 
k
++;

481 } ià(
i
 < (
UINT32
)
	`æoÜ
(()
k_fÜ_this_blk
 * 
ãc_¿tio
)) {

482 
¬¿y
[
k
] = 
»·œ_idx
 + (
i
 - 
k_fÜ_this_blk
);

483 
	`´štf
("k=%i,¬¿y[%i]=%i\n",
k
,k,
¬¿y
[k]);

484 
k
++;

486 
idx
 +ğ
k_fÜ_this_blk
;

487 
»·œ_idx
 +ğ(
UINT32
)
	`æoÜ
(()
k_fÜ_this_blk
 * 
ãc_¿tio
) - k_for_this_blk;

493 
	`OF_PRINT_ERROR
(("ERROR:¿nsmissiÚ mod%d‚Ù suµÜ‹d!\n", 
tx_mode
))

494 
”rÜ
;

496  
max_¡•s
;

498 
no_mem
:

499 
	`OF_PRINT_ERROR
(("ERROR:‚o memory.\n"))

500 
”rÜ
:

502 
	}
}

508 
	$¿ndom_loss
()

510 
UINT32
 
¡©e
 = 0;

511 
UINT32
 
is_lo¡
 = 0;

513 
¡©e
) {

515 ià((()
	`my¿nd
(è* 100.0 / ()
RAND_MAX
è< ()
p_loss_wh’_ok
) {

516 
is_lo¡
 = 1;

517 
¡©e
 = 1;

521 ià((()
	`my¿nd
(è* 100.0 / ()
RAND_MAX
è< ()
p_sucûss_wh’_los£s
) {

522 
¡©e
 = 0;

524 
is_lo¡
 = 1;

528 
	`OF_PRINT_ERROR
(("random_loss: unknown state"))

529 
	`ex™
(-1);

531 ià(
is_lo¡
)

532 
tx_simul_loss
++;

533  
is_lo¡
;

534 
	}
}

539 
boŞ
*

540 
	$ü—‹_loss_¬¿y_äom_m¬kov_mod–
(
UINT32
 
size
)

542 
boŞ
* 
is_lo¡_¬¿y
;

543 
UINT32
 
i
;

545 
is_lo¡_¬¿y
 = (
boŞ
*è
	`ÿÎoc
(
size
, (bool));

546 
i
 = 0; i < 
size
; i++)

548 ià(
	`¿ndom_loss
() == 1)

549 
is_lo¡_¬¿y
[
i
] = 
Œue
;

551  
is_lo¡_¬¿y
;

552 
	}
}

558 
boŞ
*

559 
	$ü—‹_loss_¬¿y_äom_”asu»_nb
 (
UINT32
 
size
,

560 
UINT32
 
desœed_loss_nb
)

562 
boŞ
* 
is_lo¡_¬¿y
;

563 
UINT32
 
aùu®_loss_nb
;

564 
UINT32
 
i
;

565 
UINT32
 
j
;

567 
is_lo¡_¬¿y
 = (
boŞ
*è
	`ÿÎoc
(
size
, (bool));

568 
aùu®_loss_nb
 = 0;

569 
i
 = 0; i < 
desœed_loss_nb
; i++) {

571 
j
 = 
	`my¿nd
(è% 
size
;

572 } 
is_lo¡_¬¿y
[
j
] =ğ
Œue
);

573 
aùu®_loss_nb
++;

574 
is_lo¡_¬¿y
[
j
] = 
Œue
;

576 ià(
aùu®_loss_nb
 !ğ
desœed_loss_nb
) {

577 
	`OF_PRINT_ERROR
(("create_loss_arry_from_erasure_nb: WARNING‡ctual_loss_nb (%d) != desired_loss_nb (%d)\n",

578 
aùu®_loss_nb
, 
desœed_loss_nb
))

580  
is_lo¡_¬¿y
;

581 
	}
}

588 
boŞ
*

589 
	$ü—‹_loss_¬¿y_äom_”asu»_´oba
 (
UINT32
 
size
, UINT32 
avgsize
,

590 
desœed_loss_´oba
)

592 
boŞ
 *
¬¿y
;

593 
UINT32
 
desœed_loss_nb
;

594 
UINT32
 
aùu®_loss_nb
;

595 
UINT32
 
size_nb
 = 0;

596 
UINT32
 
i
;

597 
UINT32
 
j
;

598 
UINT32
 
aùu®_loss
 = 0;

599 
UINT32
 
aùu®_los¤©e
 = 0;

600 
UINT32
 *
los§¼ay
 = 
NULL
;

601 
	`OF_TRACE_LVL
(1,("create_loss_arry_from_erasure_nb: WARNING size (%d)‡vgsize(%d),desired_loss_proba %f\n",

602 
size
, 
avgsize
, 
desœed_loss_´oba
))

603 
¬¿y
 = (
boŞ
*è
	`ÿÎoc
(
size
, (bool));

604 
desœed_loss_nb
 = (
UINT32
)(()
size
 * 
desœed_loss_´oba
 / 100.0);

605 if(
avgsize
 <ğ0 || 
size
 <=‡vgsize)‡vgsize = size;

606 
size_nb
 = (
UINT32
)(
size
/
avgsize
);

607 
aùu®_loss
 = (
UINT32
)(
desœed_loss_nb
/
size_nb
);

608 if(
aùu®_loss
 == 0)‡ctual_loss =1;

609 
aùu®_loss_nb
 = 0;

610 
los§¼ay
 = (
UINT32
*è
	`ÿÎoc
(
tÙ_nb_blocks
, (UINT32));

611 
	`OF_TRACE_LVL
(1,("create_loss_arry_from_erasure_nb: WARNING desired_loss_nb (%d) size_nb(%d), max_n %dot_nb_blocks %d‡ctual_loss %d \n",

612 
desœed_loss_nb
, 
size_nb
, 
max_n
, 
tÙ_nb_blocks
, 
aùu®_loss
))

613 
i
 = 0; i < 
desœed_loss_nb
; i++) {

616 
j
 = 
	`my¿nd
(è% ((
aùu®_los¤©e
 +1)* 
avgsize
 );

617 if(
j
 < (
aùu®_los¤©e
 * 
avgsize
 )){

622 if(0 =ğ
¬¿y
[
j
] )

626 
aùu®_loss_nb
++;

627 if(
aùu®_loss_nb
 % 
aùu®_loss
 == 0){

628 
aùu®_los¤©e
 ++;

630 
¬¿y
[
j
] = 1;

631 
los§¼ay
[
j
/
max_n
] ++;

635 
i
 = 0; i < 
tÙ_nb_blocks
; i ++){

636 
	`OF_TRACE_LVL
(1,("actual_loss_nb i %d‚um %d\n",

637 
i
, 
los§¼ay
[i]))

639 ià(
aùu®_loss_nb
 !ğ
desœed_loss_nb
) {

640 
	`OF_PRINT_ERROR
(("create_loss_arry_from_erasure_nb: WARNING‡ctual_loss_nb (%d) != desired_loss_nb (%d)\n",

641 
aùu®_loss_nb
, 
desœed_loss_nb
))

643  
¬¿y
;

644 
	}
}

649 
	$loss_Üaşe
 (
p
)

651 
r
;

653 
r
 = (()
	`my¿nd
(è/ ()
RAND_MAX
);

654 ià(
r
 < 
p
)

659  
is_lo¡
;

660 
	}
}

667 
of_¡©us_t


668 
	$š™_´ng_w™h_£ed
 (
UINT32
 
sugge¡ed_£ed
)

670 
UINT32
 
£ed
 = 0;

672 ià(
sugge¡ed_£ed
 != 0) {

673 
£ed
 = 
sugge¡ed_£ed
;

676 #ifdeà
WIN32


677 
£ed
 = 
	`timeG‘Time
();

684 * 
dev_¿ndom_·th
 = "/dev/urandom";

685 
FILE
* 
dev_¿ndom
;

686 ià((
dev_¿ndom
 = 
	`fİ’
(
dev_¿ndom_·th
, "r"))) {

687 
	`ä—d
(&
£ed
, (), 1, 
dev_¿ndom
);

688 
	`OF_TRACE_LVL
(1,("š™_´ng_w™h_£ed: g‘tšgh£ed %d from /dev/u¿ndom\n", 
£ed
));

689 
	`fşo£
(
dev_¿ndom
);

692 
timev®
 
tv
;

693 ià(
	`g‘timeofday
(&
tv
, 
NULL
) < 0) {

694 
	`OF_PRINT_ERROR
(("init_prng_with_seed: ERROR, gettimeofday() failed:"))

695  
OF_STATUS_ERROR
;

697 
£ed
 = ()
tv
.
tv_u£c
;

701 
	`my¤ªd
(
£ed
);

702 
	`OF_PRINT
(("´ng s“d=%u\n", 
£ed
))

703  
OF_STATUS_OK
;

704 
	}
}

710 
	$couÁ_»ûived_pkts
 (
block_t
 *
blk
,

711 
·ck‘_t
 *
pkt
,

712 ** 
d©aDe¡
)

714 
UINT32
 
couÁ1
 = 0;

715 
UINT32
 
couÁ2
 = 0;

716 
UINT32
 
i
;

719 
i
 = 
blk
->
fœ¡_pkt_idx
;

720 
i
 < 
blk
->
fœ¡_pkt_idx
 + blk->
k
;

721 
i
++) {

722 ià(
d©aDe¡
[
i
] =ğ
NULL
) {

727 
couÁ1
++;

729 
i
 = 
blk
->
fœ¡_»·œ_pkt_idx
;

730 
i
 < 
blk
->
fœ¡_»·œ_pkt_idx
 + blk->
n
 - blk->
k
;

731 
i
++) {

732 ià(
d©aDe¡
[
i
] =ğ
NULL
) {

737 
couÁ2
++;

739 
	`OF_TRACE_LVL
(2, ("BLOCK seq=%d: k/n=(%d/%d),…kt_rx=%d\n\tDATA„ecvd=%d, REPAIR„ecvd=%d\n",

740 
pkt
->
blk_£q
, 
blk
->
k
, blk->
n
, blk->
pkt_rx
, 
couÁ1
, 
couÁ2
))

741  (
couÁ1
+
couÁ2
);

742 
	}
}

746 #ifdeà
OF_DEBUG


754 
	$´št_rx_¡©s
 ()

756 
symbŞ_cb_t
 *
Ãw_symb_cb
;

757 
UINT32
 
nb_»cvd
 = 0;

758 
UINT32
 
nb_lo¡
 = 0;

760 (
Ãw_symb_cb
 = 
	`g‘_Ãxt_symbŞ_»ûived
()è!ğ
NULL
) {

761 
nb_»cvd
++;

762 
	`OF_TRACE_LVL
(1, ("rx: \tsbn=%uƒsi=%u\n", 
Ãw_symb_cb
->
sbn
,‚ew_symb_cb->
esi
))

764 
nb_lo¡
 = 
tÙ_nb_’codšg_symbŞs
 - 
nb_»cvd
;

765 
	`OF_PRINT
(("rx sts: %u„ecvd, %u†o¡\n", 
nb_»cvd
, 
nb_lo¡
))

766 
	}
}

	@applis/howto_examples/simple_client_server/simple_client.c

35 
	#OF_USE_DECODER


	)

37 
	~"sim¶e_ş›Á_£rv”.h
"

43 
	#USE_DECODE_WITH_NEW_SYMBOL


	)

51 
SOCKET
 
š™_sock‘
 ();

62 
of_¡©us_t
 
g‘_Ãxt_pkt
 (
SOCKET
 
so
,

63 **
pkt
,

64 
INT32
 *
Ën
);

69 
dump_bufãr_32
 (*
buf
,

70 
UINT32
 
Ën32
);

77 
	$maš
 (
¬gc
, * 
¬gv
[])

79 
of_codec_id_t
 
codec_id
;

80 
of_£ssiÚ_t
 *
£s
 = 
NULL
;

81 
of_·¿m‘”s_t
 *
·¿ms
 = 
NULL
;

82 ** 
»cvd_symbŞs_b
ğ
NULL
;

84 ** 
¤c_symbŞs_b
 = 
NULL
;

85 
UINT32
 
symb_sz_32
 = 
SYMBOL_SIZE
 / 4;

86 
UINT32
 
k
;

87 
UINT32
 
n
;

88 
UINT32
 
esi
;

89 
SOCKET
 
so
 = 
INVALID_SOCKET
;

90 *
pkt_w™h_åi
 = 
NULL
;

91 
ãc_Ùi_t
 *
ãc_Ùi
 = 
NULL
;

92 
INT32
 
Ën
;

93 
SOCKADDR_IN
 
d¡_ho¡
;

94 
UINT32
 
n_»ûived
 = 0;

95 
boŞ
 
dÚe
 = 
çl£
;

96 
UINT32
 
»t
;

102 ià((
so
 = 
	`š™_sock‘
()è=ğ
INVALID_SOCKET
)

104 
	`OF_PRINT_ERROR
(("Error initializing socket!\n"))

105 
»t
 = -1;

106 
’d
;

108 
Ën
 = (
ãc_Ùi_t
);

109 ià((
»t
 = 
	`g‘_Ãxt_pkt
(
so
, (**)&
ãc_Ùi
, &
Ën
)è!ğ
OF_STATUS_OK
)

111 
	`OF_PRINT_ERROR
(("get_next_pkt failed (FEC OTI„eception)\n"))

112 
»t
 = -1;

113 
’d
;

115 ià(
Ën
 !ğ(
ãc_Ùi_t
))

117 
	`OF_PRINT_ERROR
(("FEC OTI„eû±iÚ faed: bad size,ƒx³ùed %lu buˆ»ûived %d in¡—d\n", (
ãc_Ùi_t
), 
»t
))

118 
»t
 = -1;

119 
’d
;

122 
codec_id
 = 
ãc_Ùi
->codec_id = 
	`Áohl
(fec_oti->codec_id);

123 
k
 = 
ãc_Ùi
->k = 
	`Áohl
(fec_oti->k);

124 
n
 = 
ãc_Ùi
->Àğ
	`Áohl
(fec_oti->n);

126 
	`´štf
("\nReûivšg…ack‘ äom %s/%d\n", 
DEST_IP
, 
DEST_PORT
);

129 ià(
k
 > 
n
 || k > 40000 ||‚ > 40000)

131 
	`OF_PRINT_ERROR
(("Inv®id FEC OTI„eûived: k=%u o¸n=%u„eûived‡»…robably ouˆoà¿nge\n", 
k
, 
n
))

132 
»t
 = -1;

133 
’d
;

136 
codec_id
) {

137 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
: {

139 
of_rs_2_m_·¿m‘”s_t
 *
my_·¿ms
;

141 
	`´štf
("\nIn™Ÿliz¨R“d-SŞomÚ ov” GF(2^mècodeøš¡ªû, (n, k)=(%u, %u)...\n", 
n
, 
k
);

142 ià((
my_·¿ms
 = (
of_rs_2_m_·¿m‘”s_t
 *)
	`ÿÎoc
(1, (* my_·¿ms))è=ğ
NULL
)

144 
	`OF_PRINT_ERROR
(("nØmemÜy fÜ codeø%d\n", 
codec_id
))

145 
»t
 = -1;

146 
’d
;

148 
my_·¿ms
->
m
 = 8;

149 
·¿ms
 = (
of_·¿m‘”s_t
 *è
my_·¿ms
;

153 
OF_CODEC_LDPC_STAIRCASE_STABLE
: {

155 
of_ldpc_·¿m‘”s_t
 *
my_·¿ms
;

157 
	`´štf
("\nIn™Ÿlizª LDPC-Sœÿ£ codeøš¡ªû, (n, k)=(%u, %u)...\n", 
n
, 
k
);

158 ià((
my_·¿ms
 = (
of_ldpc_·¿m‘”s_t
 *)
	`ÿÎoc
(1, (* my_·¿ms))è=ğ
NULL
)

160 
	`OF_PRINT_ERROR
(("nØmemÜy fÜ codeø%d\n", 
codec_id
))

161 
»t
 = -1;

162 
’d
;

164 
my_·¿ms
->
´ng_£ed
 = 
	`¿nd
();

165 
my_·¿ms
->
N1
 = 7;

166 
·¿ms
 = (
of_·¿m‘”s_t
 *è
my_·¿ms
;

171 
	`OF_PRINT_ERROR
(("Inv®id FEC OTI„eûived: codec_id=%u„eûived i nÙ v®id\n", 
codec_id
))

172 
»t
 = -1;

173 
’d
;

175 
·¿ms
->
nb_sourû_symbŞs
 = 
k
;

176 
·¿ms
->
nb_»·œ_symbŞs
 = 
n
 - 
k
;

177 
·¿ms
->
’codšg_symbŞ_Ëngth
 = 
SYMBOL_SIZE
;

180 ià((
»t
 = 
	`of_ü—‹_codec_š¡ªû
(&
£s
, 
codec_id
, 
OF_DECODER
, 
VERBOSITY
)è!ğ
OF_STATUS_OK
)

182 
	`OF_PRINT_ERROR
(("of_create_codec_instance() failed\n"))

183 
»t
 = -1;

184 
’d
;

186 ià(
	`of_£t_ãc_·¿m‘”s
(
£s
, 
·¿ms
è!ğ
OF_STATUS_OK
)

188 
	`OF_PRINT_ERROR
(("of_£t_ãc_·¿m‘”s(èçed fÜ codec_id %d\n", 
codec_id
))

189 
»t
 = -1;

190 
’d
;

193 
	`´štf
( "\nDecoding in…rogress. Waiting for‚ew…ackets...\n" );

196 ià(((
»cvd_symbŞs_b
 = (**è
	`ÿÎoc
(
n
, (*))è=ğ
NULL
) ||

197 ((
¤c_symbŞs_b
 = (**è
	`ÿÎoc
(
n
, (*))è=ğ
NULL
))

199 
	`OF_PRINT_ERROR
(("nØmemÜy (ÿÎoøçed fÜƒnc_symbŞs_b,‚=%u)\n", 
n
))

200 
»t
 = -1;

201 
’d
;

204 
Ën
 = 
SYMBOL_SIZE
 + 4;

205 #ifdeà
USE_DECODE_WITH_NEW_SYMBOL


210 (
»t
 = 
	`g‘_Ãxt_pkt
(
so
, &
pkt_w™h_åi
, &
Ën
)è=ğ
OF_STATUS_OK
)

213 
n_»ûived
++;

214 
esi
 = 
	`Áohl
(*(
UINT32
*)
pkt_w™h_åi
);

215 ià(
esi
 > 
n
)

217 
	`OF_PRINT_ERROR
(("šv®idƒsi=%u„eûived iÀ¨·ck‘' FPI\n", 
esi
))

218 
»t
 = -1;

219 
’d
;

221 
»cvd_symbŞs_b
[
esi
] = (*)
pkt_w™h_åi
 + 4;

222 
	`´štf
("%05d =>„eûivšg symbŞƒsi=%u (%s)\n", 
n_»ûived
, 
esi
, (es˜< 
k
) ? "src" : "repair");

223 ià(
	`of_decode_w™h_Ãw_symbŞ
(
£s
, (*)
pkt_w™h_åi
 + 4, 
NULL
, 
esi
è=ğ
OF_STATUS_ERROR
) {

224 
	`OF_PRINT_ERROR
(("of_decode_with_new_symbol() failed\n"))

225 
»t
 = -1;

226 
’d
;

229 ià((
n_»ûived
 >ğ
k
è&& (
	`of_is_decodšg_com¶‘e
(
£s
è=ğ
Œue
)) {

231 
dÚe
 = 
Œue
;

234 
Ën
 = 
SYMBOL_SIZE
 + 4;

242 (
»t
 = 
	`g‘_Ãxt_pkt
(
so
, &
pkt_w™h_åi
, &
Ën
)è=ğ
OF_STATUS_OK
)

245 
n_»ûived
++;

246 
esi
 = 
	`Áohl
(*(
UINT32
*)
pkt_w™h_åi
);

247 ià(
esi
 > 
n
)

249 
	`OF_PRINT_ERROR
(("šv®idƒsi=%u„eûived iÀ¨·ck‘' FPI\n", 
esi
))

250 
»t
 = -1;

251 
’d
;

253 
»cvd_symbŞs_b
[
esi
] = (*)
pkt_w™h_åi
 + 4;

254 
	`´štf
("%05d =>„eûivšg symbŞƒsi=%u (%s)\n", 
n_»ûived
, 
esi
, (es˜< 
k
) ? "src" : "repair");

255 
Ën
 = 
SYMBOL_SIZE
 + 4;

258 ià(
n_»ûived
 >ğ
k
 && (
	`of_£t_avaabË_symbŞs
(
£s
, 
»cvd_symbŞs_b
, 
NULL
è!ğ
OF_STATUS_OK
))

260 
	`OF_PRINT_ERROR
(("of_£t_avaabË_symbŞs(èçed w™hƒ¼Ü (%d)\n", 
»t
))

261 
»t
 = -1;

262 
’d
;

265 ià(!
dÚe
 && (
»t
 =ğ
OF_STATUS_FAILURE
è&& (
n_»ûived
 >ğ
k
))

271 
»t
 = 
	`of_fšish_decodšg
(
£s
);

272 ià(
»t
 =ğ
OF_STATUS_ERROR
 ||„‘ =ğ
OF_STATUS_FATAL_ERROR
)

274 
	`OF_PRINT_ERROR
(("of_fšish_decodšg(èçed w™hƒ¼Ü (%d)\n", 
»t
))

275 
»t
 = -1;

276 
’d
;

278 ià(
»t
 =ğ
OF_STATUS_OK
)

280 
dÚe
 = 
Œue
;

284 ià(
dÚe
)

288 ià(
	`of_g‘_sourû_symbŞs_b
(
£s
, 
¤c_symbŞs_b
è!ğ
OF_STATUS_OK
)

290 
	`OF_PRINT_ERROR
(("of_get_source_symbols_tab() failed\n"))

291 
»t
 = -1;

292 
’d
;

294 
	`´štf
("\nDÚe! AÎ sourû symbŞ »buˆaá”„eûivšg %u…ack‘s\n", 
n_»ûived
);

295 ià(
VERBOSITY
 > 1)

297 
esi
 = 0;ƒs˜< 
k
;ƒsi++) {

298 
	`´štf
("¤c[%u]ğ", 
esi
);

299 
	`dump_bufãr_32
(
¤c_symbŞs_b
[
esi
], 1);

305 
	`´štf
("\nFaedØ»cov”‡Îƒ¿£d sourû symbŞ ev’‡á”„eûivšg %u…ack‘s\n", 
n_»ûived
);

309 
’d
:

311 ià(
so
!ğ
INVALID_SOCKET
)

313 
	`şo£
(
so
);

315 ià(
£s
)

317 
	`of_»Ëa£_codec_š¡ªû
(
£s
);

319 ià(
·¿ms
)

321 
	`ä“
(
·¿ms
);

323 ià(
ãc_Ùi
)

325 
	`ä“
(
ãc_Ùi
);

327 ià(
»cvd_symbŞs_b
 && 
¤c_symbŞs_b
)

329 
esi
 = 0;ƒs˜< 
n
;ƒsi++)

331 ià(
»cvd_symbŞs_b
[
esi
])

334 
	`ä“
((*)
»cvd_symbŞs_b
[
esi
] - 4);

336 ià(
esi
 < 
k
 && 
¤c_symbŞs_b
[esi])

339 
	`ASSERT
(
»cvd_symbŞs_b
[
esi
] =ğ
NULL
);

340 
	`ä“
(
¤c_symbŞs_b
[
esi
]);

343 
	`ä“
(
»cvd_symbŞs_b
);

344 
	`ä“
(
¤c_symbŞs_b
);

346  
»t
;

347 
	}
}

353 
SOCKET


354 
	$š™_sock‘
 ()

356 
SOCKET
 
s
;

357 
SOCKADDR_IN
 
bšdAddr
;

358 
UINT32
 
sz
 = 1024 * 1024;

360 ià((
s
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)è=ğ
INVALID_SOCKET
)

362 
	`´štf
("Error: callo socket() failed\n");

363  
INVALID_SOCKET
;

365 
bšdAddr
.
sš_çmy
 = 
AF_INET
;

366 
bšdAddr
.
sš_pÜt
 = 
	`htÚs
(()
DEST_PORT
);

367 
bšdAddr
.
sš_addr
.
s_addr
 = 
INADDR_ANY
;

368 ià(
	`bšd
(
s
, (
SOCKADDR
*è&
bšdAddr
, (bšdAddr)è=ğ
SOCKET_ERROR
)

370 
	`´štf
("bšd(èçed. PÜˆ%d may b®»ady iÀu£\n", 
DEST_PORT
);

371  
INVALID_SOCKET
;

374 ià(
	`£tsockİt
(
s
, 
SOL_SOCKET
, 
SO_RCVBUF
, &
sz
, (sz)) == -1) {

375 
	`´štf
("£tsockİt(èçedØ£ˆÃw UDP sock‘ siztØ%u\n", 
sz
);

376  
INVALID_SOCKET
;

378  
s
;

379 
	}
}

385 
of_¡©us_t


386 
	$g‘_Ãxt_pkt
 (
SOCKET
 
so
,

387 **
pkt
,

388 
INT32
 *
Ën
)

390 
boŞ
 
fœ¡_ÿÎ
 = 
Œue
;

391 
INT32
 
§ved_Ën
 = *
Ën
;

393 ià((*
pkt
 = 
	`m®loc
(
§ved_Ën
)è=ğ
NULL
)

395 
	`OF_PRINT_ERROR
(("no memory (malloc failed for…)\n"))

396  
OF_STATUS_ERROR
;

398 ià(
fœ¡_ÿÎ
)

401 
fœ¡_ÿÎ
 = 
çl£
;

402 *
Ën
 = 
	`»cväom
(
so
, *
pkt
, 
§ved_Ën
, 0, 
NULL
, NULL);

403 ià(*
Ën
 < 0)

406 
	`³¼Ü
("recvfrom");

407 
	`OF_PRINT_ERROR
(("recvfrom failed\n"))

408 
	`ä“
(*
pkt
);

409  
OF_STATUS_ERROR
;

412 ià(
	`fú
(
so
, 
F_SETFL
, 
O_NONBLOCK
) < 0)

414 
	`OF_PRINT_ERROR
(("ERROR, fcntl failedo set‚on blocking mode\n"))

415 
	`ex™
(-1);

417 ià(
VERBOSITY
 > 1)

418 
	`´štf
("%s:…kˆ»ûived 0,†’=%u\n", 
__FUNCTION__
, *
Ën
);

419  
OF_STATUS_OK
;

422 *
Ën
 = 
	`»cväom
(
so
, *
pkt
, 
§ved_Ën
, 0, 
NULL
, NULL);

423 ià(*
Ën
 > 0)

425 ià(
VERBOSITY
 > 1)

426 
	`´štf
("%s:…kˆ»ûived 1,†’=%u\n", 
__FUNCTION__
, *
Ën
);

427  
OF_STATUS_OK
;

429 ià(
”ºo
 =ğ
EAGAIN
 ||ƒ¼nØ=ğ
EWOULDBLOCK
)

432 
	`SLEEP
(200);

433 *
Ën
 = 
	`»cväom
(
so
, *
pkt
, 
§ved_Ën
, 0, 
NULL
, NULL);

434 ià(*
Ën
 > 0)

436 ià(
VERBOSITY
 > 1)

437 
	`´štf
("%s:…kˆ»ûived 2,†’=%u\n", 
__FUNCTION__
, *
Ën
);

438  
OF_STATUS_OK
;

443 ià(
VERBOSITY
 > 1)

444 
	`´štf
("%s:ƒnd oà‹¡,‚Ø·ck‘‡á”h¦“p\n", 
__FUNCTION__
);

445 
	`ä“
(*
pkt
);

446  
OF_STATUS_FAILURE
;

452 
	`³¼Ü
("recvfrom");

453 
	`OF_PRINT_ERROR
(("ERROR,„ecvfrom failed\n"))

454 
	`ä“
(*
pkt
);

455  
OF_STATUS_ERROR
;

457  
OF_STATUS_ERROR
;

458 
	}
}

465 
	$dump_bufãr_32
 (*
buf
,

466 
UINT32
 
Ën32
)

468 
UINT32
 *
±r
;

469 
UINT32
 
j
 = 0;

471 
	`´štf
("0x");

472 
±r
 = (
UINT32
*)
buf
; 
Ën32
 > 0;†en32--,…tr++) {

474 
	`´štf
Ğ"%08X", 
	`htÚl
(*
±r
));

475 ià(++
j
 == 10)

477 
j
 = 0;

478 
	`´štf
("\n");

481 
	`´štf
("\n");

482 
	}
}

	@applis/howto_examples/simple_client_server/simple_client_server.h

34 
	~<¡dio.h
>

35 
	~<¡dlib.h
>

36 
	~<m©h.h
>

37 
	~<¡ršg.h
>

38 
	~<uni¡d.h
>

39 
	~<fú.h
>

40 
	~<”ºo.h
>

41 
	~<ùy³.h
>

42 
	~<sys/ty³s.h
>

43 
	~<sys/sock‘.h
>

45 
	~<Ãtš‘/š.h
>

46 
	~<¬·/š‘.h
>

47 
	~<sys/time.h
>

49 
	~"../../../¤c/lib_commÚ/of_İ’ãc_­i.h
"

54 
	#SOCKET
 

	)

55 
	#SOCKADDR
 
sockaddr


	)

56 
	#SOCKADDR_IN
 
sockaddr_š


	)

57 
	#INVALID_SOCKET
 (-1)

	)

58 
	#SOCKET_ERROR
 (-1)

	)

59 
	#şo£sock‘
 
şo£


	)

60 
	#SLEEP
(
t
è
	`u¦“p
Ñ*1000)

	)

67 
	#SYMBOL_SIZE
 1024

	)

68 
	#DEFAULT_K
 100

	)

69 
	#CODE_RATE
 0.667

	)

70 
	#LOSS_RATE
 0.30

	)

72 
	#VERBOSITY
 2

	)

77 
	#DEST_IP
 "127.0.0.1"

	)

78 
	#DEST_PORT
 10978

	)

87 
UINT32
 
	mcodec_id
;

89 
UINT32
 
	mk
;

90 
UINT32
 
	mn
;

91 } 
	tãc_Ùi_t
;

	@applis/howto_examples/simple_client_server/simple_server.c

35 
	#OF_USE_ENCODER


	)

37 
	~"sim¶e_ş›Á_£rv”.h
"

45 
SOCKET
 
š™_sock‘
 (
SOCKADDR_IN
 *
d¡_ho¡
);

50 
¿ndomize_¬¿y
 (
UINT32
 **
¬¿y
,

51 
UINT32
 
¬¿yL’
);

56 
dump_bufãr_32
 (*
buf
,

57 
UINT32
 
Ën32
);

64 
	$maš
(
¬gc
, * 
¬gv
[])

66 
of_codec_id_t
 
codec_id
;

67 
of_£ssiÚ_t
 *
£s
 = 
NULL
;

68 
of_·¿m‘”s_t
 *
·¿ms
 = 
NULL
;

69 ** 
’c_symbŞs_b
 = 
NULL
;

70 
UINT32
 
symb_sz_32
 = 
SYMBOL_SIZE
 / 4;

71 
UINT32
 
k
;

72 
UINT32
 
n
;

73 
UINT32
 
esi
;

74 
UINT32
 
i
;

75 
UINT32
* 
¿nd_Üd”
 = 
NULL
;

77 
SOCKET
 
so
 = 
INVALID_SOCKET
;

78 *
pkt_w™h_åi
 = 
NULL
;

79 
ãc_Ùi_t
 
ãc_Ùi
;

80 
INT32
 
lo¡_aá”_šdex
= -1;

81 
SOCKADDR_IN
 
d¡_ho¡
;

82 
UINT32
 
»t
 = -1;

85 ià(
¬gc
 == 1)

88 
k
 = 
DEFAULT_K
;

92 
k
 = 
	`©oi
(
¬gv
[1]);

94 
n
 = (
UINT32
)
	`æoÜ
(()
k
 / ()
CODE_RATE
);

97 ià(
n
 <= 255)

100 
of_rs_2_m_·¿m‘”s_t
 *
my_·¿ms
;

102 
	`´štf
("\nIn™Ÿliz¨R“d-SŞomÚ ov” GF(2^mècodeøš¡ªû, (n, k)=(%u, %u)...\n", 
n
, 
k
);

103 
codec_id
 = 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
;

104 ià((
my_·¿ms
 = (
of_rs_2_m_·¿m‘”s_t
 *)
	`ÿÎoc
(1, (* my_·¿ms))è=ğ
NULL
)

106 
	`OF_PRINT_ERROR
(("nØmemÜy fÜ codeø%d\n", 
codec_id
))

107 
»t
 = -1;

108 
’d
;

110 
my_·¿ms
->
m
 = 8;

111 
·¿ms
 = (
of_·¿m‘”s_t
 *è
my_·¿ms
;

116 
of_ldpc_·¿m‘”s_t
 *
my_·¿ms
;

118 
	`´štf
("\nIn™Ÿlizª LDPC-Sœÿ£ codeøš¡ªû, (n, k)=(%u, %u)...\n", 
n
, 
k
);

119 
codec_id
 = 
OF_CODEC_LDPC_STAIRCASE_STABLE
;

120 ià((
my_·¿ms
 = (
of_ldpc_·¿m‘”s_t
 *)
	`ÿÎoc
(1, (* my_·¿ms))è=ğ
NULL
)

122 
	`OF_PRINT_ERROR
(("nØmemÜy fÜ codeø%d\n", 
codec_id
))

123 
»t
 = -1;

124 
’d
;

126 
my_·¿ms
->
´ng_£ed
 = 
	`¿nd
();

127 
my_·¿ms
->
N1
 = 7;

128 
·¿ms
 = (
of_·¿m‘”s_t
 *è
my_·¿ms
;

130 
·¿ms
->
nb_sourû_symbŞs
 = 
k
;

131 
·¿ms
->
nb_»·œ_symbŞs
 = 
n
 - 
k
;

132 
·¿ms
->
’codšg_symbŞ_Ëngth
 = 
SYMBOL_SIZE
;

135 ià((
»t
 = 
	`of_ü—‹_codec_š¡ªû
(&
£s
, 
codec_id
, 
OF_ENCODER
, 
VERBOSITY
)è!ğ
OF_STATUS_OK
)

137 
	`OF_PRINT_ERROR
(("of_create_codec_instance() failed\n"))

138 
»t
 = -1;

139 
’d
;

141 ià(
	`of_£t_ãc_·¿m‘”s
(
£s
, 
·¿ms
è!ğ
OF_STATUS_OK
)

143 
	`OF_PRINT_ERROR
(("of_£t_ãc_·¿m‘”s(èçed fÜ codec_id %d\n", 
codec_id
))

144 
»t
 = -1;

145 
’d
;

152 
	`´štf
("\nFilling source symbols...\n");

153 ià((
’c_symbŞs_b
 = (**è
	`ÿÎoc
(
n
, (*))è=ğ
NULL
) {

154 
	`OF_PRINT_ERROR
(("nØmemÜy (ÿÎoøçed fÜƒnc_symbŞs_b,‚=%u)\n", 
n
))

155 
»t
 = -1;

156 
’d
;

161 
esi
 = 0;ƒs˜< 
k
;ƒsi++ )

163 ià((
’c_symbŞs_b
[
esi
] = 
	`ÿÎoc
(
symb_sz_32
, (
UINT32
))è=ğ
NULL
)

165 
	`OF_PRINT_ERROR
(("nØmemÜy (ÿÎoøçed fÜƒnc_symbŞs_b[%d])\n", 
esi
))

166 
»t
 = -1;

167 
’d
;

169 
	`mem£t
(
’c_symbŞs_b
[
esi
], ()Ós˜+ 1), 
SYMBOL_SIZE
);

170 ià(
VERBOSITY
 > 1)

172 
	`´štf
("¤c[%03d]ğ", 
esi
);

173 
	`dump_bufãr_32
(
’c_symbŞs_b
[
esi
], 1);

178 
	`´štf
("\nBuilding„epair symbols...\n");

179 
esi
 = 
k
;ƒs˜< 
n
;ƒsi++)

181 ià((
’c_symbŞs_b
[
esi
] = (*)
	`ÿÎoc
(
symb_sz_32
, (
UINT32
))è=ğ
NULL
)

183 
	`OF_PRINT_ERROR
(("nØmemÜy (ÿÎoøçed fÜƒnc_symbŞs_b[%d])\n", 
esi
))

184 
»t
 = -1;

185 
’d
;

187 ià(
	`of_bud_»·œ_symbŞ
(
£s
, 
’c_symbŞs_b
, 
NULL
, 
esi
, 
·¿ms
->
’codšg_symbŞ_Ëngth
, 0è!ğ
OF_STATUS_OK
) {

188 
	`OF_PRINT_ERROR
(("ERROR: of_bud_»·œ_symbŞ(èçed fÜƒsi=%u\n", 
esi
))

189 
»t
 = -1;

190 
’d
;

192 ià(
VERBOSITY
 > 1)

194 
	`´štf
("»·œ[%03d]ğ", 
esi
);

195 
	`dump_bufãr_32
(
’c_symbŞs_b
[
esi
], 4);

200 
	`´štf
("\nRandomizingransmit order...\n");

201 ià((
¿nd_Üd”
 = (
UINT32
*)
	`ÿÎoc
(
n
, (UINT32))è=ğ
NULL
)

203 
	`OF_PRINT_ERROR
(("no memory (calloc failed for„and_order)\n"))

204 
»t
 = -1;

205 
’d
;

207 
	`¿ndomize_¬¿y
(&
¿nd_Üd”
, 
n
);

210 ià((
so
 = 
	`š™_sock‘
(&
d¡_ho¡
)è=ğ
INVALID_SOCKET
)

212 
	`OF_PRINT_ERROR
(("Error initializing socket!\n"))

213 
»t
 = -1;

214 
’d
;

216 
	`´štf
("Fœ¡ oà®l, s’dhFEC OTI fÜhi objeùØ%s/%d\n", 
DEST_IP
, 
DEST_PORT
);

219 
ãc_Ùi
.
codec_id
 = 
	`htÚl
(codec_id);

220 
ãc_Ùi
.
k
 = 
	`htÚl
(k);

221 
ãc_Ùi
.
n
 = 
	`htÚl
(n);

222 ià((
»t
 = 
	`£ndto
(
so
, (*)&
ãc_Ùi
, (ãc_Ùi), 0, (
SOCKADDR
 *)&
d¡_ho¡
, (dst_host))) != (fec_oti)) {

223 
	`OF_PRINT_ERROR
(("Error while sendinghe FEC OTI\n"))

224 
»t
 = -1;

225 
’d
;

228 
lo¡_aá”_šdex
 = 
n
 * (1 - 
LOSS_RATE
);

229 ià(
lo¡_aá”_šdex
 < 
k
)

231 
	`OF_PRINT_ERROR
(("Thlos ¿‹ %ài tØhigh: oÆy %u…ack‘ wÈb£Á, wh”— k=%u\n", 
LOSS_RATE
, 
lo¡_aá”_šdex
, 
k
))

232 
»t
 = -1;

233 
’d
;

235 
	`´štf
("Sending %u source‡nd„epair…acketso %s/%d. All…ackets sent‡t index %u‡nd higher‡re considered‡s†ost\n",

236 
n
, 
DEST_IP
, 
DEST_PORT
, 
lo¡_aá”_šdex
);

240 ià((
pkt_w™h_åi
 = 
	`m®loc
(4 + 
SYMBOL_SIZE
)è=ğ
NULL
)

242 
	`OF_PRINT_ERROR
(("no memory (malloc failed for…kt_with_fpi)\n"))

243 
»t
 = -1;

244 
’d
;

246 
i
 = 0; i < 
n
; i++)

248 ià(
i
 =ğ
lo¡_aá”_šdex
)

256 *(
UINT32
*)
pkt_w™h_åi
 = 
	`htÚl
(
¿nd_Üd”
[
i
]);

257 
	`memıy
(4 + 
pkt_w™h_åi
, 
’c_symbŞs_b
[
¿nd_Üd”
[
i
]], 
SYMBOL_SIZE
);

258 
	`´štf
("%05d => s’dšg symbŞ %u (%s)\n", 
i
 + 1, 
¿nd_Üd”
[i], (¿nd_Üd”[i] < 
k
) ? "src" : "repair");

259 ià((
»t
 = 
	`£ndto
(
so
, 
pkt_w™h_åi
, 
SYMBOL_SIZE
 + 4, 0, (
SOCKADDR
 *)&
d¡_ho¡
, (d¡_ho¡))è=ğ
SOCKET_ERROR
)

261 
	`OF_PRINT_ERROR
(("sendto() failed!\n"))

262 
»t
 = -1;

263 
’d
;

267 
	`u¦“p
(500);

269 
	`´štf
Ğ"\nCom¶‘ed! %d…ack‘ £Á sucûssfuÎy.\n", 
i
);

270 
»t
 = 1;

272 
’d
:

274 ià(
so
!ğ
INVALID_SOCKET
)

276 
	`şo£
(
so
);

278 ià(
£s
)

280 
	`of_»Ëa£_codec_š¡ªû
(
£s
);

282 ià(
·¿ms
)

284 
	`ä“
(
·¿ms
);

286 ià(
¿nd_Üd”
) {

287 
	`ä“
(
¿nd_Üd”
);

289 ià(
’c_symbŞs_b
)

291 
esi
 = 0;ƒs˜< 
n
;ƒsi++)

293 ià(
’c_symbŞs_b
[
esi
])

295 
	`ä“
(
’c_symbŞs_b
[
esi
]);

298 
	`ä“
(
’c_symbŞs_b
);

300 ià(
pkt_w™h_åi
)

302 
	`ä“
(
pkt_w™h_åi
);

304  
»t
;

305 
	}
}

310 
	$¿ndomize_¬¿y
 (
UINT32
 **
¬¿y
,

311 
UINT32
 
¬¿yL’
)

313 
UINT32
 
backup
 = 0;

314 
UINT32
 
¿ndInd
 = 0;

315 
UINT32
 
£ed
;

316 
UINT32
 
i
;

318 
timev®
 
tv
;

319 ià(
	`g‘timeofday
(&
tv
, 
NULL
) < 0) {

320 
	`OF_PRINT_ERROR
(("gettimeofday() failed"))

321 
	`ex™
(-1);

323 
£ed
 = ()
tv
.
tv_u£c
;

324 
	`¤ªd
(
£ed
);

325 
i
 = 0; i < 
¬¿yL’
; i++)

327 (*
¬¿y
)[
i
] = i;

329 
i
 = 0; i < 
¬¿yL’
; i++)

331 
backup
 = (*
¬¿y
)[
i
];

332 
¿ndInd
 = 
	`¿nd
()%
¬¿yL’
;

333 (*
¬¿y
)[
i
] = (*¬¿y)[
¿ndInd
];

334 (*
¬¿y
)[
¿ndInd
] = 
backup
;

336 
	}
}

340 
SOCKET


341 
	$š™_sock‘
 (
SOCKADDR_IN
 *
d¡_ho¡
)

343 
SOCKET
 
s
;

345 ià((
s
 = 
	`sock‘
(
AF_INET
, 
SOCK_DGRAM
, 0)è=ğ
INVALID_SOCKET
)

347 
	`´štf
("Error: callo socket() failed\n");

348  
INVALID_SOCKET
;

350 
d¡_ho¡
->
sš_çmy
 = 
AF_INET
;

351 
d¡_ho¡
->
sš_pÜt
 = 
	`htÚs
(()
DEST_PORT
);

352 
d¡_ho¡
->
sš_addr
.
s_addr
 = 
	`š‘_addr
(
DEST_IP
);

353  
s
;

354 
	}
}

358 
	$dump_bufãr_32
 (*
buf
,

359 
UINT32
 
Ën32
)

361 
UINT32
 *
±r
;

362 
UINT32
 
j
 = 0;

364 
	`´štf
("0x");

365 
±r
 = (
UINT32
*)
buf
; 
Ën32
 > 0;†en32--,…tr++) {

367 
	`´štf
Ğ"%08X", 
	`htÚl
(*
±r
));

368 ià(++
j
 == 10)

370 
j
 = 0;

371 
	`´štf
("\n");

374 
	`´štf
("\n");

375 
	}
}

	@mytest/preredun.c

1 
	~<¡ršg.h
>

2 
	~<¡dio.h
>

3 
	~<¡dlib.h
>

4 
	~<´”edun.h
>

6 
P»RedunMªageStu
 *
	$P»RedunMªageG‘ByName
(cÚ¡ *
Çme
) {

7 ià(!
	`¡rcmp
(
Çme
, 
´eRedunO³nFecAudDec
.name)) {

8  &
´eRedunO³nFecAudDec
;

10 ià(!
	`¡rcmp
(
Çme
, 
´eRedunO³nFecAudEnc
.name)) {

11  &
´eRedunO³nFecAudEnc
;

14  
NULL
;

15 
	}
}

17 
P»RedunCÚ‹xt
 *
	$P»RedunCÚ‹xtIn¡ªû
(cÚ¡ 
P»RedunMªageStu
 *
´eRedunObj
) {

18 
P»RedunCÚ‹xt
 *
´eRedun
 = (P»RedunCÚ‹xˆ*è
	`m®loc
 ((*preRedun));

19 ià(
NULL
 =ğ
´eRedun
) {

20 
	`´štf
 ("P»RedunCÚ‹xˆ% m®loøçu»\n", 
´eRedunObj
->
Çme
);

21 
ERR0
;

24 
	`mem£t
(
´eRedun
, 0x0, (*preRedun));

26 
´eRedun
->
´eRedunObj
 =…reRedunObj;

28 
´eRedun
->
´iv
 = (*è
	`m®loc
 (
´eRedunObj
->
´ivSize
);

29 ià(
NULL
 =ğ
´eRedun
->
´iv
) {

30 
	`´štf
 ("´eRedun->´iv % m®loøçu»\n", 
´eRedunObj
->
Çme
);

31 
ERR1
;

34  
´eRedun
;

35 
ERR1
:

36 ià(
´eRedun
è
	`ä“
(preRedun);

37 
ERR0
:

38  
NULL
;

39 
	}
}

41 
	$P»RedunCÚ‹xtUnš¡ªû
(
P»RedunCÚ‹xt
 *
oObj
) {

42 ià(
oObj
) {

43 ià(
oObj
->
´iv
è
	`ä“
(oObj->priv);

45 
	`ä“
(
oObj
);

49 
	}
}

51 
	$P»RedunCÚ‹xtIn™
(
P»RedunCÚ‹xt
 *
oObj
, *
d©a
) {

52 ià(
oObj
->
´eRedunObj
) {

53 ià(
oObj
->
´eRedunObj
->
iš™
) {

54  
oObj
->
´eRedunObj
->
	`iš™
(oObj, 
d©a
);

59 
	}
}

61 
	$P»RedunCÚ‹xtEx™
(
P»RedunCÚ‹xt
 *
oObj
) {

62 ià(
oObj
->
´eRedunObj
) {

63 ià(
oObj
->
´eRedunObj
->
“x™
) {

64  
oObj
->
´eRedunObj
->
	`“x™
(oObj);

69 
	}
}

71 
	$P»RedunCÚ‹xtProûssF¿me
(
P»RedunCÚ‹xt
 *
oObj
, *
»dunBuf
, 
RedunBufLi¡
 *
»dunBufLi¡
) {

72 ià(
oObj
->
´eRedunObj
) {

73 ià(
oObj
->
´eRedunObj
->
´oûss
) {

74  
oObj
->
´eRedunObj
->
	`´oûss
(oObj, 
»dunBuf
, 
»dunBufLi¡
);

79 
	}
}

81 
	$P»RedunCÚ‹xtProûssAá”
(
P»RedunCÚ‹xt
 *
oObj
) {

82 ià(
oObj
->
´eRedunObj
) {

83 ià(
oObj
->
´eRedunObj
->
´oûs§á”
) {

84  
oObj
->
´eRedunObj
->
	`´oûs§á”
(oObj);

89 
	}
}

91 
	$P»RedunCÚ‹xtAddRecov”F¿me
(
P»RedunCÚ‹xt
 *
oObj
, 
RedunBuf
 *
»dunBuf
) {

92 
RedunBufLi¡
 
»dunBufLi¡
;

94 
»dunBufLi¡
.
numBufs
 = 0;

95 
»dunBufLi¡
.
»dunBuf
[»dunBufLi¡.
numBufs
++] =„edunBuf;

97 ià(
oObj
->
´eRedunObj
) {

98 ià(
oObj
->
´eRedunObj
->
add
) {

99  
oObj
->
´eRedunObj
->
	`add
(oObj, &
»dunBufLi¡
);

104 
	}
}

106 
	$P»RedunCÚ‹xtAddRecov”F¿meLi¡
(
P»RedunCÚ‹xt
 *
oObj
, 
RedunBufLi¡
 *
»dunBufLi¡
) {

107 ià(
oObj
->
´eRedunObj
) {

108 ià(
oObj
->
´eRedunObj
->
add
) {

109  
oObj
->
´eRedunObj
->
	`add
(oObj, 
»dunBufLi¡
);

114 
	}
}

117 
	$P»RedunCÚ‹xtCommªd
(
P»RedunCÚ‹xt
 *
oObj
, 
cmd
, *
v®ue
) {

118 ià(
oObj
->
´eRedunObj
) {

119 ià(
oObj
->
´eRedunObj
->
commªd
) {

120  
oObj
->
´eRedunObj
->
	`commªd
(oObj, 
cmd
, 
v®ue
);

125 
	}
}

	@mytest/preredun.h

1 #iâdeà
__PRE_RUDUN_H__


2 
	#__PRE_RUDUN_H__


	)

4 
	~<»dun.h
>

7 
	mPREREDUN_COMMAND_ISSAVE_FILE
,

8 
	mPREREDUN_COMMAND_DROP_PACKAGE
,

9 
	mPREREDUN_COMMAND_CNT
,

10 } 
	tPREREDUN_COMMAND
;

12 
	gP»RedunMªageStu
;

13 
	sP»RedunCÚ‹xt
 {

14 *
	mÇme
;

15 *
	m´iv
;

17 cÚ¡ 
P»RedunMªageStu
 *
	m´eRedunObj
;

18 } 
	tP»RedunCÚ‹xt
;

20 
	sP»RedunMªageStu
 {

21 cÚ¡ *
	mÇme
;

22 
	m´ivSize
;

24 (*
	miš™
)(
P»RedunCÚ‹xt
 *
	moObj
, *
	mcÚfig
);

25 (*
	m“x™
)(
P»RedunCÚ‹xt
 *
	moObj
);

26 (*
	m´oûss
)(
P»RedunCÚ‹xt
 *
	moObj
, *
	md©a
, 
RedunBufLi¡
 *
	m»dunBufLi¡
);

27 (*
	madd
)(
P»RedunCÚ‹xt
 *
	moObj
, 
RedunBufLi¡
 *
	m»dunBufLi¡
);

28 (*
	m´oûs§á”
)(
P»RedunCÚ‹xt
 *
	moObj
);

29 (*
	mcommªd
)(
P»RedunCÚ‹xt
 *
	moObj
, 
	mcmd
, *
	mv®ue
);

30 } 
	tP»RedunMªageStu
;

32 
P»RedunMªageStu
 
´eRedunO³nFecAudDec
;

33 
P»RedunMªageStu
 
´eRedunO³nFecAudEnc
;

36 
P»RedunMªageStu
 *
P»RedunMªageG‘ByName
(cÚ¡ *
Çme
);

39 
P»RedunCÚ‹xt
 *
P»RedunCÚ‹xtIn¡ªû
(cÚ¡ 
P»RedunMªageStu
 *
´eRedunObj
);

40 
P»RedunCÚ‹xtUnš¡ªû
(
P»RedunCÚ‹xt
 *
oObj
);

42 
P»RedunCÚ‹xtIn™
(
P»RedunCÚ‹xt
 *
oObj
, *
d©a
);

43 
P»RedunCÚ‹xtEx™
(
P»RedunCÚ‹xt
 *
oObj
);

48 
P»RedunCÚ‹xtProûssF¿me
(
P»RedunCÚ‹xt
 *
oObj
, *
»dunBuf
, 
RedunBufLi¡
 *
»dunBufLi¡
);

50 
P»RedunCÚ‹xtAddRecov”F¿me
(
P»RedunCÚ‹xt
 *
oObj
, 
RedunBuf
 *
»dunBuf
);

51 
P»RedunCÚ‹xtAddRecov”F¿meLi¡
(
P»RedunCÚ‹xt
 *
oObj
, 
RedunBufLi¡
 *
»dunBufLi¡
);

54 
P»RedunCÚ‹xtProûssAá”
(
P»RedunCÚ‹xt
 *
oObj
);

56 
P»RedunCÚ‹xtCommªd
(
P»RedunCÚ‹xt
 *
oObj
, 
cmd
, *
v®ue
);

	@mytest/preredun_config.h

1 #iâdeà
__PRE_RUDUN_OPENFEC_H__


2 
	#__PRE_RUDUN_OPENFEC_H__


	)

4 
	#REDUN_MAX_LENGTH
 (2048)

	)

5 
	#REDUN_MAX_NUM
 (255)

	)

6 
	#REDUN_MAX_HEAD_LENGTH
 (128)

	)

7 
	#REDUN_ALT_NUM
 (2)

	)

8 
	#REDUN_BUFFER_NUM
 (50)

	)

9 
	#REDUN_REF_RESTORE_NUM
 (2)

	)

10 
	#REDUN_REF_JUST_SEND_NUM
 (1)

	)

12 
	sP»RedunMªageDecP¬mas
 {

13 
	mk
;

14 
	mn
;

15 
	mflL’gth
;

16 
	mh—dFlL’gth
;

18 *
	m´iv
;

24 *(*
	mŒªsfÜmFromRedun
)(*
	moObj
, *
	md©a
, *
	m»·œ
, *
	mh—dR•aœ
, 
	misSrc
);

31 *(*
	mŒªsfÜmToRedun
)(*
	moObj
, **
	m»dunBuf
, *
	md©a
, 
	misSrc
);

37 (*
	ms£nd
)(*
	moObj
, *
	md©a
);

43 (*
	m»Ëa£
)(*
	moObj
, *
	m»dunBuf
);

46 (*
	mg‘SeqId
)(*
	moObj
, *
	md©a
);

47 } 
	tP»RedunMªageDecP¬mas
;

49 
	sP»RedunMªageEncP¬mas
 {

50 
	mk
;

51 
	mn
;

52 
	mflL’gth
;

53 
	mh—dFlL’gth
;

55 *
	m´iv
;

61 *(*
	mŒªsfÜmFromRedun
)(*
	moObj
, *
	md©a
, *
	m»·œ
, *
	mh—dR•aœ
, 
	misSrc
);

68 *(*
	mŒªsfÜmToRedun
)(*
	moObj
, **
	m»dunBuf
, *
	md©a
, 
	misSrc
);

74 (*
	ms£nd
)(*
	moObj
, *
	md©a
);

80 (*
	m»Ëa£
)(*
	moObj
, *
	m»dunBuf
);

83 (*
	mg‘SeqId
)(*
	moObj
, *
	md©a
);

84 } 
	tP»RedunMªageEncP¬mas
;

	@mytest/preredun_openfec_aud.c

1 
	~<¡dio.h
>

2 
	~<¡ršg.h
>

3 
	~<¡dlib.h
>

4 
	~<queue.h
>

5 
	~<´”edun.h
>

6 
	~<»dun.h
>

7 
	~<´”edun_cÚfig.h
>

9 
	~<»dun_š‹rçû.h
>

14 
	sP»RedunMªageDecPrivStu
 {

16 
	mk
;

18 
	mn
;

20 
	mflL’gth
;

22 
	mh—dFlL’gth
;

24 
	mæag
;

26 
	misFœ¡Pkt
;

28 
	m£i
;

30 
	mcurSei
;

32 
	m»cvdNum
;

38 
	misDecChªge
;

40 
	m£qId
;

42 
	mÏ¡RecvPktSeq
;

44 
	misDrİ
;

46 
	mdrİNum
;

48 
	m‹¡DrİNum
;

50 *
	m»cvdV®idTab
[
REDUN_MAX_NUM
];

52 
	m»cvdIsS’d
[
REDUN_MAX_NUM
];

54 *
	m¤cSymbŞsTab
[
REDUN_MAX_NUM
];

57 
	m»·œH—dSymbŞsTab
[
REDUN_ALT_NUM
][
REDUN_MAX_NUM
][
REDUN_MAX_HEAD_LENGTH
];

60 (*
	mg‘SeqId
)(*
	moObj
, *
	md©a
);

63 *(*
	mŒªsfÜmFromRedun
)(*
	moObj
, *
	md©a
, *
	m»·œ
, *
	mh—dR•aœ
, 
	misSrc
);

66 *(*
	mŒªsfÜmToRedun
)(*
	moObj
, **
	m»dunBuf
, *
	md©a
, 
	misSrc
);

69 (*
	ms£nd
)(*
	moObj
, *
	md©a
);

72 (*
	m»Ëa£
)(*
	moObj
, *
	m»dunBuf
);

75 
QueHndl
 
	mhndlE
;

76 
RedunBuf
 
	m»dunBuf
[
REDUN_BUFFER_NUM
];

79 *
	m´iv
;

80 } 
	tP»RedunMªageDecPrivStu
 ;

85 
	$´eRedunO³nFecDecIn™
(
P»RedunCÚ‹xt
 *
oObj
, *
cÚfig
) {

86 
¡©us
 = -1;

87 
šdex
 = 0;

88 
P»RedunMªageDecPrivStu
 *
pObj
 = (P»RedunMªageDecPrivStu *)
oObj
->
´iv
;

89 
P»RedunMªageDecP¬mas
 *
·¿ms
 = (P»RedunMªageDecP¬ma *)
cÚfig
;

91 
	`mem£t
(
pObj
, 0x0, (*pObj));

93 
	`´štf
 ("%s %d input check k:%d‚:%d…riv:%p "

98 
__func__
, 
__LINE__
,

99 
·¿ms
->
k
,

100 
·¿ms
->
n
,

101 
·¿ms
->
´iv
,

102 
·¿ms
->
flL’gth
,

103 
·¿ms
->
h—dFlL’gth
,

104 
·¿ms
->
ŒªsfÜmFromRedun
,

105 
·¿ms
->
ŒªsfÜmToRedun
,

106 
·¿ms
->
s£nd
,

107 
·¿ms
->
»Ëa£
);

109 ià(
·¿ms
->
flL’gth
 % 2 != 0

110 || 
·¿ms
->
h—dFlL’gth
 % 2 != 0) {

111 
	`´štf
 ("[%s %d] fillLength:%d headFillLength:%d‚ot match[len mod 2 == 0]\n",

112 
__func__
, 
__LINE__
, 
·¿ms
->
flL’gth
,…¬ams->
h—dFlL’gth
);

113 
ERR0
;

116 ià(
NULL
 =ğ
·¿ms
->
ŒªsfÜmFromRedun


117 || 
NULL
 =ğ
·¿ms
->
ŒªsfÜmToRedun


118 || 
NULL
 =ğ
·¿ms
->
s£nd


119 || 
NULL
 =ğ
·¿ms
->
»Ëa£
) {

120 
	`´štf
 ("[%s %d] input callback invalid[%d-%d-%d-%d]\n",

121 
__func__
, 
__LINE__
,

122 
NULL
 =ğ
·¿ms
->
ŒªsfÜmFromRedun
,

123 
NULL
 =ğ
·¿ms
->
ŒªsfÜmToRedun
,

124 
NULL
 =ğ
·¿ms
->
s£nd
,

125 
NULL
 =ğ
·¿ms
->
»Ëa£
);

126 
ERR0
;

129 
pObj
->
k
 = 
·¿ms
->k;

130 
pObj
->
n
 = 
·¿ms
->n;

131 
pObj
->
flL’gth
 = 
·¿ms
->fillLength;

132 
pObj
->
h—dFlL’gth
 = 
·¿ms
->headFillLength;

133 
pObj
->
´iv
 = 
·¿ms
->priv;

135 
pObj
->
ŒªsfÜmFromRedun
 = 
·¿ms
->transformFromRedun;

136 
pObj
->
ŒªsfÜmToRedun
 = 
·¿ms
->transformToRedun;

137 
pObj
->
s£nd
 = 
·¿ms
->ssend;

138 
pObj
->
»Ëa£
 = 
·¿ms
->release;

139 
pObj
->
g‘SeqId
 = 
·¿ms
->getSeqId;

142 
¡©us
 = 
	`QueueC»©e
(&
pObj
->
hndlE
, 1000);

143 ià(
¡©us
) {

144 
	`´štf
 ("[% %d]QueueC»©pObj->hndlE fau»\n", 
__func__
, 
__LINE__
);

145 
ERR0
;

148 
šdex
 = 0; index < 
REDUN_BUFFER_NUM
; index++) {

149 
pObj
->
»dunBuf
[
šdex
].
hªdË
 = (*)&pObj->
hndlE
;

150 
¡©us
 = 
	`QueuePut
(&
pObj
->
hndlE
, ()&pObj->
»dunBuf
[
šdex
], 
TIMEOUT_NONE
);

151 ià(
¡©us
) {

152 
	`´štf
 ("[% %d] QueuePuˆhndlE index:%d fau»\n", 
__func__
, 
__LINE__
, 
šdex
);

157 
ERR0
:

159 
	}
}

164 
	$´eRedunO³nFecDecEx™
(
P»RedunCÚ‹xt
 *
oObj
) {

165 
P»RedunMªageDecPrivStu
 *
pObj
 = (P»RedunMªageDecPrivStu *)
oObj
->
´iv
;

167 
	`QueueD–‘e
(&
pObj
->
hndlE
);

170 
	}
}

172 *
	$P»RedunCÚ‹xtO³nFecDecG‘SeqId
(
P»RedunMªageDecPrivStu
 *
pObj
, *
d©a
) {

173 ià(
pObj
->
g‘SeqId
) {

174 
pObj
->
£qId
 =…Obj->
	`g‘SeqId
ÕObj->
´iv
, 
d©a
);

177 
	`´štf
 ("pObj->£qId:%d\n", 
pObj
->
£qId
);

178 
	}
}

186 
RedunBuf
 *
	$P»RedunCÚ‹xtO³nFecDecT¿nsfÜm
(
P»RedunMªageDecPrivStu
 *
pObj
, *
d©a
) {

187 
»t
 = -1;

188 
RedunBuf
 *
»dunBuf
 = 
NULL
;

190 
»t
 = 
	`QueueG‘
(&
pObj
->
hndlE
, (*)&
»dunBuf
, 
TIMEOUT_NONE
);

191 ià(
»t
) {

192 
	`´štf
 ("% %d QueueG‘ fau»\n", 
__func__
, 
__LINE__
);

193 
ERR0
;

197 ià(
pObj
->
ŒªsfÜmToRedun
) {

198 
»dunBuf
 = 
pObj
->
	`ŒªsfÜmToRedun
ÕObj->
´iv
, (**)&redunBuf,

199 
d©a
, 
pObj
->
curSei
 <…Obj->
k
 ? 1 : 0);

202  
»dunBuf
;

203 
ERR0
:

204  
NULL
;

205 
	}
}

212 
	$P»RedunCÚ‹xtO³nFecDecCË¬F¿me
(
P»RedunMªageDecPrivStu
 *
pObj
) {

213 
šdex
 = 0;

214 
num
 = 0;

215 *
d©a
 = 
NULL
;

216 
RedunBuf
 *
»dunBuf
 = 
NULL
;

218 ià(
pObj
->
isDecChªge
) {

220 
šdex
 = 0; index < 
pObj
->
k
; index++) {

221 ià(
pObj
->
»cvdV®idTab
[
šdex
]) {

223 
pObj
->
»cvdNum
--;

225 ià(!
pObj
->
»cvdIsS’d
[
šdex
]) {

226 
»dunBuf
->
£i
 -ğ
pObj
->
k
;

227 ià(
pObj
->
ŒªsfÜmToRedun
) {

228 
»dunBuf
 = 
pObj
->
	`ŒªsfÜmToRedun
ÕObj->
´iv
, (**)&redunBuf,„edunBuf->priv, 1);

231 ià(
pObj
->
ŒªsfÜmFromRedun
) {

232 
d©a
 = 
pObj
->
	`ŒªsfÜmFromRedun
ÕObj->
´iv
,…Obj->
»cvdV®idTab
[
šdex
], 
NULL
, NULL, 1);

233 ià(
d©a
) {

234 ià(
pObj
->
s£nd
) {

236 
»dunBuf
 = 
pObj
->
»cvdV®idTab
[
šdex
];

237 
»dunBuf
->
»fId
 = 
REDUN_REF_JUST_SEND_NUM
;

238 
pObj
->
	`s£nd
ÕObj->
´iv
, 
d©a
);

244 
pObj
->
»cvdIsS’d
[
šdex
] = 0;

249 ià(
pObj
->
»cvdNum
) {

250 
»fNum
 = 0;

251 
Ï¡Index
 = 0;

252 
šdex
 = 
pObj
->
k
; index <…Obj->
n
; index++) {

253 
»dunBuf
 = (
RedunBuf
 *)
pObj
->
»cvdV®idTab
[
šdex
];

254 
pObj
->
»cvdV®idTab
[
šdex
 -…Obj->
k
] =…Obj->recvdValidTab[index];

255 
pObj
->
»cvdIsS’d
[
šdex
 -…Obj->
k
] =…Obj->recvdIsSend[index];

257 
pObj
->
»cvdV®idTab
[
šdex
] = 
NULL
;

258 
pObj
->
»cvdIsS’d
[
šdex
] = 0;

259 ià(
pObj
->
»cvdV®idTab
[
šdex
 -…Obj->
k
]) {

260 
»dunBuf
->
£i
 -ğ
pObj
->
k
;

261 ià(
pObj
->
ŒªsfÜmToRedun
) {

262 
»dunBuf
 = 
pObj
->
	`ŒªsfÜmToRedun
ÕObj->
´iv
, (**)&redunBuf,„edunBuf->priv, 1);

265 ià(
»fNum
 =ğ
šdex
 - 
pObj
->
k
) {

267 ià(
pObj
->
ŒªsfÜmFromRedun
) {

268 
d©a
 = 
pObj
->
	`ŒªsfÜmFromRedun
ÕObj->
´iv
, 
»dunBuf
, 
NULL
, NULL, 1);

269 ià(
d©a
) {

270 ià(
pObj
->
s£nd
) {

272 
»dunBuf
 = 
pObj
->
»cvdV®idTab
[
šdex
 -…Obj->
k
];

273 
»dunBuf
->
»fId
 = 
REDUN_REF_RESTORE_NUM
;

274 
pObj
->
	`s£nd
ÕObj->
´iv
, 
d©a
);

279 
»fNum
++;

280 
Ï¡Index
 = 
šdex
;

285 
šdex
 = 0; index < 
Ï¡Index
; index++) {

286 ià(
NULL
 =ğ
pObj
->
»cvdV®idTab
[
šdex
]) {

287 
pObj
->
drİNum
++;

288 
pObj
->
isDrİ
 |ğ(1 << 
šdex
);

295 
	}
}

303 
	$P»RedunCÚ‹xtO³nFecDecC®cSei
(
P»RedunMªageDecPrivStu
 *
pObj
) {

304 
šdex
 = 0;

305 
drİPack
 = 1;

307 ià(
pObj
->
isFœ¡Pkt
) {

308 
pObj
->
£i
 =…Obj->
£qId
 %…Obj->
k
;

309 
drİPack
 = 
pObj
->
£i
 + 1;

310 
pObj
->
isFœ¡Pkt
 = 0;

311 
pObj
->
Ï¡RecvPktSeq
 =…Obj->
£qId
;

314 ià((
pObj
->
£qId
 !ğ(ÕObj->
Ï¡RecvPktSeq
 + 1) & 0x0000FFFF))

315 && (
pObj
->
£qId
 !ğÕObj->
Ï¡RecvPktSeq
 & 0x0000FFFF))) {

317 
drİPack
 = 
pObj
->
£qId
 -…Obj->
Ï¡RecvPktSeq
;

321 
pObj
->
£i
 = (pObj->£˜+ 
drİPack
 %…Obj->
n
) %…Obj->n;

324 ià(
drİPack
 - 1 > 0) {

325 
pObj
->
isDrİ
 |ğ(1 <<…Obj->
£i
);

326 
pObj
->
drİNum
 +ğ
drİPack
 - 1;

329 ià(!
pObj
->
»cvdNum
) {

330 
pObj
->
£i
 = 0;

334 ià(
pObj
->
drİNum
 >…Obj->
n
 -…Obj->
k
) {

335 
pObj
->
isDecChªge
 = 1;

338 
pObj
->
Ï¡RecvPktSeq
 =…Obj->
£qId
;

339 
pObj
->
curSei
 =…Obj->
£i
;

341 
	`´štf
 ("[%s %d]seqId:%d isDrop:0x%08x dropNum:%u sei:%d\n",

342 
__func__
, 
__LINE__
,

343 
pObj
->
£qId
,…Obj->
isDrİ
,…Obj->
drİNum
,…Obj->
curSei
);

346 
	}
}

354 
	$P»RedunCÚ‹xtO³nFecDecAddF¿me
(
P»RedunMªageDecPrivStu
 *
pObj
, 
RedunBuf
 *
»dunBuf
) {

355 
šdex
 = 0;

356 *
d©a
 = 
NULL
;

358 
»dunBuf
->
£i
 = 
pObj
->
curSei
;

360 ià(
NULL
 =ğ
pObj
->
»cvdV®idTab
[pObj->
curSei
]) {

361 
pObj
->
»cvdV®idTab
[pObj->
curSei
] = (*)
»dunBuf
;

362 ià(!
pObj
->
isDrİ
) {

363 ià(
pObj
->
ŒªsfÜmFromRedun
) {

364 
d©a
 = 
pObj
->
	`ŒªsfÜmFromRedun
ÕObj->
´iv
,…Obj->
»cvdV®idTab
[pObj->
curSei
], 
NULL
, NULL, 1);

365 ià(
d©a
) {

366 ià(
pObj
->
s£nd
) {

367 
»dunBuf
->
»fId
 = 
REDUN_REF_RESTORE_NUM
;

368 
pObj
->
	`s£nd
ÕObj->
´iv
, 
d©a
);

372 
pObj
->
»cvdIsS’d
[pObj->
curSei
] = 1;

375 
pObj
->
»cvdIsS’d
[pObj->
curSei
] = 0;

377 
pObj
->
»cvdNum
++;

379 ià(!
pObj
->
isDrİ
 &&…Obj->
»cvdNum
 =ğpObj->
k
) {

380 
	`´štf
 ("recv src sok.......................................\n");

382 
šdex
 = 0; index < 
pObj
->
k
; index++) {

383 
pObj
->
	`»Ëa£
ÕObj->
´iv
,…Obj->
»cvdV®idTab
[
šdex
]);

384 
pObj
->
»cvdIsS’d
[
šdex
] = 0;

385 
pObj
->
»cvdV®idTab
[
šdex
] = 
NULL
;

387 
pObj
->
isDrİ
 = 0;

388 
pObj
->
drİNum
 = 0;

389 
pObj
->
»cvdNum
 = 0;

393 
	`´štf
 ("[%s %d] why sei:%d…Obj->recvdValidTab:%p != NULL\n",

394 
__func__
, 
__LINE__
, 
pObj
->
curSei
,…Obj->
»cvdV®idTab
[pObj->curSei]);

398 
	}
}

405 
	$P»RedunCÚ‹xtO³nFecDecIsCom¶‘e
(
P»RedunMªageDecPrivStu
 *
pObj
) {

406  
pObj
->
»cvdNum
 =ğpObj->
k
 ? 0 : -1;

407 
	}
}

415 
	$P»RedunCÚ‹xtO³nFecDecCom¶‘ed
(
P»RedunMªageDecPrivStu
 *
pObj
,

416 
RedunBufLi¡
 *
»dunBufLi¡
) {

417 
šdex
 = 0;

418 
RedunBuf
 *
»dunBuf
 = 
NULL
;

419 
»dunBufLi¡
->
numBufs
 = 0;

421 
šdex
 = 0; index < 
pObj
->
n
; index++) {

422 ià(
pObj
->
»cvdV®idTab
[
šdex
]) {

423 
»dunBuf
 = (
RedunBuf
 *)
pObj
->
»cvdV®idTab
[
šdex
];

424 ià(
šdex
 < 
pObj
->
k
) {

430 
»dunBufLi¡
->
»dunBuf
[»dunBufLi¡->
numBufs
++] =„edunBuf;

431 
	`´štf
 ("%s %d****** combine index:%d %s\n",

432 
__func__
, 
__LINE__
, 
šdex
, index < 
pObj
->
k
 ? "src" : "repair");

436 ià(
»dunBufLi¡
->
numBufs
 =ğ
pObj
->
k
) {

441  
»dunBufLi¡
->
numBufs
 =ğ
pObj
->
k
 ? 0 : -1;

442 
	}
}

445 
	$P»RedunCÚ‹xtDrİPackage
(
P»RedunMªageDecPrivStu
 *
pObj
, *
d©a
) {

446 
RedunBuf
 *
»dunBuf
 = 
NULL
;

448 
»dunBuf
 = 
	`P»RedunCÚ‹xtO³nFecDecT¿nsfÜm
(
pObj
, 
d©a
);

449 ià(
NULL
 =ğ
»dunBuf
) {

453 ià(
pObj
->
ŒªsfÜmFromRedun
) {

454 *
d©a
 = 
pObj
->
	`ŒªsfÜmFromRedun
ÕObj->
´iv
, 
»dunBuf
, 
NULL
, NULL, 0);

455 ià(
d©a
) {

456 ià(
pObj
->
s£nd
) {

457 
»dunBuf
->
»fId
 = 
REDUN_REF_JUST_SEND_NUM
;

458 
pObj
->
	`s£nd
ÕObj->
´iv
, 
d©a
);

463 
	`´štf
 ("[% %d] cu¼’ˆdrİ seqId:%d…ackage\n", 
__func__
, 
__LINE__
, 
pObj
->
£qId
);

467 
	}
}

476 
	$´eRedunO³nFecDecProûss
(
P»RedunCÚ‹xt
 *
oObj
, *
d©a
, 
RedunBufLi¡
 *
»dunBufLi¡
) {

477 
RedunBuf
 *
»dunBuf
 = 
NULL
;

478 
P»RedunMªageDecPrivStu
 *
pObj
 = (P»RedunMªageDecPrivStu *)
oObj
->
´iv
;

480 
	`P»RedunCÚ‹xtO³nFecDecG‘SeqId
(
pObj
, 
d©a
);

482 ià(
pObj
->
‹¡DrİNum
 > 0) {

483 ià(
	`P»RedunCÚ‹xtDrİPackage
(
pObj
, 
d©a
))  -1;

484 
pObj
->
‹¡DrİNum
--;

487 
	`P»RedunCÚ‹xtO³nFecDecC®cSei
(
pObj
);

489 
	`P»RedunCÚ‹xtO³nFecDecCË¬F¿me
(
pObj
);

491 
»dunBuf
 = 
	`P»RedunCÚ‹xtO³nFecDecT¿nsfÜm
(
pObj
, 
d©a
);

492 ià(
NULL
 =ğ
»dunBuf
) {

496 
	`P»RedunCÚ‹xtO³nFecDecAddF¿me
(
pObj
, 
»dunBuf
);

498 ià(!
	`P»RedunCÚ‹xtO³nFecDecIsCom¶‘e
(
pObj
)) {

499  
	`P»RedunCÚ‹xtO³nFecDecCom¶‘ed
(
pObj
, 
»dunBufLi¡
);

503 
	}
}

512 
	$´eRedunO³nFecDecAdd
(
P»RedunCÚ‹xt
 *
oObj
, 
RedunBufLi¡
 *
»dunBufLi¡
) {

513 
šdex
 = 0;

514 
RedunBuf
 *
»dunBuf
 = 
NULL
;

515 
P»RedunMªageDecPrivStu
 *
pObj
 = (P»RedunMªageDecPrivStu *)
oObj
->
´iv
;

517 
šdex
 = 0; index < 
»dunBufLi¡
->
numBufs
; index++) {

518 
»dunBuf
 = 
»dunBufLi¡
->»dunBuf[
šdex
];

519 
pObj
->
¤cSymbŞsTab
[
»dunBuf
->
£i
] =„edunBuf;

523 
	}
}

530 
	$´eRedunO³nFecDecProûssAá”
(
P»RedunCÚ‹xt
 *
oObj
) {

531 
esi
 = 0;

532 *
d©a
 = 
NULL
;

533 
RedunBuf
 *
»dunBuf
 = 
NULL
;

534 
P»RedunMªageDecPrivStu
 *
pObj
 = (P»RedunMªageDecPrivStu *)
oObj
->
´iv
;

536 
pObj
->
æag
 = !pObj->flag;

538 
esi
 = 0;ƒs˜< 
pObj
->
k
;ƒsi++) {

539 ià(
pObj
->
»cvdV®idTab
[
esi
]) {

541 
RedunBuf
 *
»dunBuf
 = (RedunBuà*)
pObj
->
»cvdV®idTab
[
esi
];

542 ià(!
pObj
->
»cvdIsS’d
[
esi
]) {

543 ià(
pObj
->
ŒªsfÜmFromRedun
) {

544 
d©a
 = 
pObj
->
	`ŒªsfÜmFromRedun
ÕObj->
´iv
,…Obj->
»cvdV®idTab
[
esi
], 
NULL
, NULL, 1);

545 ià(
d©a
) {

546 ià(
pObj
->
s£nd
) {

547 
»dunBuf
->
»fId
 = 
REDUN_REF_JUST_SEND_NUM
;

548 
pObj
->
	`s£nd
ÕObj->
´iv
, 
d©a
);

553 
pObj
->
»cvdV®idTab
[
esi
] = 
NULL
;

554 
pObj
->
¤cSymbŞsTab
[
esi
] = 
NULL
;

557 
pObj
->
	`»Ëa£
ÕObj->
´iv
,…Obj->
»cvdV®idTab
[
esi
]);

560 
pObj
->
»cvdIsS’d
[
esi
] = 0;

561 
pObj
->
drİNum
 = (pObj->
isDrİ
 & (1 << 
esi
)) ?…Obj->dropNum - 1 :…Obj->dropNum;

562 
pObj
->
isDrİ
 &ğ~(1 << 
esi
);

563 
pObj
->
»cvdNum
--;

567 ià(
pObj
->
ŒªsfÜmFromRedun
) {

568 ià(
pObj
->
¤cSymbŞsTab
[
esi
]) {

569 
RedunBuf
 *
»dunBuf
 = 
pObj
->
¤cSymbŞsTab
[
esi
];

570 
d©a
 = 
pObj
->
	`ŒªsfÜmFromRedun
ÕObj->
´iv
,…Obj->
¤cSymbŞsTab
[
esi
], 
NULL
, NULL, 1);

571 ià(
d©a
) {

572 ià(
pObj
->
s£nd
) {

573 
»dunBuf
->
»fId
 = 
REDUN_REF_JUST_SEND_NUM
;

574 
pObj
->
	`s£nd
ÕObj->
´iv
, 
d©a
);

580 
pObj
->
»cvdIsS’d
[
esi
] = 0;

581 
pObj
->
»cvdV®idTab
[
esi
] = 
NULL
;

582 
pObj
->
¤cSymbŞsTab
[
esi
] = 
NULL
;

587 ià(
pObj
->
»cvdNum
 > 0) {

588 
»fNum
 = 0;

589 
šdex
 = 0;

590 
jIndex
 = 0;

591 
Ï¡Index
 = 0;

593 
šdex
 = 
pObj
->
k
; index <…Obj->
n
; index++) {

594 
»dunBuf
 = (
RedunBuf
 *)
pObj
->
»cvdV®idTab
[
šdex
];

595 
pObj
->
»cvdV®idTab
[
šdex
 -…Obj->
k
] =…Obj->recvdValidTab[index];

596 
pObj
->
»cvdIsS’d
[
šdex
 -…Obj->
k
] =…Obj->recvdIsSend[index];

598 
pObj
->
»cvdV®idTab
[
šdex
] = 
NULL
;

599 
pObj
->
»cvdIsS’d
[
šdex
] = 0;

600 ià(
pObj
->
»cvdV®idTab
[
šdex
 -…Obj->
k
]) {

601 
»dunBuf
->
£i
 -ğ
pObj
->
k
;

602 ià(
pObj
->
ŒªsfÜmToRedun
) {

603 
»dunBuf
 = 
pObj
->
	`ŒªsfÜmToRedun
ÕObj->
´iv
, (**)&redunBuf,„edunBuf->priv, 1);

606 ià(
»fNum
 =ğ
šdex
 - 
pObj
->
k
) {

608 ià(
pObj
->
ŒªsfÜmFromRedun
) {

609 
d©a
 = 
pObj
->
	`ŒªsfÜmFromRedun
ÕObj->
´iv
, 
»dunBuf
, 
NULL
, NULL, 1);

610 ià(
d©a
) {

611 ià(
pObj
->
s£nd
) {

612 
»dunBuf
->
»fId
 = 
REDUN_REF_RESTORE_NUM
;

613 
pObj
->
	`s£nd
ÕObj->
´iv
, 
d©a
);

617 
pObj
->
»cvdIsS’d
[
šdex
 -…Obj->
k
] = 1;

619 
»fNum
++;

620 
Ï¡Index
 = 
šdex
;

625 
pObj
->
isDrİ
 = 0;

626 
pObj
->
drİNum
 = 0;

627 
jIndex
 = 0; jIndex < 
Ï¡Index
 - 
pObj
->
k
; jIndex++) {

628 ià(
NULL
 =ğ
pObj
->
»cvdV®idTab
[
jIndex
]) {

629 
pObj
->
drİNum
++;

630 
pObj
->
isDrİ
 |ğ(1 << 
jIndex
);

634 
pObj
->
£i
 -ğpObj->
k
;

638 
	}
}

640 
	$´eRedunO³nFecDecCommªd
(
P»RedunCÚ‹xt
 *
oObj
, 
cmd
, *
v®ue
) {

641 
šdex
 = 0;

642 
¡©us
 = -1;

643 
P»RedunMªageDecPrivStu
 *
pObj
 = (P»RedunMªageDecPrivStu *)
oObj
->
´iv
;

645 
cmd
) {

646 
PREREDUN_COMMAND_ISSAVE_FILE
:

648 
pObj
->
‹¡DrİNum
 = *((*)
v®ue
);

649 
	`´štf
 ("% %d -->e¡DrİNum:%d\n", 
__func__
, 
__LINE__
, 
pObj
->
‹¡DrİNum
);

652 
PREREDUN_COMMAND_DROP_PACKAGE
:

661 
	}
}

663 
P»RedunMªageStu
 
	g´eRedunO³nFecAudDec
 = {

664 .
Çme
 = "Pre_OpenFec_Audio_Decode",

665 .
	g´ivSize
 = (
P»RedunMªageDecPrivStu
),

666 .
	giš™
 = 
´eRedunO³nFecDecIn™
,

667 .
	g“x™
 = 
´eRedunO³nFecDecEx™
,

668 .
	g´oûss
 = 
´eRedunO³nFecDecProûss
,

669 .
	gadd
 = 
´eRedunO³nFecDecAdd
,

670 .
	g´oûs§á”
 = 
´eRedunO³nFecDecProûssAá”
,

671 .
	gcommªd
 = 
´eRedunO³nFecDecCommªd
,

677 
	sP»RedunMªageEncPrivStu
 {

679 
	mk
;

681 
	mn
;

683 
	mflL’gth
;

685 
	mh—dFlL’gth
;

687 
	mæag
;

689 
	misFœ¡Pkt
;

691 
	m£i
;

693 
	m»cvdNum
;

698 
	misEncChªge
;

700 
	m£qId
;

702 
	mÏ¡RecvPktSeq
;

704 
	misDrİ
;

706 
	mdrİNum
;

708 *
	m»cvdV®idTab
[
REDUN_MAX_NUM
];

710 
	m»cvdIsS’d
[
REDUN_MAX_NUM
];

711 
	m»·œSymbŞsTab
[
REDUN_ALT_NUM
][
REDUN_MAX_NUM
][
REDUN_MAX_LENGTH
];

712 
	m»·œH—dSymbŞsTab
[
REDUN_ALT_NUM
][
REDUN_MAX_NUM
][
REDUN_MAX_HEAD_LENGTH
];

715 (*
	mg‘SeqId
)(*
	moObj
, *
	md©a
);

718 *(*
	mŒªsfÜmFromRedun
)(*
	moObj
, *
	md©a
, *
	m»·œ
, *
	mh—dR•aœ
, 
	misSrc
);

721 *(*
	mŒªsfÜmToRedun
)(*
	moObj
, **
	m»dunBuf
, *
	md©a
, 
	misSrc
);

724 (*
	ms£nd
)(*
	moObj
, *
	md©a
);

729 (*
	m»Ëa£
)(*
	moObj
, *
	m»dunBuf
);

732 
QueHndl
 
	mhndlE
;

733 
RedunBuf
 
	m»dunBuf
[
REDUN_BUFFER_NUM
];

736 *
	m´iv
;

737 } 
	tP»RedunMªageEncPrivStu
 ;

742 
	$´eRedunO³nFecEncIn™
(
P»RedunCÚ‹xt
 *
oObj
, *
cÚfig
) {

743 
»t
 = -1;

744 
šdex
 = 0;

745 
P»RedunMªageEncPrivStu
 *
pObj
 = (P»RedunMªageEncPrivStu *)
oObj
->
´iv
;

746 
P»RedunMªageEncP¬mas
 *
·¿ms
 = (P»RedunMªageEncP¬ma *)
cÚfig
;

748 
	`mem£t
(
pObj
, 0x0, (*pObj));

750 
	`´štf
 ("%s %d input check k:%d‚:%d…riv:%p "

756 
__func__
, 
__LINE__
,

757 
·¿ms
->
k
,

758 
·¿ms
->
n
,

759 
·¿ms
->
´iv
,

760 
·¿ms
->
flL’gth
,

761 
·¿ms
->
h—dFlL’gth
,

762 
·¿ms
->
ŒªsfÜmFromRedun
,

763 
·¿ms
->
ŒªsfÜmToRedun
,

764 
·¿ms
->
s£nd
,

765 
·¿ms
->
»Ëa£
,

766 
·¿ms
->
g‘SeqId
);

768 ià(
·¿ms
->
flL’gth
 % 2 != 0

769 || 
·¿ms
->
h—dFlL’gth
 % 2 != 0) {

770 
	`´štf
 ("[%s %d] fillLength:%d headFillLength:%d‚ot match[len mod 2 == 0]\n",

771 
__func__
, 
__LINE__
, 
·¿ms
->
flL’gth
,…¬ams->
h—dFlL’gth
);

772 
ERR0
;

775 ià(
NULL
 =ğ
·¿ms
->
ŒªsfÜmFromRedun


776 || 
NULL
 =ğ
·¿ms
->
ŒªsfÜmToRedun


777 || 
NULL
 =ğ
·¿ms
->
s£nd


778 || 
NULL
 =ğ
·¿ms
->
»Ëa£


779 || 
NULL
 =ğ
·¿ms
->
g‘SeqId
) {

780 
	`´štf
 ("[%s %d]input callback invalid[%d-%d-%d-%d-%d]\n",

781 
__func__
, 
__LINE__
,

782 
NULL
 =ğ
·¿ms
->
ŒªsfÜmFromRedun
,

783 
NULL
 =ğ
·¿ms
->
ŒªsfÜmToRedun
,

784 
NULL
 =ğ
·¿ms
->
s£nd
,

785 
NULL
 =ğ
·¿ms
->
»Ëa£
,

786 
NULL
 =ğ
·¿ms
->
g‘SeqId
);

787 
ERR0
;

790 
pObj
->
k
 = 
·¿ms
->k;

791 
pObj
->
n
 = 
·¿ms
->n;

792 
pObj
->
flL’gth
 = 
·¿ms
->fillLength;

793 
pObj
->
h—dFlL’gth
 = 
·¿ms
->headFillLength;

794 
pObj
->
´iv
 = 
·¿ms
->priv;

796 
pObj
->
ŒªsfÜmFromRedun
 = 
·¿ms
->transformFromRedun;

797 
pObj
->
ŒªsfÜmToRedun
 = 
·¿ms
->transformToRedun;

798 
pObj
->
s£nd
 = 
·¿ms
->ssend;

799 
pObj
->
»Ëa£
 = 
·¿ms
->release;

800 
pObj
->
g‘SeqId
 = 
·¿ms
->getSeqId;

802 
»t
 = 
	`QueueC»©e
(&
pObj
->
hndlE
, 1000);

803 ià(
»t
) {

804 
	`´štf
 ("[% %d]QueueC»©pObj->hndlE fau»\n", 
__func__
, 
__LINE__
);

805 
ERR0
;

808 
šdex
 = 0; index < 
REDUN_BUFFER_NUM
; index++) {

809 
pObj
->
»dunBuf
[
šdex
].
hªdË
 = (*)&pObj->
hndlE
;

810 
»t
 = 
	`QueuePut
(&
pObj
->
hndlE
, ()&pObj->
»dunBuf
[
šdex
], 
TIMEOUT_NONE
);

811 ià(
»t
) {

812 
	`´štf
 ("[% %d] QueuePuˆhndlE index:%d fau»\n", 
__func__
, 
__LINE__
, 
šdex
);

817 
ERR0
:

819 
	}
}

824 
	$´eRedunO³nFecEncEx™
(
P»RedunCÚ‹xt
 *
oObj
) {

825 
P»RedunMªageEncPrivStu
 *
pObj
 = (P»RedunMªageEncPrivStu *)
oObj
->
´iv
;

827 
	`QueueD–‘e
(&
pObj
->
hndlE
);

830 
	}
}

832 *
	$P»RedunCÚ‹xtO³nFecEncG‘SeqId
(
P»RedunMªageEncPrivStu
 *
pObj
, *
d©a
) {

833 ià(
pObj
->
g‘SeqId
) {

834 
pObj
->
£qId
 =…Obj->
	`g‘SeqId
ÕObj->
´iv
, 
d©a
);

836 
	}
}

844 
RedunBuf
 *
	$P»RedunCÚ‹xtO³nFecEncT¿nsfÜm
(
P»RedunMªageEncPrivStu
 *
pObj
, *
d©a
) {

845 
»t
 = -1;

846 
RedunBuf
 *
»dunBuf
 = 
NULL
;

848 
»t
 = 
	`QueueG‘
(&
pObj
->
hndlE
, (*)&
»dunBuf
, 
TIMEOUT_NONE
);

849 ià(
»t
) {

850 
	`´štf
 ("% %d QueuG‘ fau»\n", 
__func__
, 
__LINE__
);

851 
ERR0
;

855 ià(
pObj
->
ŒªsfÜmToRedun
) {

856  
pObj
->
	`ŒªsfÜmToRedun
ÕObj->
´iv
, (**)&
»dunBuf
, 
d©a
, 1);

859 
ERR0
:

860  
NULL
;

861 
	}
}

869 
	$P»RedunCÚ‹xtO³nFecEncAddF¿me
(
P»RedunMªageEncPrivStu
 *
pObj
, 
RedunBuf
 *
»dunBuf
) {

870 
šdex
 = 0;

871 *
d©a
 = 
NULL
;

873 ià(
NULL
 =ğ
pObj
->
»cvdV®idTab
[pObj->
£i
]) {

874 
pObj
->
»cvdV®idTab
[pObj->
£i
] = (*)
»dunBuf
;

875 ià(
pObj
->
£i
 <…Obj->
k
) {

876 ià(
pObj
->
ŒªsfÜmFromRedun
) {

877 
d©a
 = 
pObj
->
	`ŒªsfÜmFromRedun
ÕObj->
´iv
,

878 
pObj
->
»cvdV®idTab
[pObj->
£i
],

879 
pObj
->
»·œSymbŞsTab
[pObj->
æag
][pObj->
£i
],

880 
pObj
->
»·œH—dSymbŞsTab
[pObj->
æag
][pObj->
£i
], 1);

881 ià(
d©a
) {

882 ià(
pObj
->
s£nd
) {

884 
»dunBuf
->
»fId
 = 
REDUN_REF_RESTORE_NUM
;

885 
pObj
->
	`s£nd
ÕObj->
´iv
, 
d©a
);

889 
	`´štf
 ("´iv i NULL sei:%d\n", 
pObj
->
£i
);

894 
pObj
->
»cvdNum
++;

897 
»dunBuf
->
£i
 = 
pObj
->sei++;

900 
	`´štf
 ("[%s %d] why sei:%d…Obj->recvdValidTab:%p != NULL\n",

901 
__func__
, 
__LINE__
, 
pObj
->
£i
,…Obj->
»cvdV®idTab
[pObj->sei]);

905 
	}
}

912 
	$P»RedunCÚ‹xtO³nFecEncIsCom¶‘e
(
P»RedunMªageEncPrivStu
 *
pObj
) {

913  
pObj
->
»cvdNum
 =ğpObj->
k
 ? 0 : -1;

914 
	}
}

922 
	$P»RedunCÚ‹xtO³nFecEncCom¶‘ed
(
P»RedunMªageEncPrivStu
 *
pObj
,

923 
RedunBufLi¡
 *
»dunBufLi¡
) {

924 
»t
 = -1;

925 
šdex
 = 0;

926 *
d©a
 = 
NULL
;

927 
RedunBuf
 *
»dunBuf
 = 
NULL
;

928 
»dunBufLi¡
->
numBufs
 = 0;

930 
šdex
 = 0; index < 
pObj
->
k
; index++) {

931 ià(
pObj
->
»cvdV®idTab
[
šdex
]) {

932 
»dunBufLi¡
->
»dunBuf
[»dunBufLi¡->
numBufs
++] = (
RedunBuf
 *)
pObj
->
»cvdV®idTab
[
šdex
];

935 ià(
»dunBufLi¡
->
numBufs
 =ğ
pObj
->
k
) {

941 
šdex
 = 0; index < 
pObj
->
k
; index++) {

943 
»t
 = 
	`QueueG‘
(&
pObj
->
hndlE
, (*)&
»dunBuf
, 
TIMEOUT_NONE
);

944 ià(
»t
) {

945 
	`´štf
 ("[% %d]QueueG‘ hndlE fau»\n", 
__func__
, 
__LINE__
);

946 
ERR0
;

950 ià(
pObj
->
»que¡
) {

952 
d©a
 = 
pObj
->
	`»que¡
ÕObj->
´iv
,…Obj->
flL’gth
,…Obj->
£i
 + 
šdex
);

953 ià(
NULL
 !ğ
d©a
) {

954 ià(
pObj
->
ŒªsfÜmToRedun
) {

959 
pObj
->
»cvdV®idTab
[pObj->
k
 + 
šdex
] = (*)
»dunBuf
;

968 
pObj
->
»cvdV®idTab
[pObj->
k
 + 
šdex
] = (*)
»dunBuf
;

969 
»dunBufLi¡
->
»dunBuf
[»dunBufLi¡->
numBufs
] =„edunBuf;

970 
»dunBufLi¡
->
»dunBuf
[»dunBufLi¡->
numBufs
]->
£i
 = 
pObj
->
k
 + 
šdex
;

971 
»dunBufLi¡
->
»dunBuf
[»dunBufLi¡->
numBufs
]->
d©a
 = 
pObj
->
»·œSymbŞsTab
[!pObj->
æag
][
šdex
];

972 
»dunBufLi¡
->
»dunBuf
[»dunBufLi¡->
numBufs
]->
d©aR•aœ
 = 
pObj
->
»·œSymbŞsTab
[!pObj->
æag
][
šdex
];

973 
»dunBufLi¡
->
»dunBuf
[»dunBufLi¡->
numBufs
]->
d©aH—d
 = 
pObj
->
»·œH—dSymbŞsTab
[!pObj->
æag
][
šdex
];

974 
»dunBufLi¡
->
»dunBuf
[»dunBufLi¡->
numBufs
++]->
d©aH—dR•aœ
 = 
pObj
->
»·œH—dSymbŞsTab
[!pObj->
æag
][
šdex
];

978  
»dunBufLi¡
->
numBufs
 =ğ
pObj
->
n
 ? 0 : -1;

979 
ERR0
:

980 
šdex
 = 
pObj
->
k
; index <…Obj->
n
; index++) {

981 ià(
pObj
->
»cvdV®idTab
[
šdex
]) {

982 
»dunBuf
 = (
RedunBuf
 *)
pObj
->
»cvdV®idTab
[
šdex
];

983 
	`QueuePut
((
QueHndl
 *)
»dunBuf
->
hªdË
, (ìedunBuf, 
TIMEOUT_NONE
);

984 
pObj
->
»cvdV®idTab
[
šdex
] = 
NULL
;

989 
	}
}

999 
	$´eRedunO³nFecEncProûss
(
P»RedunCÚ‹xt
 *
oObj
, *
d©a
, 
RedunBufLi¡
 *
»dunBufLi¡
) {

1000 
RedunBuf
 *
»dunBuf
 = 
NULL
;

1001 
P»RedunMªageEncPrivStu
 *
pObj
 = (P»RedunMªageEncPrivStu *)
oObj
->
´iv
;

1004 
	`P»RedunCÚ‹xtO³nFecEncG‘SeqId
(
pObj
, 
d©a
);

1006 
»dunBuf
 = 
	`P»RedunCÚ‹xtO³nFecEncT¿nsfÜm
(
pObj
, 
d©a
);

1007 ià(
NULL
 =ğ
»dunBuf
) {

1011 
	`P»RedunCÚ‹xtO³nFecEncAddF¿me
(
pObj
, 
»dunBuf
);

1013 ià(!
	`P»RedunCÚ‹xtO³nFecEncIsCom¶‘e
(
pObj
)) {

1014  
	`P»RedunCÚ‹xtO³nFecEncCom¶‘ed
(
pObj
, 
»dunBufLi¡
);

1018 
	}
}

1025 
	$´eRedunO³nFecEncProûssAá”
(
P»RedunCÚ‹xt
 *
oObj
) {

1026 
»t
 = -1;

1027 
esi
 = 0;

1028 *
d©a
 = 
NULL
;

1029 
RedunBuf
 *
»dunBuf
 = 
NULL
;

1030 
P»RedunMªageEncPrivStu
 *
pObj
 = (P»RedunMªageEncPrivStu *)
oObj
->
´iv
;

1032 
esi
 = 0;ƒs˜< 
pObj
->
n
;ƒsi++) {

1033 ià(
pObj
->
»cvdV®idTab
[
esi
]) {

1034 
»dunBuf
 = (
RedunBuf
 *)
pObj
->
»cvdV®idTab
[
esi
];

1035 ià(
esi
 < 
pObj
->
k
) {

1037 
pObj
->
	`»Ëa£
(&pObj->
´iv
,…Obj->
»cvdV®idTab
[
esi
]);

1041 
	`QueuePut
(&
pObj
->
hndlE
, (íObj->
»cvdV®idTab
[
esi
], 
TIMEOUT_NONE
);

1044 
pObj
->
»cvdV®idTab
[
esi
] = 
NULL
;

1052 
pObj
->
»cvdNum
 = 0;

1053 
pObj
->
£i
 = 0;

1054 
pObj
->
æag
 = !pObj->flag;

1057 
	}
}

1059 
	$´eRedunO³nFecEncCommªd
(
P»RedunCÚ‹xt
 *
oObj
, 
cmd
, *
v®ue
) {

1060 
šdex
 = 0;

1061 
¡©us
 = -1;

1062 
P»RedunMªageEncPrivStu
 *
pObj
 = (P»RedunMªageEncPrivStu *)
oObj
->
´iv
;

1064 
cmd
) {

1065 
PREREDUN_COMMAND_ISSAVE_FILE
:

1074 
	}
}

1077 
P»RedunMªageStu
 
	g´eRedunO³nFecAudEnc
 = {

1078 .
Çme
 = "Pre_OpenFec_Audio_Encode",

1079 .
	g´ivSize
 = (
P»RedunMªageEncPrivStu
),

1080 .
	giš™
 = 
´eRedunO³nFecEncIn™
,

1081 .
	g“x™
 = 
´eRedunO³nFecEncEx™
,

1082 .
	g´oûss
 = 
´eRedunO³nFecEncProûss
,

1083 .
	g´oûs§á”
 = 
´eRedunO³nFecEncProûssAá”
,

1084 .
	gcommªd
 = 
´eRedunO³nFecEncCommªd
,

	@mytest/queue.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<uni¡d.h
>

4 
	~<queue.h
>

6 
	$QueueC»©e
(
QueHndl
 *
hndl
, 
maxL’
)

8 
±h»ad_mu‹x©Œ_t
 
mu‹x_©Œ
;

9 
±h»ad_cÚd©Œ_t
 
cÚd_©Œ
;

10 
¡©us
 = 0;

12 
hndl
->
curRd
 = hndl->
curWr
 = 0;

13 
hndl
->
couÁ
 = 0;

14 
hndl
->
Ën
 = 
maxL’
;

15 
hndl
->
queue
 = (*)
	`m®loc
((è* hndl->
Ën
);

17 ià(
hndl
->
queue
 =ğ
NULL
) {

18 
	`´štf
("OSA_queC»©e(èğ%d \r\n", 
¡©us
);

22 
¡©us
 |ğ
	`±h»ad_mu‹x©Œ_š™
(&
mu‹x_©Œ
);

23 
¡©us
 |ğ
	`±h»ad_cÚd©Œ_š™
(&
cÚd_©Œ
);

25 
¡©us
 |ğ
	`±h»ad_mu‹x_š™
(&
hndl
->
lock
, &
mu‹x_©Œ
);

26 
¡©us
 |ğ
	`±h»ad_cÚd_š™
(&
hndl
->
cÚdRd
, &
cÚd_©Œ
);

27 
¡©us
 |ğ
	`±h»ad_cÚd_š™
(&
hndl
->
cÚdWr
, &
cÚd_©Œ
);

29 ià(
¡©us
 != 0)

30 
	`´štf
("OSA_queC»©e(èğ%d \r\n", 
¡©us
);

32 
	`±h»ad_cÚd©Œ_de¡roy
(&
cÚd_©Œ
);

33 
	`±h»ad_mu‹x©Œ_de¡roy
(&
mu‹x_©Œ
);

35  
¡©us
;

36 
	}
}

38 
	$QueueD–‘e
(
QueHndl
 *
hndl
)

40 ià(
hndl
->
queue
 !ğ
NULL
)

41 
	`ä“
(
hndl
->
queue
);

43 
	`±h»ad_cÚd_de¡roy
(&
hndl
->
cÚdRd
);

44 
	`±h»ad_cÚd_de¡roy
(&
hndl
->
cÚdWr
);

45 
	`±h»ad_mu‹x_de¡roy
(&
hndl
->
lock
);

48 
	}
}

50 
	$QueuePut
(
QueHndl
 *
hndl
, 
v®ue
, 
timeout
)

52 
¡©us
 = -1;

54 
	`±h»ad_mu‹x_lock
(&
hndl
->
lock
);

57 ià(
hndl
->
couÁ
 < hndl->
Ën
) {

58 
hndl
->
queue
[hndl->
curWr
] = 
v®ue
;

59 
hndl
->
curWr
 = (hndl->curW¸+ 1è% hndl->
Ën
;

60 
hndl
->
couÁ
++;

61 
¡©us
 = 0;

62 
	`±h»ad_cÚd_sigÇl
(&
hndl
->
cÚdRd
);

65 ià(
timeout
 =ğ
TIMEOUT_NONE
)

68 
	`±h»ad_cÚd_wa™
(&
hndl
->
cÚdWr
, &hndl->
lock
);

72 
	`±h»ad_mu‹x_uÆock
(&
hndl
->
lock
);

74  
¡©us
;

75 
	}
}

77 
	$QueueG‘
(
QueHndl
 *
hndl
, *
v®ue
, 
timeout
)

79 
¡©us
 = -1;

81 
	`±h»ad_mu‹x_lock
(&
hndl
->
lock
);

84 ià(
hndl
->
couÁ
 > 0) {

86 ià(
v®ue
 !ğ
NULL
) {

87 *
v®ue
 = 
hndl
->
queue
[hndl->
curRd
];

90 
hndl
->
curRd
 = (hndl->curRd + 1è% hndl->
Ën
;

91 
hndl
->
couÁ
--;

92 
¡©us
 = 0;

93 
	`±h»ad_cÚd_sigÇl
(&
hndl
->
cÚdWr
);

96 ià(
timeout
 =ğ
TIMEOUT_NONE
)

99 
	`±h»ad_cÚd_wa™
(&
hndl
->
cÚdRd
, &hndl->
lock
);

103 
	`±h»ad_mu‹x_uÆock
(&
hndl
->
lock
);

105  
¡©us
;

106 
	}
}

108 
	$QueueG‘Plus
(
QueHndl
 *
hndl
, *
v®ue
, 
timeout
, *
pQueuedCouÁs
)

110 
¡©us
 = -1;

112 
	`±h»ad_mu‹x_lock
(&
hndl
->
lock
);

115 ià(
hndl
->
couÁ
 > 0) {

117 ià(
v®ue
 !ğ
NULL
) {

118 *
v®ue
 = 
hndl
->
queue
[hndl->
curRd
];

121 
hndl
->
curRd
 = (hndl->curRd + 1è% hndl->
Ën
;

122 
hndl
->
couÁ
--;

124 ià(
pQueuedCouÁs
è*pQueuedCouÁ ğ
hndl
->
couÁ
;

126 
¡©us
 = 0;

127 
	`±h»ad_cÚd_sigÇl
(&
hndl
->
cÚdWr
);

130 ià(
timeout
 =ğ
TIMEOUT_NONE
) {

131 ià(
pQueuedCouÁs
)*pQueuedCounts = 0;

135 
	`±h»ad_cÚd_wa™
(&
hndl
->
cÚdRd
, &hndl->
lock
);

139 
	`±h»ad_mu‹x_uÆock
(&
hndl
->
lock
);

141  
¡©us
;

142 
	}
}

144 
	$QueueG‘QueuedCouÁ
(
QueHndl
 *
hndl
)

146 
queuedCouÁ
 = 0;

148 
	`±h»ad_mu‹x_lock
(&
hndl
->
lock
);

149 
queuedCouÁ
 = 
hndl
->
couÁ
;

150 
	`±h»ad_mu‹x_uÆock
(&
hndl
->
lock
);

151  
queuedCouÁ
;

152 
	}
}

154 
	$QueueP“k
(
QueHndl
 *
hndl
, *
v®ue
)

156 
¡©us
 = -1;

157 
	`±h»ad_mu‹x_lock
(&
hndl
->
lock
);

158 ià(
hndl
->
couÁ
 > 0) {

159 ià(
v®ue
 !ğ
NULL
) {

160 *
v®ue
 = 
hndl
->
queue
[hndl->
curRd
];

161 
¡©us
 = 0;

164 
	`±h»ad_mu‹x_uÆock
(&
hndl
->
lock
);

166  
¡©us
;

167 
	}
}

169 
	$QueueIsEm±y
(
QueHndl
 *
hndl
)

171 
isEm±y
;

173 
	`±h»ad_mu‹x_lock
(&
hndl
->
lock
);

174 ià(
hndl
->
couÁ
 == 0) {

175 
isEm±y
 = 1;

177 
isEm±y
 = 0;

179 
	`±h»ad_mu‹x_uÆock
(&
hndl
->
lock
);

181  
isEm±y
;

182 
	}
}

	@mytest/queue.h

1 #iâdeà
__QUEUE_OPENFEC_H__


2 
	#__QUEUE_OPENFEC_H__


	)

4 
	~<±h»ad.h
>

8 
	mcurRd
;

9 
	mcurWr
;

10 
	mËn
;

11 
	mcouÁ
;

13 *
	mqueue
;

15 
±h»ad_mu‹x_t
 
	mlock
;

16 
±h»ad_cÚd_t
 
	mcÚdRd
;

17 
±h»ad_cÚd_t
 
	mcÚdWr
;

19 } 
	tQueHndl
;

21 
	#TIMEOUT_NONE
 (() 0)

22 
	#TIMEOUT_FOREVER
 (()-1)

23 

	)

24 
QueueC»©e
(
QueHndl
 *
hndl
, 
maxL’
);

25 
QueueD–‘e
(
QueHndl
 *
hndl
);

26 
QueuePut
(
QueHndl
 *
hndl
, 
v®ue
, 
timeout
);

27 
QueueG‘
(
QueHndl
 *
hndl
, *
v®ue
, 
timeout
);

28 
QueueG‘Plus
(
QueHndl
 *
hndl
, *
v®ue
, 
timeout
, *
pQueuedCouÁs
);

29 
QueueG‘QueuedCouÁ
(
QueHndl
 *
hndl
);

30 
QueueIsEm±y
(
QueHndl
 *
hndl
);

31 
QueueIsEm±y
(
QueHndl
 *
hndl
);

	@mytest/redun.c

1 
	~<¡dio.h
>

2 
	~<¡ršg.h
>

3 
	~<¡dlib.h
>

4 
	~<»dun.h
>

6 
RedunMªageStu
 *
	$RedunMªageG‘ByName
(cÚ¡ *
Çme
) {

7 ià(!
	`¡rcmp
(
Çme
, 
»dunO³nFecAudDec
.name)) {

8  &
»dunO³nFecAudDec
;

10 ià(!
	`¡rcmp
(
Çme
, 
»dunO³nFecAudEnc
.name)) {

11  &
»dunO³nFecAudEnc
;

14  
NULL
;

15 
	}
}

17 
RedunCÚ‹xt
 *
	$RedunCÚ‹xtIn¡ªû
(cÚ¡ 
RedunMªageStu
 *
»dunObj
) {

18 
RedunCÚ‹xt
 *
»dun
 = (RedunCÚ‹xˆ*è
	`m®loc
 ((*redun));

19 ià(
NULL
 =ğ
»dun
) {

20 
	`´štf
 ("RedunCÚ‹xˆ% m®loøçu»\n", 
»dunObj
->
Çme
);

21 
ERR0
;

24 
	`mem£t
(
»dun
, 0x0, (*redun));

26 
»dun
->
»dunObj
 =„edunObj;

28 
»dun
->
´iv
 = (*è
	`m®loc
 (
»dunObj
->
´ivSize
);

29 ià(
NULL
 =ğ
»dun
->
´iv
) {

30 
	`´štf
 ("»dun->´iv % m®loøçu»\n", 
»dunObj
->
Çme
);

31 
ERR1
;

34  
»dun
;

35 
ERR1
:

36 ià(
»dun
è
	`ä“
(redun);

37 
ERR0
:

38  
NULL
;

39 
	}
}

41 
	$RedunCÚ‹xtUnš¡ªû
(
RedunCÚ‹xt
 *
oObj
) {

42 ià(
oObj
) {

43 ià(
oObj
->
´iv
è
	`ä“
(oObj->priv);

45 
	`ä“
(
oObj
);

49 
	}
}

51 
	$RedunCÚ‹xtIn™
(
RedunCÚ‹xt
 *
oObj
, *
d©a
) {

52 ià(
oObj
->
»dunObj
) {

53 ià(
oObj
->
»dunObj
->
oİ’
) {

54  
oObj
->
»dunObj
->
	`oİ’
(oObj, 
d©a
);

59 
	}
}

61 
	$RedunCÚ‹xtEx™
(
RedunCÚ‹xt
 *
oObj
) {

62 ià(
oObj
->
»dunObj
) {

63 ià(
oObj
->
»dunObj
->
cşo£
) {

64  
oObj
->
»dunObj
->
	`cşo£
(oObj);

69 
	}
}

71 
	$RedunCÚ‹xtRe£t
(
RedunCÚ‹xt
 *
oObj
) {

72 ià(
oObj
->
»dunObj
) {

73 ià(
oObj
->
»dunObj
->
»£t
) {

74  
oObj
->
»dunObj
->
	`»£t
(oObj);

79 
	}
}

81 
	$RedunCÚ‹xtAddF¿me
(
RedunCÚ‹xt
 *
oObj
, 
RedunBuf
 *
d©a
) {

82 
RedunBufLi¡
 
pD©aLi¡
;

84 
pD©aLi¡
.
numBufs
 = 1;

85 
pD©aLi¡
.
»dunBuf
[0] = 
d©a
;

87 ià(
oObj
->
»dunObj
) {

88 ià(
oObj
->
»dunObj
->
add
) {

89  
oObj
->
»dunObj
->
	`add
(oObj, &
pD©aLi¡
);

94 
	}
}

96 
	$RedunCÚ‹xtAddF¿meLi¡
(
RedunCÚ‹xt
 *
oObj
, 
RedunBufLi¡
 *
pD©aLi¡
) {

97 ià(
oObj
->
»dunObj
) {

98 ià(
oObj
->
»dunObj
->
add
) {

99  
oObj
->
»dunObj
->
	`add
(oObj, 
pD©aLi¡
);

104 
	}
}

106 
	$RedunCÚ‹xtProûssF¿me
(
RedunCÚ‹xt
 *
oObj
) {

107 ià(
oObj
->
»dunObj
) {

108 ià(
oObj
->
»dunObj
->
´oûss
) {

109  
oObj
->
»dunObj
->
	`´oûss
(oObj);

114 
	}
}

116 
	$RedunCÚ‹xtCommªd
(
RedunCÚ‹xt
 *
oObj
, 
cmd
, *
v®ue
) {

117 ià(
oObj
->
»dunObj
) {

118 ià(
oObj
->
»dunObj
->
commªd
) {

119  
oObj
->
»dunObj
->
	`commªd
(oObj, 
cmd
, 
v®ue
);

124 
	}
}

	@mytest/redun.h

1 #iâdeà
__RUDUN_H__


2 
	#__RUDUN_H__


	)

4 
	#REDUN_MAX_INPUT_NUM
 (255)

	)

7 
	mREDUN_COMMAND_ISSAVE_FILE
,

8 
	mREDUN_COMMAND_CNT
,

9 } 
	tREDUN_COMMAND
;

12 
	m£i
;

13 
	m»fId
;

15 *
	mhªdË
;

16 *
	mhªdËRes
;

18 *
	md©a
;

19 *
	md©aH—d
;

21 *
	md©aR•aœ
;

22 *
	md©aH—dR•aœ
;

24 *
	m´iv
;

25 } 
	tRedunBuf
;

28 
	mnumBufs
;

29 
RedunBuf
 *
	m»dunBuf
[
REDUN_MAX_INPUT_NUM
];

30 } 
	tRedunBufLi¡
;

32 
	gRedunMªageStu
;

33 
	sRedunCÚ‹xt
 {

34 *
	mÇme
;

35 *
	m´iv
;

37 cÚ¡ 
RedunMªageStu
 *
	m»dunObj
;

38 } 
	tRedunCÚ‹xt
;

40 
	sRedunMªageStu
 {

41 cÚ¡ *
	mÇme
;

42 
	m´ivSize
;

44 (*
	moİ’
)(
RedunCÚ‹xt
 *
	moObj
, *
	mcÚfig
);

45 (*
	mcşo£
)(
RedunCÚ‹xt
 *
	moObj
);

46 (*
	m»£t
)(
RedunCÚ‹xt
 *
	moObj
);

47 (*
	madd
)(
RedunCÚ‹xt
 *
	md©a
, 
RedunBufLi¡
 *
	mpD©aLi¡
);

48 (*
	m´oûss
)(
RedunCÚ‹xt
 *
	moObj
);

49 (*
	mcommªd
)(
RedunCÚ‹xt
 *
	moObj
, 
	mcmd
, *
	mv®ue
);

50 } 
	tRedunMªageStu
;

53 
RedunMªageStu
 
»dunO³nFecAudDec
;

54 
RedunMªageStu
 
»dunO³nFecAudEnc
;

57 
RedunMªageStu
 *
RedunMªageG‘ByName
(cÚ¡ *
Çme
);

60 
RedunCÚ‹xt
 *
RedunCÚ‹xtIn¡ªû
(cÚ¡ 
RedunMªageStu
 *
»dunObj
);

61 
RedunCÚ‹xtUnš¡ªû
(
RedunCÚ‹xt
 *
oObj
);

64 
RedunCÚ‹xtIn™
(
RedunCÚ‹xt
 *
oObj
, *
d©a
);

67 
RedunCÚ‹xtEx™
(
RedunCÚ‹xt
 *
oObj
);

70 
RedunCÚ‹xtRe£t
(
RedunCÚ‹xt
 *
oObj
);

73 
RedunCÚ‹xtAddF¿me
(
RedunCÚ‹xt
 *
oObj
, 
RedunBuf
 *
d©a
);

76 
RedunCÚ‹xtAddF¿meLi¡
(
RedunCÚ‹xt
 *
oObj
, 
RedunBufLi¡
 *
pD©aLi¡
);

79 
RedunCÚ‹xtProûssF¿me
(
RedunCÚ‹xt
 *
oObj
);

81 
RedunCÚ‹xtCommªd
(
RedunCÚ‹xt
 *
oObj
, 
cmd
, *
v®ue
);

	@mytest/redun_config.h

1 #iâdeà
__RUDUN_OPENFEC_H__


2 
	#__RUDUN_OPENFEC_H__


	)

4 
	~<of_İ’ãc_­i.h
>

6 
	sRedunMªageDecP¬mas
 {

7 
	mk
;

8 
	mn
;

9 
	mflL’gth
;

10 
	mh—dFlL’gth
;

11 
	mcodecId
;

13 *
	m´iv
;

15 *(*
	m»que¡¤c
)(*
	moObj
, 
	msize
, 
	mesi
);

16 *(*
	m»que¡»·œ
)(*
	moObj
, 
	msize
, 
	mesi
);

17 *(*
	m»que¡¤úew
)(*
	moObj
,

18 **
	md©a
, **
	mh—d
,

19 
	msize
, 
	mh—d_size
,

20 
	mesi
);

21 *(*
	m»que¡»·œÃw
)(*
	moObj
,

22 **
	md©a
, **
	mh—d
,

23 
	msize
, 
	mh—d_size
,

24 
	mesi
);

25 (*
	m»Ëa£
)(*
	moObj
, 
RedunBuf
 *
	m»dunBuf
);

26 } 
	tRedunMªageDecP¬mas
;

28 
	sRedunMªageEncP¬mas
 {

29 
	mk
;

30 
	mn
;

31 
	mflL’gth
;

32 
	mh—dFlL’gth
;

33 
of_codec_id_t
 
	mcodecId
;

35 *
	m´iv
;

36 } 
	tRedunMªageEncP¬mas
;

	@mytest/redun_interface.c

1 
	~<¡dio.h
>

2 
	~<¡dlib.h
>

3 
	~<uni¡d.h
>

4 
	~"»dun_š‹rçû.h
"

14 
	$RedunS”v”AutoRecyşe
(
RedunS”v”Obj
 *
oObj
) {

15 
»t
 = 0;

16 
RedunBuf
 *
»dunBuf
 = 
NULL
;

17 
RedunS”v”Obj
 *
pObj
 = (RedunS”v”Obj *)
oObj
;

20 
»t
 = 
	`QueueG‘
(&
pObj
->
hndlRes
, (*)&
»dunBuf
, 
TIMEOUT_NONE
);

21 ià(
»t
) ;

23 
»dunBuf
->
»fId
--;

24 ià(
»dunBuf
->
»fId
 <= 0) {

25 
»dunBuf
->
»fId
 = 0;

27 
	`QueuePut
((
QueHndl
 *)
»dunBuf
->
hªdË
, (ìedunBuf, 
TIMEOUT_NONE
);

29 ià(
pObj
->
»Ëa£
) {

30 
pObj
->
	`»Ëa£
ÕObj->
´iv
, 
»dunBuf
->priv);

36 
	}
}

38 *
	$RedunS”v”T¿nsfÜmFromRedun
(*
oObj
,

39 *
»dunBuf
, *
»·œ
, *
h—dR•aœ
, 
isSrc
) {

40 
»t
 = -1;

41 *
d©a
 = 
NULL
;

42 
RedunS”v”Obj
 *
pObj
 = (RedunS”v”Obj *)
oObj
;

44 ià(
pObj
->
ŒªsfÜmFromRedun
) {

45 
d©a
 = 
pObj
->
	`ŒªsfÜmFromRedun
ÕObj->
´iv
, 
»dunBuf
, 
»·œ
, 
h—dR•aœ
, 
isSrc
);

48  
d©a
;

49 
	}
}

51 *
	$RedunS”v”T¿nsfÜmToRedun
(*
oObj
, **
»dunBuff
,

52 *
d©a
, 
isSrc
) {

53 
»t
 = -1;

54 
RedunBuf
 *
»dunBuf
 = 
NULL
;

55 
RedunS”v”Obj
 *
pObj
 = (RedunS”v”Obj *)
oObj
;

57 ià(
pObj
->
ŒªsfÜmToRedun
) {

58 
»dunBuf
 = 
pObj
->
	`ŒªsfÜmToRedun
ÕObj->
´iv
, 
»dunBuff
, 
d©a
, 
isSrc
);

59 ià(
»dunBuf
) {

60 
»dunBuf
->
hªdËRes
 = (*)&
pObj
->
hndlRes
;

64  
»dunBuf
;

65 
	}
}

67 
	$RedunS”v”S’d
(*
oObj
, *
d©a
) {

68 
RedunS”v”Obj
 *
pObj
 = (RedunS”v”Obj *)
oObj
;

70 ià(
pObj
->
s£nd
) {

71  
pObj
->
	`s£nd
ÕObj->
´iv
, 
d©a
);

75 
	}
}

77 
	$RedunS”v”G‘SeqId
(*
oObj
, *
d©a
) {

78 
RedunS”v”Obj
 *
pObj
 = (RedunS”v”Obj *)
oObj
;

80 ià(
pObj
->
g‘SeqId
) {

81  
pObj
->
	`g‘SeqId
ÕObj->
´iv
, 
d©a
);

85 
	}
}

87 
	$RedunS”v”R–—£RedunBuf
(*
oObj
, *
d©a
) {

88 
RedunBuf
 *
»dunBuf
 = (RedunBuà*)
d©a
;

90 
	`RedunS”v”RecyËRedunBuf
(
»dunBuf
->
´iv
);

93 
	}
}

96 
	$RedunS”v”MemIn™
(
RedunS”v”Obj
 *
pObj
) {

97 
»t
 = -1;

98 
šdex
 = 0;

100 
»t
 = 
	`QueueC»©e
(&
pObj
->
hndlE
, 1000);

101 ià(
»t
) {

102 
	`´štf
 ("[% %d]QueueC»©pObj->hndlE fau»\n", 
__func__
, 
__LINE__
);

103 
ERR0
;

106 
»t
 = 
	`QueueC»©e
(&
pObj
->
hndlRes
, 1000);

107 ià(
»t
) {

108 
	`´štf
 ("[% %d]QueueC»©pObj->hndlRe çu»\n", 
__func__
, 
__LINE__
);

109 
ERR1
;

112 
	`mem£t
(&
pObj
->
»dunBuf
[0], 0x0, (pObj->redunBuf));

114 
šdex
 = 0; index < 
REDUN_MAX_INPUT_NUM
; index++) {

115 
pObj
->
»dunBuf
[
šdex
].
hªdË
 = (*)&pObj->
hndlE
;

116 
»t
 = 
	`QueuePut
(&
pObj
->
hndlE
, ()&pObj->
»dunBuf
[
šdex
], 
TIMEOUT_NONE
);

117 ià(
»t
) {

118 
	`´štf
 ("[% %d] QueuePuˆhndlE index:%d fau»\n", 
__func__
, 
__LINE__
, 
šdex
);

123 
ERR1
:

124 
	`QueueD–‘e
(&
pObj
->
hndlE
);

125 
ERR0
:

127 
	}
}

129 
	$RedunS”v”MemEx™
(
RedunS”v”Obj
 *
pObj
) {

130 
	`QueueD–‘e
(&
pObj
->
hndlE
);

131 
	`QueueD–‘e
(&
pObj
->
hndlRes
);

134 
	}
}

152 
	$RedunS”v”RecyËRedunBuf
(*
d©a
) {

153 
£rv”Cl›ÁBuf
 *
pBuf
 = (£rv”Cl›ÁBuà*)
d©a
;

155 
RedunBuf
 *
»dunBuf
 = (RedunBuà*)
pBuf
->
´iv
;

157  
	`QueuePut
((
QueHndl
 *)
»dunBuf
->
hªdËRes
, (ìedunBuf, 
TIMEOUT_NONE
);

158 
	}
}

162 
	$RedunS”v”In™
(
RedunS”v”Obj
 *
pObj
,

163 
k
, 
n
, 
flL’gth
,

164 
h—dFlL’gth
,

165 
codec_id
, *
´iv
,

166 
ŒªsfÜmto
 
toRedun
,

167 
ŒªsfÜmäom
 
äomRedun
,

168 
»Ëa£
 
¾s
,

169 
s£nd
 
£ndd
,

170 
g‘SeqId
 
g‘£qid
) {

171 
»t
 = -1;

172 
šdex
 = 0;

174 
	`´štf
 ("%s %d k:%d‚:%d codecId:%d fillLength:%d headFillLength:%d "

176 
__func__
, 
__LINE__
, 
k
, 
n
, 
codec_id
, 
flL’gth
, 
h—dFlL’gth
,

177 
´iv
, 
toRedun
, 
äomRedun
, 
¾s
, 
£ndd
);

179 
pObj
->
k
 = k;

180 
pObj
->
n
 =‚;

181 
pObj
->
´iv
 =…riv;

182 
pObj
->
codec_id
 = codec_id;

183 
pObj
->
flL’gth
 = fillLength;

184 
pObj
->
h—dFlL’gth
 = headFillLength;

185 
pObj
->
ŒªsfÜmToRedun
 = 
toRedun
;

186 
pObj
->
ŒªsfÜmFromRedun
 = 
äomRedun
;

187 
pObj
->
s£nd
 = 
£ndd
;

188 
pObj
->
»Ëa£
 = 
¾s
;

189 
pObj
->
g‘SeqId
 = 
g‘£qid
;

191 
pObj
->
»dunObj
 = 
	`RedunMªageG‘ByName
("OpenFec_Audio_Encode");

192 ià(
NULL
 =ğ
pObj
->
»dunObj
) {

193 
	`´štf
 ("[%s %d] RedunManageGetByName %s failure\n",

194 
__func__
, 
__LINE__
, "OpenFec_Audio_Encode");

195 
ERR0
;

198 
pObj
->
»dunCÚ‹xt
 = 
	`RedunCÚ‹xtIn¡ªû
ÕObj->
»dunObj
);

199 ià(
NULL
 =ğ
pObj
->
»dunCÚ‹xt
) {

200 
	`´štf
 ("[% %d] RedunCÚ‹xtIn¡ªû fau»\n", 
__func__
, 
__LINE__
);

201 
ERR0
;

204 
pObj
->
cÚfig
.
k
 =…Obj->k;

205 
pObj
->
cÚfig
.
n
 =…Obj->n;

206 
pObj
->
cÚfig
.
flL’gth
 =…Obj->fillLength;

207 
pObj
->
cÚfig
.
h—dFlL’gth
 =…Obj->headFillLength;

208 
pObj
->
cÚfig
.
codecId
 =…Obj->
codec_id
;

209 
pObj
->
cÚfig
.
´iv
 =…Obj;

211 
»t
 = 
	`RedunCÚ‹xtIn™
(
pObj
->
»dunCÚ‹xt
, (*)&pObj->
cÚfig
);

212 ià(
»t
) {

213 
	`´štf
 ("[%s %d] RedunContextInit %s failure\n",

214 
__func__
, 
__LINE__
, "OpenFec_Audio_Encode");

215 
ERR1
;

218 
pObj
->
´eRedunObj
 = 
	`P»RedunMªageG‘ByName
("Pre_OpenFec_Audio_Encode");

219 ià(
NULL
 =ğ
pObj
->
´eRedunObj
) {

220 
	`´štf
 ("[%s %d] PreRedunManageGetByName %s failure\n",

221 
__func__
, 
__LINE__
, "PreRedunManageGetByName");

222 
ERR2
;

225 
pObj
->
´eRedunCÚ‹xt
 = 
	`P»RedunCÚ‹xtIn¡ªû
ÕObj->
´eRedunObj
);

226 ià(
NULL
 =ğ
pObj
->
´eRedunCÚ‹xt
) {

227 
	`´štf
 ("[% %d] P»RedunCÚ‹xtIn¡ªû fau»\n", 
__func__
, 
__LINE__
);

228 
ERR2
;

231 
pObj
->
cÚfigg
.
k
 =…Obj->k;

232 
pObj
->
cÚfigg
.
n
 =…Obj->n;

233 
pObj
->
cÚfigg
.
´iv
 =…Obj;

234 
pObj
->
cÚfigg
.
flL’gth
 =…Obj->fillLength;

235 
pObj
->
cÚfigg
.
h—dFlL’gth
 =…Obj->headFillLength;

236 
pObj
->
cÚfigg
.
ŒªsfÜmFromRedun
 = 
RedunS”v”T¿nsfÜmFromRedun
;

237 
pObj
->
cÚfigg
.
ŒªsfÜmToRedun
 = 
RedunS”v”T¿nsfÜmToRedun
;

238 
pObj
->
cÚfigg
.
s£nd
 = 
RedunS”v”S’d
;

239 
pObj
->
cÚfigg
.
»Ëa£
 = 
RedunS”v”R–—£RedunBuf
;

240 
pObj
->
cÚfigg
.
g‘SeqId
 = 
RedunS”v”G‘SeqId
;

242 
»t
 = 
	`P»RedunCÚ‹xtIn™
(
pObj
->
´eRedunCÚ‹xt
, (*)&pObj->
cÚfigg
);

243 ià(
»t
) {

244 
	`´štf
 ("[% %d] P»RedunCÚ‹xtIn™ fau»\n", 
__func__
, 
__LINE__
);

245 
ERR3
;

248 
»t
 = 
	`RedunS”v”MemIn™
(
pObj
);

249 ià(
»t
) {

250 
ERR4
;

254 
ERR4
:

255 
	`P»RedunCÚ‹xtEx™
(
pObj
->
´eRedunCÚ‹xt
);

256 
ERR3
:

257 
	`P»RedunCÚ‹xtUnš¡ªû
(
pObj
->
´eRedunCÚ‹xt
);

258 
ERR2
:

259 
	`RedunCÚ‹xtEx™
(
pObj
->
»dunCÚ‹xt
);

260 
ERR1
:

261 
	`RedunCÚ‹xtUnš¡ªû
(
pObj
->
»dunCÚ‹xt
);

262 
ERR0
:

264 
	}
}

266 
	$RedunS”v”Ex™
(
RedunS”v”Obj
 *
pObj
) {

268 
	`RedunS”v”MemEx™
(
pObj
);

270 
	`RedunCÚ‹xtEx™
(
pObj
->
»dunCÚ‹xt
);

272 
	`RedunCÚ‹xtUnš¡ªû
(
pObj
->
»dunCÚ‹xt
);

274 
	`P»RedunCÚ‹xtEx™
(
pObj
->
´eRedunCÚ‹xt
);

276 
	`P»RedunCÚ‹xtUnš¡ªû
(
pObj
->
´eRedunCÚ‹xt
);

279 
	}
}

282 
	$RedunS”v”Run
(
RedunS”v”Obj
 *
pObj
, *
d©a
) {

283 
»t
 = -1;

284 
RedunBufLi¡
 
»dunBufLi¡
 = {.
numBufs
 = 0};

287 
»t
 = 
	`P»RedunCÚ‹xtProûssF¿me
(
pObj
->
´eRedunCÚ‹xt
, 
d©a
, &
»dunBufLi¡
);

288 ià(
»t
) {

289 
	`RedunS”v”AutoRecyşe
(
pObj
);

293 
	`RedunCÚ‹xtAddF¿meLi¡
(
pObj
->
»dunCÚ‹xt
, &
»dunBufLi¡
);

295 
	`RedunCÚ‹xtProûssF¿me
(
pObj
->
»dunCÚ‹xt
);

297 
	`RedunCÚ‹xtRe£t
(
pObj
->
»dunCÚ‹xt
);

299 
	`P»RedunCÚ‹xtProûssAá”
(
pObj
->
´eRedunCÚ‹xt
);

302 
	`RedunS”v”AutoRecyşe
(
pObj
);

305 
ERR0
:

307 
	}
}

309 
	$RedunS”v”Commªd
(
RedunS”v”Obj
 *
pObj
, 
cmd
, *
v®ue
) {

310  
	`P»RedunCÚ‹xtCommªd
(
pObj
->
´eRedunCÚ‹xt
, 
cmd
, 
v®ue
);

311 
	}
}

320 
	$RedunCl›ÁAutoRecyşe
(*
oObj
) {

321 
»t
 = 0;

322 
RedunBuf
 *
»dunBuf
 = 
NULL
;

323 
RedunCl›ÁObj
 *
pObj
 = (RedunCl›ÁObj *)
oObj
;

326 
»t
 = 
	`QueueG‘
(&
pObj
->
hndlRes
, (*)&
»dunBuf
, 
TIMEOUT_NONE
);

327 ià(
»t
) ;

329 
»dunBuf
->
»fId
--;

330 ià(
»dunBuf
->
»fId
 <= 0) {

331 
»dunBuf
->
»fId
 = 0;

333 
	`´štf
 ("% %d seqId:%d sei:%d d©a:%°»f:%d\n", 
__func__
, 
__LINE__
, 0, 
»dunBuf
->
£i
,„edunBuf,„edunBuf->
»fId
);

334 
	`QueuePut
((
QueHndl
 *)
»dunBuf
->
hªdË
, (ìedunBuf, 
TIMEOUT_NONE
);

336 
pObj
->
	`»Ëa£
ÕObj->
´iv
, 
»dunBuf
->priv);

341 
	}
}

343 *
	$RedunCl›ÁT¿nsfÜmToRedun
(*
oObj
, **
»dunBuff
,

344 *
d©a
, 
isSrc
) {

345 
»t
 = -1;

346 
RedunBuf
 *
»dunBuf
 = (RedunBuà*)(*((RedunBuà**)
»dunBuff
));

347 
RedunCl›ÁObj
 *
pObj
 = (RedunCl›ÁObj *)
oObj
;

349 ià(
pObj
->
ŒªsfÜmToRedun
) {

350 
»dunBuf
 = 
pObj
->
	`ŒªsfÜmToRedun
ÕObj->
´iv
, (**)&»dunBuf, 
d©a
, 
isSrc
);

351 ià(
»dunBuf
) {

352 
»dunBuf
->
hªdËRes
 = (*)&
pObj
->
hndlRes
;

356 
ERR0
:

357  
»dunBuf
;

358 
	}
}

360 *
	$RedunCl›ÁT¿nsfÜmFromRedun
(*
oObj
,

361 *
»dunBuff
, *
»·œ
, *
h—dR•aœ
, 
isSrc
) {

362 
»t
 = -1;

363 *
d©a
 = 
NULL
;

364 
RedunBuf
 *
»dunBuf
 = 
»dunBuff
;

365 
RedunCl›ÁObj
 *
pObj
 = (RedunCl›ÁObj *)
oObj
;

367 ià(
pObj
->
ŒªsfÜmFromRedun
) {

368 
d©a
 = 
pObj
->
	`ŒªsfÜmFromRedun
ÕObj->
´iv
, 
»dunBuf
, 
»·œ
, 
h—dR•aœ
, 
isSrc
);

371 
ERR0
:

372  
d©a
;

373 
	}
}

375 
	$RedunCl›ÁS’d
(*
oObj
, *
d©a
) {

376 
RedunCl›ÁObj
 *
pObj
 = (RedunCl›ÁObj *)
oObj
;

378 ià(
pObj
->
s£nd
) {

379  
pObj
->
	`s£nd
ÕObj->
´iv
, 
d©a
);

383 
	}
}

385 
	$RedunCl›ÁG‘SeqId
(*
oObj
, *
d©a
) {

386 
RedunCl›ÁObj
 *
pObj
 = (RedunCl›ÁObj *)
oObj
;

388 ià(
pObj
->
g‘SeqId
) {

389  
pObj
->
	`g‘SeqId
ÕObj->
´iv
, 
d©a
);

393 
	}
}

395 *
	$RedunCl›ÁReque¡R•aœMem
(*
d©a
,

396 **
·yLßd
, **
h—d
,

397 
size
, 
h—dSize
, 
esi
) {

436  
NULL
;

437 
	}
}

439 *
	$RedunCl›ÁReque¡SrcMem
(*
d©a
,

440 **
·yLßd
, **
h—d
,

441 
size
, 
h—dSize
, 
esi
) {

443 
»t
 = -1;

444 
RedunBuf
 *
»dunBuf
 = 
NULL
;

445 
RedunCl›ÁObj
 *
pObj
 = (RedunCl›ÁObj *)
d©a
;

447 ià(
NULL
 =ğ
·yLßd
 || NULL =ğ
h—d
) {

448 
	`´štf
 ("»que¡ size:%d h—dSize:%d\n", 
size
, 
h—dSize
);

449  
NULL
;

452 
»t
 = 
	`QueueG‘
(&
pObj
->
hndlE
, (*)&
»dunBuf
, 
TIMEOUT_NONE
);

453 ià(
»t
) {

454 
	`´štf
 ("% %d QueueG‘ fau»\n", 
__func__
, 
__LINE__
);

455  
NULL
;

458 *
pBuf
 = (*)
pObj
->
	`»que¡¤úew
ÕObj, 
size
, 
esi
);

459 ià(
pBuf
) {

460 
»dunBuf
 = 
	`RedunCl›ÁT¿nsfÜmToRedun
(
pObj
, (**)&»dunBuf, 
pBuf
, 1);

461 
	`mem£t
(
»dunBuf
->
d©aH—d
, 0x0, 
h—dSize
);

462 
»dunBuf
->
£i
 = 
esi
;

463 
»dunBuf
->
hªdËRes
 = &
pObj
->
hndlRes
;

464 *
·yLßd
 = 
»dunBuf
->
d©a
;

465 *
h—d
 = 
»dunBuf
->
d©aH—d
;

472 
	`P»RedunCÚ‹xtAddRecov”F¿me
(
pObj
->
´eRedunCÚ‹xt
, 
»dunBuf
);

474  (*)
»dunBuf
->
d©a
;

477 
	`QueuePut
(&
pObj
->
hndlE
, ()
»dunBuf
, 
TIMEOUT_NONE
);

480  
NULL
;

481 
	}
}

483 
	$RedunCl›ÁR–—£RedunBuf
(*
oObj
, *
d©a
) {

484 
RedunBuf
 *
»dunBuf
 = (RedunBuà*)
d©a
;

486 
	`RedunCl›ÁRecyËRedunBuf
(
»dunBuf
->
´iv
);

489 
	}
}

492 
	$RedunCl›ÁMemIn™
(
RedunCl›ÁObj
 *
pObj
) {

493 
»t
 = -1;

494 
šdex
 = 0;

496 
»t
 = 
	`QueueC»©e
(&
pObj
->
hndlE
, 1000);

497 ià(
»t
) {

498 
	`´štf
 ("[% %d]QueueC»©pObj->hndlE fau»\n", 
__func__
, 
__LINE__
);

499 
ERR0
;

502 
»t
 = 
	`QueueC»©e
(&
pObj
->
hndlRes
, 1000);

503 ià(
»t
) {

504 
	`´štf
 ("[% %d]QueueC»©pObj->hndlRe çu»\n", 
__func__
, 
__LINE__
);

505 
ERR1
;

508 
	`mem£t
(&
pObj
->
»dunBuf
[0], 0x0, (pObj->redunBuf));

510 
šdex
 = 0; index < 
REDUN_MAX_INPUT_NUM
; index++) {

511 
pObj
->
»dunBuf
[
šdex
].
hªdË
 = (*)&pObj->
hndlE
;

512 
»t
 = 
	`QueuePut
(&
pObj
->
hndlE
, ()&pObj->
»dunBuf
[
šdex
], 
TIMEOUT_NONE
);

513 ià(
»t
) {

514 
	`´štf
 ("[% %d] QueuePuˆhndlE index:%d fau»\n", 
__func__
, 
__LINE__
, 
šdex
);

519 
ERR1
:

520 
	`QueueD–‘e
(&
pObj
->
hndlE
);

521 
ERR0
:

523 
	}
}

525 
	$RedunCl›ÁMemEx™
(
RedunCl›ÁObj
 *
pObj
) {

526 
	`QueueD–‘e
(&
pObj
->
hndlE
);

527 
	`QueueD–‘e
(&
pObj
->
hndlRes
);

530 
	}
}

548 
	$RedunCl›ÁCommªd
(
RedunCl›ÁObj
 *
pObj
, 
cmd
, *
v®ue
) {

549  
	`P»RedunCÚ‹xtCommªd
(
pObj
->
´eRedunCÚ‹xt
, 
cmd
, 
v®ue
);

550 
	}
}

552 
	$RedunCl›ÁRecyËRedunBuf
(*
d©a
) {

553 
£rv”Cl›ÁBuf
 *
pBuf
 = (£rv”Cl›ÁBuà*)
d©a
;

555 
RedunBuf
 *
»dunBuf
 = (RedunBuà*)
pBuf
->
´iv
;

557  
	`QueuePut
((
QueHndl
 *)
»dunBuf
->
hªdËRes
, (ìedunBuf, 
TIMEOUT_NONE
);

558 
	}
}

561 
	$RedunCl›ÁRun
(
RedunCl›ÁObj
 *
pObj
, *
d©a
) {

562 
¡©us
 = -1;

563 
RedunBufLi¡
 
pD©aLi¡
 = {

564 .
numBufs
 = 0,

568 
¡©us
 = 
	`P»RedunCÚ‹xtProûssF¿me
(
pObj
->
´eRedunCÚ‹xt
, 
d©a
, &
pD©aLi¡
);

569 ià(0 !ğ
¡©us
) {

570 
	`RedunCl›ÁAutoRecyşe
(
pObj
);

575 
	`RedunCÚ‹xtAddF¿meLi¡
(
pObj
->
»dunCÚ‹xt
, &
pD©aLi¡
);

578 
	`RedunCÚ‹xtProûssF¿me
(
pObj
->
»dunCÚ‹xt
);

581 
	`RedunCÚ‹xtRe£t
(
pObj
->
»dunCÚ‹xt
);

584 
	`P»RedunCÚ‹xtProûssAá”
(
pObj
->
´eRedunCÚ‹xt
);

586 
	`RedunCl›ÁAutoRecyşe
(
pObj
);

589 
	}
}

592 
	$RedunCl›ÁIn™
(
RedunCl›ÁObj
 *
pObj
,

593 
k
, 
n
, 
flL’gth
, 
h—dFlL’gth
,

594 
codec_id
, *
´iv
,

595 
»que¡
 
»que¡¤úew
,

596 
»que¡
 
»que¡»·œÃw
,

597 
ŒªsfÜmto
 
toRedun
,

598 
ŒªsfÜmäom
 
äomRedun
,

599 
»Ëa£
 
¾s
,

600 
s£nd
 
£ndd
,

601 
g‘SeqId
 
g‘£qid
) {

602 
šdex
 = 0;

603 
»t
 = -1;

605 
	`mem£t
(
pObj
, 0x0, (*pObj));

607 
pObj
->
k
 = k;

608 
pObj
->
n
 =‚;

609 
pObj
->
´iv
 =…riv;

610 
pObj
->
codec_id
 = codec_id;

611 
pObj
->
flL’gth
 = fillLength;

612 
pObj
->
h—dFlL’gth
 = headFillLength;

613 
pObj
->
»que¡¤úew
 =„equestsrcnew;

614 
pObj
->
»que¡»·œÃw
 =„equestrepairnew;

615 
pObj
->
ŒªsfÜmToRedun
 = 
toRedun
;

616 
pObj
->
ŒªsfÜmFromRedun
 = 
äomRedun
;

617 
pObj
->
»Ëa£
 = 
¾s
;

618 
pObj
->
s£nd
 = 
£ndd
;

619 
pObj
->
g‘SeqId
 = 
g‘£qid
;

621 
pObj
->
»dunObj
 = 
	`RedunMªageG‘ByName
("OpenFec_Audio_Decode");

622 ià(
NULL
 =ğ
pObj
->
»dunObj
) {

623 
	`´štf
 ("[%s %d] RedunManageGetByName %s failure\n",

624 
__func__
, 
__LINE__
, "OpenFec_Audio_Decode");

625 
ERR0
;

628 
pObj
->
»dunCÚ‹xt
 = 
	`RedunCÚ‹xtIn¡ªû
ÕObj->
»dunObj
);

629 ià(
NULL
 =ğ
pObj
->
»dunCÚ‹xt
) {

630 
	`´štf
 ("[% %d] RedunCÚ‹xtIn¡ªû fau»\n", 
__func__
, 
__LINE__
);

631 
ERR0
;

634 
pObj
->
cÚfig
.
k
 =…Obj->k;

635 
pObj
->
cÚfig
.
n
 =…Obj->n;

636 
pObj
->
cÚfig
.
flL’gth
 =…Obj->fillLength;

637 
pObj
->
cÚfig
.
h—dFlL’gth
 =…Obj->headFillLength;

638 
pObj
->
cÚfig
.
codecId
 =…Obj->
codec_id
;

639 
pObj
->
cÚfig
.
»que¡¤úew
 = 
RedunCl›ÁReque¡SrcMem
;

641 
pObj
->
cÚfig
.
»que¡»·œÃw
 = 
NULL
;

642 
pObj
->
cÚfig
.
´iv
 =…Obj;

644 
»t
 = 
	`RedunCÚ‹xtIn™
(
pObj
->
»dunCÚ‹xt
, (*)&pObj->
cÚfig
);

645 ià(
»t
) {

646 
	`´štf
 ("[%s %d] RedunContextInit %s failure\n",

647 
__func__
, 
__LINE__
, "OpenFec_Audio_Decode");

648 
ERR1
;

651 
pObj
->
´eRedunObj
 = 
	`P»RedunMªageG‘ByName
("Pre_OpenFec_Audio_Decode");

652 ià(
NULL
 =ğ
pObj
->
´eRedunObj
) {

653 
	`´štf
 ("[%s %d] PreRedunManageGetByName %s failure\n",

654 
__func__
, 
__LINE__
, "PreRedunManageGetByName");

655 
ERR2
;

658 
pObj
->
´eRedunCÚ‹xt
 = 
	`P»RedunCÚ‹xtIn¡ªû
ÕObj->
´eRedunObj
);

659 ià(
NULL
 =ğ
pObj
->
´eRedunCÚ‹xt
) {

660 
	`´štf
 ("[% %d] P»RedunCÚ‹xtIn¡ªû fau»\n", 
__func__
, 
__LINE__
);

661 
ERR2
;

664 
pObj
->
cÚfigg
.
k
 =…Obj->k;

665 
pObj
->
cÚfigg
.
n
 =…Obj->n;

666 
pObj
->
cÚfigg
.
flL’gth
 =…Obj->fillLength;

667 
pObj
->
cÚfigg
.
h—dFlL’gth
 =…Obj->headFillLength;

668 
pObj
->
cÚfigg
.
´iv
 =…Obj;

669 
pObj
->
cÚfigg
.
ŒªsfÜmToRedun
 = 
RedunCl›ÁT¿nsfÜmToRedun
;

670 
pObj
->
cÚfigg
.
ŒªsfÜmFromRedun
 = 
RedunCl›ÁT¿nsfÜmFromRedun
;

671 
pObj
->
cÚfigg
.
s£nd
 = 
RedunCl›ÁS’d
;

672 
pObj
->
cÚfigg
.
»Ëa£
 = 
RedunCl›ÁR–—£RedunBuf
;

673 
pObj
->
cÚfigg
.
g‘SeqId
 = 
RedunCl›ÁG‘SeqId
;

674 
»t
 = 
	`P»RedunCÚ‹xtIn™
(
pObj
->
´eRedunCÚ‹xt
, (*)&pObj->
cÚfigg
);

675 ià(
»t
) {

676 
	`´štf
 ("[% %d] P»RedunCÚ‹xtIn™ fau»\n", 
__func__
, 
__LINE__
);

677 
ERR3
;

680 
»t
 = 
	`RedunCl›ÁMemIn™
(
pObj
);

681 ià(
»t
) {

682 
ERR4
;

686 
ERR4
:

687 
	`P»RedunCÚ‹xtEx™
(
pObj
->
´eRedunCÚ‹xt
);

688 
ERR3
:

689 
	`P»RedunCÚ‹xtUnš¡ªû
(
pObj
->
´eRedunCÚ‹xt
);

690 
ERR2
:

691 
	`RedunCÚ‹xtEx™
(
pObj
->
»dunCÚ‹xt
);

692 
ERR1
:

693 
	`RedunCÚ‹xtUnš¡ªû
(
pObj
->
»dunCÚ‹xt
);

694 
ERR0
:

696 
	}
}

698 
	$RedunCl›ÁEx™
(
RedunCl›ÁObj
 *
pObj
) {

700 
	`RedunCl›ÁMemEx™
(
pObj
);

702 
	`RedunCÚ‹xtEx™
(
pObj
->
»dunCÚ‹xt
);

704 
	`RedunCÚ‹xtUnš¡ªû
(
pObj
->
»dunCÚ‹xt
);

706 
	`P»RedunCÚ‹xtEx™
(
pObj
->
´eRedunCÚ‹xt
);

708 
	`P»RedunCÚ‹xtUnš¡ªû
(
pObj
->
´eRedunCÚ‹xt
);

711 
	}
}

	@mytest/redun_interface.h

1 #iâdeà
__OPENFEC_INTERFACE_H__


2 
	#__OPENFEC_INTERFACE_H__


	)

4 
	~"queue.h
"

5 
	~"»dun.h
"

6 
	~"»dun_cÚfig.h
"

7 
	~"´”edun.h
"

8 
	~"´”edun_cÚfig.h
"

11 *
	md©a
;

12 *
	m´iv
;

13 
	m£qId
;

14 } 
	t£rv”Cl›ÁBuf
;

16 *(*
	t»que¡
)(*, 
	tsize
, 
	tesi
);

17 *(*
	tŒªsfÜmto
)(*
	toObj
, **
	t»dunBuf
, *
	td©a
, 
	tisSrc
);

18 *(*
	tŒªsfÜmäom
)(*
	toObj
, *
	t»dunBuf
, *
	t»·œ
, *
	th—dR•aœ
, 
	tisSrc
);

19 (*
	t»Ëa£
)(*
	toObj
, *
	t»dunBuf
);

20 (*
	ts£nd
)(*, *);

21 (*
	tfl
)(*, *, *, *);

22 (*
	tg‘SeqId
)(*, *);

27 
k
;

28 
n
;

29 
flL’gth
;

30 
h—dFlL’gth
;

31 
of_codec_id_t
 
codec_id
;

33 
QueHndl
 
hndlF
;

34 
QueHndl
 
hndlE
;

35 
QueHndl
 
hndlRes
;

37 
RedunBuf
 
»dunBuf
[
REDUN_MAX_INPUT_NUM
];

39 
RedunCÚ‹xt
 *
»dunCÚ‹xt
;

40 
RedunMªageStu
 *
»dunObj
;

42 
RedunMªageEncP¬mas
 
cÚfig
;

44 
P»RedunCÚ‹xt
 *
´eRedunCÚ‹xt
;

45 
P»RedunMªageStu
 *
´eRedunObj
;

47 
P»RedunMªageEncP¬mas
 
cÚfigg
;

50 
h—dTmp
[
REDUN_MAX_INPUT_NUM
][
REDUN_MAX_HEAD_LENGTH
];

53 
RedunBuf
 *(*
»que¡
)(*
oObj
, 
size
, 
esi
);

55 *(*
ŒªsfÜmToRedun
)(*
oObj
, **
»dunBuf
, *
d©a
, 
isSrc
);

56 *(*
ŒªsfÜmFromRedun
)(*
oObj
, *
d©a
, *
»·œ
, *
h—dR•aœ
, 
isSrc
);

57 (*
s£nd
)(*
oObj
, *
d©a
);

58 (*
»Ëa£
)(*
oObj
, *
»dunBuf
);

59 (*
g‘SeqId
)(*, *);

61 *
´iv
;

62 } 
	tRedunS”v”Obj
;

66 
	`RedunS”v”In™
(
RedunS”v”Obj
 *
pObj
,

67 
k
, 
n
, 
flL’gth
,

68 
h—dFlL’gth
,

69 
codec_id
, *
´iv
,

70 
ŒªsfÜmto
 
toRedun
,

71 
ŒªsfÜmäom
 
äomRedun
,

72 
»Ëa£
 
¾s
,

73 
s£nd
 
£ndd
,

74 
g‘SeqId
 
g‘£qid
);

77 
	`RedunS”v”Ex™
(
RedunS”v”Obj
 *
pObj
);

80 
	`RedunS”v”Run
(
RedunS”v”Obj
 *
pObj
, *
d©a
);

83 
	`RedunS”v”RecyËRedunBuf
(*
d©a
);

85 
	`RedunS”v”Commªd
(
RedunS”v”Obj
 *
pObj
, 
cmd
, *
v®ue
);

90 
k
;

91 
n
;

92 
flL’gth
;

93 
h—dFlL’gth
;

94 
of_codec_id_t
 
codec_id
;

96 *
´iv
;

98 
RedunCÚ‹xt
 *
»dunCÚ‹xt
;

99 
RedunMªageStu
 *
»dunObj
;

101 
RedunMªageDecP¬mas
 
cÚfig
;

103 
P»RedunCÚ‹xt
 *
´eRedunCÚ‹xt
;

104 
P»RedunMªageStu
 *
´eRedunObj
;

106 
P»RedunMªageDecP¬mas
 
cÚfigg
;

112 *(*
»que¡¤úew
)(*
oObj
, 
size
, 
esi
);

113 *(*
»que¡»·œÃw
)(*
oObj
, 
size
, 
esi
);

114 *(*
ŒªsfÜmToRedun
)(*
oObj
, **
»dunBuf
, *
d©a
, 
isSrc
);

115 *(*
ŒªsfÜmFromRedun
)(*
oObj
, *
d©a
, *
»·œ
, *
h—dR•aœ
, 
isSrc
);

116 (*
»Ëa£
)(*
oObj
, *
»dunBuf
);

117 (*
s£nd
)(*, *);

118 (*
g‘SeqId
)(*, *);

120 
QueHndl
 
hndlRes
;

121 
QueHndl
 
hndlE
;

122 
RedunBuf
 
»dunBuf
[
REDUN_MAX_INPUT_NUM
];

124 } 
	tRedunCl›ÁObj
;

127 
	`RedunCl›ÁIn™
(
RedunCl›ÁObj
 *
pObj
,

128 
k
, 
n
, 
flL’gth
, 
h—dFlL’gth
,

129 
codec_id
, *
´iv
,

130 
»que¡
 
»que¡¤úew
,

131 
»que¡
 
»que¡»·œÃw
,

132 
ŒªsfÜmto
 
toRedun
,

133 
ŒªsfÜmäom
 
äomRedun
,

134 
»Ëa£
 
¾s
,

135 
s£nd
 
£ndd
,

136 
g‘SeqId
 
g‘£qid
);

139 
	`RedunCl›ÁEx™
(
RedunCl›ÁObj
 *
pObj
);

142 
	`RedunCl›ÁRun
(
RedunCl›ÁObj
 *
pObj
, *
d©a
);

145 
	`RedunCl›ÁRecyËRedunBuf
(*
d©a
);

147 
	`RedunCl›ÁCommªd
(
RedunCl›ÁObj
 *
pObj
, 
cmd
, *
v®ue
);

	@mytest/redun_openfec_aud.c

1 
	~<¡dio.h
>

2 
	~<¡ršg.h
>

3 
	~<¡dlib.h
>

4 
	~<»dun.h
>

5 
	~<»dun_cÚfig.h
>

6 
	#VERBOSITY
 1

	)

13 
	sRedunMªageDecPrivStu
 {

14 
	mk
;

15 
	mn
;

16 
	mflL’gth
;

17 
	mh—dFlL’gth
;

18 
of_codec_id_t
 
	mcodecId
;

20 
of_£ssiÚ_t
 *
	m£s
;

21 
of_·¿m‘”s_t
 *
	m·¿ms
;

22 *
	mmy_·¿ms
;

24 
	m»cvdNum
;

25 *
	m¤c_symbŞs_b
[
REDUN_MAX_INPUT_NUM
];

26 *
	m¤c_h—d_symbŞs_b
[
REDUN_MAX_INPUT_NUM
];

27 *
	m»cvd_symbŞs_b
[
REDUN_MAX_INPUT_NUM
];

28 *
	m»cvd_h—d_symbŞs_b
[
REDUN_MAX_INPUT_NUM
];

30 } 
	tRedunMªageDecPrivStu
;

33 
	$»dunO³nFecDecO³n
(
RedunCÚ‹xt
 *
oObj
, *
cÚfig
) {

34 
¡©us
 = -1;

35 
RedunMªageDecPrivStu
 *
pObj
 = (RedunMªageDecPrivStu *)
oObj
->
´iv
;

36 
RedunMªageDecP¬mas
 *
·¿ms
 = (RedunMªageDecP¬ma *)
cÚfig
;

38 
	`mem£t
(
pObj
, 0x0, (*pObj));

40 
pObj
->
»cvdNum
 = 0;

41 
pObj
->
k
 = 
·¿ms
->k;

42 
pObj
->
n
 = 
·¿ms
->n;

43 
pObj
->
flL’gth
 = 
·¿ms
->fillLength;

44 
pObj
->
h—dFlL’gth
ğ
·¿ms
->headFillLength;

45 
pObj
->
codecId
 = 
·¿ms
->codecId;

47 
pObj
->
codecId
) {

48 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

50 
pObj
->
my_·¿ms
 = (
of_rs_2_m_·¿m‘”s_t
 *è
	`m®loc
 ((of_rs_2_m_parameters_t ));

51 ià(
NULL
 !ğ
pObj
->
my_·¿ms
) {

52 ((
of_rs_2_m_·¿m‘”s_t
 *)(
pObj
->
my_·¿ms
))->
m
 =…Obj->
n
;

56 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

58 
pObj
->
my_·¿ms
 = (
of_rs_·¿m‘”s_t
 *è
	`m®loc
 ((of_rs_parameters_t));

62 
	`´štf
 ("codecId :%d inv®id\n", 
pObj
->
codecId
);

66 ià(
NULL
 =ğ
pObj
->
my_·¿ms
) {

67 
	`´štf
 ("m®loøcodeId:%d…Obj->my_·¿m çu»\n", 
pObj
->
codecId
);

68 
ERR0
;

71 
	`mem£t
(
pObj
->
my_·¿ms
, 0x0, (*pObj->my_params));

73 
pObj
->
·¿ms
 = (
of_·¿m‘”s_t
 *íObj->
my_·¿ms
;

74 
pObj
->
·¿ms
->
nb_sourû_symbŞs
 =…Obj->
k
;

75 
pObj
->
·¿ms
->
nb_»·œ_symbŞs
 =…Obj->
n
 -…Obj->
k
;

76 
pObj
->
·¿ms
->
’codšg_symbŞ_Ëngth
 =…Obj->
flL’gth
;

77 
pObj
->
·¿ms
->
’codšg_h—d_Ëngth
 =…Obj->
h—dFlL’gth
;

79 
¡©us
 = 
	`of_ü—‹_codec_š¡ªû
(&
pObj
->
£s
,…Obj->
codecId
, 
OF_DECODER
, 
VERBOSITY
);

80 ià(
OF_STATUS_OK
 !ğ
¡©us
) {

81 
	`´štf
 ("of_create_codec_instance failure\n");

82 
ERR1
;

85 
¡©us
 = 
	`of_£t_ãc_·¿m‘”s
(
pObj
->
£s
,…Obj->
·¿ms
);

86 ià(
OF_STATUS_OK
 !ğ
¡©us
) {

87 
	`´štf
 ("of_set_fec_parameters failure\n");

88 
ERR2
;

92 ià(
·¿ms
->
»que¡¤úew
 ||…¬ams->
»que¡»·œÃw
) {

93 
	`of_£t_ÿÎback_funùiÚs_Ãw
(
pObj
->
£s
,

94 
·¿ms
->
»que¡¤úew
,…¬ams->
»que¡»·œÃw
,…¬ams->
´iv
);

96 ià(
·¿ms
->
»que¡¤c
 ||…¬ams->
»que¡»·œ
) {

97 
	`of_£t_ÿÎback_funùiÚs
(
pObj
->
£s
,

98 
·¿ms
->
»que¡¤c
,…¬ams->
»que¡»·œ
,…¬ams->
´iv
);

101 
	`mem£t
(
pObj
->
¤c_symbŞs_b
, 0x0, (pObj->src_symbols_tab));

102 
	`mem£t
(
pObj
->
»cvd_symbŞs_b
, 0x0, (pObj->recvd_symbols_tab));

103 
	`mem£t
(
pObj
->
»cvd_h—d_symbŞs_b
, 0x0, (pObj->recvd_head_symbols_tab));

106 
ERR2
:

107 ià(
pObj
->
£s
è
	`of_»Ëa£_codec_š¡ªû
(pObj->ses);

108 
ERR1
:

109 ià(
pObj
->
my_·¿ms
è
	`ä“
(pObj->my_params);

110 
ERR0
:

112 
	}
}

114 
	$»dunO³nFecDecClo£
(
RedunCÚ‹xt
 *
oObj
) {

115 
RedunMªageDecPrivStu
 *
pObj
 = (RedunMªageDecPrivStu *)
oObj
->
´iv
;

117 ià(
pObj
->
my_·¿ms
è
	`ä“
(pObj->my_params);

118 ià(
pObj
->
£s
è
	`of_»Ëa£_codec_š¡ªû
(pObj->ses);

121 
	}
}

123 
	$»dunO³nFecDecRe£t
(
RedunCÚ‹xt
 *
oObj
) {

124 
šdex
 = 0;

125 
RedunMªageDecPrivStu
 *
pObj
 = (RedunMªageDecPrivStu *)
oObj
->
´iv
;

127 
pObj
->
»cvdNum
 = 0;

129 
šdex
 = 0; index < 
pObj
->
n
; index++) {

130 
pObj
->
»cvd_symbŞs_b
[
šdex
] = 
NULL
;

131 
pObj
->
»cvd_h—d_symbŞs_b
[
šdex
] = 
NULL
;

132 
pObj
->
¤c_symbŞs_b
[
šdex
] = 
NULL
;

135 ià(
pObj
->
£s
è
	`of_»£t_decodšg_¡©u
(pObj->ses);

138 
	}
}

140 
	$»dunO³nFecDecAdd
(
RedunCÚ‹xt
 *
oObj
, 
RedunBufLi¡
 *
pD©aLi¡
) {

141 
šdex
 = 0;

142 
RedunBuf
 *
pBuf
 = 
NULL
;

143 
RedunMªageDecPrivStu
 *
pObj
 = (RedunMªageDecPrivStu *)
oObj
->
´iv
;

145 
šdex
 = 0; index < 
pD©aLi¡
->
numBufs
; index++) {

146 
pBuf
 = 
pD©aLi¡
->
»dunBuf
[
šdex
];

147 ià(
pBuf
) {

149 ià(
pBuf
->
£i
 >ğ
pObj
->
n
) {

150 
	`´štf
 ("input data openfec sei:%d invalid, "

151 "¿ngtØ[0 - %d]\n", 
pBuf
->
£i
, 
pObj
->
n
);

152 
ERR0
;

155 ià(
pBuf
->
£i
 < 
pObj
->
k
) {

156 ià(
NULL
 =ğ
pBuf
->
d©a
) {

157 
	`´štf
 ("špuˆd©¨İ’ãød©a:0x%°šv®id\n", 
pBuf
->
d©a
);

158 
ERR0
;

162 ià(
NULL
 =ğ
pBuf
->
d©aR•aœ
) {

163 
	`´štf
 ("špuˆd©¨İ’ãød©aR•aœ:0x%°šv®id\n", 
pBuf
->
d©aR•aœ
);

164 
ERR0
;

168 
pObj
->
»cvdNum
++;

169 
pObj
->
»cvd_symbŞs_b
[
pBuf
->
£i
] =…Buf->£˜<…Obj->
k
 ?…Buf->
d©a
 :…Buf->
d©aR•aœ
;

170 
pObj
->
»cvd_h—d_symbŞs_b
[
pBuf
->
£i
] =…Buf->£˜<…Obj->
k
 ?…Buf->
d©aH—d
 :…Buf->
d©aH—dR•aœ
;

171 
	`´štf
 ("%s %d„edun sei:%d %s,„cvd:%d„ecvdSybTab:%p„ecvdHeadSybTab:%p \n",

172 
__func__
, 
__LINE__
,

173 
pBuf
->
£i
,…Buf->£˜>ğ
pObj
->
k
 ? "repair" : "src",

174 
pObj
->
»cvdNum
,…Obj->
»cvd_symbŞs_b
[
pBuf
->
£i
],

175 
pObj
->
»cvd_h—d_symbŞs_b
[
pBuf
->
£i
]);

180 
ERR0
:

182 
	}
}

233 
	$»dunO³nFecDecProûss
(
RedunCÚ‹xt
 *
oObj
) {

234 
šdex
 = 0;

235 
¡©us
 = -1;

236 
RedunMªageDecPrivStu
 *
pObj
 = (RedunMªageDecPrivStu *)
oObj
->
´iv
;

239 ià(
pObj
->
»cvdNum
 >ğpObj->
k
) {

240 
šdex
 = 0; index < 
pObj
->
n
; index++) {

241 ià(
pObj
->
»cvd_symbŞs_b
[
šdex
]) {

243 
¡©us
 = 
	`of_decode_w™h_Ãw_symbŞ
(
pObj
->
£s
,

244 
pObj
->
»cvd_symbŞs_b
[
šdex
],

245 
pObj
->
»cvd_h—d_symbŞs_b
[
šdex
],

246 
šdex
);

247 ià(
OF_STATUS_OK
 !ğ
¡©us
) {

248 
	`´štf
 ("of_decode_w™h_Ãw_symbŞ sei:%d fau»\n", 
šdex
);

254 
¡©us
 = 
	`of_is_decodšg_com¶‘e
(
pObj
->
£s
);

255 ià(
Œue
 !ğ
¡©us
) {

256 
	`´štf
 ("of_is_decoding_complete failure\n");

257 
ERR0
;

261 
¡©us
 = 
	`of_g‘_sourû_symbŞs_b_Ãw
(
pObj
->
£s
,

262 
pObj
->
¤c_symbŞs_b
,…Obj->
¤c_h—d_symbŞs_b
);

263 ià(
OF_STATUS_OK
 !ğ
¡©us
) {

264 
	`´štf
 ("of_get_source_symbols_tab_new failure\n");

265 
ERR0
;

269 
	`´štf
 ("špuˆ»cvdNum:%d mu¡ >ğpObj->k:%d\n", 
pObj
->
»cvdNum
,…Obj->
k
);

270 
ERR0
;

274 
ERR0
:

276 
	}
}

278 
	$»dunO³nFecDecCommªd
(
RedunCÚ‹xt
 *
oObj
, 
cmd
, *
v®ue
) {

279 
šdex
 = 0;

280 
¡©us
 = -1;

281 
RedunMªageDecPrivStu
 *
pObj
 = (RedunMªageDecPrivStu *)
oObj
->
´iv
;

283 
cmd
) {

284 
REDUN_COMMAND_ISSAVE_FILE
:

293 
	}
}

295 
RedunMªageStu
 
	g»dunO³nFecAudDec
 = {

296 .
Çme
 = "OpenFec_Audio_Decode",

297 .
	g´ivSize
 = (
RedunMªageDecPrivStu
),

298 .
	goİ’
 = 
»dunO³nFecDecO³n
,

299 .
	gcşo£
 = 
»dunO³nFecDecClo£
,

300 .
	g»£t
 = 
»dunO³nFecDecRe£t
,

301 .
	gadd
 = 
»dunO³nFecDecAdd
,

302 .
	g´oûss
 = 
»dunO³nFecDecProûss
,

303 .
	gcommªd
 = 
»dunO³nFecDecCommªd
,

309 
	sRedunMªageEncPrivStu
 {

310 
	mk
;

311 
	mn
;

312 
	mflL’gth
;

313 
	mh—dFlL’gth
;

314 
of_codec_id_t
 
	mcodecId
;

316 
of_£ssiÚ_t
 *
	m£s
;

317 
of_·¿m‘”s_t
 *
	m·¿ms
;

318 *
	mmy_·¿ms
;

320 
	m»cvdNum
;

322 *
	m’c_symbŞs_b
[
REDUN_MAX_INPUT_NUM
];

323 *
	m’c_h—d_symbŞs_b
[
REDUN_MAX_INPUT_NUM
];

324 } 
	tRedunMªageEncPrivStu
;

326 
	$»dunO³nFecEncO³n
(
RedunCÚ‹xt
 *
oObj
, *
cÚfig
) {

327 
¡©us
 = -1;

328 
RedunMªageEncPrivStu
 *
pObj
 = (RedunMªageEncPrivStu *)
oObj
->
´iv
;

329 
RedunMªageEncP¬mas
 *
·¿ms
 = (RedunMªageEncP¬ma *)
cÚfig
;

331 
	`mem£t
(
pObj
, 0x0, (*pObj));

333 
pObj
->
»cvdNum
 = 0;

334 
pObj
->
k
 = 
·¿ms
->k;

335 
pObj
->
n
 = 
·¿ms
->n;

336 
pObj
->
flL’gth
 = 
·¿ms
->fillLength;

337 
pObj
->
h—dFlL’gth
ğ
·¿ms
->headFillLength;

338 
pObj
->
codecId
 = 
·¿ms
->codecId;

340 
pObj
->
codecId
) {

341 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

343 
pObj
->
my_·¿ms
 = (
of_rs_2_m_·¿m‘”s_t
 *è
	`m®loc
 ((of_rs_2_m_parameters_t ));

344 ià(
NULL
 !ğ
pObj
->
my_·¿ms
) {

345 ((
of_rs_2_m_·¿m‘”s_t
 *)(
pObj
->
my_·¿ms
))->
m
 =…Obj->
n
;

349 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

351 
pObj
->
my_·¿ms
 = (
of_rs_·¿m‘”s_t
 *è
	`m®loc
 ((of_rs_parameters_t));

355 
	`´štf
 ("codecId :%d inv®id\n", 
pObj
->
codecId
);

359 ià(
NULL
 =ğ
pObj
->
my_·¿ms
) {

360 
	`´štf
 ("m®loøcodeId:%d…Obj->my_·¿m çu»\n", 
pObj
->
codecId
);

361 
ERR0
;

364 
	`mem£t
(
pObj
->
my_·¿ms
, 0x0, (*pObj->my_params));

366 
pObj
->
·¿ms
 = (
of_·¿m‘”s_t
 *íObj->
my_·¿ms
;

367 
pObj
->
·¿ms
->
nb_sourû_symbŞs
 =…Obj->
k
;

368 
pObj
->
·¿ms
->
nb_»·œ_symbŞs
 =…Obj->
n
 -…Obj->
k
;

369 
pObj
->
·¿ms
->
’codšg_symbŞ_Ëngth
 =…Obj->
flL’gth
;

370 
pObj
->
·¿ms
->
’codšg_h—d_Ëngth
 =…Obj->
h—dFlL’gth
;

372 
¡©us
 = 
	`of_ü—‹_codec_š¡ªû
(&
pObj
->
£s
,…Obj->
codecId
, 
OF_ENCODER
, 
VERBOSITY
);

373 ià(
OF_STATUS_OK
 !ğ
¡©us
) {

374 
	`´štf
 ("of_create_codec_instance failure\n");

375 
ERR1
;

378 
¡©us
 = 
	`of_£t_ãc_·¿m‘”s
(
pObj
->
£s
,…Obj->
·¿ms
);

379 ià(
OF_STATUS_OK
 !ğ
¡©us
) {

380 
	`´štf
 ("of_set_fec_parameters failure\n");

381 
ERR2
;

384 
	`mem£t
(
pObj
->
’c_symbŞs_b
, 0x0, (pObj->enc_symbols_tab));

385 
	`mem£t
(
pObj
->
’c_h—d_symbŞs_b
, 0x0, (pObj->enc_head_symbols_tab));

388 
ERR2
:

389 ià(
pObj
->
£s
è
	`of_»Ëa£_codec_š¡ªû
(pObj->ses);

390 
ERR1
:

391 ià(
pObj
->
my_·¿ms
è
	`ä“
(pObj->my_params);

392 
ERR0
:

394 
	}
}

396 
	$»dunO³nFecEncClo£
(
RedunCÚ‹xt
 *
oObj
) {

397 
RedunMªageEncPrivStu
 *
pObj
 = (RedunMªageEncPrivStu *)
oObj
->
´iv
;

399 ià(
pObj
->
my_·¿ms
è
	`ä“
(pObj->my_params);

400 ià(
pObj
->
£s
è
	`of_»Ëa£_codec_š¡ªû
(pObj->ses);

403 
	}
}

405 
	$»dunO³nFecEncRe£t
(
RedunCÚ‹xt
 *
oObj
) {

406 
šdex
 = 0;

407 
RedunMªageEncPrivStu
 *
pObj
 = (RedunMªageEncPrivStu *)
oObj
->
´iv
;

409 
pObj
->
»cvdNum
 = 0;

411 
šdex
 = 0; index < 
pObj
->
n
; index++) {

412 
pObj
->
’c_symbŞs_b
[
šdex
] = 
NULL
;

413 
pObj
->
’c_h—d_symbŞs_b
[
šdex
] = 
NULL
;

419 
	}
}

421 
	$»dunO³nFecEncAdd
(
RedunCÚ‹xt
 *
oObj
, 
RedunBufLi¡
 *
pD©aLi¡
) {

422 
šdex
 = 0;

423 
RedunBuf
 *
pBuf
 = 
NULL
;

424 
RedunMªageEncPrivStu
 *
pObj
 = (RedunMªageEncPrivStu *)
oObj
->
´iv
;

426 
šdex
 = 0; index < 
pD©aLi¡
->
numBufs
; index++) {

427 
pBuf
 = 
pD©aLi¡
->
»dunBuf
[
šdex
];

428 ià(
pBuf
) {

430 ià(
pBuf
->
£i
 >ğ
pObj
->
n
) {

431 
	`´štf
 ("input data openfec sei:%d invalid, "

432 "¿ngtØ[0 - %d]\n", 
pBuf
->
£i
, 
pObj
->
n
);

433 
ERR0
;

436 ià(
pBuf
->
£i
 < 
pObj
->
k
) {

437 ià(
NULL
 =ğ
pBuf
->
d©a
) {

438 
	`´štf
 ("špuˆd©¨İ’ãød©a:0x%°šv®id\n", 
pBuf
->
d©a
);

439 
ERR0
;

443 ià(
NULL
 =ğ
pBuf
->
d©aR•aœ
) {

444 
	`´štf
 ("špuˆd©¨İ’ãød©aR•aœ:0x%°šv®id\n", 
pBuf
->
d©aR•aœ
);

445 
ERR0
;

449 
pObj
->
»cvdNum
++;

450 
pObj
->
’c_symbŞs_b
[
pBuf
->
£i
] =…Buf->£˜<…Obj->
k
 ?…Buf->
d©a
 :…Buf->
d©aR•aœ
;

451 
pObj
->
’c_h—d_symbŞs_b
[
pBuf
->
£i
] =…Buf->£˜<…Obj->
k
 ?…Buf->
d©aH—d
 :…Buf->
d©aH—dR•aœ
;

452 
	`´štf
 ("%s %d„edun sei:%d %s,„cvd:%d\n",

453 
__func__
, 
__LINE__
,

454 
pBuf
->
£i
,…Buf->£˜>ğ
pObj
->
k
 ? "repair" : "src",

455 
pObj
->
»cvdNum
);

460 
ERR0
:

462 
	}
}

464 
	$»dunO³nFecEncProûss
(
RedunCÚ‹xt
 *
oObj
) {

465 
šdex
 = 0;

466 
¡©us
 = -1;

467 
RedunMªageEncPrivStu
 *
pObj
 = (RedunMªageEncPrivStu *)
oObj
->
´iv
;

470 ià(
pObj
->
»cvdNum
 =ğpObj->
n
) {

471 
šdex
 = 
pObj
->
k
; index <…Obj->
n
; index++) {

472 ià(
pObj
->
’c_symbŞs_b
[
šdex
]

473 && 
pObj
->
’c_h—d_symbŞs_b
[
šdex
]) {

475 
	`´štf
 ("flL’gth:%d h—dFlL’gth:%d\n", 
pObj
->
flL’gth
,…Obj->
h—dFlL’gth
);

476 
¡©us
 = 
	`of_bud_»·œ_symbŞ
(
pObj
->
£s
,

477 
pObj
->
’c_symbŞs_b
,

478 
pObj
->
’c_h—d_symbŞs_b
,

479 
šdex
,

480 
pObj
->
flL’gth
,

481 
pObj
->
h—dFlL’gth
);

482 ià(
OF_STATUS_OK
 !ğ
¡©us
) {

483 
	`´štf
 ("of_bud_»·œ_symbŞ sei:%d fau»\n", 
šdex
);

484 
ERR0
;

490 
	`´štf
 ("[%s %d]input„ecvdNum:%d must ==…Obj->n:%d\n",

491 
__func__
, 
__LINE__
, 
pObj
->
»cvdNum
,…Obj->
n
);

492 
ERR0
;

496 
ERR0
:

498 
	}
}

500 
	$»dunO³nFecEncCommªd
(
RedunCÚ‹xt
 *
oObj
, 
cmd
, *
v®ue
) {

501 
šdex
 = 0;

502 
¡©us
 = -1;

503 
RedunMªageEncPrivStu
 *
pObj
 = (RedunMªageEncPrivStu *)
oObj
->
´iv
;

505 
cmd
) {

506 
REDUN_COMMAND_ISSAVE_FILE
:

515 
	}
}

517 
RedunMªageStu
 
	g»dunO³nFecAudEnc
 = {

518 .
Çme
 = "OpenFec_Audio_Encode",

519 .
	g´ivSize
 = (
RedunMªageEncPrivStu
),

520 .
	goİ’
 = 
»dunO³nFecEncO³n
,

521 .
	gcşo£
 = 
»dunO³nFecEncClo£
,

522 .
	g»£t
 = 
»dunO³nFecEncRe£t
,

523 .
	gadd
 = 
»dunO³nFecEncAdd
,

524 .
	g´oûss
 = 
»dunO³nFecEncProûss
,

525 .
	gcommªd
 = 
»dunO³nFecEncCommªd
,

	@mytest/simple_server.c

1 
	#OF_USE_ENCODER


	)

3 
	~"»dun_š‹rçû.h
"

4 
	~<±h»ad.h
>

5 
	~<sigÇl.h
>

6 
	~<execšfo.h
>

7 
	~<sys/»sourû.h
>

8 
	~<sys/´ùl.h
>

9 
	~<sys/ty³s.h
>

10 
	~<sys/sysÿÎ.h
>

11 
	~<uni¡d.h
>

16 
	sgRH—d


18 
	mulSeq
:16;

19 
	mb™7PT
:7;

20 
	mb™1M
:1;

21 
	mb™4CC
:4;

22 
	mb™1X
:1;

23 
	mb™1P
:1;

24 
	mb™2V
:2;

25 
	mulTimeSmp
;

26 
	mulSSRC
;

27 } 
	tRH—dDef
;

29 
	s_gSrcRTPH—d
{

30 
	m£q
:16;

31 
	mm¬k
:1;

32 
	m·ylßdL’
:15;

33 
	mtime¡amp
;

34 } 
	tSrcRTPH—d
;

36 
	s_gRedunRTPH—d
{

37 
	m£i
;

38 
	mv”siÚ
;

39 
	mmould
;

40 
	mbmšus
;

41 
SrcRTPH—d
 
	m¤cH—d
;

42 } 
	tRedunRTPH—d
;

45 
	mk
;

46 
	mn
;

47 
	mflL’gth
;

48 
	mh—dFlL’gth
;

50 
	mtime¡amp
;

51 
	m£qId
;

53 
of_codec_id_t
 
	mcodec_id
;

54 
QueHndl
 
	mhndlE
;

55 
QueHndl
 
	mhndlF
;

57 
£rv”Cl›ÁBuf
 
	mbufãr
[30];

59 
QueHndl
 
	mş›ÁHndlE
;

60 
QueHndl
 
	mş›ÁHndlF
;

62 
£rv”Cl›ÁBuf
 
	mbufãrCl›Á
[30];

64 
FILE
 *
	måIn
;

65 
FILE
 *
	måOut
;

67 
RedunS”v”Obj
 
	m’code
;

68 
RedunCl›ÁObj
 
	mdecode
;

70 
±h»ad_mu‹x_t
 
	mmu‹x
;

71 } 
	t£rv”_ş›Á
;

73 
	g£ndNum
 = 0;

74 
	g»cvNum
 = 0;

75 
	#POSTION_BYTE
 ((
RH—dDef
))

	)

77 
	#_Crc32Ex´essiÚ
 0x04C10DB7

	)

78 
	#_Crc32TabËSize
 256

	)

79 *
O³nFecCl›ÁReque¡Src
(*
oObj
, 
size
, 
esi
);

80 *
myş›ÁŒªsfÜm
(*
oObj
, *
d©a
, *
»·œ
, *
h—dR•aœ
, 
isSrc
);

81 *
my£rv”ŒªsfÜm
(*
oObj
, *
d©a
, *
»·œ
, *
h—dR•aœ
, 
isSrc
);

82 *
my£rv”Œª¤omtÜedun
(*
oObj
, **
»dunBuf
, *
d©a
, 
isSrc
);

83 *
myş›ÁŒª¤omtÜedun
(*
oObj
, **
»dunBuf
, *
d©a
, 
isSrc
);

84 
my£nd
(*
oObj
, *
d©a
);

85 
my£r£nd
(*
oObj
, *
d©a
);

86 
my£rv”»Ëa£
(*
oObj
, *
d©a
);

87 
myş›Á»Ëa£
(*
oObj
, *
d©a
);

88 
my£rv”g‘£qid
(*
oObj
, *
d©a
);

89 
myş›Ág‘£qid
(*
oObj
, *
d©a
);

91 
šlše
 
	$_C»©eCrc32TabË
(
ücTabË
[], 
aPŞy
) {

93 
nD©a
;

94 
nAccum
;

95 
i
, 
j
;

97 
i
 = 0; i < 
_Crc32TabËSize
; i++ ) {

99 
nD©a
 = ()Ğ
i
 << 24 );

100 
nAccum
 = 0;

101 
j
 = 0; j < 8; j++ ) {

103 ià((
nD©a
 ^ 
nAccum
è& 0x80000000ènAccum = (nAccum << 1è^ 
aPŞy
;

104 
nAccum
 <<= 1;

105 
nD©a
 <<= 1;

108 
ücTabË
[
i
] = 
nAccum
;

114 
	}
}

116 
šlše
 
	$_G‘Crc32V®
(*
d©a
, 
d©aL’
) {

118 
ücTabË
[
_Crc32TabËSize
] = {

121 
nAccum
 = 0;

122 
i
 = 0;

123 
	`_C»©eCrc32TabË
(
ücTabË
, 
_Crc32Ex´essiÚ
);

124 
i
 = 0; i < 
d©aL’
; i++)

125 
nAccum
 = (nAccum << 8è^ 
ücTabË
[ÒAccum >> 24è^ *
d©a
++];

127  
nAccum
;

129 
	}
}

131 
	$Sim¶e_RedunS”v”BudRTP
(
£rv”_ş›Á
 *
oObj
, 
£rv”Cl›ÁBuf
 *
–em
) {

132 
»t
 = -1;

133 
RH—dDef
 *
¹pH—d
 = (RH—dDeà*)(
–em
->
d©a
);

134 *
·ylßd
 = (*)
–em
->
d©a
 + (
RH—dDef
);

137 
	`mem£t
(
¹pH—d
, 0x0, (
RH—dDef
));

138 
¹pH—d
->
ulSeq
 = 
oObj
->
£qId
++;

139 
¹pH—d
->
ulTimeSmp
 = 
oObj
->
time¡amp
;

140 
¹pH—d
->
b™1M
 = 1;

142 
oObj
->
time¡amp
 += 960;

145 
»t
 = 
	`ä—d
(
·ylßd
, 1, 
oObj
->
flL’gth
, oObj->
åIn
);

146 ià(
»t
 !ğ
oObj
->
flL’gth
) {

147 
	`f£ek
(
oObj
->
åIn
, 0, 
SEEK_SET
);

148 
»t
 = 
	`ä—d
(
·ylßd
, 1, 
oObj
->
flL’gth
, oObj->
åIn
);

151 
–em
->
£qId
 = 
¹pH—d
->
ulSeq
;

154 
	}
}

156 *
	$£rv”_ÿÎback
(*
¬gs
) {

157 
i
 = 0;

158 
»t
 = -1;

159 
æag
 = 0;

160 
£rv”_ş›Á
 *
š¡
 = (£rv”_ş›Á *)
¬gs
;

161 
RedunS”v”Obj
 *
pObj
 = (RedunS”v”Obj *)&
š¡
->
’code
;

162 
£rv”Cl›ÁBuf
 *
pkt_w™h_åi
 = 
NULL
;

163 
£qId3
 = 0;

167 
	`±h»ad_mu‹x_lock
(&
š¡
->
mu‹x
);

168 
i
 = 0; i < 
š¡
->
k
; i++) {

169 
	`´štf
 ("starting ...LLLLLLLLLLLLLLLLLLLLLL server queNum:F %d queu:E %d client F:%d E:%d\n",

170 
	`QueueG‘QueuedCouÁ
(&
š¡
->
hndlF
),

171 
	`QueueG‘QueuedCouÁ
(&
š¡
->
hndlE
),

172 
	`QueueG‘QueuedCouÁ
(&
š¡
->
ş›ÁHndlF
),

173 
	`QueueG‘QueuedCouÁ
(&
š¡
->
ş›ÁHndlE
));

174 
»t
 = 
	`QueueG‘
(&
š¡
->
hndlE
, (*)&
pkt_w™h_åi
, 
TIMEOUT_NONE
);

175 ià(!
»t
) {

176 
	`Sim¶e_RedunS”v”BudRTP
(
š¡
, 
pkt_w™h_åi
);

178 
»t
 = 
	`RedunS”v”Run
(
pObj
, 
pkt_w™h_åi
);

179 
	`´štf
 ("ending ...LLLLLLLLLLLLLLLLLLLLLL server queNum:F %d queu:E %d client F:%d E:%d\n",

180 
	`QueueG‘QueuedCouÁ
(&
š¡
->
hndlF
),

181 
	`QueueG‘QueuedCouÁ
(&
š¡
->
hndlE
),

182 
	`QueueG‘QueuedCouÁ
(&
š¡
->
ş›ÁHndlF
),

183 
	`QueueG‘QueuedCouÁ
(&
š¡
->
ş›ÁHndlE
));

186 
	`±h»ad_mu‹x_uÆock
(&
š¡
->
mu‹x
);

188 
	`u¦“p
(1000000);

191  
NULL
;

192 
	}
}

197 *
	$ş›Á_ÿÎback
(*
¬gs
) {

198 
i
 = 0;

199 
¡©us
 = -1;

200 
»t
 = -1;

201 
esi
 = -1;

202 
£rv”_ş›Á
 *
š¡
 = (£rv”_ş›Á *)
¬gs
;

203 
RedunCl›ÁObj
 *
pObj
 = (RedunCl›ÁObj *)&
š¡
->
decode
;

204 *
pkt_w™h_åi
 = 
NULL
;

205 
´oûssNum
 = 0;

206 
drİNum
 = 0;

207 
	`¤ªd
(
	`time
(
NULL
));

210 ià(
´oûssNum
 % 8 == 0) {

211 
drİNum
 = 
	`¿nd
() % 4;

212 
	`´štf
 ("---------------------->>>> cu¼’ˆgrou°´oûssNum:%d drİ %d\n", 
´oûssNum
, 
drİNum
);

213 
	`RedunCl›ÁCommªd
(
pObj
, 
PREREDUN_COMMAND_DROP_PACKAGE
, &
drİNum
);

215 
´oûssNum
++;

216 
	`±h»ad_mu‹x_lock
(&
š¡
->
mu‹x
);

217 
¡©us
 = 
	`QueueG‘
(&
š¡
->
ş›ÁHndlF
, (*)&
pkt_w™h_åi
, 
TIMEOUT_NONE
);

218 ià(!
¡©us
) {

219 
	`´štf
 ("starting CCCCCCCCCCCCCCCC clientF:%d E:%d\n",

220 
	`QueueG‘QueuedCouÁ
(&
š¡
->
ş›ÁHndlF
),

221 
	`QueueG‘QueuedCouÁ
(&
š¡
->
ş›ÁHndlE
));

222 
	`RedunCl›ÁRun
(
pObj
, 
pkt_w™h_åi
);

223 
	`´štf
 ("ending CCCCCCCCCCCCCCCC clientF:%d E:%d\n",

224 
	`QueueG‘QueuedCouÁ
(&
š¡
->
ş›ÁHndlF
),

225 
	`QueueG‘QueuedCouÁ
(&
š¡
->
ş›ÁHndlE
));

227 
	`±h»ad_mu‹x_uÆock
(&
š¡
->
mu‹x
);

228 
	`u¦“p
(20000);

231  
NULL
;

232 
	}
}

236 
št32_t
 
	$Sim¶e_RedunS”v”Obj
(
£rv”_ş›Á
 *
š¡
, cÚ¡ *
šput
) {

237 
esi
;

238 
esj
;

239 
i
;

240 
»t
 = -1;

241 
RedunS”v”Obj
 *
pObj
;

243 
pObj
 = &
š¡
->
’code
;

245 
š¡
->
åIn
 = 
	`fİ’
(
šput
, "r");

246 ià(
NULL
 =ğ
š¡
->
åIn
) {

247 
	`´štf
 ("fİ’ f:% çu»\n", 
šput
);

248 
ERR0
;

251 
»t
 = 
	`RedunS”v”In™
(
pObj
, 
š¡
->
k
, in¡->
n
, in¡->
flL’gth
, 24,

252 
š¡
->
codec_id
, (*)inst,

253 
my£rv”Œª¤omtÜedun
,

254 
my£rv”ŒªsfÜm
,

255 
my£rv”»Ëa£
,

256 
my£r£nd
,

257 
my£rv”g‘£qid
);

258 ià(
»t
) {

259 
	`´štf
 ("RedunServerInit failure?\n");

260 
ERR1
;

263 
±h»ad_t
 
tid
 = 0;

264 ià((
	`±h»ad_ü—‹
(&
tid
, 
NULL
, 
£rv”_ÿÎback
, (*)
š¡
)) != 0) {

265 
	`OF_PRINT_ERROR
(("ü—‹…thŒ—d fau»,‚=%u)\n", 
š¡
->
n
))

266 
»t
 = -1;

267 
ERR2
;

271 
ERR2
:

273 
ERR1
:

274 
	`fşo£
(
š¡
->
åIn
);

275 
ERR0
:

277 
	}
}

279 *
	$O³nFecCl›ÁReque¡Src
(*
oObj
, 
size
, 
esi
) {

280 
£rv”Cl›ÁBuf
 *
pkt_w™h_åi
 = 
NULL
;

281 
RedunBuf
 *
»dunBuf
 = 
NULL
;

282 
RedunCl›ÁObj
 *
decode
 = (RedunCl›ÁObj *)
oObj
;

283 
£rv”_ş›Á
 *
£rv”
 = (£rv”_ş›Á *)
decode
->
´iv
;

284 
RedunS”v”Obj
 *
’code
 = (RedunS”v”Obj *)&
£rv”
->encode;

286 
»t
 = 
	`QueueG‘
(&
£rv”
->
ş›ÁHndlE
, (*)&
pkt_w™h_åi
, 
TIMEOUT_NONE
);

287 ià(
»t
) {

288 
	`´štf
 ("QueueG‘ decode->hndlE fau»?ƒsi:%d\n", 
esi
);

289  
NULL
;

292 
	`mem£t
((*)
pkt_w™h_åi
->
d©a
, 0x0, 
decode
->
flL’gth
 * 3);

294  
pkt_w™h_åi
;

295 
	}
}

299 
št32_t
 
	$Sim¶e_RedunCl›ÁObj
(
£rv”_ş›Á
 *
š¡
, cÚ¡ *
ouut
) {

300 
esi
;

301 
i
;

302 
»t
 = -1;

303 
RedunCl›ÁObj
 *
pObj
;

305 
pObj
 = &
š¡
->
decode
;

307 
š¡
->
åOut
 = 
	`fİ’
(
ouut
, "w+");

308 ià(
NULL
 =ğ
š¡
->
åOut
) {

309 
	`´štf
 ("fİ’ f% çu»\n", 
ouut
);

310 
ERR0
;

313 
»t
 = 
	`RedunCl›ÁIn™
(
pObj
, 
š¡
->
k
, in¡->
n
, in¡->
flL’gth
, in¡->
h—dFlL’gth
,

314 
š¡
->
codec_id
, (*)inst,

315 
O³nFecCl›ÁReque¡Src
,

316 
O³nFecCl›ÁReque¡Src
,

317 
myş›ÁŒª¤omtÜedun
,

318 
myş›ÁŒªsfÜm
,

319 
myş›Á»Ëa£
,

320 
my£nd
,

321 
myş›Ág‘£qid
);

322 ià(
»t
) {

323 
	`´štf
 ("OpenFecClientInit failure?\n");

324 
ERR1
;

327 
±h»ad_t
 
tid
 = 0;

328 ià((
	`±h»ad_ü—‹
(&
tid
, 
NULL
, 
ş›Á_ÿÎback
, (*)
š¡
)) != 0) {

329 
	`´štf
 ("ü—‹…thŒ—d fau»,‚=%u)\n", 
š¡
->
n
);

330 
»t
 = -1;

331 
	`ex™
(-1);

335 
ERR1
:

336 
	`fşo£
(
š¡
->
åOut
);

337 
ERR0
:

339 
	}
}

341 
št32_t
 
	$Sim¶e_sys
(
£rv”_ş›Á
 *
š¡
, 
n
, 
k
,

342 
flL’gth
, 
h—dFlL’gth
, cÚ¡ *
šput
, cÚ¡ *
ouut
) {

343 
num
 = 30;

344 
šdex
 = 0;

346 
š¡
->
n
 =‚;

347 
š¡
->
k
 = k;

348 
š¡
->
flL’gth
 = fillLength;

349 
š¡
->
h—dFlL’gth
= headFillLength;

350 
š¡
->
codec_id
 = 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
;

353 ià(
	`QueueC»©e
(&
š¡
->
hndlE
, 1000)) {

354 
	`´štf
(".........s1111\n");

355 
	`ex™
(-1);

358 ià(
	`QueueC»©e
(&
š¡
->
hndlF
, 1000)) {

359 
	`´štf
(".........s2222\n");

360 
	`ex™
(-1);

363 ià(
	`QueueC»©e
(&
š¡
->
ş›ÁHndlE
, 1000)) {

364 
	`´štf
(".........s1111\n");

365 
	`ex™
(-1);

368 ià(
	`QueueC»©e
(&
š¡
->
ş›ÁHndlF
, 1000)) {

369 
	`´štf
(".........s2222\n");

370 
	`ex™
(-1);

373 
	`´štf
 ("ONE hndle:%p hndlF:%p clientHndlE:%p clientHndlF:%p\n",

374 &
š¡
->
hndlE
, &š¡->
hndlF
, &š¡->
ş›ÁHndlE
, &š¡->
ş›ÁHndlF
);

376 
šdex
 = 0; index < 
num
; index++) {

377 *
§m¶e_mem
 = (*)
	`m®loc
 (
flL’gth
 * 3);

378 
š¡
->
bufãr
[
šdex
].
d©a
 = 
§m¶e_mem
;

379 
š¡
->
bufãr
[
šdex
].
´iv
 = 
NULL
;

380 
	`´štf
 ("d©¨šdex:%d %p\n", 
šdex
, 
§m¶e_mem
);

381 
RH—dDef
 *
¹pH—d
 = (RH—dDeà*)
§m¶e_mem
;

382 
	`mem£t
(
¹pH—d
, 0x0, (
RH—dDef
));

383 
»t
 = 
	`QueuePut
(&
š¡
->
hndlE
, ()&š¡->
bufãr
[
šdex
], 
TIMEOUT_NONE
);

384 ià(
»t
) {

385 
	`´štf
 ("QueuePuˆçu» index:%d\n", 
šdex
);

389 
šdex
 = 0; index < 
num
; index++) {

390 *
§m¶e_mem
 = (*)
	`m®loc
 (
flL’gth
 * 3);

391 
š¡
->
bufãrCl›Á
[
šdex
].
d©a
 = 
§m¶e_mem
;

392 
š¡
->
bufãrCl›Á
[
šdex
].
´iv
 = 
NULL
;

393 
»t
 = 
	`QueuePut
(&
š¡
->
ş›ÁHndlE
, ()&š¡->
bufãrCl›Á
[
šdex
], 
TIMEOUT_NONE
);

394 ià(
»t
) {

395 
	`´štf
 ("QueuePuˆçu» index:%d\n", 
šdex
);

399 
	`±h»ad_mu‹x_š™
(&
š¡
->
mu‹x
, 
NULL
);

400 
	`´štf
 ("SLLLLLLLLLLLLLLLLLSSSSSSSSSSSSƒncoe:%p decode:%p\n",

401 &
š¡
->
’code
, &š¡->
decode
);

402 
	`´štf
 ("SLLLLLLLLLLLLLLLLLSSSSSSSSSSSSƒncoe:%p\n",

403 &
š¡
->
hndlF
);

406 
	`Sim¶e_RedunS”v”Obj
(
š¡
, 
šput
);

407 
	`Sim¶e_RedunCl›ÁObj
(
š¡
, 
ouut
);

410 
	}
}

412 
	$´štBackŒaû
(
no
) {

414 cÚ¡ *
”rmsg
 = "unknown";

415 
i
 = 0;

416 
size
 = 0;

417 **
¡räame
 = 
NULL
;

418 
	#btSIZE
 30

	)

419 * 
bufãr
[
btSIZE
] = {

423 
no
) {

425 
SIGSEGV
: 
”rmsg
 = "Segment Fault"; ;

426 
SIGHUP
: 
”rmsg
 = "SIGHUP"; ;

427 
SIGQUIT
: 
”rmsg
 = "SIGQUIT"; ;

428 
SIGSYS
: 
”rmsg
 = "SIGSYS"; ;

429 
SIGILL
: 
”rmsg
 = " Illegal code"; ;

430 
SIGABRT
: 
”rmsg
 = "sendƒxit command by‡bort"; ;

431 
SIGFPE
: 
”rmsg
 = " float‡bort"; ;

432 
SIGKILL
: 
”rmsg
 = "AEF Kill signal"; ;

433 
SIGALRM
: 
”rmsg
 = "alarm signal"; ;

434 
SIGTERM
: 
”rmsg
 = "Terminal signal"; ;

435 
SIGSTOP
: 
”rmsg
 = "DEFerminal…rocess"; ;

437 
	`´štf
("undefšsig‚Øğ%d ", 
no
);

441 
	`´štf
 ("MedŸ„eciv sigÇÈ% ,SigNO %d Loÿl_CPU_Id: %d ", 
”rmsg
, 
no
, 0);

443 
size
 = 
	`backŒaû
(
bufãr
, 
btSIZE
);

444 
¡räame
 = (**)
	`backŒaû_symbŞs
(
bufãr
, 
size
);

445 
	`´štf
 ("backŒaû sizğ%d , sŒäame: %p", 
size
, 
¡räame
);

446 
i
 = 0; i < 
size
; i++)

449 
	`´štf
 ("äam%d: %s\n", 
i
, 
¡räame
[i]);

452 ià(
¡räame
) {

454 
	`ä“
(
¡räame
);

455 
¡räame
 = 
NULL
;

458 
	}
}

460 
	$SigSegFauÉ
(
no
) {

462 cÚ¡ *
”rmsg
 = "unknown";

463 
Šame
[16] = {

466 
no
) {

468 
SIGSEGV
: 
”rmsg
 = "Segment Fault"; ;

469 
SIGFPE
: 
”rmsg
 = "div 0"; ;

474 
	`´štf
 ("SigNO %d % IÀTID %d ", 
no
, 
”rmsg
, ( )
	`sysÿÎ
(224));

475 ià(0 =ğ
	`´ùl
(
PR_GET_NAME
, 
Šame
))

476 
	`´štf
 ("TÇm% ", 
Šame
);

478 
	`´štBackŒaû
(
no
);

481 ià(
SIG_ERR
 =ğ
	`sigÇl
(
no
, 
NULL
)) {

483 
	`´štf
("sigÇÈ%d fa\r\n", 
no
);

486 
	}
}

488 *
	$myş›ÁŒªsfÜm
(*
oObj
, *
d©a
, *
»·œ
, *
h—dR•aœ
, 
isSrc
) {

489 
RedunBuf
 *
»dunBuf
 = (RedunBuà*)
d©a
;

491  
»dunBuf
->
´iv
;

492 
	}
}

494 *
	$my£rv”ŒªsfÜm
(*
oObj
, *
d©a
, *
»·œ
, *
h—dR•aœ
, 
isSrc
) {

496 
RedunBuf
 *
»dunBuf
 = (RedunBuà*)
d©a
;

497 
£rv”Cl›ÁBuf
 *
u£rBuf
 = (£rv”Cl›ÁBuà*)
»dunBuf
->
´iv
;

498 
£rv”_ş›Á
 *
pObj
 = (£rv”_ş›Á *)
oObj
;

499 
RH—dDef
 *
¹pH—d
 = (RH—dDeà*)
u£rBuf
->
d©a
;

500 *
·ylßd
 = (*)((*)
u£rBuf
->
d©a
 + (
RH—dDef
));

501 
RedunRTPH—d
 *
»dunRH—d
 = (RedunRTPH—d *)((*)
u£rBuf
->
d©a
 + (
RH—dDef
è+ 
pObj
->
flL’gth
);

502 *
»dunPaylßd
 = (*)((*)
u£rBuf
->
d©a
 + (
RH—dDef
è+ 
pObj
->
flL’gth
 + (
RedunRTPH—d
));

505 
	`memıy
(
»dunPaylßd
, 
»·œ
, 
pObj
->
flL’gth
);

508 
	`memıy
(
»dunRH—d
, 
h—dR•aœ
, (
RedunRTPH—d
));

510  
»dunBuf
->
´iv
;

511 
	}
}

513 *
	$my£rv”Œª¤omtÜedun
(*
oObj
, **
»dunBuf
, *
d©a
, 
isSrc
) {

514 
£rv”_ş›Á
 *
pObj
 = (£rv”_ş›Á *)
oObj
;

515 
RedunBuf
 *
šBuf
 = (RedunBuà*)(*((RedunBuà**)
»dunBuf
));

516 
£rv”Cl›ÁBuf
 *
pkt_w™h_åi
 = (£rv”Cl›ÁBuà*)
d©a
;

517 
RedunRTPH—d
 *
»dunRH—d
 = 
NULL
;

518 
RH—dDef
 *
¹pH—d
 = (RH—dDeà*)
pkt_w™h_åi
->
d©a
;

520 
pkt_w™h_åi
->
´iv
 = 
šBuf
;

521 
šBuf
->
´iv
 = (*)
d©a
;

522 
šBuf
->
d©a
 = (*)
pkt_w™h_åi
->d©¨+ 
POSTION_BYTE
;

523 
šBuf
->
d©aH—d
 = (*)
pkt_w™h_åi
->
d©a
 + 
POSTION_BYTE
 + (
RedunRTPH—d
è+ 
pObj
->
flL’gth
 * 2;

525 
šBuf
->
»fId
 = 0;

527 
»dunRH—d
 = (
RedunRTPH—d
 *)
šBuf
->
d©aH—d
;

529 ià(
isSrc
) {

530 
	`mem£t
(
»dunRH—d
, 0x0, (
RedunRTPH—d
));

531 
»dunRH—d
->
¤cH—d
.
£q
 = 
¹pH—d
->
ulSeq
;

532 
»dunRH—d
->
¤cH—d
.
time¡amp
 = 
¹pH—d
->
ulTimeSmp
;

533 
»dunRH—d
->
¤cH—d
.
m¬k
 = 
¹pH—d
->
b™1M
;

534 
»dunRH—d
->
¤cH—d
.
·ylßdL’
 = 1024;

537  
šBuf
;

538 
	}
}

540 *
	$myş›ÁŒª¤omtÜedun
(*
oObj
, **
»dunBuf
, *
d©a
, 
isSrc
) {

541 
£rv”_ş›Á
 *
pObj
 = (£rv”_ş›Á *)
oObj
;

542 
RedunBuf
 *
šBuf
 = (RedunBuà*)(*((RedunBuà**)
»dunBuf
));

543 
£rv”Cl›ÁBuf
 *
pkt_w™h_åi
 = (£rv”Cl›ÁBuà*)
d©a
;

544 
RedunRTPH—d
 *
»dunRH—d
 = 
NULL
;

545 
RH—dDef
 *
¹pH—d
 = (RH—dDeà*)
pkt_w™h_åi
->
d©a
;

548 
pkt_w™h_åi
->
´iv
 = 
šBuf
;

549 
šBuf
->
´iv
 = (*)
d©a
;

550 
šBuf
->
»fId
 = 0;

552 ià(
isSrc
) {

554 
šBuf
->
d©a
 = (*)
pkt_w™h_åi
->d©¨+ 
POSTION_BYTE
;

555 
šBuf
->
d©aH—d
 = (*)
pkt_w™h_åi
->
d©a
 + 
POSTION_BYTE
 + (
RedunRTPH—d
è+ 
pObj
->
flL’gth
 * 2;

559 
šBuf
->
d©aR•aœ
 = (*)
pkt_w™h_åi
->
d©a
 + 
POSTION_BYTE
 + (
RedunRTPH—d
è+ 
pObj
->
flL’gth
;

560 
šBuf
->
d©aH—dR•aœ
 = (*)
pkt_w™h_åi
->
d©a
 + 
POSTION_BYTE
 + 
pObj
->
flL’gth
;

564 ià(
isSrc
) {

565 
»dunRH—d
 = (
RedunRTPH—d
 *)
šBuf
->
d©aH—d
;

567 
	`mem£t
(
»dunRH—d
, 0x0, (
RedunRTPH—d
));

568 
»dunRH—d
->
¤cH—d
.
£q
 = 
¹pH—d
->
ulSeq
;

569 
»dunRH—d
->
¤cH—d
.
time¡amp
 = 
¹pH—d
->
ulTimeSmp
;

570 
»dunRH—d
->
¤cH—d
.
m¬k
 = 
¹pH—d
->
b™1M
;

571 
»dunRH—d
->
¤cH—d
.
·ylßdL’
 = 1024;

574  
šBuf
;

575 
	}
}

577 
	$myş›Á»Ëa£
(*
oObj
, *
d©a
) {

578 
£rv”_ş›Á
 *
pIn¡
 = (£rv”_ş›Á *)
oObj
;

580  
	`QueuePut
(&
pIn¡
->
ş›ÁHndlE
, ()
d©a
, 
TIMEOUT_NONE
);

581 
	}
}

583 
	$my£rv”»Ëa£
(*
oObj
, *
d©a
) {

584 
£rv”_ş›Á
 *
pIn¡
 = (£rv”_ş›Á *)
oObj
;

586  
	`QueuePut
(&
pIn¡
->
hndlE
, ()
d©a
, 
TIMEOUT_NONE
);

587 
	}
}

589 
	$my£rv”g‘£qid
(*
oObj
, *
d©a
) {

590 
£rv”Cl›ÁBuf
 *
u£rBuf
 = (£rv”Cl›ÁBuà*)
d©a
;

591 
RH—dDef
 *
¹pH—d
 = 
u£rBuf
->
d©a
;

593  
¹pH—d
->
ulSeq
;

594 
	}
}

596 
	$myş›Ág‘£qid
(*
oObj
, *
d©a
) {

597 
£rv”Cl›ÁBuf
 *
u£rBuf
 = (£rv”Cl›ÁBuà*)
d©a
;

598 
RH—dDef
 *
¹pH—d
 = 
u£rBuf
->
d©a
;

600  
¹pH—d
->
ulSeq
;

601 
	}
}

603 
	$my£nd
(*
oObj
, *
d©a
) {

610  
	`RedunCl›ÁRecyËRedunBuf
(
d©a
);

611 
	}
}

613 
	$my£r£nd
(*
oObj
, *
d©a
) {

614 
»t
 = -1;

615 
£rv”Cl›ÁBuf
 *
pkt_w™h_åi
 = 
d©a
;

616 
£rv”Cl›ÁBuf
 *
ş›ÁD©a
 = 
NULL
;

617 
£rv”_ş›Á
 *
pIn¡
 = (£rv”_ş›Á *)
oObj
;

618 
RedunS”v”Obj
 *
pObj
 = (RedunS”v”Obj *)&
pIn¡
->
decode
;

619 
RedunBuf
 *
¤c
 = (RedunBuà*)
pkt_w™h_åi
->
d©a
;

620 
RedunBuf
 *
de¡
 = 
NULL
;

622 
»t
 = 
	`QueueG‘
(&
pIn¡
->
ş›ÁHndlE
, (*)&
ş›ÁD©a
, 
TIMEOUT_NONE
);

623 ià(!
»t
) {

624 
de¡
 = (
RedunBuf
 *)
ş›ÁD©a
->
´iv
;

625 
	`memıy
(
ş›ÁD©a
->
d©a
, 
pkt_w™h_åi
->d©a, 
pIn¡
->
flL’gth
 * 3);

626 
ş›ÁD©a
->
£qId
 = 
pkt_w™h_åi
->seqId;

627 
RH—dDef
 *
¹pH—d
 = (RH—dDeà*)
ş›ÁD©a
->
d©a
;

628 
	`QueuePut
(&
pIn¡
->
ş›ÁHndlF
, ()
ş›ÁD©a
, 
TIMEOUT_NONE
);

630 
	`RedunS”v”RecyËRedunBuf
(
d©a
);

634 
	}
}

636 
	$maš
(
¬gs
, *
¬gv
[]) {

637 ià(
¬gs
 != 7) {

638 
	`´štf
 ("simple_server‚ k fillLength headFillLength inputFile outputFile\n");

641 (*
£gvHªdËr
)(
signo
);

643 
n
 = 
	`©oi
(
¬gv
[1]);

644 
k
 = 
	`©oi
(
¬gv
[2]);

645 
flL’gth
 = 
	`©oi
(
¬gv
[3]);

646 
h—dFlL’gth
 = 
	`©oi
(
¬gv
[4]);

647 cÚ¡ *
šput
 = 
¬gv
[5];

648 cÚ¡ *
ouut
 = 
¬gv
[6];

649 
£rv”_ş›Á
 
š¡
;

652 
£gvHªdËr
 = 
SigSegFauÉ
;

653 ià(
SIG_ERR
 =ğ
	`sigÇl
(
SIGSEGV
, 
£gvHªdËr
)) {

654 
	`´štf
("signal SIGSEGV fail\r\n");

655 
	`ex™
(-1);

659 
	`´štf
 ("n :%d k:%d fillLength:%d headFillLength:%d input:%s output:%s\n",

660 
n
, 
k
, 
flL’gth
, 
h—dFlL’gth
, 
šput
, 
ouut
);

662 
	`mem£t
(&
š¡
, 0x0, (inst));

663 
	`Sim¶e_sys
(&
š¡
, 
n
, 
k
, 
flL’gth
, 
h—dFlL’gth
, 
šput
, 
ouut
);

666 
	`¦“p
 (10);

670 
	}
}

	@src/lib_advanced/ldpc_from_file/of_codec_profile.h

36 
	#OF_USE_LDPC_FROM_FILE_CODEC


	)

38 
	#READ_MATRIX_FILE


	)

53 #ifdeà
ML_DECODING


54 
	#OF_LDPC_FROM_FILE_MAX_NB_SOURCE_SYMBOLS_DEFAULT
 40000

	)

55 
	#OF_LDPC_FROM_FILE_MAX_NB_ENCODING_SYMBOLS_DEFAULT
 40000

	)

57 
	#OF_LDPC_FROM_FILE_MAX_NB_SOURCE_SYMBOLS_DEFAULT
 100000

	)

58 
	#OF_LDPC_FROM_FILE_MAX_NB_ENCODING_SYMBOLS_DEFAULT
 100000

	)

	@src/lib_advanced/ldpc_from_file/of_ldpc_ff.h

34 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


36 #iâdeà
OF_LDPC_FF_H


37 
	#OF_LDPC_FF_H


	)

43 
	sof_ldpc_ff_cb


45 
of_ldpc_¡aœÿ£_cb
 
	mcb1
;

53 
boŞ
 
	mH2_is_id’t™y_w™h_low”_ŒŸngË
;

55 } 
	tof_ldpc_ff_cb_t
;

70 
of_¡©us_t
 
of_ldpc_ff_ü—‹_codec_š¡ªû
 (
of_ldpc_ff_cb_t
** 
of_cb
);

81 
of_¡©us_t
 
of_ldpc_ff_£t_ãc_·¿m‘”s
 (
of_ldpc_ff_cb_t
* 
cb
,

82 
of_ldpc_ff_·¿m‘”s_t
* 
·¿ms
);

84 #ifdeà
OF_USE_ENCODER


98 
of_¡©us_t
 
of_ldpc_ff_bud_»·œ_symbŞ
 (
of_ldpc_ff_cb_t
* 
ofcb
,

99 * 
’codšg_symbŞs_b
[],

100 
UINT32
 
esi_of_symbŞ_to_bud
);

103 #ifdeà
OF_USE_DECODER


113 
of_¡©us_t
 
of_ldpc_ff_£t_cÚŒŞ_·¿m‘”
 (
of_ldpc_ff_cb_t
* 
ofcb
,

114 
UINT32
 
ty³
,

115 * 
v®ue
,

116 
UINT32
 
Ëngth
);

129 
of_¡©us_t
 
of_ldpc_ff_g‘_cÚŒŞ_·¿m‘”
 (
of_ldpc_ff_cb_t
* 
ofcb
,

130 
UINT32
 
ty³
,

131 * 
v®ue
,

132 
UINT32
 
Ëngth
);

146 
of_¡©us_t
 
of_g‘_pck_m©rix_dim’siÚs_äom_fe
 (* 
m©rix_fe
,

147 
UINT32
 * 
n_rows
,

148 
UINT32
 * 
n_cŞs
);

	@src/lib_advanced/ldpc_from_file/of_ldpc_ff_api.c

34 
	~"of_ldpc_ff_šşudes.h
"

36 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


39 
of_¡©us_t
 
	$of_ldpc_ff_ü—‹_codec_š¡ªû
(
of_ldpc_ff_cb_t
** 
of_cb
)

41 
OF_ENTER_FUNCTION


42 
of_codec_ty³_t
 
codec_ty³
;

43 
of_ldpc_ff_cb_t
* 
ff_cb
 = (of_ldpc_ff_cb_t*è
	`of_»®loc
(*
of_cb
, (of_ldpc_ff_cb_t));

44 
of_ldpc_¡aœÿ£_cb_t
* 
cb
 = (of_ldpc_¡aœÿ£_cb_t*è
ff_cb
;

46 *
of_cb
=
ff_cb
;

49 
codec_ty³
 = 
cb
->codec_type;

50 
	`mem£t
(
cb
, 0, (*cb));

53 
cb
->
codec_id
 = 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
;

54 
cb
->
codec_ty³
 = codec_type;

55 
cb
->
max_nb_sourû_symbŞs
 = 
OF_LDPC_FROM_FILE_MAX_NB_SOURCE_SYMBOLS_DEFAULT
;

56 
cb
->
max_nb_’codšg_symbŞs
 = 
OF_LDPC_FROM_FILE_MAX_NB_ENCODING_SYMBOLS_DEFAULT
;

57 
OF_EXIT_FUNCTION


58  
OF_STATUS_OK
;

59 
	}
}

62 
of_¡©us_t
 
	$of_ldpc_ff_£t_ãc_·¿m‘”s
 (
of_ldpc_ff_cb_t
* 
cb
,

63 
of_ldpc_ff_·¿m‘”s_t
* 
·¿ms
)

65 
of_mod2’Œy
 *
e
;

66 
UINT32
 
row
;

67 
UINT32
 
£q
;

68 
UINT32
 
m©rix_nb_·r
;

69 
UINT32
 
m©rix_nb_¤c
;

70 
UINT32
 *
p_m©rix_nb_·r
;

71 
UINT32
 *
p_m©rix_nb_¤c
;

72 * 
m_m©rix_fe
;

73 
FILE
 *
pFe
;

75 
OF_ENTER_FUNCTION


76 
p_m©rix_nb_¤c
 = &
m©rix_nb_¤c
;

77 
p_m©rix_nb_·r
 = &
m©rix_nb_·r
;

78 #ifdeà
OF_DEBUG


79 
cb
->
cb1
.
¡©s_xÜ
 = 
	`of_ÿÎoc
(1, (
of_symbŞ_¡©s_İ_t
));

82 
m_m©rix_fe
ğ
·¿ms
->
pchk_fe
;

83 
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
 = (of_ldpc_¡aœÿ£_cb_t*è
cb
;

84 
pFe
 = 
	`fİ’
 (
m_m©rix_fe
,"r");

85 ià(
pFe
 =ğ
NULL
)

87 
	`OF_PRINT_ERROR
(("of_ldpc_ff_£t_ãc_·¿m‘” : ERROR, cªnÙ o³Àm©rix f%s",
m_m©rix_fe
))

88 
”rÜ
;

90 
ofcb
->
pchk_m©rix
 = 
	`of_mod2¥¬£_»ad_humª_»adabË
(
pFe
, 
p_m©rix_nb_¤c
, 
p_m©rix_nb_·r
);

91 
	`fşo£
(
pFe
);

93 ià(
ofcb
->
pchk_m©rix
 =ğ
NULL
)

95 
	`OF_PRINT_ERROR
(("of_ldpc_ff_set_fec_parameters : ERROR,…arity check matrix can't be created withhis…arameters.."))

96 
”rÜ
;

99 
cb
->
H2_is_id’t™y_w™h_low”_ŒŸngË
 = 
Œue
;

101 
	`of_mod2¥¬£_m©rix_¡©s
(
¡dout
, 
ofcb
->
pchk_m©rix
, *
p_m©rix_nb_¤c
, *
p_m©rix_nb_·r
);

104 ià((
ofcb
->
nb_sourû_symbŞs
 = 
m©rix_nb_¤c
 ) > ofcb->
max_nb_sourû_symbŞs
) {

105 
	`OF_PRINT_ERROR
(("of_ldpc_staircase_set_fec_parameters: ERROR, invalid‚b_source_symbols…arameter (got %d, maximum is %d)",

106 
ofcb
->
nb_sourû_symbŞs
, ofcb->
max_nb_sourû_symbŞs
));

107 
”rÜ
;

109 
ofcb
->
nb_»·œ_symbŞs
 =
m©rix_nb_·r
;

110 
ofcb
->
nb_tÙ®_symbŞs
 = 
m©rix_nb_¤c
 + 
m©rix_nb_·r
;

111 ià(
ofcb
->
nb_tÙ®_symbŞs
 > ofcb->
max_nb_’codšg_symbŞs
) {

112 
	`OF_PRINT_ERROR
(("of_ldpc_staircase_set_fec_parameters: ERROR, invalid‚umber ofƒncoding symbols (got %d, maximum is %d)",

113 
ofcb
->
nb_tÙ®_symbŞs
, ofcb->
max_nb_’codšg_symbŞs
));

114 
”rÜ
;

117 
·¿ms
->
nb_sourû_symbŞs
 = 
ofcb
->nb_source_symbols;

118 
·¿ms
->
nb_»·œ_symbŞs
 = 
ofcb
->nb_repair_symbols;

121 
ofcb
->
’codšg_symbŞ_Ëngth
 = 
·¿ms
->encoding_symbol_length;

123 
	`OF_TRACE_LVL
 (1, ("%s: k=%u,‚-k=%u,‚=%u, symbŞ_Ëngth=%u, PRNG s“d=%u, N1=%u\n", 
__FUNCTION__
,

124 
ofcb
->
nb_sourû_symbŞs
, ofcb->
nb_»·œ_symbŞs
, ofcb->
nb_tÙ®_symbŞs
,

125 
ofcb
->
’codšg_symbŞ_Ëngth
, ofcb->
´ng_£ed
, ofcb->
N1
))

126 #ifdeà
ML_DECODING


127 
ofcb
->
pchk_m©rix_sim¶if›d
 = 
NULL
;

129 ià((
ofcb
->
’codšg_symbŞs_b
 = (**è
	`of_ÿÎoc
(ofcb->
nb_tÙ®_symbŞs
, (*))è=ğ
NULL
) {

130 
no_mem
;

133 #ifdeà
OF_USE_DECODER


134 ià(
ofcb
->
codec_ty³
 & 
OF_DECODER
)

136 
ofcb
->
b_nb_unknown_symbŞs
 = (
UINT16
*è
	`of_ÿÎoc
(ofcb->
nb_»·œ_symbŞs
, (UINT16));

137 
ofcb
->
b_cÚ¡_‹rm_of_equ
 = (**è
	`of_ÿÎoc
(ofcb->
nb_»·œ_symbŞs
, (*));

138 
ofcb
->
b_nb_equ_fÜ_»·œ
 = (
UINT16
*è
	`of_ÿÎoc
(ofcb->
nb_»·œ_symbŞs
, (UINT16));

139 
ofcb
->
b_nb_’c_symbŞs_³r_equ
 = (
UINT16
*è
	`of_ÿÎoc
(ofcb->
nb_»·œ_symbŞs
, (UINT16));

140 ià(
ofcb
->
b_nb_unknown_symbŞs
 =ğ
NULL
 || ofcb->
b_cÚ¡_‹rm_of_equ
 == NULL ||

141 
ofcb
->
b_nb_equ_fÜ_»·œ
 =ğ
NULL
 || ofcb->
b_nb_’c_symbŞs_³r_equ
 == NULL) {

142 
no_mem
;

145 
row
 = 0;„ow < 
ofcb
->
nb_»·œ_symbŞs
;„ow++)

147 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
ofcb
->
pchk_m©rix
, 
row
);

148 !
	`of_mod2¥¬£_©_’d
 (
e
);

149 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e))

151 
ofcb
->
b_nb_’c_symbŞs_³r_equ
[
row
]++;

152 
ofcb
->
b_nb_unknown_symbŞs
[
row
]++;

155 
£q
 = 
ofcb
->
nb_sourû_symbŞs
; seq < (ofcb->
nb_tÙ®_symbŞs
); seq++)

157 
e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
ofcb
->
pchk_m©rix
, 
	`of_g‘_symbŞ_cŞ
 ((
of_cb_t
*)ofcb, 
£q
));

158 !
	`of_mod2¥¬£_©_’d
 (
e
);

159 
e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e))

161 
ofcb
->
b_nb_equ_fÜ_»·œ
[
£q
 - ofcb->
nb_sourû_symbŞs
]++;

166 
ofcb
->
nb_sourû_symbŞ_»ady
 = 0;

167 
ofcb
->
nb_»·œ_symbŞ_»ady
 = 0;

169 #ifdeà
ML_DECODING


170 
ofcb
->
šdex_rows
 = 
NULL
;

171 
ofcb
->
šdex_cŞs
 = 
NULL
;

172 
ofcb
->
»maš_cŞs
 = 0;

173 
ofcb
->
»maš_rows
 = 0;

174 
ofcb
->
pchk_m©rix_sim¶if›d
 = 
NULL
;

175 
ofcb
->
Üigš®_pchkM©rix
 = 
NULL
;

176 
ofcb
->
pchk_m©rix_gauss
 = 
NULL
;

178 
ofcb
->
dec_¡•
 = 0;

179 
ofcb
->
th»shŞd_sim¶ifiÿtiÚ
 = 0;

182 
OF_EXIT_FUNCTION


183  
OF_STATUS_OK
;

184 
no_mem
:

185 
	`OF_PRINT_ERROR
(("out of memory"));

186 
”rÜ
:

187 
OF_EXIT_FUNCTION


188  
OF_STATUS_FATAL_ERROR
;

189 
	}
}

192 
of_¡©us_t
 
	$of_ldpc_ff_bud_»·œ_symbŞ
 (
of_ldpc_ff_cb_t
* 
ofcb
,

193 * 
’codšg_symbŞs_b
[],

194 
UINT32
 
esi_of_symbŞ_to_bud
)

196 ià(
ofcb
->
H2_is_id’t™y_w™h_low”_ŒŸngË
)

199  
	`of_ldpc_¡aœÿ£_bud_»·œ_symbŞ
((
of_ldpc_¡aœÿ£_cb_t
*)
ofcb
, 
’codšg_symbŞs_b
, 
esi_of_symbŞ_to_bud
);

204 
OF_EXIT_FUNCTION


205  
OF_STATUS_ERROR
;

207 
	}
}

210 
of_¡©us_t
 
	$of_ldpc_ff_£t_cÚŒŞ_·¿m‘”
 (
of_ldpc_ff_cb_t
* 
ofcb
,

211 
UINT32
 
ty³
,

212 * 
v®ue
,

213 
UINT32
 
Ëngth
)

215 
	`OF_PRINT_ERROR
(("of_ldpc_ff_set_control_parameter: ERROR,‚ot implemented...\n"))

216  
OF_STATUS_ERROR
;

217 
	}
}

220 
of_¡©us_t
 
	$of_ldpc_ff_g‘_cÚŒŞ_·¿m‘”
 (
of_ldpc_ff_cb_t
* 
ofcb
,

221 
UINT32
 
ty³
,

222 * 
v®ue
,

223 
UINT32
 
Ëngth
)

225 
of_ldpc_¡aœÿ£_cb_t
 *
ofcb_¡aœÿ£
;

227 
OF_ENTER_FUNCTION


228 
ofcb_¡aœÿ£
 = (
of_ldpc_¡aœÿ£_cb_t
*)
ofcb
;

229 
ty³
) {

230 
OF_CTRL_GET_MAX_K
:

231 ià(
v®ue
 =ğ
NULL
 || 
Ëngth
 !ğ(
UINT32
)) {

232 
	`OF_PRINT_ERROR
(("%s: OF_CTRL_GET_MAX_K ERROR:‚ull value or bad†ength (got %d,ƒxpected %ld)\n",

233 
__FUNCTION__
, 
Ëngth
, (
UINT32
)))

234 
”rÜ
;

236 *(
UINT32
*)
v®ue
 = 
ofcb_¡aœÿ£
->
max_nb_sourû_symbŞs
;

237 
	`OF_TRACE_LVL
(1, ("%s: OF_CTRL_GET_MAX_K (%d)\n", 
__FUNCTION__
, *(
UINT32
*)
v®ue
))

240 
OF_CTRL_GET_MAX_N
:

241 ià(
v®ue
 =ğ
NULL
 || 
Ëngth
 !ğ(
UINT32
)) {

242 
	`OF_PRINT_ERROR
(("%s: OF_CTRL_GET_MAX_N ERROR:‚ull value or bad†ength (got %d,ƒxpected %ld)\n",

243 
__FUNCTION__
, 
Ëngth
, (
UINT32
)))

244 
”rÜ
;

246 *(
UINT32
*)
v®ue
 = 
ofcb_¡aœÿ£
->
max_nb_’codšg_symbŞs
;

247 
	`OF_TRACE_LVL
(1, ("%s: OF_CTRL_GET_MAX_N (%d)\n", 
__FUNCTION__
, *(
UINT32
*)
v®ue
))

251 
	`OF_PRINT_ERROR
(("%s: unknowÀty³ (%d)\n", 
__FUNCTION__
, 
ty³
))

252 
”rÜ
;

254 
OF_EXIT_FUNCTION


255  
OF_STATUS_OK
;

257 
”rÜ
:

258 
OF_EXIT_FUNCTION


259  
OF_STATUS_ERROR
;

260 
	}
}

263 
of_¡©us_t
 
	$of_g‘_pck_m©rix_dim’siÚs_äom_fe
(* 
m©rix_fe
,
UINT32
 * 
n_rows
, UINT32 *
n_cŞs
){

265 
FILE
 * 
f
;

266 * 
pch
;

267 
lše
[1024];

269 
f
 = 
	`fİ’
 (
m©rix_fe
,"r");

270 ià(
f
 =ğ
NULL
) {

271 
	`OF_PRINT_ERROR
(("CªnÙ o³Àf%s\n",
m©rix_fe
))

272 
”rÜ
;

275 ià(
	`fg‘s
 (
lše
, †še, 
f
è!ğ
NULL
)

278 
pch
 = 
	`¡¹ok
 (
lše
, " ");

279 *
n_rows
 = 
	`©oi
 (
pch
);

283 ià(
	`fg‘s
 (
lše
, †še, 
f
è!ğ
NULL
)

286 
pch
 = 
	`¡¹ok
 (
lše
, " ");

287 *
n_cŞs
 = 
	`©oi
 (
pch
);

290 
	`fşo£
(
f
);

291 
OF_EXIT_FUNCTION


292  
OF_STATUS_OK
;

294 
”rÜ
:

295 
OF_EXIT_FUNCTION


296  
OF_STATUS_ERROR
;

298 
	}
}

	@src/lib_advanced/ldpc_from_file/of_ldpc_ff_api.h

33 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


35 #iâdeà
OF_CODEC_STABLE_LDPC_FF_API


36 
	#OF_CODEC_STABLE_LDPC_FF_API


	)

38 
	~"../../lib_commÚ/of_ty³s.h
"

48 
	sof_ldpc_ff_·¿m‘”s


50 
UINT32
 
	mnb_sourû_symbŞs
;

51 
UINT32
 
	mnb_»·œ_symbŞs
;

52 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

53 
UINT32
 
	m’codšg_h—d_Ëngth
;

58 *
	mpchk_fe
;

59 } 
	tof_ldpc_ff_·¿m‘”s_t
;

	@src/lib_advanced/ldpc_from_file/of_ldpc_ff_includes.h

34 #iâdeà
OF_LDPC_FF_INCLUDES_H


35 
	#OF_LDPC_FF_INCLUDES_H


	)

37 
	~<¡dio.h
>

38 
	~<¡ršg.h
>

39 
	~<m©h.h
>

40 
	~<sys/time.h
>

42 
	~"../../lib_commÚ/of_İ’ãc_­i.h
"

44 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


46 
	~"../../lib_commÚ/lš—r_bš¬y_codes_uts/of_lš—r_bš¬y_code.h
"

48 
	~"../../lib_¡abË/ldpc_¡aœÿ£/of_ldpc_¡aœÿ£_­i.h
"

49 
	~"../../lib_¡abË/ldpc_¡aœÿ£/of_ldpc_¡aœÿ£.h
"

51 
	~"of_ldpc_ff_­i.h
"

52 
	~"of_ldpc_ff.h
"

	@src/lib_advanced/ldpc_from_file/of_ldpc_includes.h

39 #iâdeà
OF_LDPC_INCLUDES


40 
	#OF_LDPC_INCLUDES


	)

42 
	~<¡dio.h
>

44 
	~<m©h.h
>

45 
	~<sys/time.h
>

47 
	~"../../lib_commÚ/of_ty³s.h
"

48 
	~"../../lib_commÚ/of_mem.h
"

49 
	~"../../lib_commÚ/of_debug.h
"

50 
	~"../../lib_commÚ/of_İ’ãc_­i.h
"

51 
	~"../../lib_commÚ/of_cb.h
"

53 
	~"of_¿nd.h
"

54 
	~"of_toŞs.h
"

55 
	~"of_hammšg_weight.h
"

56 
	~"of_ldpc_¡aœÿ£.h
"

57 
	~"of_m©rix_¥¬£.h
"

58 
	~"of_m©rix_d’£.h
"

59 
	~"of_m©rix_cÚv”t.h
"

60 
	~"of_ldpc_¡aœÿ£_­i.h
"

61 
	~"of_symbŞ.h
"

62 
	~"of_ü—‹_pchk.h
"

63 
	~"of_ml_decodšg.h
"

64 
	~"of_ml_toŞ.h
"

65 
	~"of_ml_toŞ_2.h
"

	@src/lib_common/linear_binary_codes_utils/binary_matrix/of_hamming_weight.c

34 
	~"../of_lš—r_bš¬y_code.h
"

37 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


39 cÚ¡ 
UINT64
 
	gof_m1
 = 0x5555555555555555LL;

40 cÚ¡ 
UINT64
 
	gof_m2
 = 0x3333333333333333LL;

41 cÚ¡ 
UINT64
 
	gof_m4
 = 0x0f0f0f0f0f0f0f0fLL;

42 cÚ¡ 
UINT64
 
	gof_m8
 = 0x00ff00ff00ff00ffLL;

43 cÚ¡ 
UINT64
 
	gof_m16
 = 0x0000ffff0000ffffLL;

44 cÚ¡ 
UINT64
 
	gof_m32
 = 0x00000000ffffffffLL;

45 cÚ¡ 
UINT64
 
	gof_hff
 = 0xffffffffffffffffLL;

46 cÚ¡ 
UINT64
 
	gof_h01
 = 0x0101010101010101LL;

49 
UINT8
 
	gof_hw8bË
[256] = {0, 1, 1, 2, 1, 2, 2, 3, 1, 2, 2, 3, 2, 3, 3, 4, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 1, 2, 2, 3, 2, 3, 3, 4, 2, 3, 3, 4, 3, 4, 4, 5, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 2, 3, 3, 4, 3, 4, 4, 5, 3, 4, 4, 5, 4, 5, 5, 6, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 3, 4, 4, 5, 4, 5, 5, 6, 4, 5, 5, 6, 5, 6, 6, 7, 4, 5, 5, 6, 5, 6, 6, 7, 5, 6, 6, 7, 6, 7, 7, 8};

55 
INT32
 
	$of_pİcouÁ_3
 (
UINT64
 
x
)

57 
x
 -ğ(x >> 1è& 
of_m1
;

58 
x
 = (x & 
of_m2
) + ( (x >> 2) & of_m2);

59 
x
 = (x + (x >> 4)è& 
of_m4
;

60  (
x
 * 
of_h01
) >> 56;

61 
	}
}

64 
UINT32
 
	$of_hweight32
 (
UINT32
 
w
)

66 
UINT32
 
»s
 = 
w
 - ( (w >> 1) & 0x55555555);

67 
»s
 = (res & 0x33333333) + ( (res >> 2) & 0x33333333);

68 
»s
 = (res + (res >> 4)) & 0x0F0F0F0F;

69 
»s
 =„es + (res >> 8);

70  (
»s
 + (res >> 16)) & 0x000000FF;

71 
	}
}

74 
UINT8
 
	$of_hweight8_bË
 (
UINT8
 
w
)

82  
of_hw8bË
[
w
];

83 
	}
}

86 
UINT32
 
	$of_hweight32_bË
 (
UINT32
 
w
)

88 
UINT32
 
»s
 = 0;

89 
UINT8
 *
w8
 = (UINT8*è(&
w
);

94 
»s
 = 
of_hw8bË
[
w8
[0]] + of_hw8table[w8[1]] + of_hw8table[w8[2]] + of_hw8table[w8[3]];

95  
»s
;

96 
	}
}

99 
UINT32
 
	$of_hweight32_Çive
 (
UINT32
 
w
)

101 
INT32
 
j
;

102 
UINT32
 
»s
 = 0;

103 
UINT32
 
x
 = 
w
;

104 
j
 = 0; j <  (
UINT32
); j++)

106 
»s
 +ğ
x
 & 1;

107 
x
 = x >> 1;

109  
»s
;

110 
	}
}

114 
UINT32
 
	$of_hweight_¬¿y
 (
UINT32
 *
¬¿y
, 
INT32
 
size
)

116 
UINT32
 
weight
 = 0;

117 
UINT32
 
i
;

118 
UINT32
 
¬¿y_size_32
, 
¬¿y_size_32_»m
;

119 
UINT32
 *
v32
;

121 
¬¿y_size_32
 = 
size
 >> 5;

122 
¬¿y_size_32_»m
 = 
size
 % 32;

123 ià(
¬¿y_size_32_»m
 > 0)

125 
¬¿y_size_32
++;

128 #ià
	`defšed
 (
__LP64__
è|| (
__WORDSIZE
 == 64)

129 
UINT32
 
¬¿y_size64
;

130 
UINT32
 
¬¿y_size64»m
;

131 
¬¿y_size64
 = 
¬¿y_size_32
 >> 1;

132 
¬¿y_size64»m
 = 
¬¿y_size_32
 % 2;

136 
UINT64
 *
v64
 = (UINT64*è
¬¿y
;

137 
i
 = 
¬¿y_size64
; i > 0; i--)

139 
weight
 +ğ
	`of_pİcouÁ_3
 (*
v64
);

140 
v64
++;

143 ià(
¬¿y_size64»m
 > 0)

145 
v32
 = (
UINT32
*è
v64
;

146 
weight
 +ğ
	`of_hweight32_bË
 (*
v32
);

147 
v32
++;

150 
v32
 = (
UINT32
*è
¬¿y
;

151 
i
 = 
¬¿y_size_32
;i > 0;i--)

153 
weight
 +ğ
	`of_hweight32_bË
 (*
v32
);

154 
v32
++;

157  
weight
;

158 
	}
}

	@src/lib_common/linear_binary_codes_utils/binary_matrix/of_hamming_weight.h

35 #iâdeà
HAMMING_WEIGHT_H


36 
	#HAMMING_WEIGHT_H


	)

39 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


51 
INT32
 
of_pİcouÁ_3
 (
UINT64
 
x
);

61 
UINT32
 
of_hweight32
 (UINT32 
w
);

71 
UINT32
 
of_hweight32_Çive
 (UINT32 
w
);

81 
UINT32
 
of_hweight32_bË
 (UINT32 
w
);

92 
UINT32
 
of_hweight_¬¿y
 (UINT32 *
¬¿y
, 
INT32
 
size
);

	@src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_convert.c

34 
	~"../of_lš—r_bš¬y_code.h
"

37 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


41 
	$of_mod2¥¬£_to_d’£
 (
of_mod2¥¬£
 *
m
,

42 
of_mod2d’£
 *
r
)

44 
OF_ENTER_FUNCTION


45 
of_mod2’Œy
 *
e
;

46 
UINT32
 
i
;

48 ià(
	`of_mod2¥¬£_rows
 (
m
è> 
	`of_mod2d’£_rows
 (
r
)

49 || 
	`of_mod2¥¬£_cŞs
 (
m
è> 
	`of_mod2d’£_cŞs
 (
r
))

51 
	`OF_PRINT_ERROR
(("mod2sparse_to_dense: Dimension of„esult matrix is†esshan source\n"))

52 
OF_EXIT_FUNCTION


56 
	`of_mod2d’£_ş—r
 (
r
);

58 
i
 = 0; i < 
	`of_mod2¥¬£_rows
 (
m
); i++)

60 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
i
);

61 !
	`of_mod2¥¬£_©_’d
 (
e
))

63 
	`of_mod2d’£_£t
 (
r
, 
i
, 
	`of_mod2¥¬£_cŞ
 (
e
), 1);

64 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e);

67 
	}
}

72 
	$of_mod2d’£_to_¥¬£
 (
of_mod2d’£
 *
m
,

73 
of_mod2¥¬£
 *
r
)

75 
UINT32
 
i
, 
j
;

77 ià(
	`of_mod2d’£_rows
 (
m
è> 
	`of_mod2¥¬£_rows
 (
r
)

78 || 
	`of_mod2d’£_cŞs
 (
m
è> 
	`of_mod2¥¬£_cŞs
 (
r
))

80 
	`OF_PRINT_ERROR
(("mod2dense_to_sparse: Dimension of„esult matrix is†esshan source\n"))

81 
OF_EXIT_FUNCTION


84 
	`of_mod2¥¬£_ş—r
 (
r
);

85 
i
 = 0; i < 
	`of_mod2d’£_rows
 (
m
); i++)

87 
j
 = 0; j < 
	`of_mod2d’£_cŞs
 (
m
); j++)

89 ià(
	`of_mod2d’£_g‘
 (
m
, 
i
, 
j
))

91 
	`of_mod2¥¬£_š£¹
 (
r
, 
i
, 
j
);

95 
	}
}

	@src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_convert.h

16 #iâdeà
OF_MATRIX_CONVERT


17 
	#OF_MATRIX_CONVERT


	)

20 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


28 
of_mod2¥¬£_to_d’£
 (
of_mod2¥¬£
 *
m
,

29 
of_mod2d’£
 *
r
);

38 
of_mod2d’£_to_¥¬£
 (
of_mod2d’£
 *
m
,

39 
of_mod2¥¬£
 *
r
);

	@src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_dense.c

15 
	~"../of_lš—r_bš¬y_code.h
"

18 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


20 
	#ROW_MAX_ENTRY
 1000

	)

21 
	#COL_MAX_ENTRY
 1000

	)

25 
of_mod2d’£
 *
	$of_mod2d’£_®loÿ‹
 (
UINT32
 
n_rows
,

26 
UINT32
 
n_cŞs
)

28 
of_mod2d’£
 *
m
;

29 
UINT32
 
j
;

31 
OF_ENTER_FUNCTION


32 ià(
n_rows
 <ğ0 || 
n_cŞs
 <= 0)

34 
	`OF_PRINT_ERROR
(("mod2d’£_®loÿ‹: Inv®id‚umb” oàrow (%dèÜ cŞumn (%d)\n", 
n_rows
, 
n_cŞs
))

35  
NULL
;

37 
m
 = (
of_mod2d’£
 *è
	`of_ÿÎoc
(1, (*m));

38 
m
->
n_rows
 =‚_rows;

39 
m
->
n_cŞs
 =‚_cols;

40 #ifdeà
COL_ORIENTED


41 
m
->
n_wÜds
 = (
n_rows
 + 
of_mod2_wÜdsize
 - 1è>> 
of_mod2_wÜdsize_shiá
;

42 
m
->
cŞ
 = 
	`of_ÿÎoc
 (m->
n_cŞs
, (*m->col));

43 
m
->
b™s
 = 
	`of_ÿÎoc
 (m->
n_wÜds
 * m->
n_cŞs
, (*m->bits));

44 
j
 = 0; j < 
m
->
n_cŞs
; j++)

46 
m
->
cŞ
[
j
] = m->
b™s
 + j * m->
n_wÜds
;

49 
m
->
n_wÜds
 = (
n_cŞs
 + 
of_mod2_wÜdsize
 - 1è>> 
of_mod2_wÜdsize_shiá
;

50 
m
->
row
 = (
of_mod2wÜd
**è
	`of_ÿÎoc
 (m->
n_rows
, (*m->row));

51 
m
->
b™s
 = (
of_mod2wÜd
*è
	`of_ÿÎoc
 (m->
n_wÜds
 * m->
n_rows
, (*m->bits));

52 
j
 = 0; j < 
m
->
n_rows
; j++)

54 
m
->
row
[
j
] = m->
b™s
 + j * m->
n_wÜds
;

57 
OF_EXIT_FUNCTION


58  
m
;

59 
	}
}

64 
	$of_mod2d’£_ä“
 (
of_mod2d’£
 *
m
)

66 
OF_ENTER_FUNCTION


67 
	`of_ä“
 (
m
->
b™s
);

68 #ifdeà
COL_ORIENTED


69 
	`of_ä“
 (
m
->
cŞ
);

71 
	`of_ä“
 (
m
->
row
);

73 
	`of_ä“
 (
m
);

74 
OF_EXIT_FUNCTION


75 
	}
}

80 
	$of_mod2d’£_ş—r
 (
of_mod2d’£
 *
r
)

82 
OF_ENTER_FUNCTION


83 
UINT32
 
k
, 
j
;

84 #ifdeà
COL_ORIENTED


85 
j
 = 0; j < 
	`of_mod2d’£_cŞs
 (
r
); j++)

87 
k
 = 0; k < 
r
->
n_wÜds
; k++)

89 
r
->
cŞ
[
j
][
k
] = 0;

94 
j
 = 0; j < 
	`of_mod2d’£_rows
 (
r
); j++)

96 
k
 = 0; k < 
r
->
n_wÜds
; k++)

98 
r
->
row
[
j
][
k
] = 0;

102 
OF_EXIT_FUNCTION


103 
	}
}

108 
	$of_mod2d’£_cİy
 (
of_mod2d’£
 *
m
,

109 
of_mod2d’£
 *
r
)

111 
OF_ENTER_FUNCTION


112 
UINT32
 
k
, 
j
;

115 ià(
	`of_mod2d’£_rows
 (
m
è> of_mod2d’£_row (
r
)

116 || 
	`of_mod2d’£_cŞs
 (
m
è> of_mod2d’£_cŞ (
r
))

118 
	`OF_PRINT_ERROR
(("mod2dense_copy: Destination matrix isoo small\n"))

119 
OF_EXIT_FUNCTION


122 #ifdeà
COL_ORIENTED


123 
j
 = 0; j < 
	`of_mod2d’£_cŞs
 (
m
); j++)

125 
k
 = 0; k < 
m
->
n_wÜds
; k++)

127 
r
->
cŞ
[
j
][
k
] = 
m
->col[j][k];

129 ; 
k
 < 
r
->
n_wÜds
; k++)

131 
r
->
cŞ
[
j
][
k
] = 0;

135 ; 
j
 < 
	`of_mod2d’£_cŞs
 (
r
); j++)

137 
k
 = 0; k < 
r
->
n_wÜds
; k++)

139 
r
->
cŞ
[
j
][
k
] = 0;

143 
j
 = 0; j < 
	`of_mod2d’£_rows
 (
m
); j++)

145 
k
 = 0; k < 
m
->
n_wÜds
; k++)

147 
r
->
row
[
j
][
k
] = 
m
->row[j][k];

149 ; 
k
 < 
r
->
n_wÜds
; k++)

151 
r
->
row
[
j
][
k
] = 0;

155 ; 
j
 < 
	`of_mod2d’£_rows
 (
r
); j++)

157 
k
 = 0; k < 
r
->
n_wÜds
; k++)

159 
r
->
row
[
j
][
k
] = 0;

163 
OF_EXIT_FUNCTION


164 
	}
}

169 
	$of_mod2d’£_cİyrows
 (
of_mod2d’£
 *
m
,

170 
of_mod2d’£
 *
r
,

171 
UINT32
 *
rows
)

173 
OF_ENTER_FUNCTION


174 
UINT32
 
i
, 
j
, 
k
;

176 ià(
	`of_mod2d’£_cŞs
 (
m
è> of_mod2d’£_cŞ (
r
))

178 
	`OF_PRINT_ERROR
(("mod2dense_copyrows: Destination matrix has fewer columnshan source\n"))

179 
OF_EXIT_FUNCTION


183 
	`of_mod2d’£_ş—r
 (
r
);

186 
i
 = 0; i < 
	`of_mod2d’£_rows
 (
r
); i++)

188 ià(
rows
[
i
] >ğ
	`of_mod2d’£_rows
 (
m
))

190 
	`OF_PRINT_ERROR
(("mod2dense_copyrows: Row index out of„ange\n"))

191 
OF_EXIT_FUNCTION


194 #ifdeà
COL_ORIENTED


195 
j
 = 0; j < 
	`of_mod2d’£_cŞs
 (
m
); j++)

197 
	`of_mod2d’£_£t
 (
r
, 
i
, 
j
, 
	`of_mod2d’£_g‘
 (
m
, 
rows
[i], j));

200 
j
 = 0; j < 
	`of_mod2d’£_cŞs
 (
r
); j++)

202 ià(
rows
[
j
] >ğ
	`of_mod2d’£_rows
 (
m
))

204 
	`OF_PRINT_ERROR
(("mod2dense_copycols: Column index out of„ange\n"))

205 
OF_EXIT_FUNCTION


208 
k
 = 0; k < 
m
->
n_wÜds
; k++)

210 
r
->
row
[
j
][
k
] = 
m
->row[
rows
[j]][k];

212 ; 
k
 < 
r
->
n_wÜds
; k++)

214 
r
->
row
[
j
][
k
] = 0;

221 
OF_EXIT_FUNCTION


222 
	}
}

227 
	$of_mod2d’£_cİycŞs
 (
of_mod2d’£
 *
m
,

228 
of_mod2d’£
 *
r
,

229 
UINT32
 *
cŞs
)

231 
UINT32
 
i
, 
j
;

233 
OF_ENTER_FUNCTION


234 ià(
	`of_mod2d’£_rows
 (
m
è> of_mod2d’£_row (
r
))

236 
	`OF_PRINT_ERROR
(("mod2dense_copycols: Destination matrix has fewer„owshan source\n"))

237 
OF_EXIT_FUNCTION


241 
j
 = 0; j < 
	`of_mod2d’£_cŞs
 (
r
); j++)

243 #ifdeà
COL_ORIENTED


244 ià(
cŞs
[
j
] < 0 || cŞs[j] >ğ
	`of_mod2d’£_cŞs
 (
m
))

246 
	`OF_PRINT_ERROR
(("mod2dense_copycols: Column index out of„ange\n"))

247 
OF_EXIT_FUNCTION


251 
k
 = 0; k < 
m
->
n_wÜds
; k++)

253 
r
->
cŞ
[
j
][
k
] = 
m
->cŞ[
cŞs
[j]][k];

255 ; 
k
 < 
r
->
n_wÜds
; k++)

257 
r
->
cŞ
[
j
][
k
] = 0;

261 
i
 = 0; i < 
	`of_mod2d’£_rows
 (
m
); i++)

263 
	`of_mod2d’£_£t
 (
r
, 
i
, 
j
, 
	`of_mod2d’£_g‘
 (
m
, i, 
cŞs
[j]));

267 
OF_EXIT_FUNCTION


268 
	}
}

273 
	$of_mod2d’£_´št
 (
FILE
 *
f
,

274 
of_mod2d’£
 *
m
)

276 
UINT32
 
i
, 
j
;

278 
OF_ENTER_FUNCTION


279 
i
 = 0; i < 
	`of_mod2d’£_rows
 (
m
); i++)

281 
j
 = 0; j < 
	`of_mod2d’£_cŞs
 (
m
); j++)

283 ifĞ
	`of_mod2d’£_g‘
 (
m
, 
i
, 
j
) !=0)

285 
	`årštf
 (
f
, " %d", 
	`of_mod2d’£_g‘
 (
m
, 
i
, 
j
));

289 
	`årštf
 (
f
, " " );

292 
	`årštf
 (
f
, "\n");

294 
OF_EXIT_FUNCTION


295 
	}
}

299 
	$of_mod2d’£_´št_b™m­
 (
of_mod2d’£
 *
m
,

300 *
âame
)

302 #ifdeà
IL_SUPPORT


303 
UINT32
 
i
, 
j
;

304 
UINT32
 
x
,
y
;

305 
ILušt
 
lImage
;

306 
cmd
[100];

308 
OF_ENTER_FUNCTION


309 
	`In™
();

310 
	`G’Images
(1, &
lImage
);

311 
	`BšdImage
(
lImage
);

313 
	`TexImage
(
	`of_mod2d’£_cŞs
 (
m
),
	`of_mod2d’£_rows
 (mè, 1, 3, 
IL_RGB
, 
IL_UNSIGNED_BYTE
, 
NULL
);

314 
UINT32
 
v®
 =1;

315 
y
=
	`of_mod2d’£_rows
 (
m
);

316 
x
=
	`of_mod2d’£_cŞs
 (
m
);

317 
i
 = 0; i < 
	`of_mod2d’£_rows
 (
m
); i++)

319 
j
 = 0; j < 
	`of_mod2d’£_cŞs
 (
m
); j++)

321 ià(
	`of_mod2d’£_g‘
 (
m
, 
i
, 
j
))

323 
v®
 = 0x00FF00;

327 
v®
 = 0xFFFFFF;

329 
x
=
j
;

330 
y
=
	`of_mod2d’£_rows
 (
m
)-
i
-1;

331 
	`S‘Pix–s
(
x
 ,
y
, 0, 1, 1, 1, 
IL_RGBA
, 
IL_UNSIGNED_BYTE
, &
v®
);

334 ià(
âame
 =ğ
NULL
)

336 
âame
 = "dense.bmp";

340 
	`EÇbË
(
IL_FILE_OVERWRITE
);

341 
	`SaveImage
(
âame
);

343 
OF_EXIT_FUNCTION


346 
	}
}

355 
UINT32
 
	$of_mod2d’£_wr™e
 (
FILE
 *
f
, 
of_mod2d’£
 *
m
)

357 
OF_ENTER_FUNCTION


358 
UINT32
 
j
, 
k
;

360 
	`of_štio_wr™e
 (
f
, 
m
->
n_rows
);

361 ià(
	`ã¼Ü
 (
f
))

363 
OF_EXIT_FUNCTION


367 
	`of_štio_wr™e
 (
f
, 
m
->
n_cŞs
);

368 ià(
	`ã¼Ü
 (
f
))

370 
OF_EXIT_FUNCTION


373 #ifdeà
COL_ORIENTED


374 
j
 = 0; j < 
	`of_mod2d’£_cŞs
 (
m
); j++)

376 
k
 = 0; k < 
m
->
n_wÜds
; k++)

378 
	`of_štio_wr™e
 (
f
, 
m
->
cŞ
[
j
][
k
]);

379 ià(
	`ã¼Ü
 (
f
))

381 
OF_EXIT_FUNCTION


387 
j
 = 0; j < 
	`of_mod2d’£_rows
 (
m
); j++)

389 
k
 = 0; k < 
m
->
n_wÜds
; k++)

391 
	`of_štio_wr™e
 (
f
, 
m
->
row
[
j
][
k
]);

392 ià(
	`ã¼Ü
 (
f
))

394 
OF_EXIT_FUNCTION


400 
OF_EXIT_FUNCTION


402 
	}
}

407 
of_mod2d’£
 *
	$of_mod2d’£_»ad
 (
FILE
 *
f
)

409 
OF_ENTER_FUNCTION


410 
UINT32
 
n_rows
, 
n_cŞs
;

411 
of_mod2d’£
 *
m
;

412 
UINT32
 
j
, 
k
;

414 
n_rows
 = 
	`of_štio_»ad
 (
f
);

415 ià(
	`ãof
 (
f
è|| 
	`ã¼Ü
 (fè|| 
n_rows
 <= 0)

417 
OF_EXIT_FUNCTION


421 
n_cŞs
 = 
	`of_štio_»ad
 (
f
);

422 ià(
	`ãof
 (
f
è|| 
	`ã¼Ü
 (fè|| 
n_cŞs
 <= 0)

424 
OF_EXIT_FUNCTION


428 
m
 = 
	`of_mod2d’£_®loÿ‹
 (
n_rows
, 
n_cŞs
);

429 #ifdeà
COL_ORIENTED


430 
j
 = 0; j < 
	`of_mod2d’£_cŞs
 (
m
); j++)

432 
k
 = 0; k < 
m
->
n_wÜds
; k++)

434 
m
->
cŞ
[
j
][
k
] = 
	`of_štio_»ad
 (
f
);

435 ià(
	`ãof
 (
f
è|| 
	`ã¼Ü
 (f))

437 
	`of_mod2d’£_ä“
(
m
);

438 
OF_EXIT_FUNCTION


444 
j
 = 0; j < 
	`of_mod2d’£_rows
 (
m
); j++)

446 
k
 = 0; k < 
m
->
n_wÜds
; k++)

448 
m
->
row
[
j
][
k
] = 
	`of_štio_»ad
 (
f
);

449 ià(
	`ãof
 (
f
è|| 
	`ã¼Ü
 (f))

451 
	`of_mod2d’£_ä“
(
m
);

452 
OF_EXIT_FUNCTION


458 
OF_EXIT_FUNCTION


459  
m
;

460 
	}
}

465 
UINT32
 
	$of_mod2d’£_g‘
 (
of_mod2d’£
 *
m
,

466 
UINT32
 
row
,

467 
UINT32
 
cŞ
)

470 #ifdeà
OF_DEBUG


471 iàĞ
row
 >ğ
	`of_mod2d’£_rows
 (
m
è|| 
cŞ
 >ğ
	`of_mod2d’£_cŞs
 (m))

473 
	`OF_PRINT_ERROR
(("mod2d’£_g‘:„ow (%dèÜ cŞumÀšdex (%dèouˆoàbound Ôe¥. %d‡nd %d)\n", 
row
, 
cŞ
,

474 
	`of_mod2d’£_rows
 (
m
), 
	`of_mod2d’£_cŞs
 (m)))

475 
OF_EXIT_FUNCTION


479 #ifdeà
COL_ORIENTED


480  
	`of_mod2_g‘b™
 (
m
->
cŞ
[cŞ][
row
>>
of_mod2_wÜdsize_shiá
],

481 
row
&
of_mod2_wÜdsize_mask
);

483  
	`of_mod2_g‘b™
 (
m
->
row
[row][
cŞ
>>
of_mod2_wÜdsize_shiá
],

484 
cŞ
&
of_mod2_wÜdsize_mask
);

487 
	}
}

492 
INT32
 
	$of_mod2d’£_£t
 (
of_mod2d’£
 *
m
,

493 
UINT32
 
row
,

494 
UINT32
 
cŞ
,

495 
UINT32
 
v®ue
)

497 
of_mod2wÜd
 *
w
;

500 ià(
row
 >ğ
	`of_mod2d’£_rows
 (
m
è|| 
cŞ
 >ğ
	`of_mod2d’£_cŞs
 (m))

502 
	`OF_PRINT_ERROR
(("mod2d’£_£t:„ow (%dèÜ cŞumÀšdex (%dèouˆoàbound Ôe¥. %d‡nd %d)\n", 
row
, 
cŞ
,

503 
	`of_mod2d’£_rows
 (
m
), 
	`of_mod2d’£_cŞs
 (m)))

504 
OF_EXIT_FUNCTION


507 #ifdeà
COL_ORIENTED


508 
w
 = &
m
->
cŞ
[cŞ][
row
>>
of_mod2_wÜdsize_shiá
];

510 *
w
 = 
v®ue
 ? 
	`of_mod2_£tb™1
 (*w, 
row
 & 
of_mod2_wÜdsize_mask
)

511 : 
	`of_mod2_£tb™0
 (*
w
, 
row
 & 
of_mod2_wÜdsize_mask
);

513 
w
 = &
m
->
row
[row][
cŞ
>>
of_mod2_wÜdsize_shiá
];

515 *
w
 = 
v®ue
 ? 
	`of_mod2_£tb™1
 (*w, 
cŞ
 & 
of_mod2_wÜdsize_mask
)

516 : 
	`of_mod2_£tb™0
 (*
w
, 
cŞ
 & 
of_mod2_wÜdsize_mask
);

520 
	}
}

525 
UINT32
 
	$of_mod2d’£_æ
 (
of_mod2d’£
 *
m
,

526 
UINT32
 
row
,

527 
UINT32
 
cŞ
)

529 
of_mod2wÜd
 *
w
;

530 
UINT32
 
b
;

532 
OF_ENTER_FUNCTION


533 ià(
row
 >ğ
	`of_mod2d’£_rows
 (
m
è|| 
cŞ
 >ğ
	`of_mod2d’£_cŞs
 (m))

535 
	`OF_PRINT_ERROR
(("mod2d’£_æ:„ow (%dèÜ cŞumÀšdex (%dèouˆoàbound Ôe¥. %d‡nd %d)\n", 
row
, 
cŞ
,

536 
	`of_mod2d’£_rows
 (
m
), 
	`of_mod2d’£_cŞs
 (m)))

537 
OF_EXIT_FUNCTION


540 #ifdeà
COL_ORIENTED


541 
b
 = 1 ^ 
	`of_mod2_g‘b™
 (
m
->
cŞ
[cŞ][
row
>>
of_mod2_wÜdsize_shiá
],

542 
row
 & 
of_mod2_wÜdsize_mask
);

544 
w
 = &
m
->
cŞ
[cŞ][
row
>>
of_mod2_wÜdsize_shiá
];

546 *
w
 = 
b
 ? 
	`of_mod2_£tb™1
 (*w, 
row
 & 
of_mod2_wÜdsize_mask
)

547 : 
	`of_mod2_£tb™0
 (*
w
, 
row
 & 
of_mod2_wÜdsize_mask
);

549 
b
 = 1 ^ 
	`of_mod2_g‘b™
 (
m
->
row
[row][
cŞ
>>
of_mod2_wÜdsize_shiá
],

550 
cŞ
 & 
of_mod2_wÜdsize_mask
);

552 
w
 = &
m
->
row
[row][
cŞ
>>
of_mod2_wÜdsize_shiá
];

554 *
w
 = 
b
 ? 
	`of_mod2_£tb™1
 (*w, 
cŞ
 & 
of_mod2_wÜdsize_mask
)

555 : 
	`of_mod2_£tb™0
 (*
w
, 
cŞ
 & 
of_mod2_wÜdsize_mask
);

558 
OF_EXIT_FUNCTION


559  
b
;

560 
	}
}

567 
	gof_mod2d’£_Œª¥o£


568 (
of_mod2d’£
 *
	gm
,

569 
of_mod2d’£
 *
	gr


572 
OF_ENTER_FUNCTION


573 
of_mod2wÜd
 
	gw
, 
	gv
, *
	gp
;

574 
UINT32
 
	gk1
, 
	gj1
, 
	gi2
, 
	gj2
;

576 ià(
of_mod2d’£_rows
 (
m
è!ğ
of_mod2d’£_cŞs
 (
r
)

577 || 
of_mod2d’£_cŞs
 (
m
è!ğ
of_mod2d’£_rows
 (
r
))

579 
OF_PRINT_ERROR
(("mod2dense_transpose: Matrices have incompatible dimensions\n"))

580 
OF_EXIT_FUNCTION


584 ià(
	gr
 =ğ
m
)

586 
OF_PRINT_ERROR
(("mod2dense_transpose: Result matrix ishe same‡she operand\n"))

587 
OF_EXIT_FUNCTION


591 
of_mod2d’£_ş—r
 (
r
);

592 #ifdeà
COL_ORIENTED


593 
	gj1
 = 0; j1 < 
of_mod2d’£_cŞs
 (
m
); j1++)

595 
	gi2
 = 
j1
 >> 
of_mod2_wÜdsize_shiá
;

596 
	gv
 = 1 << (
j1
 & 
of_mod2_wÜdsize_mask
);

598 
	gp
 = 
m
->
cŞ
[
j1
];

599 
	gk1
 = 0;

601 
	gj2
 = 0; j2 < 
of_mod2d’£_cŞs
 (
r
); j2++)

603 ià(
	gk1
 == 0)

605 
w
 = *
p
++;

606 
	gk1
 = 
of_mod2_wÜdsize
;

608 ià(
	gw
&1)

610 
	gr
->
	gcŞ
[
j2
][
i2
] |ğ
v
;

612 
	gw
 >>= 1;

613 
	gk1
 -= 1;

617 
	gj1
 = 0; j1 < 
of_mod2d’£_rows
 (
m
); j1++)

619 
	gi2
 = 
j1
 >> 
of_mod2_wÜdsize_shiá
;

620 
	gv
 = 1 << (
j1
 & 
of_mod2_wÜdsize_mask
);

622 
	gp
 = 
m
->
row
[
j1
];

623 
	gk1
 = 0;

625 
	gj2
 = 0; j2 < 
of_mod2d’£_rows
 (
r
); j2++)

627 ià(
	gk1
 == 0)

629 
w
 = *
p
++;

630 
	gk1
 = 
of_mod2_wÜdsize
;

632 ià(
	gw
&1)

634 
	gr
->
	grow
[
j2
][
i2
] |ğ
v
;

636 
	gw
 >>= 1;

637 
	gk1
 -= 1;

641 
	gOF_EXIT_FUNCTION


647 
	gof_mod2d’£_add


648 (
of_mod2d’£
 *
	gm1
,

649 
of_mod2d’£
 *
	gm2
,

650 
of_mod2d’£
 *
	gr


653 
OF_ENTER_FUNCTION


654 
UINT32
 
	gj
, 
	gk
;

656 ià(
of_mod2d’£_rows
 (
m1
è!ğof_mod2d’£_row (
r
)

657 || 
of_mod2d’£_cŞs
 (
m1
è!ğof_mod2d’£_cŞ (
r
)

658 || 
of_mod2d’£_rows
 (
m2
è!ğof_mod2d’£_row (
r
)

659 || 
of_mod2d’£_cŞs
 (
m2
è!ğof_mod2d’£_cŞ (
r
))

661 
OF_PRINT_ERROR
(("mod2dense_add: Matrices have different dimensions\n"))

662 
OF_EXIT_FUNCTION


665 #ifdeà
COL_ORIENTED


666 
	gj
 = 0; j < 
of_mod2d’£_cŞs
 (
r
); j++)

668 
	gk
 = 0; k < 
	gr
->
	gn_wÜds
; k++)

670 
	gr
->
	gcŞ
[
j
][
k
] = 
m1
->
cŞ
[j][k] ^ 
m2
->col[j][k];

674 
	gj
 = 0; j < 
of_mod2d’£_rows
 (
r
); j++)

676 
	gk
 = 0; k < 
	gr
->
	gn_wÜds
; k++)

678 
	gr
->
	grow
[
j
][
k
] = 
m1
->
row
[j][k] ^ 
m2
->row[j][k];

683 
	gOF_EXIT_FUNCTION


696 
	gof_mod2d’£_muÉly


697 (
of_mod2d’£
 *
	gm1
,

698 
of_mod2d’£
 *
	gm2
,

699 
of_mod2d’£
 *
	gr


702 
OF_ENTER_FUNCTION


703 
UINT32
 
	gi
, 
	gj
, 
	gk
;

705 ià(
of_mod2d’£_cŞs
 (
m1
è!ğ
of_mod2d’£_rows
 (
m2
)

706 || 
of_mod2d’£_rows
 (
m1
è!ğof_mod2d’£_row (
r
)

707 || 
of_mod2d’£_cŞs
 (
m2
è!ğof_mod2d’£_cŞ (
r
))

709 
OF_PRINT_ERROR
(("mod2dense_multiply: Matrices have incompatible dimensions\n"))

710 
OF_EXIT_FUNCTION


714 ià(
	gr
 =ğ
m1
 || 
r
 =ğ
m2
)

716 
OF_PRINT_ERROR
(("mod2dense_multiply: Result matrix ishe same‡s one ofhe operands\n"))

717 
OF_EXIT_FUNCTION


721 
of_mod2d’£_ş—r
 (
r
);

722 #ifdeà
COL_ORIENTED


723 
	gj
 = 0; j < 
of_mod2d’£_cŞs
 (
r
); j++)

725 
	gi
 = 0; i < 
of_mod2d’£_rows
 (
m2
); i++)

727 ià(
of_mod2d’£_g‘
 (
m2
, 
i
, 
j
))

729 
	gk
 = 0; k < 
	gr
->
	gn_wÜds
; k++)

731 
	gr
->
	gcŞ
[
j
][
k
] ^ğ
m1
->
cŞ
[
i
][k];

737 
	gj
 = 0; j < 
of_mod2d’£_rows
 (
r
); j++)

739 
	gi
 = 0; i < 
of_mod2d’£_cŞs
 (
m2
); i++)

741 ià(
of_mod2d’£_g‘
 (
m2
, 
j
, 
i
))

743 
	gk
 = 0; k < 
	gr
->
	gn_wÜds
; k++)

745 
	gr
->
	grow
[
i
][
k
] ^ğ
m1
->
row
[
j
][k];

751 
	gOF_EXIT_FUNCTION
;

757 
UINT32
 
	gof_mod2d’£_equ®


758 (
of_mod2d’£
 *
	gm1
,

759 
of_mod2d’£
 *
	gm2


762 
OF_ENTER_FUNCTION


763 
UINT32
 
	gk
, 
	gj
, 
	gw
;

764 
of_mod2wÜd
 
	gm
;

766 ià(
of_mod2d’£_rows
 (
m1
è!ğof_mod2d’£_row (
m2
)

767 || 
of_mod2d’£_cŞs
 (
m1
è!ğof_mod2d’£_cŞ (
m2
))

769 
OF_PRINT_ERROR
(("mod2dense_equal: Matrices have different dimensions\n"))

770 
OF_EXIT_FUNCTION


774 
	gw
 = 
m1
->
n_wÜds
;

778 #ifdeà
COL_ORIENTED


779 
	gm
 = (1 << (
of_mod2_wÜdsize
 - (
w
 * of_mod2_wÜdsiz- 
m1
->
n_rows
))) - 1;

781 
	gj
 = 0; j < 
of_mod2d’£_cŞs
 (
m1
); j++)

783 
	gk
 = 0; k < 
	gw
 - 1; k++)

785 ià(
	gm1
->
	gcŞ
[
j
][
k
] !ğ
m2
->
cŞ
[j][k])

787 
OF_EXIT_FUNCTION


792 iàĞ(
	gm1
->
	gcŞ
[
j
][
k
]&
	gm
è!ğ(
m2
->
cŞ
[j][k]&
m
))

794 
OF_EXIT_FUNCTION


800 
	gm
 = (1 << (
of_mod2_wÜdsize
 - (
w
 * of_mod2_wÜdsiz- 
m1
->
n_cŞs
))) - 1;

802 
	gj
 = 0; j < 
of_mod2d’£_rows
 (
m1
); j++)

804 
	gk
 = 0; k < 
	gw
 - 1; k++)

806 ià(
	gm1
->
	grow
[
j
][
k
] !ğ
m2
->
row
[j][k])

808 
OF_EXIT_FUNCTION


813 iàĞ(
	gm1
->
	grow
[
j
][
k
]&
	gm
è!ğ(
m2
->
row
[j][k]&
m
))

815 
OF_EXIT_FUNCTION


820 
OF_EXIT_FUNCTION


827 
UINT32
 
	gof_mod2d’£_šv”t


828 (
of_mod2d’£
 *
	gm
,

829 
of_mod2d’£
 *
	gr


832 
OF_ENTER_FUNCTION


833 
of_mod2wÜd
 *
	gs
, *
	gt
;

834 
UINT32
 
	gi
, 
	gj
, 
	gk
, 
	gn
, 
	gw
, 
	gk0
, 
	gb0
;

836 ià(
of_mod2d’£_rows
 (
m
è!ğ
of_mod2d’£_cŞs
 (m))

838 
OF_PRINT_ERROR
(("mod2dense_invert: Matrixo invert is‚ot square\n"))

839 
OF_EXIT_FUNCTION


843 ià(
	gr
 =ğ
m
)

845 
OF_PRINT_ERROR
(("mod2dense_invert: Result matrix ishe same‡she operand\n"))

846 
OF_EXIT_FUNCTION


849 #ifdeà
COL_ORIENTED


850 
	gn
 = 
of_mod2d’£_rows
 (
m
);

852 
	gw
 = 
m
->
n_wÜds
;

854 ià(
of_mod2d’£_rows
 (
r
è!ğ
n
 || 
of_mod2d’£_cŞs
 (r) !=‚)

856 
OF_PRINT_ERROR
(("mod2dense_invert: Matrixo„eceive inverse has wrong dimensions\n"))

857 
OF_EXIT_FUNCTION


861 
of_mod2d’£_ş—r
 (
r
);

862 
	gi
 = 0; i < 
	gn
; i++)

864 
of_mod2d’£_£t
 (
r
, 
i
, i, 1);

867 
	gi
 = 0; i < 
	gn
; i++)

869 
	gk0
 = 
i
 >> 
of_mod2_wÜdsize_shiá
;

870 
	gb0
 = 
i
 & 
of_mod2_wÜdsize_mask
;

872 
	gj
 = 
i
; j < 
	gn
; j++)

874 ià(
of_mod2_g‘b™
 (
m
->
cŞ
[
j
][
k0
], 
b0
))

878 ià(
	gj
 =ğ
n
)

880 
OF_EXIT_FUNCTION


884 ià(
	gj
 !ğ
i
)

886 
t
 = 
m
->
cŞ
[
i
];

887 
	gm
->
	gcŞ
[
i
] = 
m
->
cŞ
[
j
];

888 
	gm
->
	gcŞ
[
j
] = 
t
;

890 
	gt
 = 
r
->
cŞ
[
i
];

891 
	gr
->
	gcŞ
[
i
] = 
r
->
cŞ
[
j
];

892 
	gr
->
	gcŞ
[
j
] = 
t
;

895 
	gj
 = 0; j < 
	gn
; j++)

897 ià(
	gj
 !ğ
i
 && 
of_mod2_g‘b™
 (
m
->
cŞ
[
j
][
k0
], 
b0
))

899 
	gs
 = 
m
->
cŞ
[
j
];

900 
	gt
 = 
m
->
cŞ
[
i
];

901 
	gk
 = 
k0
; k < 
	gw
; k++)

902 
	gs
[
k
] ^ğ
t
[k];

903 
	gs
 = 
r
->
cŞ
[
j
];

904 
	gt
 = 
r
->
cŞ
[
i
];

905 
	gk
 = 0; k < 
	gw
; k++)

906 
	gs
[
k
] ^ğ
t
[k];

911 
	gn
 = 
of_mod2d’£_cŞs
 (
m
);

913 
	gw
 = 
m
->
n_wÜds
;

915 ià(
of_mod2d’£_cŞs
 (
r
è!ğ
n
 || 
of_mod2d’£_rows
 (r) !=‚)

917 
OF_PRINT_ERROR
(("mod2dense_invert: Matrixo„eceive inverse has wrong dimensions\n"))

918 
OF_EXIT_FUNCTION


922 
of_mod2d’£_ş—r
 (
r
);

923 
	gi
 = 0; i < 
	gn
; i++)

925 
of_mod2d’£_£t
 (
r
, 
i
, i, 1);

929 
	gi
 = 0; i < 
	gn
; i++)

931 
	gk0
 = 
i
 >> 
of_mod2_wÜdsize_shiá
;

932 
	gb0
 = 
i
 & 
of_mod2_wÜdsize_mask
;

934 
	gj
 = 
i
; j < 
	gn
; j++)

936 ià(
of_mod2_g‘b™
 (
m
->
row
[
j
][
k0
], 
b0
))

940 ià(
	gj
 =ğ
n
)

942 
OF_EXIT_FUNCTION


946 ià(
	gj
 !ğ
i
)

948 
t
 = 
m
->
row
[
i
];

949 
	gm
->
	grow
[
i
] = 
m
->
row
[
j
];

950 
	gm
->
	grow
[
j
] = 
t
;

952 
	gt
 = 
r
->
row
[
i
];

953 
	gr
->
	grow
[
i
] = 
r
->
row
[
j
];

954 
	gr
->
	grow
[
j
] = 
t
;

957 
	gj
 = 0; j < 
	gn
; j++)

959 ià(
	gj
 !ğ
i
 && 
of_mod2_g‘b™
 (
m
->
row
[
j
][
k0
], 
b0
))

961 
	gs
 = 
m
->
row
[
j
];

962 
	gt
 = 
m
->
row
[
i
];

963 
	gk
 = 
k0
; k < 
	gw
; k++)

964 
	gs
[
k
] ^ğ
t
[k];

965 
	gs
 = 
r
->
row
[
j
];

966 
	gt
 = 
r
->
row
[
i
];

967 
	gk
 = 0; k < 
	gw
; k++)

968 
	gs
[
k
] ^ğ
t
[k];

973 
OF_EXIT_FUNCTION


980 
UINT32
 
	gof_mod2d’£_ŒŸnguÏrize


981 (
of_mod2d’£
 *
	gm
,

982 
of_mod2d’£
 *
	gr


985 
OF_ENTER_FUNCTION


986 
of_mod2wÜd
 *
	gs
, *
	gt
;

987 
UINT32
 
	gi
, 
	gj
, 
	gk
, 
	gn
, 
	gp
, 
	gw
, 
	gk0
, 
	gb0
;

994 ià(
	gr
 =ğ
m
)

996 
OF_PRINT_ERROR
(("mod2dense_triangularize: Result matrix ishe same‡she operand\n"))

997 
OF_EXIT_FUNCTION


1000 #ifdeà
COL_ORIENTED


1002 
	gn
 = 
of_mod2d’£_rows
 (
m
);

1003 
	gp
 = 
of_mod2d’£_cŞs
 (
m
);

1004 
	gw
 = 
m
->
n_wÜds
;

1006 ià(
of_mod2d’£_rows
 (
r
è!ğ
n
 || 
of_mod2d’£_cŞs
 (rè!ğ
p
)

1008 
OF_PRINT_ERROR
(("mod2dense_triangularize: Matrixo„eceive inverse has wrong dimensions\n"))

1009 
OF_EXIT_FUNCTION


1014 
of_mod2d’£_ş—r
 (
r
);

1015 
	gi
 = 0; i < 
	gp
; i++)

1017 
of_mod2d’£_£t
 (
r
, 
i
, i, 1);

1022 
	gi
 = 0; i < 
	gn
; i++)

1024 
	gk0
 = 
i
 >> 
of_mod2_wÜdsize_shiá
;

1025 
	gb0
 = 
i
 & 
of_mod2_wÜdsize_mask
;

1028 
	gj
 = 
i
; j < 
	gp
; j++)

1030 ià(
of_mod2_g‘b™
 (
m
->
cŞ
[
j
][
k0
], 
b0
))

1034 ià(
	gj
 =ğ
p
)

1036 
OF_EXIT_FUNCTION


1040 ià(
	gj
 !ğ
i
)

1043 
t
 = 
m
->
cŞ
[
i
];

1044 
	gm
->
	gcŞ
[
i
] = 
m
->
cŞ
[
j
];

1045 
	gm
->
	gcŞ
[
j
] = 
t
;

1047 
	gt
 = 
r
->
cŞ
[
i
];

1048 
	gr
->
	gcŞ
[
i
] = 
r
->
cŞ
[
j
];

1049 
	gr
->
	gcŞ
[
j
] = 
t
;

1053 
	gj
 = 
i
; j < 
	gp
; j++)

1055 ià(
	gj
 !ğ
i
 && 
of_mod2_g‘b™
 (
m
->
cŞ
[
j
][
k0
], 
b0
))

1058 
	gs
 = 
m
->
cŞ
[
j
];

1059 
	gt
 = 
m
->
cŞ
[
i
];

1060 
	gk
 = 
k0
; k < 
	gw
; k++)

1061 
	gs
[
k
] ^ğ
t
[k];

1062 
	gs
 = 
r
->
cŞ
[
j
];

1063 
	gt
 = 
r
->
cŞ
[
i
];

1064 
	gk
 = 0; k < 
	gw
; k++)

1065 
	gs
[
k
] ^ğ
t
[k];

1071 
	gn
 = 
of_mod2d’£_cŞs
 (
m
);

1072 
	gp
 = 
of_mod2d’£_rows
 (
m
);

1073 
	gw
 = 
m
->
n_wÜds
;

1075 ià(
of_mod2d’£_cŞs
 (
r
è!ğ
n
 || 
of_mod2d’£_rows
 (rè!ğ
p
)

1077 
OF_PRINT_ERROR
(("mod2dense_triangularize: Matrixo„eceive inverse has wrong dimensions\n"))

1078 
OF_EXIT_FUNCTION


1083 
of_mod2d’£_ş—r
 (
r
);

1084 
	gi
 = 0; i < 
	gn
; i++)

1086 
of_mod2d’£_£t
 (
r
, 
i
, i, 1);

1091 
	gi
 = 0; i < 
	gn
; i++)

1093 
	gk0
 = 
i
 >> 
of_mod2_wÜdsize_shiá
;

1094 
	gb0
 = 
i
 & 
of_mod2_wÜdsize_mask
;

1097 
	gj
 = 
i
; j < 
	gp
; j++)

1099 ià(
of_mod2_g‘b™
 (
m
->
row
[
j
][
k0
], 
b0
))

1103 ià(
	gj
 =ğ
p
)

1105 
OF_EXIT_FUNCTION


1109 ià(
	gj
 !ğ
i
)

1112 
t
 = 
m
->
row
[
i
];

1113 
	gm
->
	grow
[
i
] = 
m
->
row
[
j
];

1114 
	gm
->
	grow
[
j
] = 
t
;

1116 
	gt
 = 
r
->
row
[
i
];

1117 
	gr
->
	grow
[
i
] = 
r
->
row
[
j
];

1118 
	gr
->
	grow
[
j
] = 
t
;

1123 
	gj
 = 0; j < 
	gp
; j++)

1126 ià(
	gj
 !ğ
i
 && 
of_mod2_g‘b™
 (
m
->
row
[
j
][
k0
], 
b0
))

1129 
	gs
 = 
m
->
row
[
j
];

1130 
	gt
 = 
m
->
row
[
i
];

1131 
	gk
 = 
k0
; k < 
	gw
; k++)

1132 
	gs
[
k
] ^ğ
t
[k];

1133 
	gs
 = 
r
->
row
[
j
];

1134 
	gt
 = 
r
->
row
[
i
];

1135 
	gk
 = 0; k < 
	gw
; k++)

1136 
	gs
[
k
] ^ğ
t
[k];

1143 
OF_EXIT_FUNCTION


1150 
UINT32
 
	gof_mod2d’£_šv”t_£Ëùed


1151 (
of_mod2d’£
 *
	gm
,

1152 
of_mod2d’£
 *
	gr
,

1153 
UINT32
 *
	grows
,

1154 
UINT32
 *
	gcŞs


1157 
OF_ENTER_FUNCTION


1158 
of_mod2wÜd
 *
	gs
, *
	gt
;

1159 
UINT32
 
	gR
;

1160 
UINT32
 
	gi
, 
	gj
, 
	gk
, 
	gn
, 
	gw
, 
	gk0
, 
	gb0
, 
	gn2
, 
	gc
;

1162 ià(
	gr
 =ğ
m
)

1164 
OF_PRINT_ERROR
(("mod2dense_invert_selected2: Result matrix ishe same‡she operand\n"))

1165 
OF_EXIT_FUNCTION


1168 #ifdeà
COL_ORIENTED


1169 
	gn
 = 
of_mod2d’£_rows
 (
m
);

1170 
	gw
 = 
m
->
n_wÜds
;

1172 
	gn2
 = 
of_mod2d’£_cŞs
 (
m
);

1174 ià(
of_mod2d’£_rows
 (
r
è!ğ
n
 || 
of_mod2d’£_cŞs
 (rè!ğ
n2
)

1176 
OF_PRINT_ERROR
(("mod2dense_invert_selected2: Matrixo„eceive inverse has wrong dimensions\n"))

1177 
OF_EXIT_FUNCTION


1181 
of_mod2d’£_ş—r
 (
r
);

1183 
	gi
 = 0; i < 
	gn
; i++)

1185 
	grows
[
i
] = i;

1188 
	gj
 = 0; j < 
	gn2
; j++)

1190 
	gcŞs
[
j
] = j;

1193 
	gR
 = 0;

1194 
	gi
 = 0;

1198 
	gi
 < 
	gn
 - 
	gR
)

1200 
	gk0
 = 
rows
[
i
] >> 
of_mod2_wÜdsize_shiá
;

1201 
	gb0
 = 
rows
[
i
] & 
of_mod2_wÜdsize_mask
;

1203 
	gj
 = 
i
; j < 
	gn2
; j++)

1205 ià(
of_mod2_g‘b™
 (
m
->
cŞ
[
cŞs
[
j
]][
k0
], 
b0
))

1209 ià(
	gj
 < 
	gn2
)

1212 
	gR
 += 1;

1213 
	gc
 = 
rows
[
i
];

1214 
	grows
[
i
] = 
rows
[
n
-
R
];

1215 
	grows
[
n
-
R
] = 
c
;

1219 ià(
	gi
 =ğ
n
 - 
R
)

1222 
	gc
 = 
cŞs
[
j
];

1223 
	gcŞs
[
j
] = 
cŞs
[
i
];

1224 
	gcŞs
[
i
] = 
c
;

1226 
of_mod2d’£_£t
 (
r
, 
rows
[
i
], 
c
, 1);

1228 
	gj
 = 0; j < 
	gn2
; j++)

1230 ià(
	gj
 !ğ
c
 && 
of_mod2_g‘b™
 (
m
->
cŞ
[
j
][
k0
], 
b0
))

1232 
	gs
 = 
m
->
cŞ
[
j
];

1233 
	gt
 = 
m
->
cŞ
[
c
];

1234 
	gk
 = 0; k < 
	gw
; k++)

1235 
	gs
[
k
] ^ğ
t
[k];

1236 
	gs
 = 
r
->
cŞ
[
j
];

1237 
	gt
 = 
r
->
cŞ
[
c
];

1238 
	gk
 = 0; k < 
	gw
; k++)

1239 
	gs
[
k
] ^ğ
t
[k];

1243 
	gi
 += 1;

1246 
	gj
 = 
n
 - 
R
; j < 
	gn
; j++)

1248 
	gs
 = 
r
->
cŞ
[
cŞs
[
j
]];

1249 
	gk
 = 0; k < 
	gw
; k++)

1250 
	gs
[
k
] = 0;

1254 
	gn
 = 
of_mod2d’£_cŞs
 (
m
);

1255 
	gw
 = 
m
->
n_wÜds
;

1257 
	gn2
 = 
of_mod2d’£_rows
 (
m
);

1265 
of_mod2d’£_ş—r
 (
r
);

1267 
	gi
 = 0; i < 
	gn
; i++)

1269 
	grows
[
i
] = i;

1272 
	gj
 = 0; j < 
	gn2
; j++)

1274 
	gcŞs
[
j
] = j;

1277 
	gR
 = 0;

1278 
	gi
 = 0;

1282 
	gi
 < 
	gn
 - 
	gR
)

1284 
	gk0
 = 
cŞs
[
i
] >> 
of_mod2_wÜdsize_shiá
;

1285 
	gb0
 = 
cŞs
[
i
] & 
of_mod2_wÜdsize_mask
;

1287 
	gj
 = 
i
; j < 
	gn2
; j++)

1289 ià(
of_mod2_g‘b™
 (
m
->
row
[
rows
[
j
]][
k0
], 
b0
))

1293 ià(
	gj
 < 
	gn2
)

1296 
	gR
 += 1;

1297 
	gc
 = 
cŞs
[
i
];

1298 
	gcŞs
[
i
] = 
cŞs
[
n
-
R
];

1299 
	gcŞs
[
n
-
R
] = 
c
;

1303 ià(
	gi
 =ğ
n
 - 
R
)

1306 
	gc
 = 
rows
[
j
];

1307 
	grows
[
j
] = 
rows
[
i
];

1308 
	grows
[
i
] = 
c
;

1310 
of_mod2d’£_£t
 (
r
, 
c
, 
cŞs
[
i
], 1);

1312 
	gj
 = 0; j < 
	gn2
; j++)

1314 ià(
	gj
 !ğ
c
 && 
of_mod2_g‘b™
 (
m
->
row
[
j
][
k0
], 
b0
))

1316 
	gs
 = 
m
->
row
[
j
];

1317 
	gt
 = 
m
->
row
[
c
];

1318 
	gk
 = 0; k < 
	gw
; k++)

1319 
	gs
[
k
] ^ğ
t
[k];

1320 
	gs
 = 
r
->
row
[
j
];

1321 
	gt
 = 
r
->
row
[
c
];

1322 
	gk
 = 0; k < 
	gw
; k++)

1323 
	gs
[
k
] ^ğ
t
[k];

1327 
	gi
 += 1;

1330 
	gj
 = 
n
 - 
R
; j < 
	gn
; j++)

1332 
	gs
 = 
r
->
row
[
rows
[
j
]];

1333 
	gk
 = 0; k < 
	gw
; k++)

1334 
	gs
[
k
] = 0;

1337 
OF_EXIT_FUNCTION


1338  
	gR
;

1344 
UINT32
 
	gof_mod2d’£_fÜcibly_šv”t


1345 (
of_mod2d’£
 *
	gm
,

1346 
of_mod2d’£
 *
	gr
,

1347 
UINT32
 *
	ga_row
,

1348 
UINT32
 *
	ga_cŞ


1351 
OF_ENTER_FUNCTION


1354 
UINT32
 
	gc
 = 0;

1355 #ifdeà
COL_ORIENTED


1356 ià(
of_mod2d’£_rows
 (
m
è!ğ
of_mod2d’£_cŞs
 (m))

1358 
OF_PRINT_ERROR
(("mod2dense_forcibly_invert: Matrixo invert is‚ot square\n"))

1359 
OF_EXIT_FUNCTION


1363 ià(
	gr
 =ğ
m
)

1365 
OF_PRINT_ERROR
(("mod2dense_forcibly_invert: Result matrix ishe same‡she operand\n"))

1366 
OF_EXIT_FUNCTION


1370 
	gn
 = 
of_mod2d’£_rows
 (
m
);

1371 
	gw
 = 
m
->
n_wÜds
;

1373 ià(
of_mod2d’£_rows
 (
r
è!ğ
n
 || 
of_mod2d’£_cŞs
 (r) !=‚)

1375 
OF_PRINT_ERROR
(("mod2dense_forcibly_invert: Matrixo„eceive inverse has wrong dimensions\n"))

1376 
OF_EXIT_FUNCTION


1380 
of_mod2d’£_ş—r
 (
r
);

1381 
	gi
 = 0; i < 
	gn
; i++)

1383 
of_mod2d’£_£t
 (
r
, 
i
, i, 1);

1386 
	gi
 = 0; i < 
	gn
; i++)

1388 
	ga_row
[
i
] = -1;

1389 
	ga_cŞ
[
i
] = i;

1392 
	gi
 = 0; i < 
	gn
; i++)

1394 
	gk0
 = 
i
 >> 
of_mod2_wÜdsize_shiá
;

1395 
	gb0
 = 
i
 & 
of_mod2_wÜdsize_mask
;

1397 
	gj
 = 
i
; j < 
	gn
; j++)

1399 ià(
of_mod2_g‘b™
 (
m
->
cŞ
[
j
][
k0
], 
b0
))

1403 ià(
	gj
 =ğ
n
)

1405 
j
 = 
i
;

1406 
of_mod2d’£_£t
 (
m
, 
i
, 
j
, 1);

1407 
	ga_row
[
i
] = i;

1410 ià(
	gj
 !ğ
i
)

1412 
t
 = 
m
->
cŞ
[
i
];

1413 
	gm
->
	gcŞ
[
i
] = 
m
->
cŞ
[
j
];

1414 
	gm
->
	gcŞ
[
j
] = 
t
;

1416 
	gt
 = 
r
->
cŞ
[
i
];

1417 
	gr
->
	gcŞ
[
i
] = 
r
->
cŞ
[
j
];

1418 
	gr
->
	gcŞ
[
j
] = 
t
;

1420 
	gu
 = 
a_cŞ
[
i
];

1421 
	ga_cŞ
[
i
] = 
a_cŞ
[
j
];

1422 
	ga_cŞ
[
j
] = 
u
;

1425 
	gj
 = 0; j < 
	gn
; j++)

1427 ià(
	gj
 !ğ
i
 && 
of_mod2_g‘b™
 (
m
->
cŞ
[
j
][
k0
], 
b0
))

1429 
	gs
 = 
m
->
cŞ
[
j
];

1430 
	gt
 = 
m
->
cŞ
[
i
];

1431 
	gk
 = 
k0
; k < 
	gw
; k++)

1432 
	gs
[
k
] ^ğ
t
[k];

1433 
	gs
 = 
r
->
cŞ
[
j
];

1434 
	gt
 = 
r
->
cŞ
[
i
];

1435 
	gk
 = 0; k < 
	gw
; k++)

1436 
	gs
[
k
] ^ğ
t
[k];

1441 
	gc
 = 0;

1442 
	gi
 = 0; i < 
	gn
; i++)

1444 ià(
	ga_row
[
i
] != -1)

1446 
a_row
[
c
] =‡_row[
i
];

1447 
	ga_cŞ
[
c
] = 
a_cŞ
[
i
];

1448 
	gc
 += 1;

1452 
OF_EXIT_FUNCTION


1453  
	gc
;

1459 
	$of_mod2d’£_d’s™y
 (
of_mod2d’£
 *
m
)

1462 
OF_ENTER_FUNCTION


1463 
UINT32
 
nb_Úe
 = 0;

1464 
UINT32
 
nb_’Œy
 = 0;

1465 
UINT32
 
i
, 
j
;

1466 
d’s™y
 = 0;

1467 #ifdeà
COL_ORIENTED


1468 
j
 = 0; j < 
	`of_mod2d’£_cŞs
 (
m
); j++)

1470 
i
 = 0; i < 
	`of_mod2d’£_rows
 (
m
); i++)

1472 ià(
	`of_mod2d’£_g‘
 (
m
, 
i
, 
j
))

1474 
nb_Úe
++;

1479 
j
 = 0; j < 
	`of_mod2d’£_rows
 (
m
); j++)

1481 
i
 = 0; i < 
	`of_mod2d’£_cŞs
 (
m
); i++)

1483 ià(
	`of_mod2d’£_g‘
 (
m
, 
j
, 
i
))

1485 
nb_Úe
++;

1490 
nb_’Œy
 = 
	`of_mod2d’£_rows
 (
m
è* 
	`of_mod2d’£_cŞs
 (m);

1491 
d’s™y
 = (è
nb_Úe
 / 
nb_’Œy
;

1493 
OF_EXIT_FUNCTION


1494  
d’s™y
;

1495 
	}
}

1500 
boŞ
 
	$of_mod2d’£_row_is_em±y
 (
of_mod2d’£
 *
m
,

1501 
UINT32
 
row
)

1503 
UINT32
 
i
;

1504 
UINT32
 
n_w
;

1505 
of_mod2wÜd
 *
w
;

1507 
OF_ENTER_FUNCTION


1508 #ifdeà
OF_DEBUG


1509 ià(
row
 >ğ
	`of_mod2d’£_rows
 (
m
))

1511 
OF_EXIT_FUNCTION


1512 
	`ex™
(-1);

1516 
n_w
 = 
m
->
n_wÜds
;

1517 
i
 = 0, 
w
 = 
m
->
row
[row]; i < 
n_w
; i++, w++)

1519 ià(*
w
 != 0)

1521  
çl£
;

1524  
Œue
;

1525 
	}
}

1528 
UINT32
 
	$of_mod2d’£_row_weight
 (
of_mod2d’£
 *
m
, 
UINT32
 
i
)

1530 
UINT32
 
weight
 = 0;

1532 
OF_ENTER_FUNCTION


1533 ià(
i
 >ğ
	`of_mod2d’£_rows
 (
m
))

1535 
OF_EXIT_FUNCTION


1539 
	#SLOW_HAMMING_WEIGHT_CALCULATION


	)

1540 #ifdeà 
SLOW_HAMMING_WEIGHT_CALCULATION


1541 
UINT32
 
j
;

1542 
UINT32
 
nwÜds
;

1545 
nwÜds
 = 
	`of_mod2d’£_cŞs
 (
m
è>> (
of_mod2_wÜdsize_shiá
);

1547 
j
 = 0; j < 
	`of_mod2d’£_cŞs
(
m
); j++)

1549 ià(
	`of_mod2d’£_g‘
(
m
, 
i
, 
j
))

1551 
weight
++;

1556 
weight
 = 
	`of_hweight_¬¿y
 ((
UINT32
 *è
m
->
row
[
i
], 
	`of_mod2d’£_cŞs
 (m));

1559 
OF_EXIT_FUNCTION


1560  
weight
;

1561 
	}
}

1564 
UINT32
 
	$of_mod2d’£_row_weight_ignÜe_fœ¡
 (
of_mod2d’£
 *
m
, 
UINT32
 
i
, UINT32 
nb_ignÜe
)

1566 
UINT32
 
weight
 = 0;

1568 
UINT32
 
¡¬t0
;

1570 
OF_ENTER_FUNCTION


1571 ià(
i
 >ğ
	`of_mod2d’£_rows
 (
m
))

1573 
OF_EXIT_FUNCTION


1578 
¡¬t0
 = 
nb_ignÜe
 >> (
of_mod2_wÜdsize_shiá
 - 1);

1580 
UINT32
 
off£t32
 = 
nb_ignÜe
 >> 
of_mod2_wÜdsize_shiá
;

1581 
UINT32
 
»m
 = 
	`of_mod2d’£_cŞs
 (
m
è- (
off£t32
 << 
of_mod2_wÜdsize_shiá
);

1583 
weight
 = 
	`of_hweight_¬¿y
 ((
UINT32
 *è& 
m
->
row
[
i
][
off£t32
], 
»m
);

1584 
OF_EXIT_FUNCTION


1585  
weight
;

1586 
	}
}

1589 
UINT32
 
	$of_mod2d’£_cŞ_weight
 (
of_mod2d’£
 *
m
, 
UINT32
 
i
)

1591 
OF_ENTER_FUNCTION


1592 
UINT32
 
weight
 = 0;

1593 ià(
i
 >ğ
	`of_mod2d’£_cŞs
 (
m
))

1595 
OF_EXIT_FUNCTION


1598 
UINT32
 
j
;

1599 
j
 = 0; j < 
	`of_mod2d’£_rows
 (
m
); j++)

1601 ià(
	`of_mod2d’£_g‘
 (
m
, 
j
, 
i
))

1603 
weight
++;

1606 
OF_EXIT_FUNCTION


1607  
weight
;

1609 
	}
}

1612 
	$of_mod2d’£_´št_¡©s
 (
FILE
 *
f
, 
of_mod2d’£
 *
m
)

1614 
OF_ENTER_FUNCTION


1615 
UINT32
 
i
;

1616 
d’s™y
 = 0;

1617 
row_d’s™y
 = 0;

1618 
cŞ_d’s™y
 = 0;

1621 
av”_nb_’Œy_³r_row
 = 0;

1622 
UINT32
 
max_’Œy_³r_row
 = 0;

1623 
UINT32
 
mš_’Œy_³r_row
 = 9999999;

1624 
UINT32
 
nb_’Œy_row
[
ROW_MAX_ENTRY
];

1625 
UINT32
 
nb_’Œy_cu¼’t_row
 = 0;

1626 
UINT32
 
ùr
 = 0;

1628 
i
 = 0;˜< 
ROW_MAX_ENTRY
;i++)

1630 
nb_’Œy_row
[
i
] = 0;

1632 
i
 = 0; i < 
	`of_mod2d’£_rows
 (
m
); i++)

1634 
nb_’Œy_cu¼’t_row
 = 
	`of_mod2d’£_row_weight
 (
m
, 
i
);

1635 
nb_’Œy_row
[
nb_’Œy_cu¼’t_row
]++;

1636 ià(
nb_’Œy_cu¼’t_row
 < 
mš_’Œy_³r_row
)

1638 
mš_’Œy_³r_row
 = 
nb_’Œy_cu¼’t_row
;

1640 ià(
nb_’Œy_cu¼’t_row
 > 
max_’Œy_³r_row
)

1642 
max_’Œy_³r_row
 = 
nb_’Œy_cu¼’t_row
;

1644 
ùr
 +ğ
nb_’Œy_cu¼’t_row
;

1646 
av”_nb_’Œy_³r_row
 = ( (è
ùr
è/ 
	`of_mod2d’£_rows
 (
m
);

1647 
row_d’s™y
 = 
av”_nb_’Œy_³r_row
 / (
	`of_mod2d’£_cŞs
 (
m
));

1650 
av”_nb_’Œy_³r_cŞ
 = 0;

1651 
UINT32
 
max_’Œy_³r_cŞ
 = 0;

1652 
UINT32
 
mš_’Œy_³r_cŞ
 = 9999999;

1653 
UINT32
 
nb_’Œy_cŞ
[
COL_MAX_ENTRY
];

1654 
UINT32
 
nb_’Œy_cu¼’t_cŞ
 = 0;

1656 
ùr
 = 0;

1657 
i
 = 0;˜< 
COL_MAX_ENTRY
;i++)

1659 
nb_’Œy_cŞ
[
i
] = 0;

1661 
i
 = 0; i < 
	`of_mod2d’£_cŞs
 (
m
); i++)

1663 
nb_’Œy_cu¼’t_cŞ
 = 
	`of_mod2d’£_cŞ_weight
 (
m
, 
i
);

1664 
nb_’Œy_cŞ
[
nb_’Œy_cu¼’t_cŞ
]++;

1665 ià(
nb_’Œy_cu¼’t_cŞ
 == 1)

1669 ià(
nb_’Œy_cu¼’t_cŞ
 == 0)

1673 ià(
nb_’Œy_cu¼’t_cŞ
 < 
mš_’Œy_³r_cŞ
)

1675 
mš_’Œy_³r_cŞ
 = 
nb_’Œy_cu¼’t_cŞ
;

1677 ià(
nb_’Œy_cu¼’t_cŞ
 > 
max_’Œy_³r_cŞ
)

1679 
max_’Œy_³r_cŞ
 = 
nb_’Œy_cu¼’t_cŞ
;

1681 
ùr
 +ğ
nb_’Œy_cu¼’t_cŞ
;

1683 
av”_nb_’Œy_³r_cŞ
 = ( (è
ùr
è/ 
	`of_mod2d’£_cŞs
 (
m
);

1684 
cŞ_d’s™y
 = 
av”_nb_’Œy_³r_cŞ
 / (
	`of_mod2d’£_rows
 (
m
));

1685 
d’s™y
 = 
cŞ_d’s™y
;

1688 
	`årštf
 (
f
, "‚b_cŞ=%d‚b_row=%d \n", 
	`of_mod2d’£_cŞs
 (
m
), 
	`of_mod2d’£_rows
 (m));

1689 
	`årštf
 (
f
, "„ow_d’s™y=%à\n", 
row_d’s™y
);

1691 
	`årštf
 (
f
, "‡v”_nb_’Œy_³r_row=%à\n", 
av”_nb_’Œy_³r_row
);

1692 
	`årštf
 (
f
, " mš_’Œy_³r_row=%d \n", 
mš_’Œy_³r_row
);

1693 
	`årštf
 (
f
, " max_’Œy_³r_row=%d \n", 
max_’Œy_³r_row
);

1694 
i
 = 
mš_’Œy_³r_row
;˜<ğ
max_’Œy_³r_row
;i++)

1696 
	`årštf
 (
f
, "‚b_’Œy_row[%d]=%d \n", 
i
, 
nb_’Œy_row
[i]);

1698 
	`årštf
 (
f
, "------------------ \n");

1699 
	`årštf
 (
f
, " cŞ_d’s™y=%à\n", 
cŞ_d’s™y
);

1700 
	`årštf
 (
f
, "‡v”_nb_’Œy_³r_cŞ=%à\n", 
av”_nb_’Œy_³r_cŞ
);

1701 
	`årštf
 (
f
, " mš_’Œy_³r_cŞ=%d \n", 
mš_’Œy_³r_cŞ
);

1702 
	`årštf
 (
f
, " max_’Œy_³r_cŞ=%d \n", 
max_’Œy_³r_cŞ
);

1703 
i
 = 
mš_’Œy_³r_cŞ
;˜<ğ
max_’Œy_³r_cŞ
;i++)

1705 ià(
nb_’Œy_cŞ
[
i
] > 0)

1707 
	`årštf
 (
f
, "‚b_’Œy_cŞ[%d]=%d \n", 
i
, 
nb_’Œy_cŞ
[i]);

1710 
	`årštf
 (
f
, "------------------ \n");

1711 
	`årštf
 (
f
, " m©rix_d’s™y=%à\n", 
d’s™y
);

1712 
OF_EXIT_FUNCTION


1713 
	}
}

1716 
	$of_mod2d’£_´št_memÜy_šfo
 (
of_mod2d’£
 *
m
)

1718 
OF_ENTER_FUNCTION


1719 
	`´štf
 ("m=%p\n", 
m
);

1720 
	`´štf
 ("m->n_rows=%d\n", 
m
->
n_rows
);

1721 
	`´štf
 ("m->n_cŞs=%d\n", 
m
->
n_cŞs
);

1722 
	`´štf
 ("m->n_wÜds=%d\n", 
m
->
n_wÜds
);

1723 #ifdeà
COL_ORIENTED


1726 
	`´štf
 ("m->row=%p\n", 
m
->
row
);

1727 
	`´štf
 (" m->row sizğ%lu\n", 
m
->
n_rows
* *m->
row
);

1729 
	`´štf
 ("m->b™s=%p\n", 
m
->
b™s
);

1730 
	`´štf
 (" m->b™ sizğ%lu\n", 
m
->
n_wÜds
*m->
n_rows
* *m->
b™s
);

1731 
	`´štf
 ("sizeof(mod2wÜd)=%lu\n",  (
of_mod2wÜd
));

1732 
OF_EXIT_FUNCTION


1733 
	}
}

1736 
	$of_mod2d’£_xÜ_rows
(
of_mod2d’£
 *
m
, 
UINT16
 
äom
, UINT16 
to
)

1738 
UINT32
 
i
;

1739 
of_mod2wÜd
 *
f
;

1740 
of_mod2wÜd
 *
t
;

1742 
f
 = 
m
->
row
[
äom
];

1743 
t
 = 
m
->
row
[
to
];

1744 
i
 = 0; i < 
m
->
n_wÜds
; i++)

1746 
t
[
i
] ^ğ
f
[i];

1748 
	}
}

	@src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_dense.h

32 #iâdeà
MOD2DENSE_H


33 
	#MOD2DENSE_H


	)

36 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


41 
UINT32
 
	tof_mod2wÜd
;

44 
	#of_mod2_wÜdsize
 32

	)

47 
	#of_mod2_wÜdsize_shiá
 5

	)

48 
	#of_mod2_wÜdsize_mask
 0x1à

	)

51 
	#of_mod2_g‘b™
(
w
,
i
è(((w)>>(i))&1)

	)

54 
	#of_mod2_£tb™1
(
w
,
i
è((w)|(1<<(i)))

	)

57 
	#of_mod2_£tb™0
(
w
,
i
è((w)&(~(1<<(i))))

	)

70 
UINT32
 
	mn_rows
;

71 
UINT32
 
	mn_cŞs
;

73 
UINT32
 
	mn_wÜds
;

75 #ifdeà
COL_ORIENTED


76 
of_mod2wÜd
 **
	mcŞ
;

78 
of_mod2wÜd
 **
	mrow
;

80 
of_mod2wÜd
 *
	mb™s
;

82 } 
	tof_mod2d’£
;

87 
	#of_mod2d’£_rows
(
m
è((m)->
n_rows
è

	)

88 
	#of_mod2d’£_cŞs
(
m
è((m)->
n_cŞs
è

	)

93 
of_mod2d’£
 *
of_mod2d’£_®loÿ‹
 (
UINT32
, UINT32);

94 
of_mod2d’£_ä“
 (
of_mod2d’£
 *);

96 
of_mod2d’£_ş—r
 (
of_mod2d’£
 *);

97 
of_mod2d’£_cİy
 (
of_mod2d’£
 *, of_mod2dense *);

98 
of_mod2d’£_cİyrows
 (
of_mod2d’£
*, of_mod2d’£ *, 
UINT32
 *);

99 
of_mod2d’£_cİycŞs
 (
of_mod2d’£
*, of_mod2d’£ *, 
UINT32
 *);

101 
of_mod2d’£_´št
 (
FILE
 *, 
of_mod2d’£
 *);

102 
UINT32
 
of_mod2d’£_wr™e
 (
FILE
 *, 
of_mod2d’£
 *);

103 
of_mod2d’£
 *
of_mod2d’£_»ad
 (
FILE
 *);

105 
UINT32
 
of_mod2d’£_g‘
 (
of_mod2d’£
 *, UINT32, UINT32);

106 
INT32
 
of_mod2d’£_£t
 (
of_mod2d’£
 *, 
UINT32
, UINT32, UINT32);

107 
UINT32
 
of_mod2d’£_æ
 (
of_mod2d’£
 *, UINT32, UINT32);

109 
of_mod2d’£_Œª¥o£
 (
of_mod2d’£
 *, of_mod2dense *);

110 
of_mod2d’£_add
 (
of_mod2d’£
 *, of_mod2dense *, of_mod2dense *);

111 
of_mod2d’£_muÉly
 (
of_mod2d’£
 *, of_mod2dense *, of_mod2dense *);

113 
UINT32
 
of_mod2d’£_equ®
 (
of_mod2d’£
 *, of_mod2dense *);

115 
UINT32
 
of_mod2d’£_šv”t
 (
of_mod2d’£
 *, of_mod2dense *);

116 
UINT32
 
of_mod2d’£_fÜcibly_šv”t
 (
of_mod2d’£
 *, of_mod2dense *, UINT32 *, UINT32 *);

117 
UINT32
 
of_mod2d’£_šv”t_£Ëùed
 (
of_mod2d’£
 *, of_mod2dense *, UINT32 *, UINT32 *);

119 
UINT32
 
of_mod2d’£_ŒŸnguÏrize
 (
of_mod2d’£
 *, of_mod2dense *);

122 
of_mod2d’£_´št_b™m­
 (
of_mod2d’£
 *, *);

123 
of_mod2d’£_´št_memÜy_šfo
 (
of_mod2d’£
 *);

124 
of_mod2d’£_d’s™y
 (
of_mod2d’£
 *);

126 
boŞ
 
of_mod2d’£_row_is_em±y
 (
of_mod2d’£
 *
m
, 
UINT32
 
row
);

127 
UINT32
 
of_mod2wÜd_weight
 (
of_mod2wÜd
);

129 
UINT32
 
of_mod2d’£_row_weight
 (
of_mod2d’£
 *, UINT32);

130 
UINT32
 
of_mod2d’£_row_weight_ignÜe_fœ¡
 (
of_mod2d’£
 *
m
, UINT32 
i
, UINT32 
nb_ignÜe
);

131 
UINT32
 
of_mod2d’£_cŞ_weight
 (
of_mod2d’£
 *, UINT32);

133 
of_mod2d’£_´št_¡©s
 (
FILE
 *, 
of_mod2d’£
 *);

138 
of_mod2d’£_xÜ_rows
(
of_mod2d’£
 *
m
, 
UINT16
 
äom
, UINT16 
to
);

	@src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_sparse.c

17 
	~"../of_lš—r_bš¬y_code.h
"

20 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


22 
	#ROW_MAX_ENTRY
 50

	)

23 
	#COL_MAX_ENTRY
 1000

	)

28 
of_mod2¥¬£_d–‘e_İt
 (
of_mod2¥¬£
 *, 
of_mod2’Œy
 *, of_mod2entry **);

33 
of_mod2’Œy
 * 
of_mod2¥¬£_š£¹_İt
 (
of_mod2¥¬£
 *,

34 
UINT32
 ,

35 
UINT32
,

36 
of_mod2’Œy
 **
__·rsšg
);

45 
of_mod2’Œy
 *
	$of_®loc_’Œy
 (
of_mod2¥¬£
 *
m
)

48 
of_mod2block
 *
b
;

49 
of_mod2’Œy
 *
e
;

50 
INT32
 
k
;

52 ià(
m
->
Ãxt_ä“
 == 0)

54 
b
 = (
of_mod2block
*è
	`of_ÿÎoc
 (1,  * b);

56 
b
->
Ãxt
 = 
m
->
blocks
;

57 
m
->
blocks
 = 
b
;

59 
k
 = 0; k < 
of_mod2¥¬£_block
; k++)

61 
b
->
’Œy
[
k
].
Ëá
 = 
m
->
Ãxt_ä“
;

62 
m
->
Ãxt_ä“
 = &
b
->
’Œy
[
k
];

65 
e
 = 
m
->
Ãxt_ä“
;

66 
m
->
Ãxt_ä“
 = 
e
->
Ëá
;

68  
e
;

69 
	}
}

74 
of_mod2¥¬£
 *
	$of_mod2¥¬£_®loÿ‹
 (
UINT32
 
n_rows
,

75 
UINT32
 
n_cŞs
)

78 
of_mod2¥¬£
 *
m
;

79 
of_mod2’Œy
 *
e
;

80 
INT32
 
i
, 
j
;

82 ià(
n_rows
 <ğ0 || 
n_cŞs
 <= 0)

84 
	`OF_PRINT_ERROR
(("Inv®id‚umb” oàrow (%dèÜ cŞumn (%d)\nBÙh v®ue mu¡ b> 0.\n", 
n_rows
, 
n_cŞs
));

85 
OF_EXIT_FUNCTION


86  
NULL
;

89 
m
 = (
of_mod2¥¬£
*è
	`of_ÿÎoc
 (1,  * m);

91 
m
->
n_rows
 =‚_rows;

92 
m
->
n_cŞs
 =‚_cols;

93 
m
->
rows
 = (
of_mod2’Œy
*è
	`of_ÿÎoc
 (
n_rows
,  * m->rows);

94 
m
->
cŞs
 = (
of_mod2’Œy
*è
	`of_ÿÎoc
 (
n_cŞs
,  * m->cols);

95 
m
->
blocks
 = 0;

96 
m
->
Ãxt_ä“
 = 0;

98 
i
 = 0; i < 
n_rows
; i++)

100 
e
 = &
m
->
rows
[
i
];

101 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


102 
e
->
Ëá
 =ƒ->
right
 =ƒ->
up
 =ƒ->
down
 =ƒ;

104 
e
->
Ëá
 =ƒ->
right
 =ƒ->
down
 =ƒ;

106 
e
->
row
 =ƒ->
cŞ
 = -1;

109 
j
 = 0; j < 
n_cŞs
; j++)

111 
e
 = &
m
->
cŞs
[
j
];

112 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


113 
e
->
Ëá
 =ƒ->
right
 =ƒ->
up
 =ƒ->
down
 =ƒ;

115 
e
->
Ëá
 =ƒ->
right
 =ƒ->
down
 =ƒ;

117 
e
->
row
 =ƒ->
cŞ
 = -1;

120 #ifdeà
LDPC_QC


121 
m
->
exp_çùÜ
 = 1;

124  
m
;

125 
	}
}

129 
	$of_mod2¥¬£_ä“
 (
of_mod2¥¬£
 *
m
)

132 
of_mod2block
 *
b
;

134 
	`of_ä“
 (
m
->
rows
);

135 
	`of_ä“
 (
m
->
cŞs
);

137 
m
->
blocks
 != 0)

139 
b
 = 
m
->
blocks
;

140 
m
->
blocks
 = 
b
->
Ãxt
;

141 
	`of_ä“
 (
b
);

144 
	}
}

149 
	$of_mod2¥¬£_ş—r
 (
of_mod2¥¬£
 *
r
)

151 
of_mod2block
 *
b
;

152 
of_mod2’Œy
 *
e
;

153 
INT32
 
i
, 
j
;

155 
OF_ENTER_FUNCTION


156 
i
 = 0; i < 
	`of_mod2¥¬£_rows
 (
r
); i++)

158 
e
 = &
r
->
rows
[
i
];

159 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


160 
e
->
Ëá
 =ƒ->
right
 =ƒ->
up
 =ƒ->
down
 =ƒ;

162 
e
->
Ëá
 =ƒ->
right
 =ƒ->
down
 =ƒ;

166 
j
 = 0; j < 
	`of_mod2¥¬£_cŞs
 (
r
); j++)

168 
e
 = &
r
->
cŞs
[
j
];

169 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


170 
e
->
Ëá
 =ƒ->
right
 =ƒ->
up
 =ƒ->
down
 =ƒ;

172 
e
->
Ëá
 =ƒ->
right
 =ƒ->
down
 =ƒ;

176 
r
->
blocks
 != 0)

178 
b
 = 
r
->
blocks
;

179 
r
->
blocks
 = 
b
->
Ãxt
;

180 
	`ä“
 (
b
);

182 
OF_EXIT_FUNCTION


183 
	}
}

188 
	$of_mod2¥¬£_cİy
 (
of_mod2¥¬£
 *
m
,

189 
of_mod2¥¬£
 *
r
)

191 
OF_ENTER_FUNCTION


192 
of_mod2’Œy
 *
e
, *
f
;

193 
INT32
 
i
;

195 ià(
	`of_mod2¥¬£_rows
 (
m
è> of_mod2¥¬£_row (
r
)

196 || 
	`of_mod2¥¬£_cŞs
 (
m
è> of_mod2¥¬£_cŞ (
r
))

198 
	`OF_PRINT_ERROR
(("Destination matrix isoo small"));

202 
	`of_mod2¥¬£_ş—r
 (
r
);

204 
i
 = 0; i < 
	`of_mod2¥¬£_rows
 (
m
); i++)

206 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
i
);

208 !
	`of_mod2¥¬£_©_’d
 (
e
))

210 
f
 = 
	`of_mod2¥¬£_š£¹
 (
r
, 
e
->
row
,ƒ->
cŞ
);

211 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e);

214 
OF_EXIT_FUNCTION


215 
	}
}

220 
	$of_mod2¥¬£_cİyrows
 (
of_mod2¥¬£
 *
m
,

221 
of_mod2¥¬£
 *
r
,

222 
UINT32
 *
rows
)

224 
of_mod2’Œy
 *
e
;

225 
INT32
 
i
;

227 
OF_ENTER_FUNCTION


228 ià(
	`of_mod2¥¬£_cŞs
 (
m
è> of_mod2¥¬£_cŞ (
r
))

230 
	`OF_PRINT_ERROR
(("Destination matrix has fewer columnshan source"));

231 
OF_EXIT_FUNCTION


235 
	`of_mod2¥¬£_ş—r
 (
r
);

237 
i
 = 0; i < 
	`of_mod2¥¬£_rows
 (
r
); i++)

239 ià(
rows
[
i
] >ğ
	`of_mod2¥¬£_rows
 (
m
))

241 
	`OF_PRINT_ERROR
(("Row index out of„ange"));

242 
OF_EXIT_FUNCTION


245 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
rows
[
i
]);

246 !
	`of_mod2¥¬£_©_’d
 (
e
))

248 
	`of_mod2¥¬£_š£¹
 (
r
, 
i
, 
e
->
cŞ
);

249 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e);

252 
OF_EXIT_FUNCTION


253 
	}
}

256 
	$of_mod2¥¬£_cİyrows_İt
 (
of_mod2¥¬£
 *
m
,

257 
of_mod2¥¬£
 *
r
,

258 
UINT32
 *
rows
,

259 
of_mod2’Œy
 **
__·rsšg
)

261 
of_mod2’Œy
 * 
__š£¹ed
;

262 
boŞ
 
__was_nuÎ
 = 
çl£
;

263 
of_mod2’Œy
 * 
__e
;

264 
INT32
 
i
;

266 
OF_ENTER_FUNCTION


267 ià(
	`of_mod2¥¬£_cŞs
 (
m
è> of_mod2¥¬£_cŞ (
r
))

269 
	`OF_PRINT_ERROR
(("Destination matrix has fewer columnshan source"));

270 
OF_EXIT_FUNCTION


274 ià(
__·rsšg
 =ğ
NULL
)

276 
__was_nuÎ
 = 
Œue
;

277 
__·rsšg
 = (
of_mod2’Œy
 **è
	`of_ÿÎoc
 (
	`of_mod2¥¬£_cŞs
 (
m
),  (of_mod2entry *));

282 
i
 = 0 ; i < 
	`of_mod2¥¬£_rows
 (
r
) ; i++)

285 ià(
rows
[
i
] >ğ
	`of_mod2¥¬£_rows
 (
m
))

287 
	`OF_PRINT_LVL
 (1, ("mod2¥¬£_cİyrows_İt: Row index ouˆoà¿nge:„ows[i] = %d\n", 
rows
[
i
]))

288 
	`OF_PRINT_ERROR
(("Row index out of„ange"));

291 
__e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
rows
[
i
]);

292 !
	`of_mod2¥¬£_©_’d_row
 (
__e
))

294 
__š£¹ed
 = 
	`of_mod2¥¬£_š£¹_İt
 (
r
, 
i
, 
	`of_mod2¥¬£_cŞ
 (
__e
), 
__·rsšg
);

295 ià(
__was_nuÎ
 =ğ
Œue
)

297 
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
__e
è] = 
__š£¹ed
;

300 
__e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__e);

304 ià(
__was_nuÎ
 =ğ
Œue
)

306 
	`of_ä“
 (
__·rsšg
);

307 
__·rsšg
 = 
NULL
;

309 
OF_EXIT_FUNCTION


310 
	}
}

315 
	$of_mod2¥¬£_cİycŞs
 (
of_mod2¥¬£
 *
m
,

316 
of_mod2¥¬£
 *
r
,

317 
UINT32
 *
cŞs
)

319 
of_mod2’Œy
 *
e
;

320 
INT32
 
j
;

322 
OF_ENTER_FUNCTION


323 ià(
	`of_mod2¥¬£_rows
 (
m
è> of_mod2¥¬£_row (
r
))

325 
	`OF_PRINT_ERROR
(("Destination matrix has fewer„owshan source"));

326 
OF_EXIT_FUNCTION


330 
	`of_mod2¥¬£_ş—r
 (
r
);

332 
j
 = 0; j < 
	`of_mod2¥¬£_cŞs
 (
r
); j++)

335 ià(
cŞs
[
j
] >ğ
	`of_mod2¥¬£_cŞs
 (
m
))

337 
	`OF_PRINT_ERROR
(("Column index out of„ange"));

338 
	`OF_PRINT_LVL
 (1, (" mod2¥¬£_cİycŞs: CŞumÀšdex ouˆoà¿ngcŞs[j] = %d\n", 
cŞs
[
j
]))

339 
OF_EXIT_FUNCTION


342 
e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
cŞs
[
j
]);

343 !
	`of_mod2¥¬£_©_’d
 (
e
))

345 
	`of_mod2¥¬£_š£¹
 (
r
, 
e
->
row
, 
j
);

346 
e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e);

349 
OF_EXIT_FUNCTION


350 
	}
}

353 
	$of_mod2¥¬£_cİycŞs_İt
 (
of_mod2¥¬£
 *
m
,

354 
of_mod2¥¬£
 *
r
,

355 
UINT32
 *
cŞs
)

357 
of_mod2’Œy
 ** 
__·rsšg
;

358 
of_mod2’Œy
 * 
__š£¹ed
;

359 
of_mod2’Œy
 * 
__e
;

360 
INT32
 
j
;

362 
OF_ENTER_FUNCTION


363 ià(
	`of_mod2¥¬£_rows
 (
m
è> of_mod2¥¬£_row (
r
))

365 
	`OF_PRINT_ERROR
(("Destination matrix has fewer„owshan source"));

366 
OF_EXIT_FUNCTION


371 
__·rsšg
 = (
of_mod2’Œy
 **è
	`of_ÿÎoc
 (
	`of_mod2¥¬£_cŞs
 (
r
),  (of_mod2entry *));

373 
j
 = 0 ; j < 
	`of_mod2¥¬£_cŞs
 (
r
) ; j++)

376 ià(
cŞs
[
j
] >ğ
	`of_mod2¥¬£_cŞs
 (
m
))

378 
	`OF_PRINT_ERROR
(("Column index out of„ange"));

379 
	`OF_PRINT_LVL
 (1, (" mod2¥¬£_cİycŞs: CŞumÀšdex ouˆoà¿ngcŞs[j] = %d\n", 
cŞs
[
j
]))

380 
OF_EXIT_FUNCTION


384 
__e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
cŞs
[
j
]);

385 !
	`of_mod2¥¬£_©_’d_cŞ
 (
__e
))

387 
__š£¹ed
 = 
	`of_mod2¥¬£_š£¹_İt
 (
r
, 
	`of_mod2¥¬£_row
 (
__e
), 
j
, 
__·rsšg
);

388 
__·rsšg
[
j
] = 
__š£¹ed
;

389 
__e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (__e);

393 
	`of_ä“
 (
__·rsšg
);

394 
__·rsšg
 = 
NULL
;

395 
OF_EXIT_FUNCTION


396 
	}
}

402 
	$of_mod2¥¬£_m©rix_¡©s
 (
FILE
 *
f
,

403 
of_mod2¥¬£
 *
m
,

404 
UINT32
 
nb_¤c
 ,

405 
UINT32
 
nb_·r
)

407 
of_mod2’Œy
 *
e
;

408 
INT32
 
i
;

409 
d’s™y
 = 0;

410 
row_d’s™y
 = 0;

411 
cŞ_d’s™y
 = 0;

414 
av”_nb_’Œy_³r_row
 = 0;

415 
INT32
 
max_’Œy_³r_row
 = 0;

416 
INT32
 
mš_’Œy_³r_row
 = 9999999;

417 
INT32
 
nb_’Œy_row
[
ROW_MAX_ENTRY
];

418 
INT32
 
nb_’Œy_cu¼’t_row
 = 0;

419 
INT32
 
ùr
 = 0;

422 
av”_nb_’Œy_³r_cŞ
 = 0;

423 
INT32
 
max_’Œy_³r_cŞ
 = 0;

424 
INT32
 
mš_’Œy_³r_cŞ
 = 9999999;

425 
INT32
 
nb_’Œy_cŞ
[
COL_MAX_ENTRY
];

426 
INT32
 
max_’Œy_³r_d©a_cŞ
 = 0;

427 
INT32
 
mš_’Œy_³r_d©a_cŞ
 = 9999999;

428 
INT32
 
max_’Œy_³r_·r™y_cŞ
 = 0;

429 
INT32
 
mš_’Œy_³r_·r™y_cŞ
 = 9999999;

430 
INT32
 
nb_’Œy_d©a_cŞ
[
COL_MAX_ENTRY
];

431 
INT32
 
nb_’Œy_·r™y_cŞ
[
COL_MAX_ENTRY
];

432 
INT32
 
nb_’Œy_cu¼’t_cŞ
 = 0;

434 
OF_ENTER_FUNCTION


436 
	`mem£t
(
nb_’Œy_row
, 0, (*nb_entry_row));

438 
i
 = 0; i < 
	`of_mod2¥¬£_rows
 (
m
); i++)

440 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
i
);

441 !
	`of_mod2¥¬£_©_’d
 (
e
))

443 
nb_’Œy_cu¼’t_row
++;

444 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e);

447 
nb_’Œy_row
[
nb_’Œy_cu¼’t_row
]++;

449 ià(
nb_’Œy_cu¼’t_row
 < 
mš_’Œy_³r_row
)

451 
mš_’Œy_³r_row
 = 
nb_’Œy_cu¼’t_row
;

453 ià(
nb_’Œy_cu¼’t_row
 > 
max_’Œy_³r_row
)

455 
max_’Œy_³r_row
 = 
nb_’Œy_cu¼’t_row
;

458 
ùr
 +ğ
nb_’Œy_cu¼’t_row
;

459 
nb_’Œy_cu¼’t_row
 = 0;

462 
av”_nb_’Œy_³r_row
 = ( (è
ùr
è/ 
	`of_mod2¥¬£_rows
 (
m
);

463 
row_d’s™y
 = 
av”_nb_’Œy_³r_row
 / (
	`of_mod2¥¬£_cŞs
 (
m
));

466 
ùr
 = 0;

467 
	`mem£t
(
nb_’Œy_cŞ
, 0, (*nb_entry_col));

468 
	`mem£t
(
nb_’Œy_d©a_cŞ
, 0, (*nb_entry_data_col));

469 
	`mem£t
(
nb_’Œy_·r™y_cŞ
, 0, (*nb_entry_parity_col));

471 
i
 = 0; i < 
	`of_mod2¥¬£_cŞs
 (
m
); i++)

473 
e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
i
);

474 !
	`of_mod2¥¬£_©_’d
 (
e
))

476 
nb_’Œy_cu¼’t_cŞ
++;

477 
e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e);

480 
nb_’Œy_cŞ
[
nb_’Œy_cu¼’t_cŞ
]++;

481 ià(
nb_’Œy_cu¼’t_cŞ
 == 1)

485 ià(
nb_’Œy_cu¼’t_cŞ
 == 0)

489 ià(
i
 < 
nb_·r
)

493 ià(
nb_’Œy_cu¼’t_cŞ
 < 
mš_’Œy_³r_·r™y_cŞ
)

495 
mš_’Œy_³r_·r™y_cŞ
 = 
nb_’Œy_cu¼’t_cŞ
;

497 ià(
nb_’Œy_cu¼’t_cŞ
 > 
max_’Œy_³r_·r™y_cŞ
)

499 
max_’Œy_³r_·r™y_cŞ
 = 
nb_’Œy_cu¼’t_cŞ
;

501 
nb_’Œy_·r™y_cŞ
[
nb_’Œy_cu¼’t_cŞ
]++;

506 ià(
nb_’Œy_cu¼’t_cŞ
 < 
mš_’Œy_³r_d©a_cŞ
)

508 
mš_’Œy_³r_d©a_cŞ
 = 
nb_’Œy_cu¼’t_cŞ
;

510 ià(
nb_’Œy_cu¼’t_cŞ
 > 
max_’Œy_³r_d©a_cŞ
)

512 
max_’Œy_³r_d©a_cŞ
 = 
nb_’Œy_cu¼’t_cŞ
;

514 
nb_’Œy_d©a_cŞ
[
nb_’Œy_cu¼’t_cŞ
]++;

517 ià(
nb_’Œy_cu¼’t_cŞ
 < 
mš_’Œy_³r_cŞ
)

519 
mš_’Œy_³r_cŞ
 = 
nb_’Œy_cu¼’t_cŞ
;

521 ià(
nb_’Œy_cu¼’t_cŞ
 > 
max_’Œy_³r_cŞ
)

523 
max_’Œy_³r_cŞ
 = 
nb_’Œy_cu¼’t_cŞ
;

526 
ùr
 +ğ
nb_’Œy_cu¼’t_cŞ
;

527 
nb_’Œy_cu¼’t_cŞ
 = 0;

530 
av”_nb_’Œy_³r_cŞ
 = ( (è
ùr
è/ 
	`of_mod2¥¬£_cŞs
 (
m
);

532 
cŞ_d’s™y
 = 
av”_nb_’Œy_³r_cŞ
 / (
	`of_mod2¥¬£_rows
 (
m
));

534 
d’s™y
 = 
cŞ_d’s™y
;

538 
	`årštf
 (
f
, "‚b_cŞ=%d‚b_row=%d \n", 
	`of_mod2¥¬£_cŞs
 (
m
), 
	`of_mod2¥¬£_rows
 (m));

539 
	`årštf
 (
f
, "„ow_d’s™y=%à\n", 
row_d’s™y
);

541 
	`årštf
 (
f
, "‡v”_nb_’Œy_³r_row=%à\n", 
av”_nb_’Œy_³r_row
);

542 
	`årštf
 (
f
, " mš_’Œy_³r_row=%d \n", 
mš_’Œy_³r_row
);

543 
	`årštf
 (
f
, " max_’Œy_³r_row=%d \n", 
max_’Œy_³r_row
);

544 
i
 = 
mš_’Œy_³r_row
;˜<ğ
max_’Œy_³r_row
;i++)

546 
	`årštf
 (
f
, "‚b_’Œy_row[%d]=%d \n", 
i
, 
nb_’Œy_row
[i]);

549 
	`årštf
 (
f
, "------------------ \n");

550 
	`årštf
 (
f
, " cŞ_d’s™y=%à\n", 
cŞ_d’s™y
);

551 
	`årštf
 (
f
, "‡v”_nb_’Œy_³r_cŞ=%à\n", 
av”_nb_’Œy_³r_cŞ
);

552 
	`årštf
 (
f
, " mš_’Œy_³r_cŞ=%d \n", 
mš_’Œy_³r_cŞ
);

553 
	`årštf
 (
f
, " max_’Œy_³r_cŞ=%d \n", 
max_’Œy_³r_cŞ
);

554 
i
 = 
mš_’Œy_³r_cŞ
;˜<ğ
max_’Œy_³r_cŞ
;i++)

556 ià(
nb_’Œy_cŞ
[
i
] > 0)

558 
	`årštf
 (
f
, "‚b_’Œy_cŞ[%d]=%d \n", 
i
, 
nb_’Œy_cŞ
[i]);

561 
	`årštf
 (
f
, "------- \n");

562 
	`årštf
 (
f
, " mš_’Œy_³r_d©a_cŞ=%d \n", 
mš_’Œy_³r_d©a_cŞ
);

563 
	`årštf
 (
f
, " max_’Œy_³r_d©a_cŞ=%d \n", 
max_’Œy_³r_d©a_cŞ
);

564 
i
 = 
mš_’Œy_³r_d©a_cŞ
;˜<ğ
max_’Œy_³r_d©a_cŞ
;i++)

566 ià(
nb_’Œy_d©a_cŞ
[
i
] > 0)

568 
	`årštf
 (
f
, "‚b_’Œy_d©a_cŞ[%d]=%d \n", 
i
, 
nb_’Œy_d©a_cŞ
[i]);

571 
	`årštf
 (
f
, "------- \n");

573 
	`årštf
 (
f
, " mš_’Œy_³r_·r™y_cŞ=%d \n", 
mš_’Œy_³r_·r™y_cŞ
);

574 
	`årštf
 (
f
, " max_’Œy_³r_·r™y_cŞ=%d \n", 
max_’Œy_³r_·r™y_cŞ
);

575 
i
 = 
mš_’Œy_³r_·r™y_cŞ
;˜<ğ
max_’Œy_³r_·r™y_cŞ
;i++)

577 ià(
nb_’Œy_·r™y_cŞ
[
i
] > 0)

579 
	`årštf
 (
f
, "‚b_’Œy_·r™y_cŞ[%d]=%d \n", 
i
, 
nb_’Œy_·r™y_cŞ
[i]);

582 
	`årštf
 (
f
, "------------------ \n");

584 
	`årštf
 (
f
, " m©rix_d’s™y=%à\n", 
d’s™y
);

585 
OF_EXIT_FUNCTION


586 
	}
}

589 
	$of_mod2¥¬£_´štf
 (
FILE
 * 
fout
,

590 
of_mod2¥¬£
 * 
m
)

592 
INT32
 
__row
;

594 
OF_ENTER_FUNCTION


595 
__row
 = 0 ; __row < 
	`of_mod2¥¬£_rows
 (
m
) ; __row++)

597 
INT32
 
__cŞ
;

598 
__cŞ
 = 0 ; __cŞ < 
	`of_mod2¥¬£_cŞs
 (
m
) ; __col++)

600 ià(
	`of_mod2¥¬£_fšd
 (
m
, 
__row
, 
__cŞ
è!ğ
NULL
)

601 
	`årštf
 (
fout
, "1");

604 
	`årštf
 (
fout
, " ");

606 
	`årštf
 (
fout
, "\n");

607 
OF_EXIT_FUNCTION


609 
	}
}

612 
	$of_mod2¥¬£_´št_b™m­
 (
of_mod2¥¬£
 * 
m
)

614 
UINT32
 
i
;

615 
UINT32
 
x
;

616 
UINT32
 
y
;

617 
UINT32
 
row
;

618 
UINT32
 
cŞ
;

619 
UINT32
 
v®
 = 1;

620 
of_mod2’Œy
 *
e
;

621 #ifdeà
IL_SUPPORT


622 
ILušt
 
lImage
;

624 
	`In™
();

625 
	`G’Images
(1, &
lImage
);

626 
	`BšdImage
(
lImage
);

628 
	`TexImage
(
	`of_mod2¥¬£_cŞs
(
m
), 
	`of_mod2¥¬£_rows
(m), 1, 3, 
IL_RGB
, 
IL_UNSIGNED_BYTE
, 
NULL
);

631 
OF_ENTER_FUNCTION


632 
y
 = 
	`of_mod2d’£_rows
 (
m
);

633 
x
 = 
	`of_mod2d’£_cŞs
 (
m
);

634 
row
 = 0;„ow < 
	`of_mod2¥¬£_rows
(
m
);„ow++)

636 
cŞ
 = 0; cŞ < 
	`of_mod2¥¬£_cŞs
(
m
); col++)

638 
v®
 = 0;

639 
x
 = 
cŞ
;

640 
y
 = 
	`of_mod2¥¬£_rows
(
m
è- 
row
 - 1;

641 #ifdeà
IL_SUPPORT


642 
	`S‘Pix–s
(
x
, 
y
, 0, 1, 1, 1, 
IL_RGBA
, 
IL_UNSIGNED_BYTE
, &
v®
);

646 
i
 = 0; i < 
	`of_mod2¥¬£_rows
 (
m
); i++)

648 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
i
);

649 !
	`of_mod2¥¬£_©_’d_row
 (
e
))

651 
v®
 = 0xFFFFFF;

652 
row
 = 
	`of_mod2¥¬£_row
(
e
);

653 
cŞ
 = 
	`of_mod2¥¬£_cŞ
(
e
);

654 
x
 = 
cŞ
;

655 
y
 = 
	`of_mod2¥¬£_rows
(
m
è- 
row
 - 1;

656 #ifdeà
IL_SUPPORT


657 
	`S‘Pix–s
(
x
 ,
y
, 0, 1, 1, 1, 
IL_RGBA
, 
IL_UNSIGNED_BYTE
, &
v®
);

659 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
(e);

665 #ifdef 
IL_SUPPORT


666 
	`EÇbË
(
IL_FILE_OVERWRITE
);

667 
	`SaveImage
("sparse.bmp");

669 
	`sy¡em
("open sparse.bmp");

672 
OF_EXIT_FUNCTION


673 
	}
}

678 
	gof_mod2¥¬£_´št


679 (
FILE
 *
	gf
,

680 
of_mod2¥¬£
 *
	gm


683 
OF_ENTER_FUNCTION


684 
INT32
 
	grdig™s
, 
	gcdig™s
;

685 
of_mod2’Œy
 *
	ge
;

686 
INT32
 
	gi
;

688 
	grdig™s
 = 
of_mod2¥¬£_rows
 (
m
) <= 10 ? 1

689 : 
of_mod2¥¬£_rows
 (
m
) <= 100 ? 2

690 : 
of_mod2¥¬£_rows
 (
m
) <= 1000 ? 3

691 : 
of_mod2¥¬£_rows
 (
m
) <= 10000 ? 4

692 : 
of_mod2¥¬£_rows
 (
m
) <= 100000 ? 5

695 
	gcdig™s
 = 
of_mod2¥¬£_cŞs
 (
m
) <= 10 ? 1

696 : 
of_mod2¥¬£_cŞs
 (
m
) <= 100 ? 2

697 : 
of_mod2¥¬£_cŞs
 (
m
) <= 1000 ? 3

698 : 
of_mod2¥¬£_cŞs
 (
m
) <= 10000 ? 4

699 : 
of_mod2¥¬£_cŞs
 (
m
) <= 100000 ? 5

702 
	gi
 = 0; i < 
of_mod2¥¬£_rows
 (
m
); i++)

704 
årštf
 (
f
, "%*d:", 
rdig™s
, 
i
);

706 
	ge
 = 
of_mod2¥¬£_fœ¡_š_row
 (
m
, 
i
);

707 !
of_mod2¥¬£_©_’d
 (
e
))

709 
årštf
 (
f
, " %*d", 
cdig™s
, 
of_mod2¥¬£_cŞ
 (
e
));

710 
	ge
 = 
of_mod2¥¬£_Ãxt_š_row
 (
e
);

713 
årštf
 (
f
, "\n");

715 
	gOF_EXIT_FUNCTION


722 
INT32
 
	gmod2¥¬£_wr™e


723 (
FILE
 *
	gf
,

724 
of_mod2¥¬£
 *
	gm


727 
OF_ENTER_FUNCTION


728 
of_mod2’Œy
 *
	ge
;

729 
INT32
 
	gi
;

731 
of_štio_wr™e
 (
f
, 
m
->
n_rows
);

732 ià(
ã¼Ü
 (
f
))

734 
OF_EXIT_FUNCTION


738 
of_štio_wr™e
 (
f
, 
m
->
n_cŞs
);

739 ià(
ã¼Ü
 (
f
))

741 
OF_EXIT_FUNCTION


745 
	gi
 = 0; i < 
of_mod2¥¬£_rows
 (
m
); i++)

747 
	ge
 = 
of_mod2¥¬£_fœ¡_š_row
 (
m
, 
i
);

749 ià(!
of_mod2¥¬£_©_’d
 (
e
))

751 
of_štio_wr™e
 (
f
, - (
i
 + 1));

752 ià(
ã¼Ü
 (
f
))

754 
OF_EXIT_FUNCTION


758 !
of_mod2¥¬£_©_’d
 (
e
))

760 
of_štio_wr™e
 (
f
, 
of_mod2¥¬£_cŞ
 (
e
) + 1);

761 ià(
ã¼Ü
 (
f
))

763 
OF_EXIT_FUNCTION


767 
	ge
 = 
of_mod2¥¬£_Ãxt_š_row
 (
e
);

772 
of_štio_wr™e
 (
f
, 0);

773 ià(
ã¼Ü
 (
f
))

775 
OF_EXIT_FUNCTION


779 
OF_EXIT_FUNCTION


786 
of_mod2¥¬£
 *
	gmod2¥¬£_»ad


787 (
FILE
 *
	gf


790 
OF_ENTER_FUNCTION


791 
INT32
 
	gn_rows
, 
	gn_cŞs
;

792 
of_mod2¥¬£
 *
	gm
;

793 
INT32
 
	gv
, 
	grow
, 
	gcŞ
;

795 
	gn_rows
 = 
of_štio_»ad
 (
f
);

796 ià(
ãof
 (
f
è|| 
ã¼Ü
 (fè|| 
	gn_rows
 <= 0)

798 
OF_EXIT_FUNCTION


802 
	gn_cŞs
 = 
of_štio_»ad
 (
f
);

803 ià(
ãof
 (
f
è|| 
ã¼Ü
 (fè|| 
	gn_cŞs
 <= 0)

805 
OF_EXIT_FUNCTION


809 
	gm
 = 
of_mod2¥¬£_®loÿ‹
 (
n_rows
, 
n_cŞs
);

811 
	grow
 = -1;

815 
	gv
 = 
of_štio_»ad
 (
f
);

816 ià(
ãof
 (
f
è|| 
ã¼Ü
 (f))

819 ià(
	gv
 == 0)

821 
OF_EXIT_FUNCTION


822  
m
;

825 ià(
	gv
 < 0)

827 
	grow
 = -
v
 - 1;

828 ià(
	grow
 >ğ
n_rows
)

833 
	gcŞ
 = 
v
 - 1;

834 ià(
	gcŞ
 >ğ
n_cŞs
)

836 ià(
	grow
 == -1)

838 
of_mod2¥¬£_š£¹
 (
m
, 
row
, 
cŞ
);

844 
of_mod2¥¬£_ä“
 (
m
);

845 
OF_EXIT_FUNCTION


853 
UINT32
 
	$of_mod2¥¬£_wr™e_humª_»adabË
 (
FILE
 *
f
,

854 
of_mod2¥¬£
 *
m
,

855 
UINT32
 
nb_sourû
,

856 
UINT32
 
nb_·r™y
)

858 
of_mod2’Œy
 *
e
;

859 
INT32
 
i
, 
cŞ_idx
, 
c
;

860 
bufãr
 [20];

861 
INT32
 
¡r_Ëngth
;

863 
OF_ENTER_FUNCTION


864 
	`mem£t
 (
bufãr
, 0, 5);

866 
¡r_Ëngth
 = 
	`¥rštf
 (
bufãr
, " %d\n", 
m
->
n_rows
);

867 
	`fwr™e
 (
bufãr
, 
¡r_Ëngth
, 1, 
f
);

868 ià(
	`ã¼Ü
 (
f
))

870 
OF_EXIT_FUNCTION


874 
¡r_Ëngth
 = 
	`¥rštf
 (
bufãr
, " %d\n", 
m
->
n_cŞs
);

875 
	`fwr™e
 (
bufãr
, 
¡r_Ëngth
, 1, 
f
);

876 ià(
	`ã¼Ü
 (
f
))

878 
OF_EXIT_FUNCTION


882 
¡r_Ëngth
 = 
	`¥rštf
 (
bufãr
, " %d\n", 
nb_sourû
);

883 
	`fwr™e
 (
bufãr
, 
¡r_Ëngth
, 1, 
f
);

884 ià(
	`ã¼Ü
 (
f
))

886 
OF_EXIT_FUNCTION


890 
¡r_Ëngth
 = 
	`¥rštf
 (
bufãr
, " %d", 
nb_·r™y
);

891 
	`fwr™e
 (
bufãr
, 
¡r_Ëngth
, 1, 
f
);

892 ià(
	`ã¼Ü
 (
f
))

894 
OF_EXIT_FUNCTION


898 
i
 = 0; i < 
	`of_mod2¥¬£_rows
 (
m
); i++)

900 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
i
);

901 ià(!
	`of_mod2¥¬£_©_’d
 (
e
))

903 
¡r_Ëngth
 = 
	`¥rštf
 (
bufãr
, "\À%5d", 
i
);

904 
	`fwr™e
 (
bufãr
, 
¡r_Ëngth
, 1, 
f
);

905 ià(
	`ã¼Ü
 (
f
))

907 
OF_EXIT_FUNCTION


911 !
	`of_mod2¥¬£_©_’d
 (
e
))

913 
c
 = 
	`of_mod2¥¬£_cŞ
 (
e
);

914 ià(
c
 >ğ
nb_·r™y
)

916 
cŞ_idx
 = 
c
 - 
nb_·r™y
;

917 
¡r_Ëngth
 = 
	`¥rštf
 (
bufãr
, " %7d ", 
cŞ_idx
);

918 
	`fwr™e
 (
bufãr
, 
¡r_Ëngth
, 1, 
f
);

919 ià(
	`ã¼Ü
 (
f
))

921 
OF_EXIT_FUNCTION


925 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e);

928 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
i
);

929 !
	`of_mod2¥¬£_©_’d
 (
e
))

931 
c
 = 
	`of_mod2¥¬£_cŞ
 (
e
);

932 ià(
c
 < 
nb_·r™y
)

934 
cŞ_idx
 = 
nb_sourû
 + 
c
;

935 
¡r_Ëngth
 = 
	`¥rštf
 (
bufãr
, " %7d ", 
cŞ_idx
);

936 
	`fwr™e
 (
bufãr
, 
¡r_Ëngth
, 1, 
f
);

937 ià(
	`ã¼Ü
 (
f
))

939 
OF_EXIT_FUNCTION


943 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e);

948 ià(
	`ã¼Ü
 (
f
))

950 
OF_EXIT_FUNCTION


953 
OF_EXIT_FUNCTION


955 
	}
}

971 
of_mod2¥¬£
 *
	$of_mod2¥¬£_»ad_humª_»adabË
 (
FILE
 *
f
,

972 
UINT32
 *
nb_sourû
,

973 
UINT32
 *
nb_·r™y
)

975 
UINT32
 
n_rows
 = 0;

976 
UINT32
 
n_cŞs
 = 0;

977 
of_mod2¥¬£
 *
m
;

978 
INT32
 
cŞ
;

979 
INT32
 
cu»Á_lše
;

980 
INT32
 
tmp
;

981 *
pch
;

982 
lše
[1024];

984 
OF_ENTER_FUNCTION


986 ià(
	`fg‘s
 (
lše
, †še, 
f
è!ğ
NULL
)

989 
pch
 = 
	`¡¹ok
 (
lše
, " ");

990 
n_rows
 = 
	`©oi
 (
pch
);

994 ià(
	`fg‘s
 (
lše
, †še, 
f
è!ğ
NULL
)

997 
pch
 = 
	`¡¹ok
 (
lše
, " ");

998 
n_cŞs
 = 
	`©oi
 (
pch
);

1002 ià(
	`fg‘s
 (
lše
, †še, 
f
è!ğ
NULL
)

1005 
pch
 = 
	`¡¹ok
 (
lše
, " ");

1006 *
nb_sourû
 = 
	`©oi
 (
pch
);

1010 ià(
	`fg‘s
 (
lše
, †še, 
f
è!ğ
NULL
)

1013 
pch
 = 
	`¡¹ok
 (
lše
, " ");

1014 *
nb_·r™y
 = 
	`©oi
 (
pch
);

1017 
	`OF_TRACE_LVL
 (1, ("Äowsğ%d‚cŞ = %d‚b_¤cğ%d‚b_·rğ%d \n", 
n_rows
, 
n_cŞs
, *
nb_sourû
, *
nb_·r™y
))

1018 iàĞ(*
nb_·r™y
 + *
nb_sourû
 < 
n_cŞs
è|| (*nb_·r™y < 
n_rows
))

1021 
	`OF_PRINT_ERROR
(("error„ead file invalid‚b_parity‚b_source "));

1022 
OF_EXIT_FUNCTION


1023  
NULL
;

1027 
m
 = 
	`of_mod2¥¬£_®loÿ‹
 (
n_rows
, 
n_cŞs
);

1029 
cu»Á_lše
 = 0;

1031 
	`fg‘s
 (
lše
, †še, 
f
è!ğ
NULL
)

1033 
size_t
 
i
 = 
	`¡r¥n
 (
lše
, " \t\n\v");

1035 ià(
lše
[
i
] == '#')

1040 
pch
 = 
	`¡¹ok
 (
lše
, " ");

1043 
tmp
 = 
	`©oi
 (
pch
);

1045 ià(
tmp
 !ğ
cu»Á_lše
)

1047 
	`årštf
 (
¡d”r
, "E¼Ü„—dšg fe:„—dšg†š%d should b%d\n", 
tmp
, 
cu»Á_lše
);

1048 
OF_EXIT_FUNCTION


1049  
NULL
;

1053 
pch
 = 
	`¡¹ok
 (
NULL
, " ");

1054 
pch
 !ğ
NULL
)

1056 ià(
	`¡rcmp
 (
pch
, "\n") != 0)

1060 
tmp
 = 
	`©oi
 (
pch
);

1063 ià(
tmp
 < *
nb_sourû
)

1065 
cŞ
 = 
tmp
 + *
nb_·r™y
;

1069 
cŞ
 = 
tmp
 - *
nb_sourû
;

1071 
	`of_mod2¥¬£_š£¹
 (
m
, 
cu»Á_lše
, 
cŞ
);

1078 
pch
 = 
	`¡¹ok
 (
NULL
, " ");

1080 
cu»Á_lše
++;

1083 
OF_EXIT_FUNCTION


1084  
m
;

1085 
	}
}

1090 
of_mod2’Œy
 *
	$of_mod2¥¬£_fšd
 (
of_mod2¥¬£
 *
m
,

1091 
UINT32
 
row
,

1092 
UINT32
 
cŞ
)

1095 
of_mod2’Œy
 *
»
, *
û
;

1098 ià(
row
 >ğ
	`of_mod2¥¬£_rows
 (
m
è|| 
cŞ
 >ğ
	`of_mod2¥¬£_cŞs
 (m))

1100 
	`årštf
 (
¡d”r
, "mod2sparse_find:„ow or column index out of bounds\n");

1101 
OF_EXIT_FUNCTION


1102  
NULL
;

1107 
»
 = 
	`of_mod2¥¬£_Ï¡_š_row
 (
m
, 
row
);

1108 ià(
	`of_mod2¥¬£_©_’d
 (
»
è|| 
	`of_mod2¥¬£_cŞ
 (»è< 
cŞ
)

1113 ià(
	`of_mod2¥¬£_cŞ
 (
»
è=ğ
cŞ
)

1116  
»
;

1119 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1120 
û
 = 
	`of_mod2¥¬£_Ï¡_š_cŞ
 (
m
, 
cŞ
);

1121 ià(
	`of_mod2¥¬£_©_’d
 (
û
è|| 
	`of_mod2¥¬£_row
 (ûè< 
row
)

1126 ià(
	`of_mod2¥¬£_row
 (
û
è=ğ
row
)

1129  
û
;

1135 
»
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row
);

1136 
û
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
cŞ
);

1140 ià(
	`of_mod2¥¬£_©_’d
 (
»
è|| 
	`of_mod2¥¬£_cŞ
 (»è> 
cŞ
)

1145 ià(
	`of_mod2¥¬£_cŞ
 (
»
è=ğ
cŞ
)

1148  
»
;

1151 ià(
	`of_mod2¥¬£_©_’d
 (
û
è|| 
	`of_mod2¥¬£_row
 (ûè> 
row
)

1156 ià(
	`of_mod2¥¬£_row
 (
û
è=ğ
row
)

1159  
û
;

1161 
»
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (re);

1162 
û
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (ce);

1165 
	}
}

1170 
of_mod2’Œy
 *
	$of_mod2¥¬£_š£¹
 (
of_mod2¥¬£
 *
m
,

1171 
UINT32
 
row
,

1172 
UINT32
 
cŞ
)

1175 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1176 
of_mod2’Œy
 *
»
, *
û
, *
Ã
;

1178 
of_mod2’Œy
 *
»
, *
û
, *
Ã
, *
û2
;

1182 ià(
row
 >ğ
	`of_mod2¥¬£_rows
 (
m
è|| 
cŞ
 >ğ
	`of_mod2¥¬£_cŞs
 (m))

1184 
	`årštf
 (
¡d”r
, "mod2sparse_insert:„ow or column index out of bounds\n");

1185 
OF_EXIT_FUNCTION


1186  
NULL
;

1191 
»
 = 
	`of_mod2¥¬£_Ï¡_š_row
 (
m
, 
row
);

1193 ià(!
	`of_mod2¥¬£_©_’d
 (
»
è&& 
	`of_mod2¥¬£_cŞ
 (»è=ğ
cŞ
)

1195 
OF_EXIT_FUNCTION


1196  
»
;

1199 ià(
	`of_mod2¥¬£_©_’d
 (
»
è|| 
	`of_mod2¥¬£_cŞ
 (»è< 
cŞ
)

1201 
»
 =„e->
right
;

1205 
»
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row
);

1208 ià(!
	`of_mod2¥¬£_©_’d
 (
»
è&& 
	`of_mod2¥¬£_cŞ
 (»è=ğ
cŞ
)

1210 
OF_EXIT_FUNCTION


1211  
»
;

1213 ià(
	`of_mod2¥¬£_©_’d
 (
»
è|| 
	`of_mod2¥¬£_cŞ
 (»è> 
cŞ
)

1217 
»
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (re);

1221 
Ã
 = 
	`of_®loc_’Œy
 (
m
);

1223 
Ã
->
row
 =„ow;

1224 
Ã
->
cŞ
 = col;

1226 
Ã
->
Ëá
 = 
»
->left;

1227 
Ã
->
right
 = 
»
;

1228 
Ã
->
Ëá
->
right
 =‚e;

1229 
Ã
->
right
->
Ëá
 =‚e;

1233 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1237 
û
 = 
	`of_mod2¥¬£_Ï¡_š_cŞ
 (
m
, 
cŞ
);

1239 ià(!
	`of_mod2¥¬£_©_’d
 (
û
è&& 
	`of_mod2¥¬£_row
 (ûè=ğ
row
)

1241 
	`årštf
 (
¡d”r
, "mod2sparse_insert: Garbled matrix\n");

1242 
OF_EXIT_FUNCTION


1243  
NULL
;

1246 ià(
	`of_mod2¥¬£_©_’d
 (
û
è|| 
	`of_mod2¥¬£_row
 (ûè< 
row
)

1248 
û
 = ce->
down
;

1253 
û2
 = & (
m
->
cŞs
[
cŞ
]);

1255 
û
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
cŞ
);

1259 ià(!
	`of_mod2¥¬£_©_’d
 (
û
è&& 
	`of_mod2¥¬£_row
 (ûè=ğ
row
)

1261 
	`årštf
 (
¡d”r
, "mod2sparse_insert: Garbled matrix\n");

1262 
OF_EXIT_FUNCTION


1263  
NULL
;

1266 ià(
	`of_mod2¥¬£_©_’d
 (
û
è|| 
	`of_mod2¥¬£_row
 (ûè> 
row
)

1270 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1271 
û2
 = 
û
;

1273 
û
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (ce);

1276 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1279 
Ã
->
up
 = 
û
->up;

1280 
Ã
->
down
 = 
û
;

1281 
Ã
->
up
->
down
 =‚e;

1282 
Ã
->
down
->
up
 =‚e;

1284 
Ã
->
down
 = 
û
;

1285 
û2
->
down
 = 
Ã
;

1290  
Ã
;

1294 
of_mod2’Œy
 * 
	`of_mod2¥¬£_š£¹_İt
 (
of_mod2¥¬£
 *
m
,

1295 
UINT32
 
row
,

1296 
UINT32
 
cŞ
,

1297 
of_mod2’Œy
 **
__·rsšg
)

1299 
of_mod2’Œy
 * 
__right_’Œy
, * 
__cŞ_’Œy
, * 
__Ãw_’Œy
;

1300 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1301 
of_mod2’Œy
 * 
__cŞ_’Œy_
;

1304 
OF_ENTER_FUNCTION


1306 ià(
row
 >ğ
	`of_mod2¥¬£_rows
 (
m
è|| 
cŞ
 >ğ
	`of_mod2¥¬£_cŞs
 (m))

1308 
	`årštf
 (
¡d”r
, "mod2sparse_insert:„ow or column index out of bounds\n");

1309 
OF_EXIT_FUNCTION


1310  
NULL
;

1315 
__right_’Œy
 = 
	`of_mod2¥¬£_Ï¡_š_row
 (
m
, 
row
);

1317 ià(!
	`of_mod2¥¬£_©_’d
 (
__right_’Œy
è&& 
	`of_mod2¥¬£_cŞ
 (__right_’Œyè=ğ
cŞ
)

1319 
OF_EXIT_FUNCTION


1320  
__right_’Œy
;

1323 ià(
	`of_mod2¥¬£_©_’d
 (
__right_’Œy
è|| 
	`of_mod2¥¬£_cŞ
 (__right_’Œyè< 
cŞ
)

1325 
__right_’Œy
 = __right_’Œy->
right
;

1329 
__right_’Œy
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row
);

1333 ià(!
	`of_mod2¥¬£_©_’d
 (
__right_’Œy
è&& 
	`of_mod2¥¬£_cŞ
 (__right_’Œyè=ğ
cŞ
)

1335 
OF_EXIT_FUNCTION


1336  
__right_’Œy
;

1339 ià(
	`of_mod2¥¬£_©_’d
 (
__right_’Œy
è|| 
	`of_mod2¥¬£_cŞ
 (__right_’Œyè> 
cŞ
)

1344 
__right_’Œy
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__right_entry);

1348 
__Ãw_’Œy
 = 
	`of_®loc_’Œy
 (
m
);

1350 
__Ãw_’Œy
->
row
 =„ow;

1351 
__Ãw_’Œy
->
cŞ
 = col;

1353 
__Ãw_’Œy
->
Ëá
 = 
__right_’Œy
->left;

1354 
__Ãw_’Œy
->
right
 = 
__right_’Œy
;

1355 
__Ãw_’Œy
->
Ëá
->
right
 = __new_entry;

1356 
__Ãw_’Œy
->
right
->
Ëá
 = __new_entry;

1359 ià(
__·rsšg
 !ğ
NULL
)

1361 ià(
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
__Ãw_’Œy
è] !ğ
NULL
)

1363 
__cŞ_’Œy
 = 
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
__Ãw_’Œy
) ];

1367 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
	`of_mod2¥¬£_cŞ
 (
__Ãw_’Œy
));

1372 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
	`of_mod2¥¬£_cŞ
 (
__Ãw_’Œy
));

1375 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1376 
__cŞ_’Œy_
 = 
__cŞ_’Œy
;

1378 !
	`of_mod2¥¬£_©_’d_cŞ
 (
__cŞ_’Œy
è&& 
	`of_mod2¥¬£_row
 (__cŞ_’Œyè< 
row
)

1380 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1381 
__cŞ_’Œy_
 = 
__cŞ_’Œy
;

1383 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (__col_entry);

1386 
__Ãw_’Œy
->
down
 = 
__cŞ_’Œy
;

1387 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1388 
__Ãw_’Œy
->
up
 = 
__cŞ_’Œy
->up;

1389 
__Ãw_’Œy
->
up
->
down
 = __new_entry;

1390 
__Ãw_’Œy
->
down
->
up
 = __new_entry;

1392 
__cŞ_’Œy_
->
down
 = 
__Ãw_’Œy
;

1395 
OF_EXIT_FUNCTION


1397  
__Ãw_’Œy
;

1402 
	`of_mod2¥¬£_d–‘e
 (
of_mod2¥¬£
 *
m
,

1403 
of_mod2’Œy
 *
e
)

1405 
OF_ENTER_FUNCTION


1406 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1407 
of_mod2’Œy
 *
û
;

1410 ià(
e
 == 0)

1412 
	`årštf
 (
¡d”r
, "mod2sparse_delete: Tryingo delete‡‚ullƒntry\n");

1413 
OF_EXIT_FUNCTION


1416 ià((
	`of_mod2¥¬£_row
 (
e
è< 0è|| (
	`of_mod2¥¬£_cŞ
 (e) < 0))

1418 
	`årštf
 (
¡d”r
, "mod2¥¬£_d–‘e: TryšgØd–‘¨h—d”ƒÁry (row=%d, cŞ=%d)\n", 
e
->
row
,ƒ->
cŞ
);

1419 
OF_EXIT_FUNCTION


1422 #ifdeà
OF_DEBUG


1425 
of_mod2’Œy
 *
tmp_e
;

1426 
tmp_e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
(
m
, 
	`of_mod2¥¬£_cŞ
(
e
));mp_!ğe;mp_ğtmp_e->
down
)

1428 ià(
	`of_mod2¥¬£_©_’d_cŞ
(
tmp_e
))

1430 
	`årštf
 (
¡d”r
, "mod2sparse_delete:ƒrror,ƒntry %d/%d‚ot found in column\n",

1431 
e
->
row
,ƒ->
cŞ
);

1432 
	`ASSERT
(0);

1433 
OF_EXIT_FUNCTION


1438 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1439 
e
->
up
->
down
 =ƒ->down;

1440 
e
->
down
->
up
 =ƒ->up;

1442 
û
 = & (
m
->
cŞs
[
	`of_mod2¥¬£_cŞ
(
e
)]);

1443 ; 
û
->
down
 !ğ
e
; ce = ce->down);

1444 
û
->
down
 = 
e
->down;

1447 
e
->
Ëá
->
right
 =ƒ->right;

1448 
e
->
right
->
Ëá
 =ƒ->left;

1450 
e
->
Ëá
 = 
m
->
Ãxt_ä“
;

1451 
m
->
Ãxt_ä“
 = 
e
;

1452 
OF_EXIT_FUNCTION


1456 
	`of_mod2¥¬£_d–‘e_İt
 (
of_mod2¥¬£
 * 
m
,

1457 
of_mod2’Œy
 * 
e
,

1458 
of_mod2’Œy
 ** 
__·rsšg
)

1460 
OF_ENTER_FUNCTION


1461 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1462 
of_mod2’Œy
 * 
û
;

1465 ià(
e
 =ğ
NULL
)

1467 
	`årštf
 (
¡d”r
, "mod2sparse_delete: Tryingo delete‡‚ullƒntry\n");

1468 
OF_EXIT_FUNCTION


1471 ià((
	`of_mod2¥¬£_row
 (
e
è< 0è|| (
	`of_mod2¥¬£_cŞ
 (e) < 0))

1473 
	`årštf
 (
¡d”r
, "mod2¥¬£_d–‘e: TryšgØd–‘¨h—d”ƒÁry (row=%d, cŞ=%d)\n", 
e
->
row
,ƒ->
cŞ
);

1474 
OF_EXIT_FUNCTION


1477 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


1478 
e
->
up
->
down
 =ƒ->down;

1479 
e
->
down
->
up
 =ƒ->up;

1481 ià(
__·rsšg
 !ğ
NULL
)

1483 
û
 = 
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
e
) ];

1487 
û
 = & (
m
->
cŞs
[
	`of_mod2¥¬£_cŞ
 (
e
) ]);

1489 !
	`of_mod2¥¬£_©_’d_cŞ
 (
û
))

1491 
û
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (ce);

1493 
û
->
down
 = 
e
->down;

1496 
e
->
Ëá
->
right
 =ƒ->right;

1497 
e
->
right
->
Ëá
 =ƒ->left;

1499 
e
->
Ëá
 = 
m
->
Ãxt_ä“
;

1500 
m
->
Ãxt_ä“
 = 
e
;

1501 
OF_EXIT_FUNCTION


1509 
INT32
 
mod2¥¬£_equ®


1510 (
of_mod2¥¬£
 *
m1
,

1511 
of_mod2¥¬£
 *
m2


1514 
OF_ENTER_FUNCTION


1515 
of_mod2’Œy
 *
e1
, *
e2
;

1516 
INT32
 
i
;

1518 ià(
	`of_mod2¥¬£_rows
 (
m1
è!ğof_mod2¥¬£_row (
m2
)

1519 || 
	`of_mod2¥¬£_cŞs
 (
m1
è!ğof_mod2¥¬£_cŞ (
m2
))

1521 
	`årštf
 (
¡d”r
, "mod2sparse_equal: Matrices have different dimensions\n");

1522 
OF_EXIT_FUNCTION


1526 
i
 = 0; i < 
	`of_mod2¥¬£_rows
 (
m1
); i++)

1528 
e1
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m1
, 
i
);

1529 
e2
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m2
, 
i
);

1531 !
	`of_mod2¥¬£_©_’d
 (
e1
è&& !of_mod2¥¬£_©_’d (
e2
))

1533 ià(
	`of_mod2¥¬£_cŞ
 (
e1
è!ğof_mod2¥¬£_cŞ (
e2
))

1535 
OF_EXIT_FUNCTION


1539 
e1
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e1);

1540 
e2
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e2);

1543 ià(!
	`of_mod2¥¬£_©_’d
 (
e1
è|| !of_mod2¥¬£_©_’d (
e2
))

1545 
OF_EXIT_FUNCTION


1550 
OF_EXIT_FUNCTION


1557 
mod2¥¬£_Œª¥o£


1558 (
of_mod2¥¬£
 *
m
,

1559 
of_mod2¥¬£
 *
r


1562 
OF_ENTER_FUNCTION


1563 
of_mod2’Œy
 *
e
;

1564 
INT32
 
i
;

1566 ià(
	`of_mod2¥¬£_rows
 (
m
è!ğ
	`of_mod2¥¬£_cŞs
 (
r
)

1567 || 
	`of_mod2¥¬£_cŞs
 (
m
è!ğ
	`of_mod2¥¬£_rows
 (
r
))

1569 
	`årštf
 (
¡d”r
,

1571 
OF_EXIT_FUNCTION


1572  
NULL
;

1575 ià(
r
 =ğ
m
)

1577 
	`årštf
 (
¡d”r
,

1579 
OF_EXIT_FUNCTION


1580  
NULL
;

1583 
	`of_mod2¥¬£_ş—r
 (
r
);

1585 
i
 = 0; i < 
	`of_mod2¥¬£_rows
 (
m
); i++)

1587 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
i
);

1589 !
	`of_mod2¥¬£_©_’d
 (
e
))

1591 
	`of_mod2¥¬£_š£¹
 (
r
, 
	`of_mod2¥¬£_cŞ
 (
e
), 
i
);

1592 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e);

1595 
OF_EXIT_FUNCTION


1601 
mod2¥¬£_add


1602 (
of_mod2¥¬£
 *
m1
,

1603 
of_mod2¥¬£
 *
m2
,

1604 
of_mod2¥¬£
 *
r


1607 
OF_ENTER_FUNCTION


1608 
of_mod2’Œy
 *
e1
, *
e2
;

1609 
INT32
 
i
;

1611 ià(
	`of_mod2¥¬£_rows
 (
m1
è!ğof_mod2¥¬£_row (
r
)

1612 || 
	`of_mod2¥¬£_cŞs
 (
m1
è!ğof_mod2¥¬£_cŞ (
r
)

1613 || 
	`of_mod2¥¬£_rows
 (
m2
è!ğof_mod2¥¬£_row (
r
)

1614 || 
	`of_mod2¥¬£_cŞs
 (
m2
è!ğof_mod2¥¬£_cŞ (
r
))

1616 
	`årštf
 (
¡d”r
, "mod2sparse_add: Matrices have different dimensions\n");

1617 
OF_EXIT_FUNCTION


1618  
NULL
;

1621 ià(
r
 =ğ
m1
 ||„ =ğ
m2
)

1623 
	`årštf
 (
¡d”r
,

1625 
OF_EXIT_FUNCTION


1626  
NULL
;

1629 
	`of_mod2¥¬£_ş—r
 (
r
);

1631 
i
 = 0; i < 
	`of_mod2¥¬£_rows
 (
r
); i++)

1633 
e1
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m1
, 
i
);

1634 
e2
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m2
, 
i
);

1636 !
	`of_mod2¥¬£_©_’d
 (
e1
è&& !of_mod2¥¬£_©_’d (
e2
))

1638 ià(
	`of_mod2¥¬£_cŞ
 (
e1
è=ğof_mod2¥¬£_cŞ (
e2
))

1640 
e1
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e1);

1641 
e2
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e2);

1645 ià(
	`of_mod2¥¬£_cŞ
 (
e1
è< of_mod2¥¬£_cŞ (
e2
))

1647 
	`of_mod2¥¬£_š£¹
 (
r
, 
i
, 
	`of_mod2¥¬£_cŞ
 (
e1
));

1648 
e1
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e1);

1653 
	`of_mod2¥¬£_š£¹
 (
r
, 
i
, 
	`of_mod2¥¬£_cŞ
 (
e2
));

1654 
e2
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e2);

1658 !
	`of_mod2¥¬£_©_’d
 (
e1
))

1660 
	`of_mod2¥¬£_š£¹
 (
r
, 
i
, 
	`of_mod2¥¬£_cŞ
 (
e1
));

1661 
e1
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e1);

1664 !
	`of_mod2¥¬£_©_’d
 (
e2
))

1666 
	`of_mod2¥¬£_š£¹
 (
r
, 
i
, 
	`of_mod2¥¬£_cŞ
 (
e2
));

1667 
e2
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e2);

1670 
OF_EXIT_FUNCTION


1676 
mod2¥¬£_muÉly


1677 (
of_mod2¥¬£
 *
m1
,

1678 
of_mod2¥¬£
 *
m2
,

1679 
of_mod2¥¬£
 *
r


1682 
OF_ENTER_FUNCTION


1683 
of_mod2’Œy
 *
e1
, *
e2
;

1684 
INT32
 
i
, 
j
, 
b
;

1686 ià(
	`of_mod2¥¬£_cŞs
 (
m1
è!ğ
	`of_mod2¥¬£_rows
 (
m2
)

1687 || 
	`of_mod2¥¬£_rows
 (
m1
è!ğof_mod2¥¬£_row (
r
)

1688 || 
	`of_mod2¥¬£_cŞs
 (
m2
è!ğof_mod2¥¬£_cŞ (
r
))

1690 
	`årštf
 (
¡d”r
,

1692 
OF_EXIT_FUNCTION


1693  
NULL
;

1696 ià(
r
 =ğ
m1
 ||„ =ğ
m2
)

1698 
	`årštf
 (
¡d”r
,

1700 
OF_EXIT_FUNCTION


1701  
NULL
;

1704 
	`of_mod2¥¬£_ş—r
 (
r
);

1706 
i
 = 0; i < 
	`of_mod2¥¬£_rows
 (
m1
); i++)

1708 ià(
	`of_mod2¥¬£_©_’d
 (
	`of_mod2¥¬£_fœ¡_š_row
 (
m1
, 
i
)))

1713 
j
 = 0; j < 
	`of_mod2¥¬£_cŞs
 (
m2
); j++)

1715 
b
 = 0;

1717 
e1
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m1
, 
i
);

1718 
e2
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m2
, 
j
);

1720 !
	`of_mod2¥¬£_©_’d
 (
e1
è&& !of_mod2¥¬£_©_’d (
e2
))

1722 ià(
	`of_mod2¥¬£_cŞ
 (
e1
è=ğ
	`of_mod2¥¬£_row
 (
e2
))

1724 
b
 ^= 1;

1725 
e1
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e1);

1726 
e2
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e2);

1730 ià(
	`of_mod2¥¬£_cŞ
 (
e1
è< 
	`of_mod2¥¬£_row
 (
e2
))

1732 
e1
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e1);

1737 
e2
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e2);

1741 ià(
b
)

1743 
	`of_mod2¥¬£_š£¹
 (
r
, 
i
, 
j
);

1747 
OF_EXIT_FUNCTION


1753 
mod2¥¬£_mulvec


1754 (
of_mod2¥¬£
 *
m
,

1755 
UINT8
 *
u
,

1756 
UINT8
 *
v


1759 
OF_ENTER_FUNCTION


1760 
of_mod2’Œy
 *
e
;

1761 
INT32
 
M
, 
N
;

1762 
INT32
 
i
, 
j
;

1764 
M
 = 
	`of_mod2¥¬£_rows
 (
m
);

1765 
N
 = 
	`of_mod2¥¬£_cŞs
 (
m
);

1767 
i
 = 0; i < 
M
; i++)

1768 
v
[
i
] = 0;

1770 
j
 = 0; j < 
N
; j++)

1772 ià(
u
[
j
])

1774 
e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
j
);

1775 !
	`of_mod2¥¬£_©_’d
 (
e
);

1776 
e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e))

1778 
v
[
	`of_mod2¥¬£_row
 (
e
) ] ^= 1;

1782 
OF_EXIT_FUNCTION


1788 
UINT32
 
mod2¥¬£_couÁ_row


1789 (
of_mod2¥¬£
 *
m
,

1790 
UINT32
 
row


1793 
OF_ENTER_FUNCTION


1794 
of_mod2’Œy
 *
e
;

1795 
INT32
 
couÁ
;

1797 ià(
row
 < 0 ||„ow >ğ
	`of_mod2¥¬£_rows
 (
m
))

1799 
	`årštf
 (
¡d”r
, "mod2sparse_count_row:„ow index out of bounds\n");

1800 
OF_EXIT_FUNCTION


1801  
NULL
;

1804 
couÁ
 = 0;

1806 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row
);

1807 !
	`of_mod2¥¬£_©_’d
 (
e
);

1808 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e))

1810 
couÁ
 += 1;

1813 
OF_EXIT_FUNCTION


1814  
couÁ
;

1820 
UINT32
 
mod2¥¬£_couÁ_cŞ


1821 (
of_mod2¥¬£
 *
m
,

1822 
UINT32
 
cŞ


1825 
OF_ENTER_FUNCTION


1826 
of_mod2’Œy
 *
e
;

1827 
INT32
 
couÁ
;

1829 ià(
cŞ
 < 0 || cŞ >ğ
	`of_mod2¥¬£_cŞs
 (
m
))

1831 
	`årštf
 (
¡d”r
, "mod2sparse_count_col: column index out of bounds\n");

1832 
OF_EXIT_FUNCTION


1833  
NULL
;

1836 
couÁ
 = 0;

1838 
e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
cŞ
);

1839 !
	`of_mod2¥¬£_©_’d
 (
e
);

1840 
e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e))

1842 
couÁ
 += 1;

1845 
OF_EXIT_FUNCTION


1846  
couÁ
;

1852 
mod2¥¬£_add_row


1853 (
of_mod2¥¬£
 *
m1
,

1854 
UINT32
 
row1
,

1855 
of_mod2¥¬£
 *
m2
,

1856 
UINT32
 
row2


1859 
OF_ENTER_FUNCTION


1860 
of_mod2’Œy
 *
f1
, *
f2
, *
á
;

1862 ià(
	`of_mod2¥¬£_cŞs
 (
m1
è< of_mod2¥¬£_cŞ (
m2
))

1864 
	`årštf
 (
¡d”r
,

1866 
OF_EXIT_FUNCTION


1867  
NULL
;

1870 ià(
row1
 < 0 ||„ow1 >ğ
	`of_mod2¥¬£_rows
 (
m1
)

1871 || 
row2
 < 0 ||„ow2 >ğ
	`of_mod2¥¬£_rows
 (
m2
))

1873 
	`årštf
 (
¡d”r
, "mod2sparse_add_row:„ow index out of„ange\n");

1874 
OF_EXIT_FUNCTION


1875  
NULL
;

1878 
f1
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m1
, 
row1
);

1879 
f2
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m2
, 
row2
);

1881 !
	`of_mod2¥¬£_©_’d
 (
f1
è&& !of_mod2¥¬£_©_’d (
f2
))

1883 ià(
	`of_mod2¥¬£_cŞ
 (
f1
è> of_mod2¥¬£_cŞ (
f2
))

1885 
	`of_mod2¥¬£_š£¹
 (
m1
, 
row1
, 
	`of_mod2¥¬£_cŞ
 (
f2
));

1886 
f2
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (f2);

1890 
á
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (
f1
);

1891 ià(
	`of_mod2¥¬£_cŞ
 (
f1
è=ğof_mod2¥¬£_cŞ (
f2
))

1893 
	`of_mod2¥¬£_d–‘e
 (
m1
, 
f1
);

1894 
f2
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (f2);

1896 
f1
 = 
á
;

1900 !
	`of_mod2¥¬£_©_’d
 (
f2
))

1902 
	`of_mod2¥¬£_š£¹
 (
m1
, 
row1
, 
	`of_mod2¥¬£_cŞ
 (
f2
));

1903 
f2
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (f2);

1906 
OF_EXIT_FUNCTION


1912 
mod2¥¬£_add_cŞ


1913 (
of_mod2¥¬£
 *
m1
,

1914 
UINT32
 
cŞ1
,

1915 
of_mod2¥¬£
 *
m2
,

1916 
UINT32
 
cŞ2


1919 
OF_ENTER_FUNCTION


1920 
of_mod2’Œy
 *
f1
, *
f2
, *
á
;

1922 ià(
	`of_mod2¥¬£_rows
 (
m1
è< of_mod2¥¬£_row (
m2
))

1924 
	`årštf
 (
¡d”r
,

1926 
OF_EXIT_FUNCTION


1927  
NULL
;

1930 ià(
cŞ1
 < 0 || cŞ1 >ğ
	`of_mod2¥¬£_cŞs
 (
m1
)

1931 || 
cŞ2
 < 0 || cŞ2 >ğ
	`of_mod2¥¬£_cŞs
 (
m2
))

1933 
	`årštf
 (
¡d”r
, "mod2sparse_add_col: Column index out of„ange\n");

1934 
OF_EXIT_FUNCTION


1935  
NULL
;

1938 
f1
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m1
, 
cŞ1
);

1939 
f2
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m2
, 
cŞ2
);

1941 !
	`of_mod2¥¬£_©_’d
 (
f1
è&& !of_mod2¥¬£_©_’d (
f2
))

1943 ià(
	`of_mod2¥¬£_row
 (
f1
è> of_mod2¥¬£_row (
f2
))

1945 
	`of_mod2¥¬£_š£¹
 (
m1
, 
	`of_mod2¥¬£_row
 (
f2
), 
cŞ1
);

1946 
f2
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (f2);

1950 
á
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (
f1
);

1951 ià(
	`of_mod2¥¬£_row
 (
f1
è=ğof_mod2¥¬£_row (
f2
))

1953 
	`of_mod2¥¬£_d–‘e
 (
m1
, 
f1
);

1954 
f2
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (f2);

1956 
f1
 = 
á
;

1960 !
	`of_mod2¥¬£_©_’d
 (
f2
))

1962 
	`of_mod2¥¬£_š£¹
 (
m1
, 
	`of_mod2¥¬£_row
 (
f2
), 
cŞ1
);

1963 
f2
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (f2);

1966 
OF_EXIT_FUNCTION


1972 
UINT32
 
mod2¥¬£_decomp


1973 (
of_mod2¥¬£
 *
A
,

1974 
UINT32
 
K
,

1975 
of_mod2¥¬£
 *
L
,

1976 
of_mod2¥¬£
 *
U
,

1977 
UINT32
 *
rows
,

1978 
UINT32
 *
cŞs
,

1979 
mod2¥¬£_¡¿‹gy
 
¡¿‹gy
,

1980 
UINT32
 
abªdÚ_numb”
,

1981 
UINT32
 
abªdÚ_wh’


1984 
OF_ENTER_FUNCTION


1985 
UINT32
 *
ršv
 = 
NULL
, *
cšv
 = NULL, *
aút
 = NULL, *
rút
 = NULL;

1986 
of_mod2¥¬£
 *
B
 = 
NULL
;

1987 
UINT32
 
M
, 
N
;

1989 
of_mod2’Œy
 *
e
 = 
NULL
, *
f
 = NULL, *
â
 = NULL, *
e2
 = NULL;

1990 
INT32
 
i
 = 0, 
j
 = 0, 
k
 = 0, 
cc
 = 0, 
cc2
 = 0, 
cc3
 = 0, 
ü2
 = 0, 
´
 = 0;

1991 
INT32
 
found
, 
Âf
;

1993 
M
 = 
	`of_mod2¥¬£_rows
 (
A
);

1994 
N
 = 
	`of_mod2¥¬£_cŞs
 (
A
);

1996 ià(
	`of_mod2¥¬£_cŞs
 (
L
è!ğ
K
 || 
	`of_mod2¥¬£_rows
 (Lè!ğ
M


1997 || 
	`of_mod2¥¬£_cŞs
 (
U
è!ğ
N
 || 
	`of_mod2¥¬£_rows
 (Uè!ğ
K
)

1999 
	`årštf
 (
¡d”r
,

2001 
OF_EXIT_FUNCTION


2002  
NULL
;

2005 ià(
abªdÚ_numb”
 > 
N
 - 
K
)

2007 
	`årštf
 (
¡d”r
, "Tryingo‡bandon more columnshan‡llowed\n");

2008 
OF_EXIT_FUNCTION


2009  
NULL
;

2012 
ršv
 = (
UINT32
*è
	`of_ÿÎoc
 (
M
,  *„inv);

2013 
cšv
 = (
UINT32
*è
	`of_ÿÎoc
 (
N
,  * cinv);

2015 ià(
abªdÚ_numb”
 > 0)

2017 
aút
 = (
UINT32
*è
	`of_ÿÎoc
 (
M
 + 1,  *‡cnt);

2020 ià(
¡¿‹gy
 =ğ
Mod2¥¬£_mš´od
)

2022 
rút
 = (
UINT32
*è
	`of_ÿÎoc
 (
M
,  *„cnt);

2025 
	`of_mod2¥¬£_ş—r
 (
L
);

2026 
	`of_mod2¥¬£_ş—r
 (
U
);

2030 
B
 = 
	`of_mod2¥¬£_®loÿ‹
 (
M
, 
N
);

2031 
	`of_mod2¥¬£_cİy
 (
A
, 
B
);

2035 ià(
¡¿‹gy
 =ğ
Mod2¥¬£_mš´od
)

2037 
i
 = 0; i < 
M
; i++)

2039 
rút
[
i
] = 
	`mod2¥¬£_couÁ_row
 (
B
, i);

2045 
i
 = 0; i < 
M
; i++)

2046 
rows
[
i
] = 
ršv
[i] = i;

2047 
j
 = 0; j < 
N
; j++)

2048 
cŞs
[
j
] = 
cšv
[j] = j;

2052 
Âf
 = 0;

2054 
i
 = 0; i < 
K
; i++)

2058 
¡¿‹gy
)

2060 
Mod2¥¬£_fœ¡
:

2062 
found
 = 0;

2064 
k
 = 
i
; k < 
N
; k++)

2066 
e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
B
, 
cŞs
[
k
]);

2067 !
	`of_mod2¥¬£_©_’d
 (
e
))

2069 ià(
ršv
[
	`of_mod2¥¬£_row
 (
e
è] >ğ
i
)

2071 
found
 = 1;

2072 
out_fœ¡
;

2074 
e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e);

2078 
out_fœ¡
:

2082 
Mod2¥¬£_mšcŞ
:

2084 
found
 = 0;

2086 
j
 = 
i
; j < 
N
; j++)

2088 
cc2
 = 
	`mod2¥¬£_couÁ_cŞ
 (
B
, 
cŞs
[
j
]);

2089 ià(!
found
 || 
cc2
 < 
cc
)

2091 
e2
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
B
, 
cŞs
[
j
]);

2092 !
	`of_mod2¥¬£_©_’d
 (
e2
))

2094 ià(
ršv
[
	`of_mod2¥¬£_row
 (
e2
è] >ğ
i
)

2096 
found
 = 1;

2097 
cc
 = 
cc2
;

2098 
e
 = 
e2
;

2099 
k
 = 
j
;

2102 
e2
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e2);

2110 
Mod2¥¬£_mš´od
:

2112 
found
 = 0;

2114 
j
 = 
i
; j < 
N
; j++)

2116 
cc2
 = 
	`mod2¥¬£_couÁ_cŞ
 (
B
, 
cŞs
[
j
]);

2117 
e2
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
B
, 
cŞs
[
j
]);

2118 !
	`of_mod2¥¬£_©_’d
 (
e2
))

2120 ià(
ršv
[
	`of_mod2¥¬£_row
 (
e2
è] >ğ
i
)

2122 
ü2
 = 
rút
[
	`of_mod2¥¬£_row
 (
e2
) ];

2123 ià(!
found
 || 
cc2
 =ğ1 || (cc2 - 1è* (
ü2
 - 1è< 
´
)

2125 
found
 = 1;

2126 
´
 = 
cc2
 =ğ1 ? 0 : (cc2 - 1è* (
ü2
 - 1);

2127 
e
 = 
e2
;

2128 
k
 = 
j
;

2131 
e2
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e2);

2140 
	`årštf
 (
¡d”r
, "mod2sparse_decomp: Unknown stategy\n");

2141 
OF_EXIT_FUNCTION


2142  
NULL
;

2146 ià(!
found
)

2148 
Âf
 += 1;

2153 ià(
found
)

2155 ià(
cšv
[
	`of_mod2¥¬£_cŞ
 (
e
è] !ğ
k
)

2156 
	`abÜt
();

2158 
cŞs
[
k
] = cŞs[
i
];

2159 
cŞs
[
i
] = 
	`of_mod2¥¬£_cŞ
 (
e
);

2161 
cšv
[
cŞs
[
k
]] = k;

2162 
cšv
[
cŞs
[
i
]] = i;

2164 
k
 = 
ršv
[
	`of_mod2¥¬£_row
 (
e
) ];

2166 ià(
k
 < 
i
)

2167 
	`abÜt
();

2169 
rows
[
k
] =„ows[
i
];

2170 
rows
[
i
] = 
	`of_mod2¥¬£_row
 (
e
);

2172 
ršv
[
rows
[
k
]] = k;

2173 
ršv
[
rows
[
i
]] = i;

2178 
f
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
B
, 
cŞs
[
i
]);

2180 !
	`of_mod2¥¬£_©_’d
 (
f
))

2182 
â
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (
f
);

2183 
k
 = 
	`of_mod2¥¬£_row
 (
f
);

2185 ià(
ršv
[
k
] > 
i
)

2187 
	`mod2¥¬£_add_row
 (
B
, 
k
, B, 
	`of_mod2¥¬£_row
 (
e
));

2188 ià(
¡¿‹gy
 =ğ
Mod2¥¬£_mš´od
)

2190 
rút
[
k
] = 
	`mod2¥¬£_couÁ_row
 (
B
, k);

2192 
	`of_mod2¥¬£_š£¹
 (
L
, 
k
, 
i
);

2195 ià(
ršv
[
k
] < 
i
)

2197 
	`of_mod2¥¬£_š£¹
 (
U
, 
ršv
[
k
], 
cŞs
[
i
]);

2201 
	`of_mod2¥¬£_š£¹
 (
L
, 
k
, 
i
);

2202 
	`of_mod2¥¬£_š£¹
 (
U
, 
i
, 
cŞs
[i]);

2205 
f
 = 
â
;

2212 
f
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
B
, 
cŞs
[
i
]);

2213 ià(
	`of_mod2¥¬£_©_’d
 (
f
))

2215 
	`of_mod2¥¬£_d–‘e
 (
B
, 
f
);

2220 ià(
abªdÚ_numb”
 > 0 && 
i
 =ğ
abªdÚ_wh’
)

2222 
k
 = 0; k < 
M
 + 1; k++)

2224 
aút
[
k
] = 0;

2226 
j
 = 0; j < 
N
; j++)

2228 
k
 = 
	`mod2¥¬£_couÁ_cŞ
 (
B
, 
j
);

2229 
aút
[
k
] += 1;

2232 
cc
 = 
abªdÚ_numb”
;

2233 
k
 = 
M
;

2234 
aút
[
k
] < 
cc
)

2236 
cc
 -ğ
aút
[
k
];

2237 
k
 -= 1;

2238 ià(
k
 < 0)

2239 
	`abÜt
();

2242 
cc2
 = 0;

2243 
j
 = 0; j < 
N
; j++)

2245 
cc3
 = 
	`mod2¥¬£_couÁ_cŞ
 (
B
, 
j
);

2246 ià(
cc3
 > 
k
 || cc3 =ğk && 
cc
 > 0)

2248 ià(
cc3
 =ğ
k
)

2249 
cc
 -= 1;

2252 
f
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
B
, 
j
);

2253 ià(
	`of_mod2¥¬£_©_’d
 (
f
))

2255 
	`of_mod2¥¬£_d–‘e
 (
B
, 
f
);

2257 
cc2
 += 1;

2261 ià(
cc2
 !ğ
abªdÚ_numb”
)

2262 
	`abÜt
();

2264 ià(
¡¿‹gy
 =ğ
Mod2¥¬£_mš´od
)

2266 
j
 = 0; j < 
M
; j++)

2268 
rút
[
j
] = 
	`mod2¥¬£_couÁ_row
 (
B
, j);

2276 
i
 = 
K
; i < 
M
; i++)

2280 
f
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
L
, 
rows
[
i
]);

2281 ià(
	`of_mod2¥¬£_©_’d
 (
f
))

2283 
	`of_mod2¥¬£_d–‘e
 (
L
, 
f
);

2287 
	`of_mod2¥¬£_ä“
 (
B
);

2288 
	`ä“
 (
ršv
);

2289 
	`ä“
 (
cšv
);

2290 ià(
¡¿‹gy
 =ğ
Mod2¥¬£_mš´od
)

2291 
	`ä“
 (
rút
);

2292 ià(
abªdÚ_numb”
 > 0)

2293 
	`ä“
 (
aút
);

2295 
OF_EXIT_FUNCTION


2296  
Âf
;

2302 
UINT32
 
mod2¥¬£_fÜw¬d_sub


2303 (
of_mod2¥¬£
 *
L
,

2304 
UINT32
 *
rows
,

2305 
UINT8
 *
x
,

2306 
UINT8
 *
y


2309 
OF_ENTER_FUNCTION


2310 
INT32
 
K
, 
i
, 
j
, 
ii
, 
b
, 
d
;

2311 
of_mod2’Œy
 *
e
;

2313 
K
 = 
	`of_mod2¥¬£_cŞs
 (
L
);

2317 
i
 = 0; i < 
K
; i++)

2319 
ii
 = 
rows
 ?„ows[
i
] : i;

2320 
e
 = 
	`of_mod2¥¬£_Ï¡_š_row
 (
L
, 
ii
);

2321 ià(!
	`of_mod2¥¬£_©_’d
 (
e
è&& 
	`of_mod2¥¬£_cŞ
 (eè> 
i
)

2323 
	`årštf
 (
¡d”r
,

2325 
OF_EXIT_FUNCTION


2326  
NULL
;

2332 
i
 = 0; i < 
K
; i++)

2334 
ii
 = 
rows
 ?„ows[
i
] : i;

2339 
d
 = 0;

2340 
b
 = 0;

2342 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
L
, 
ii
);

2343 !
	`of_mod2¥¬£_©_’d
 (
e
);

2344 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e))

2346 
j
 = 
	`of_mod2¥¬£_cŞ
 (
e
);

2348 ià(
j
 =ğ
i
)

2350 
d
 = 1;

2354 
b
 ^ğ
y
[
j
];

2360 ià(!
d
 && 
b
 !ğ
x
[
ii
])

2362 
OF_EXIT_FUNCTION


2368 
y
[
i
] = 
b
 ^ 
x
[
ii
];

2371 
OF_EXIT_FUNCTION


2378 
UINT32
 
mod2¥¬£_backw¬d_sub


2379 (
of_mod2¥¬£
 *
U
,

2380 
UINT32
 *
cŞs
,

2381 
UINT8
 *
y
,

2382 
UINT8
 *
z


2385 
OF_ENTER_FUNCTION


2386 
INT32
 
K
, 
i
, 
j
, 
ii
, 
b
, 
d
;

2387 
of_mod2’Œy
 *
e
;

2389 
K
 = 
	`of_mod2¥¬£_rows
 (
U
);

2393 
i
 = 0; i < 
K
; i++)

2395 
ii
 = 
cŞs
 ? cŞs[
i
] : i;

2396 
e
 = 
	`of_mod2¥¬£_Ï¡_š_cŞ
 (
U
, 
ii
);

2397 ià(!
	`of_mod2¥¬£_©_’d
 (
e
è&& 
	`of_mod2¥¬£_row
 (eè> 
i
)

2399 
	`årštf
 (
¡d”r
,

2401 
OF_EXIT_FUNCTION


2402  
NULL
;

2408 
i
 = 
K
 - 1; i >= 0; i--)

2410 
ii
 = 
cŞs
 ? cŞs[
i
] : i;

2415 
d
 = 0;

2416 
b
 = 0;

2418 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
U
, 
i
);

2419 !
	`of_mod2¥¬£_©_’d
 (
e
);

2420 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e))

2422 
j
 = 
	`of_mod2¥¬£_cŞ
 (
e
);

2424 ià(
j
 =ğ
ii
)

2426 
d
 = 1;

2430 
b
 ^ğ
z
[
j
];

2436 ià(!
d
 && 
b
 !ğ
y
[
i
])

2443 
z
[
ii
] = 
b
 ^ 
y
[
i
];

2446 
OF_EXIT_FUNCTION


2452 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2453 
of_mod2’Œy
 * 
	`of_mod2¥¬£_Ï¡_š_cŞ
 (
of_mod2¥¬£
 *
m
,

2454 
UINT32
 
i
)

2456 
of_mod2’Œy
 *
e
;

2458 
OF_ENTER_FUNCTION


2459 
e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
i
);

2460 !
	`of_mod2¥¬£_©_’d
 (
e
->
down
))

2462 
e
 =ƒ->
down
;

2464 
OF_EXIT_FUNCTION


2465  
e
;

2470 #ià
	`defšed
(
ML_DECODING
)

2475 
UINT32
 
	`of_mod2¥¬£_sw­_rows
 (
of_mod2¥¬£
 * 
m
,

2476 
UINT32
 
row0
,

2477 
UINT32
 
row1
,

2478 
of_mod2¥¬£
 *
__sw­
,

2479 
of_mod2’Œy
 ** 
__lšks
,

2480 
of_mod2’Œy
 **
__·rsšg
)

2482 
UINT32
 
row_weight
;

2483 
UINT32
 
__cŞ
;

2485 
OF_ENTER_FUNCTION


2486 
row_weight
 = 0;

2488 ià(
row0
 !ğ
row1
)

2491 
UINT32
 
__ıy
[2];

2492 
of_mod2’Œy
 * 
e0
;

2493 
of_mod2’Œy
 * 
e1
;

2494 
of_mod2’Œy
 * 
__e
, * 
__´ev
;

2495 
of_mod2’Œy
 * 
__d–Me
;

2496 
of_mod2’Œy
 * 
__cŞ_’Œy
, * 
__Ãw_’Œy
;

2497 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2498 
of_mod2’Œy
 * 
__cŞ_’Œy_
;

2500 
boŞ
 
__sw­_was_nuÎ
 = 
çl£
;

2503 ià(
__sw­
 =ğ
NULL
)

2505 
__sw­_was_nuÎ
 = 
Œue
;

2506 
__sw­
 = 
	`of_mod2¥¬£_®loÿ‹
 (1, 
	`of_mod2¥¬£_cŞs
 (
m
));

2509 
__ıy
[0] = 
row0
;

2510 
__ıy
[1] = 
row1
;

2511 
	`of_mod2¥¬£_cİyrows_İt
 (
m
, 
__sw­
, 
__ıy
, 
__·rsšg
);

2514 
e0
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row0
);

2515 !
	`of_mod2¥¬£_©_’d_row
 (
e0
))

2517 
__e
 = 
e0
;

2518 
e0
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e0);

2519 ià(
__lšks
 !ğ
NULL
)

2521 
	`of_mod2¥¬£_d–‘e_İt
 (
m
, 
__e
, 
__lšks
);

2525 
	`of_mod2¥¬£_d–‘e
 (
m
, 
__e
);

2531 
row_weight
 = 0;

2532 
e1
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row1
);

2533 !
	`of_mod2¥¬£_©_’d_row
 (
e1
))

2535 
__´ev
 = 
	`of_mod2¥¬£_Ï¡_š_row
 (
m
, 
row0
);

2538 
__Ãw_’Œy
 = 
	`of_®loc_’Œy
 (
m
);

2540 
__Ãw_’Œy
->
row
 = 
row0
;

2541 
__Ãw_’Œy
->
cŞ
 = 
	`of_mod2¥¬£_cŞ
 (
e1
);

2542 
__cŞ
 = 
	`of_mod2¥¬£_cŞ
 (
__Ãw_’Œy
);

2545 
__Ãw_’Œy
->
Ëá
 = 
__´ev
;

2546 
__Ãw_’Œy
->
right
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (
__´ev
);

2547 
__Ãw_’Œy
->
Ëá
->
right
 = __new_entry;

2548 
__Ãw_’Œy
->
right
->
Ëá
 = __new_entry;

2551 ià(
__lšks
 =ğ
NULL
)

2553 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
__cŞ
);

2554 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2555 
__cŞ_’Œy_
 = 
__cŞ_’Œy
;

2557 !
	`of_mod2¥¬£_©_’d_cŞ
 (
__cŞ_’Œy
è&& 
	`of_mod2¥¬£_row
 (__cŞ_’Œyè< 
row0
)

2559 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2560 
__cŞ_’Œy_
 = 
__cŞ_’Œy
;

2562 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (__col_entry);

2567 ià(
__lšks
[
__cŞ
] =ğ
NULL
)

2570 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
__cŞ
);

2571 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2572 
__cŞ_’Œy_
 = 
__cŞ_’Œy
;

2578 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2579 
__cŞ_’Œy_
 = 
__lšks
[
__cŞ
];

2581 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (
__lšks
[
__cŞ
]);

2585 
__Ãw_’Œy
->
down
 = 
__cŞ_’Œy
;

2586 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2587 
__Ãw_’Œy
->
up
 = 
__cŞ_’Œy
->up;

2588 
__Ãw_’Œy
->
up
->
down
 = __new_entry;

2589 
__Ãw_’Œy
->
down
->
up
 = __new_entry;

2591 
__cŞ_’Œy_
->
down
 = 
__Ãw_’Œy
;

2594 ià(
__lšks
 !ğ
NULL
)

2596 
__lšks
[
__cŞ
] = 
__Ãw_’Œy
;

2599 
__d–Me
 = 
e1
;

2600 
e1
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e1);

2601 ià(
__lšks
 !ğ
NULL
)

2603 
	`of_mod2¥¬£_d–‘e_İt
 (
m
, 
__d–Me
, 
__lšks
);

2607 
	`of_mod2¥¬£_d–‘e
 (
m
, 
__d–Me
);

2610 ++
row_weight
;

2614 
__e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
__sw­
, 0);

2615 !
	`of_mod2¥¬£_©_’d_row
 (
__e
))

2617 
__´ev
 = 
	`of_mod2¥¬£_Ï¡_š_row
 (
m
, 
row1
);

2620 
__Ãw_’Œy
 = 
	`of_®loc_’Œy
 (
m
);

2622 
__Ãw_’Œy
->
row
 = 
row1
;

2623 
__Ãw_’Œy
->
cŞ
 = 
	`of_mod2¥¬£_cŞ
 (
__e
);

2624 
__cŞ
 = 
	`of_mod2¥¬£_cŞ
 (
__Ãw_’Œy
);

2627 
__Ãw_’Œy
->
Ëá
 = 
__´ev
;

2628 
__Ãw_’Œy
->
right
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (
__´ev
);

2629 
__Ãw_’Œy
->
Ëá
->
right
 = __new_entry;

2630 
__Ãw_’Œy
->
right
->
Ëá
 = __new_entry;

2633 ià(
__lšks
 !ğ
NULL
)

2635 ià(
__lšks
[
__cŞ
] !ğ
NULL
)

2637 
__cŞ_’Œy
 = 
__lšks
[
__cŞ
];

2641 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
__cŞ
);

2646 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
__cŞ
);

2649 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2650 
__cŞ_’Œy_
 = 
__cŞ_’Œy
;

2652 !
	`of_mod2¥¬£_©_’d_cŞ
 (
__cŞ_’Œy
è&& 
	`of_mod2¥¬£_row
 (__cŞ_’Œyè< 
row1
)

2654 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2655 
__cŞ_’Œy_
 = 
__cŞ_’Œy
;

2657 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (__col_entry);

2660 
__Ãw_’Œy
->
down
 = 
__cŞ_’Œy
;

2661 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2662 
__Ãw_’Œy
->
up
 = 
__cŞ_’Œy
->up;

2663 
__Ãw_’Œy
->
up
->
down
 = __new_entry;

2664 
__Ãw_’Œy
->
down
->
up
 = __new_entry;

2666 
__cŞ_’Œy_
->
down
 = 
__Ãw_’Œy
;

2669 
__d–Me
 = 
__e
;

2670 
__e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__e);

2671 
	`of_mod2¥¬£_d–‘e
 (
__sw­
, 
__d–Me
);

2675 ià(
__sw­_was_nuÎ
 =ğ
Œue
)

2677 
	`of_mod2¥¬£_ä“
 (
__sw­
);

2678 
	`of_ä“
 (
__sw­
);

2681 ià(
__·rsšg
 !ğ
NULL
 && 
__lšks
 != NULL)

2683 
	`memıy
 (

2684 & (
__·rsšg
[
row0
]),

2685 & (
__lšks
[
row0
]),

2686 (
	`of_mod2¥¬£_cŞs
 (
m
è- 
row0
è*  (
of_mod2’Œy
 *)

2692 ià(
__lšks
 !ğ
NULL
)

2694 
of_mod2’Œy
 * 
__e
;

2696 
__e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row0
);

2698 !
	`of_mod2¥¬£_©_’d_row
 (
__e
))

2700 
row_weight
++;

2701 
__lšks
[
	`of_mod2¥¬£_cŞ
 (
__e
) ] = __e;

2703 
__e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__e);

2706 ià(
__·rsšg
 !ğ
NULL
 && 
__lšks
 != NULL)

2708 
	`memıy
 (

2709 & (
__·rsšg
[
row0
]),

2710 & (
__lšks
[
row0
]),

2711 (
	`of_mod2¥¬£_cŞs
 (
m
è- 
row0
è*  (
of_mod2’Œy
 *)

2715 
OF_EXIT_FUNCTION


2716  
row_weight
;

2723 
UINT32
 
	`of_mod2¥¬£_xÜ_rows
 (
of_mod2¥¬£
 *
m
,

2724 
UINT32
 
row0
,

2725 
UINT32
 
row1
,

2726 
of_mod2’Œy
 **
__lšks
,

2727 
of_mod2’Œy
 **
__·rsšg
)

2729 
UINT32
 
__cŞ
;

2730 
of_mod2’Œy
 * 
__e0
;

2731 
of_mod2’Œy
 * 
__e1
;

2732 
of_mod2’Œy
 * 
__´ev
;

2733 
of_mod2’Œy
 * 
__cŞ_’Œy
, * 
__Ãw_’Œy
;

2734 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2735 
of_mod2’Œy
 * 
__cŞ_’Œy_
;

2737 
INT32
 
row_weight
;

2739 
OF_ENTER_FUNCTION


2740 
row_weight
 = 0;

2742 ià(
	`of_mod2¥¬£_em±y_row
 (
m
, 
row0
))

2744 
of_mod2’Œy
 * 
__e
;

2746 ià(
__·rsšg
 !ğ
NULL
)

2748 
__e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row1
);

2750 !
	`of_mod2¥¬£_©_’d_row
 (
__e
))

2752 
row_weight
++;

2753 
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
__e
) ] = __e;

2754 
__e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__e);

2756 
OF_EXIT_FUNCTION


2757  
row_weight
;

2759 
OF_EXIT_FUNCTION


2760  
	`of_mod2¥¬£_weight_row
 (
m
, 
row1
);

2764 ià(
row0
 =ğ
row1
)

2766 
of_mod2’Œy
 * 
__d–Me
;

2768 
__e0
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row0
);

2769 !
	`of_mod2¥¬£_©_’d_row
 (
__e0
))

2771 
__d–Me
 = 
__e0
;

2772 
__e0
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__e0);

2773 ià(
__·rsšg
 !ğ
NULL
)

2775 
	`of_mod2¥¬£_d–‘e_İt
 (
m
, 
__d–Me
, 
__·rsšg
);

2779 
	`of_mod2¥¬£_d–‘e
 (
m
, 
__d–Me
);

2782 
OF_EXIT_FUNCTION


2786 
__e0
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row0
);

2787 
__e1
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row1
);

2789 
row_weight
 = 0;

2791 !
	`of_mod2¥¬£_©_’d_row
 (
__e0
è&& !of_mod2¥¬£_©_’d_row (
__e1
))

2793 ià(
	`of_mod2¥¬£_cŞ
 (
__e0
è< of_mod2¥¬£_cŞ (
__e1
))

2795 
row_weight
++;

2798 
__Ãw_’Œy
 = 
	`of_®loc_’Œy
 (
m
);

2800 
__Ãw_’Œy
->
row
 = 
row1
;

2801 
__Ãw_’Œy
->
cŞ
 = 
	`of_mod2¥¬£_cŞ
 (
__e0
);

2802 
__cŞ
 = 
	`of_mod2¥¬£_cŞ
 (
__Ãw_’Œy
);

2804 
__Ãw_’Œy
->
Ëá
 = 
	`of_mod2¥¬£_´ev_š_row
 (
__e1
);

2805 
__Ãw_’Œy
->
right
 = 
__e1
;

2806 
__Ãw_’Œy
->
Ëá
->
right
 = __new_entry;

2807 
__Ãw_’Œy
->
right
->
Ëá
 = __new_entry;

2810 ià(
__·rsšg
 !ğ
NULL
)

2812 ià(
__·rsšg
[
__cŞ
] !ğ
NULL
)

2814 
__cŞ_’Œy
 = 
__·rsšg
[
__cŞ
];

2818 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
__cŞ
);

2823 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
__cŞ
);

2826 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2827 
__cŞ_’Œy_
 = 
__cŞ_’Œy
;

2829 !
	`of_mod2¥¬£_©_’d_cŞ
 (
__cŞ_’Œy
è&& 
	`of_mod2¥¬£_row
 (__cŞ_’Œyè< 
row1
)

2831 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2832 
__cŞ_’Œy_
 = 
__cŞ_’Œy
;

2834 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (__col_entry);

2836 
__Ãw_’Œy
->
down
 = 
__cŞ_’Œy
;

2837 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2838 
__Ãw_’Œy
->
up
 = 
__cŞ_’Œy
->up;

2839 
__Ãw_’Œy
->
up
->
down
 = __new_entry;

2840 
__Ãw_’Œy
->
down
->
up
 = __new_entry;

2842 
__cŞ_’Œy_
->
down
 = 
__Ãw_’Œy
;

2845 ià(
__·rsšg
 !ğ
NULL
)

2847 
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
__Ãw_’Œy
) ] = __new_entry;

2849 
__e0
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__e0);

2853 ià(
	`of_mod2¥¬£_cŞ
 (
__e0
è=ğof_mod2¥¬£_cŞ (
__e1
))

2855 ià(
__·rsšg
 !ğ
NULL
)

2857 ià(
__lšks
 !ğ
NULL
)

2859 
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
__e1
è] = 
__lšks
[of_mod2sparse_col (__e1) ];

2863 
of_mod2’Œy
 * 
__e
;

2865 
__e
 = 
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
__e1
) ];

2866 
__´ev
 = 
__e
;

2867 !
	`of_mod2¥¬£_©_’d_cŞ
 (
__e
è&& 
	`of_mod2¥¬£_row
 (__eè< 
row1
)

2869 
__´ev
 = 
__e
;

2870 
__e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (__e);

2873 
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
__e1
è] = 
__´ev
;

2876 ià(
__·rsšg
 !ğ
NULL
)

2878 
	`of_mod2¥¬£_d–‘e_İt
 (
m
, 
__e1
, 
__·rsšg
);

2882 
	`of_mod2¥¬£_d–‘e
 (
m
, 
__e1
);

2884 
__e0
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__e0);

2885 
__e1
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__e1);

2889 
row_weight
++;

2890 ià(
__·rsšg
 !ğ
NULL
)

2892 
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
__e1
) ] = __e1;

2895 
__e1
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__e1);

2900 !
	`of_mod2¥¬£_©_’d_row
 (
__e0
))

2902 
row_weight
++;

2904 
__´ev
 = 
	`of_mod2¥¬£_Ï¡_š_row
 (
m
, 
row1
);

2907 
__Ãw_’Œy
 = 
	`of_®loc_’Œy
 (
m
);

2909 
__Ãw_’Œy
->
row
 = 
row1
;

2910 
__Ãw_’Œy
->
cŞ
 = 
	`of_mod2¥¬£_cŞ
 (
__e0
);

2911 
__cŞ
 = 
	`of_mod2¥¬£_cŞ
 (
__Ãw_’Œy
);

2913 
__Ãw_’Œy
->
Ëá
 = 
__´ev
;

2914 
__Ãw_’Œy
->
right
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (
__´ev
);

2915 
__Ãw_’Œy
->
Ëá
->
right
 = __new_entry;

2916 
__Ãw_’Œy
->
right
->
Ëá
 = __new_entry;

2919 ià(
__·rsšg
 !ğ
NULL
)

2921 ià(
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
__Ãw_’Œy
è] !ğ
NULL
)

2923 
__cŞ_’Œy
 = 
__·rsšg
[
__cŞ
];

2927 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
__cŞ
);

2932 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
__cŞ
);

2935 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2936 
__cŞ_’Œy_
 = 
__cŞ_’Œy
;

2938 !
	`of_mod2¥¬£_©_’d_cŞ
 (
__cŞ_’Œy
è&& 
	`of_mod2¥¬£_row
 (__cŞ_’Œyè< 
row1
)

2940 #ifdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2941 
__cŞ_’Œy_
 = 
__cŞ_’Œy
;

2943 
__cŞ_’Œy
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (__col_entry);

2946 
__Ãw_’Œy
->
down
 = 
__cŞ_’Œy
;

2947 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


2948 
__Ãw_’Œy
->
up
 = 
__cŞ_’Œy
->up;

2949 
__Ãw_’Œy
->
up
->
down
 = __new_entry;

2950 
__Ãw_’Œy
->
down
->
up
 = __new_entry;

2952 
__cŞ_’Œy_
->
down
 = 
__Ãw_’Œy
;

2955 ià(
__·rsšg
 !ğ
NULL
)

2957 
__·rsšg
[
	`of_mod2¥¬£_cŞ
 (
__Ãw_’Œy
) ] = __new_entry;

2960 
__e0
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__e0);

2963 
OF_EXIT_FUNCTION


2964  
row_weight
;

2968 
boŞ
 
	`of_mod2¥¬£_em±y_row
 (
of_mod2¥¬£
 * 
m
, 
UINT32
 
row
)

2970 
OF_ENTER_FUNCTION


2971 ià(
	`of_mod2¥¬£_©_’d_row
 (
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row
)))

2973 
OF_EXIT_FUNCTION


2974  
Œue
;

2977 
OF_EXIT_FUNCTION


2978  
çl£
;

2982 
boŞ
 
	`of_mod2¥¬£_em±y_cŞ
 (
of_mod2¥¬£
 * 
m
, 
UINT32
 
cŞ
)

2984 
OF_ENTER_FUNCTION


2985 ià(
m
 !ğ
NULL
)

2987 ià(
	`of_mod2¥¬£_©_’d_cŞ
 (
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
cŞ
)))

2989 
OF_EXIT_FUNCTION


2990  
Œue
;

2992 
OF_EXIT_FUNCTION


2993  
çl£
;

2997 
	`årštf
 (
¡d”r
, "mod2sparse_empty_col: Matrix m does‚otƒxist.");

2998 
OF_EXIT_FUNCTION


2999  
çl£
;

3004 
UINT32
 
	`of_mod2¥¬£_weight_row
 (
of_mod2¥¬£
 * 
m
, UINT32 
row
)

3006 
OF_ENTER_FUNCTION


3007 
of_mod2’Œy
 * 
__e
;

3008 
INT32
 
row_weight
;

3010 
row_weight
 = 0;

3012 
__e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
m
, 
row
);

3013 !
	`of_mod2¥¬£_©_’d
 (
__e
))

3015 ++
row_weight
;

3016 
__e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (__e);

3018 
OF_EXIT_FUNCTION


3019  
row_weight
;

3024 
UINT32
 
	`mod2¥¬£_weight_cŞ
 (
of_mod2¥¬£
 * 
m
, UINT32 
cŞ
)

3026 
OF_ENTER_FUNCTION


3027 
of_mod2’Œy
 * 
__e
;

3028 
INT32
 
cŞ_weight
;

3030 
cŞ_weight
 = 0;

3031 
__e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
m
, 
cŞ
);

3032 !
	`of_mod2¥¬£_©_’d
 (
__e
))

3034 ++
cŞ_weight
;

3035 
__e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (__e);

3037 
OF_EXIT_FUNCTION


3038  
cŞ_weight
;

3043 
	`of_mod2¥¬£_cİy_fËd_m©rix
 (
of_mod2¥¬£
 *
m
,

3044 
of_mod2¥¬£
 *
r
,

3045 
UINT32
 *
šdex_rows
,

3046 
UINT32
 *
šdex_cŞs
)

3048 
of_mod2’Œy
 *
e
;

3049 
UINT32
 
i
;

3051 
i
 = 0; i < 
	`of_mod2¥¬£_rows
(
m
); i++)

3053 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
(
m
, 
i
);

3054 !
	`of_mod2¥¬£_©_’d_row
(
e
))

3056 ià(!
	`of_mod2¥¬£_em±y_cŞ
(
m
, 
e
->
cŞ
è&& !
	`of_mod2¥¬£_em±y_row
(m,ƒ->
row
))

3059 
	`of_mod2¥¬£_š£¹
(
r
, 
šdex_rows
[
e
->
row
], 
šdex_cŞs
[e->
cŞ
]);

3061 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
(e);

	@src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_sparse.h

41 #iâdeà
OF_LDPC_MATRIX_SPARSE__


42 
	#OF_LDPC_MATRIX_SPARSE__


	)

45 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


52 
	sof_mod2’Œy


58 #ifdeà
SPARSE_MATRIX_OPT_SMALL_INDEXES


59 
cu¼’y
 
nÙ
 
	mu£d
... 
Ùh”wi£
 
»move
 
this
 
	mlše
...

60 
INT16
 
	mrow
;

61 
INT16
 
	mcŞ
;

63 
INT32
 
	mrow
;

64 
INT32
 
	mcŞ
;

70 
of_mod2’Œy
 *
	mËá
,

71 *
	mright
,

72 *
	mdown
;

73 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


74 
of_mod2’Œy
 *
	mup
;

76 } 
	tof_mod2’Œy
;

78 
	#of_mod2¥¬£_block
 1024

	)

84 
	sof_mod2block


87 
of_mod2block
 *
	mÃxt
;

90 
of_mod2’Œy
 
	m’Œy
[
of_mod2¥¬£_block
];

91 } 
	tof_mod2block
;

97 
	sof_mod2¥¬£


99 
INT32
 
	mn_rows
;

100 
INT32
 
	mn_cŞs
;

102 
of_mod2’Œy
 *
	mrows
;

103 
of_mod2’Œy
 *
	mcŞs
;

105 
of_mod2block
 *
	mblocks
;

106 
of_mod2’Œy
 *
	mÃxt_ä“
;

108 #ifdeà
LDPC_QC


109 
INT32
 
	mexp_çùÜ
;

111 } 
	tof_mod2¥¬£
;

120 
	#of_mod2¥¬£_fœ¡_š_row
(
m
,
i
è((m)->
rows
[i].
right
è

	)

121 
	#of_mod2¥¬£_fœ¡_š_cŞ
(
m
,
j
è((m)->
cŞs
[j].
down
è

	)

122 
	#of_mod2¥¬£_Ï¡_š_row
(
m
,
i
è((m)->
rows
[i].
Ëá
è

	)

123 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


124 
	#of_mod2¥¬£_Ï¡_š_cŞ
(
m
,
j
è((m)->
cŞs
[j].
up
)

	)

126 
of_mod2’Œy
 * 
of_mod2¥¬£_Ï¡_š_cŞ
 (
of_mod2¥¬£
 * 
m
, 
UINT32
 
i
);

129 
	#of_mod2¥¬£_Ãxt_š_row
(
e
è(Ó)->
right
è

	)

130 
	#of_mod2¥¬£_Ãxt_š_cŞ
(
e
è(Ó)->
down
è

	)

131 
	#of_mod2¥¬£_´ev_š_row
(
e
è(Ó)->
Ëá
è

	)

132 #iâdeà
SPARSE_MATRIX_OPT_FOR_LDPC_STAIRCASE


133 
	#of_mod2¥¬£_´ev_š_cŞ
(
e
è(Ó)->
up
)

	)

136 
	#of_mod2¥¬£_©_’d_cŞ
(
e
è(Ó)->
cŞ
 < 0è

	)

137 
	#of_mod2¥¬£_©_’d_row
(
e
è(Ó)->
row
 < 0è

	)

138 
	#of_mod2¥¬£_©_’d
(
e
è(Ó)->
row
 < 0è

	)

141 
	#of_mod2¥¬£_row
(
e
è(Ó)->
row
è

	)

142 
	#of_mod2¥¬£_cŞ
(
e
è(Ó)->
cŞ
è

	)

144 
	#of_mod2¥¬£_rows
(
m
è((m)->
n_rows
è

	)

145 
	#of_mod2¥¬£_cŞs
(
m
è((m)->
n_cŞs
è

	)

151 
	emod2¥¬£_¡¿‹gy_’um


152 { 
	mMod2¥¬£_fœ¡
,

153 
	mMod2¥¬£_mšcŞ
,

154 
	mMod2¥¬£_mš´od


155 } 
	tmod2¥¬£_¡¿‹gy
;

160 
of_mod2¥¬£
 *
of_mod2¥¬£_®loÿ‹
 (
UINT32
, UINT32);

162 
of_mod2¥¬£_ä“
 (
of_mod2¥¬£
 *);

164 
of_mod2¥¬£_ş—r
 (
of_mod2¥¬£
 *);

167 
of_mod2¥¬£_cİy
 (
of_mod2¥¬£
 *, of_mod2sparse *);

170 #ià
defšed
(
ML_DECODING
)

172 
of_mod2¥¬£_cİyrows
 (
of_mod2¥¬£
 *, of_mod2¥¬£ *, 
UINT32
 *);

173 
of_mod2¥¬£_cİycŞs
 (
of_mod2¥¬£
 *, of_mod2¥¬£ *, 
UINT32
 *);

185 
of_mod2¥¬£_cİyrows_İt
 (
of_mod2¥¬£
 * 
m
,

186 
of_mod2¥¬£
 * 
r
,

187 
UINT32
 * 
rows
,

188 
of_mod2’Œy
 ** 
__·rsšg
);

198 
of_mod2¥¬£_cİycŞs_İt
 (
of_mod2¥¬£
 * 
m
,

199 
of_mod2¥¬£
 * 
r
,

200 
UINT32
 * 
cŞs
);

211 
of_mod2¥¬£_´štf
 (
FILE
 * 
fout
, 
of_mod2¥¬£
 * 
m
);

214 
of_mod2¥¬£_´št
 (
FILE
 *, 
of_mod2¥¬£
 *);

215 
of_mod2¥¬£_´št_b™m­
 (
of_mod2¥¬£
 *
m
);

219 
UINT32
 
mod2¥¬£_wr™e
 (
FILE
 *, 
of_mod2¥¬£
 *);

220 
of_mod2¥¬£
 *
mod2¥¬£_»ad
 (
FILE
 *);

223 
UINT32
 
of_mod2¥¬£_wr™e_humª_»adabË
 (
FILE
 *,

224 
of_mod2¥¬£
 *,

225 
UINT32
 
nb_sourû
,

226 
UINT32
 
nb_·r™y
);

228 
of_mod2¥¬£
 *
of_mod2¥¬£_»ad_humª_»adabË
 (
FILE
 *
f
,

229 
UINT32
 *
nb_sourû
,

230 
UINT32
 *
nb_·r™y
);

234 
of_mod2¥¬£_m©rix_¡©s
 (
FILE
 *,

235 
of_mod2¥¬£
 *,

236 
UINT32
 
nb_¤c
,

237 
UINT32
 
nb_·r
);

240 
of_mod2’Œy
 *
of_mod2¥¬£_fšd
 (
of_mod2¥¬£
 *,

241 
UINT32
,

242 
UINT32
);

244 
of_mod2’Œy
 *
of_mod2¥¬£_š£¹
 (
of_mod2¥¬£
 *,

245 
UINT32
,

246 
UINT32
);

248 
of_mod2¥¬£_d–‘e
 (
of_mod2¥¬£
 *,

249 
of_mod2’Œy
 *);

252 #ià
defšed
(
ML_DECODING
)

275 
UINT32
 
of_mod2¥¬£_sw­_rows
 (
of_mod2¥¬£
 * 
m
,

276 
UINT32
 
row0
,

277 
UINT32
 
row1
,

278 
of_mod2¥¬£
 * 
__sw­M©rix
,

279 
of_mod2’Œy
 ** 
__lšks
,

280 
of_mod2’Œy
 ** 
__·rsšg
);

298 
UINT32
 
of_mod2¥¬£_xÜ_rows
 (
of_mod2¥¬£
 * 
m
,

299 
UINT32
 
row0
, UINT32 
row1
,

300 
of_mod2’Œy
 ** 
__lšks
,

301 
of_mod2’Œy
 ** 
__·rsšg
);

311 
boŞ
 
of_mod2¥¬£_em±y_row
 (
of_mod2¥¬£
 * 
m
, 
UINT32
 
row
);

322 
boŞ
 
of_mod2¥¬£_em±y_cŞ
 (
of_mod2¥¬£
 * 
m
, 
UINT32
 
cŞ
);

333 
UINT32
 
of_mod2¥¬£_weight_row
 (
of_mod2¥¬£
 * 
m
, UINT32 
row
);

345 
UINT32
 
mod2¥¬£_weight_cŞ
 (
of_mod2¥¬£
 * 
m
, UINT32 
cŞ
);

351 
mod2¥¬£_Œª¥o£
 (
of_mod2¥¬£
 *, of_mod2sparse *);

352 
mod2¥¬£_add
 (
of_mod2¥¬£
 *, of_mod2sparse *, of_mod2sparse *);

353 
mod2¥¬£_muÉly
 (
of_mod2¥¬£
 *, of_mod2sparse *, of_mod2sparse *);

354 
mod2¥¬£_mulvec
 (
of_mod2¥¬£
 *, 
UINT8
 *, UINT8 *);

356 
UINT32
 
mod2¥¬£_equ®
 (
of_mod2¥¬£
 *, of_mod2sparse *);

358 
UINT32
 
mod2¥¬£_couÁ_row
 (
of_mod2¥¬£
 *, UINT32);

359 
UINT32
 
mod2¥¬£_couÁ_cŞ
 (
of_mod2¥¬£
 *, UINT32);

361 
mod2¥¬£_add_row
 (
of_mod2¥¬£
 *, 
UINT32
, of_mod2sparse *, UINT32);

362 
mod2¥¬£_add_cŞ
 (
of_mod2¥¬£
 *, 
UINT32
, of_mod2sparse *, UINT32);

364 
UINT32
 
mod2¥¬£_decomp
 (
of_mod2¥¬£
 *, UINT32, of_mod2sparse *, of_mod2sparse *,

365 
UINT32
 *, UINT32 *, 
mod2¥¬£_¡¿‹gy
,UINT32, UINT32);

367 
UINT32
 
mod2¥¬£_fÜw¬d_sub
 (
of_mod2¥¬£
 *, UINT32 *, 
UINT8
 *, UINT8 *);

368 
UINT32
 
mod2¥¬£_backw¬d_sub
 (
of_mod2¥¬£
 *, UINT32 *, 
UINT8
 *, UINT8 *);

372 
of_mod2¥¬£_cİy_fËd_m©rix
 (
of_mod2¥¬£
 *
m
,

373 
of_mod2¥¬£
 *
r
,

374 
UINT32
 *
šdex_rows
,

375 
UINT32
 *
šdex_cŞs
);

	@src/lib_common/linear_binary_codes_utils/binary_matrix/of_tools.c

40 
	~"../of_lš—r_bš¬y_code.h
"

43 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


49 *
	$of_chk_®loc
 (
UINT32
 
n
,

50 
UINT32
 
size
)

52 *
p
;

54 
OF_ENTER_FUNCTION


55 
p
 = 
	`of_ÿÎoc
 (
n
, 
size
);

56 ià(
p
 =ğ
NULL
)

58 
	`årštf
 (
¡d”r
, "Rª ouˆoàmemÜy (whŒyšgØ®loÿ‹ %d by‹s)\n", 
n
*
size
);

59 
OF_EXIT_FUNCTION


60  
NULL
;

62 
OF_EXIT_FUNCTION


63  
p
;

64 
	}
}

81 
INT32
 
	$of_štio_»ad
 (
FILE
 *
f
)

83 
UINT8
 
b
[4];

84 
INT32
 
tİ
;

85 
INT32
 
i
;

87 
OF_ENTER_FUNCTION


88 
i
 = 0; i < 4; i++)

90 ià(
	`ä—d
 (&
b
[
i
], 1, 1, 
f
) != 1)

92 
OF_EXIT_FUNCTION


96 
tİ
 = 
b
[3] > 127 ? (
INT32
) b[3] - 256 : b[3];

97 
OF_EXIT_FUNCTION


98  (
tİ
 << 24è+ (
b
[2] << 16) + (b[1] << 8) + b[0];

99 
	}
}

110 
	$of_štio_wr™e
 (
FILE
 *
f
,

111 
INT32
 
v
)

113 
UINT8
 
b
;

114 
INT32
 
i
;

116 
OF_ENTER_FUNCTION


117 
i
 = 0; i < 3; i++)

119 
b
 = 
v
 & 0xff;

120 
	`fwr™e
 (&
b
, 1, 1, 
f
);

121 
v
 >>= 8;

123 
b
 = 
v
 > 0 ? v : v + 256;

124 
	`fwr™e
 (&
b
, 1, 1, 
f
);

125 
OF_EXIT_FUNCTION


126 
	}
}

130 
	$of_´št_compos™iÚ
 (* 
symbŞ
, 
UINT32
 
size
)

132 
UINT32
 
i
;

134 
OF_ENTER_FUNCTION


135 
i
 = 0;˜< 
size
;i++)

137 ià(
symbŞ
[
i
] != 0)

139 
	`´štf
 ("%d ", 
i
);

142 
	`´štf
 ("\n");

143 
OF_EXIT_FUNCTION


144 
	}
}

	@src/lib_common/linear_binary_codes_utils/binary_matrix/of_tools.h

40 #iâdeà
TOOLS_H__


41 
	#TOOLS_H__


	)

44 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


50 * 
of_chk_®loc
 (
UINT32
 
n
,

51 
UINT32
 
size
);

55 
of_´št_compos™iÚ
 (* 
symbŞ
,

56 
UINT32
 
size
);

61 
INT32
 
of_štio_»ad
 (
FILE
 *);

66 
of_štio_wr™e
 (
FILE
 *, 
INT32
);

	@src/lib_common/linear_binary_codes_utils/it_decoding/of_it_decoding.c

34 
	~"../of_lš—r_bš¬y_code.h
"

36 #ifdeà
OF_USE_DECODER


37 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


40 
of_¡©us_t
 
	$of_lš—r_bš¬y_code_decode_w™h_Ãw_symbŞ
 (
of_lš—r_bš¬y_code_cb_t
* 
ofcb
,

41 * 
Ãw_symbŞ
,

42 
UINT32
 
Ãw_symbŞ_esi
)

44 
of_mod2’Œy
 *
e
 = 
NULL
;

45 
of_mod2’Œy
 *
mod_’Œy_to_d–‘e
;

46 *
cÚ¡_‹rm
;

48 
UINT32
 
row
;

49 
UINT32
 *
bË_of_check_deg_1
 = 
NULL
;

51 
INT32
 
bË_of_check_deg_1_nb
 = 0;

52 
UINT32
 
size_of_bË_of_check_deg_1
 = 0;

53 
UINT32
 
decoded_symbŞ_esi
;

55 
OF_ENTER_FUNCTION


56 
	`ASSERT
(
ofcb
);

57 
	`ASSERT
(
Ãw_symbŞ
);

58 
	`ASSERT
(
Ãw_symbŞ_esi
 < 
ofcb
->
nb_tÙ®_symbŞs
);

63 ià(
ofcb
->
’codšg_symbŞs_b
[
Ãw_symbŞ_esi
] !ğ
NULL
)

65 
	`OF_TRACE_LVL
 (1, ("%s: % symbŞ (esi=%dè®»ady„eûived o¸»but, ignÜed.\n", 
__FUNCTION__
,

66 (
	`of_is_sourû_symbŞ
 ((
of_cb_t
*)
ofcb
, 
Ãw_symbŞ_esi
)) ? "source" : "parity",‚ew_symbol_esi))

67 #ifdeà
OF_DEBUG


68 ià(
	`of_is_sourû_symbŞ
 ((
of_cb_t
*)
ofcb
, 
Ãw_symbŞ_esi
))

69 
ofcb
->
¡©s_symbŞs
->
nb_sourû_symbŞs_ignÜed
++;

71 
ofcb
->
¡©s_symbŞs
->
nb_»·œ_symbŞs_ignÜed
++;

73 
OF_EXIT_FUNCTION


74  
OF_STATUS_OK
;

82 ià(
	`of_is_sourû_symbŞ
 ((
of_cb_t
*)
ofcb
, 
Ãw_symbŞ_esi
))

84 
ofcb
->
nb_sourû_symbŞ_»ady
++;

85 #ifdeà
OF_DEBUG


86 
ofcb
->
¡©s_symbŞs
->
nb_sourû_symbŞs_»ûived
++;

88 
ofcb
->
’codšg_symbŞs_b
[
Ãw_symbŞ_esi
] = 
Ãw_symbŞ
;

89 ià(
	`of_is_decodšg_com¶‘e
 ((
of_£ssiÚ_t
*)
ofcb
))

91 
	`OF_TRACE_LVL
 (1, ("%s: decodšg fšished\n", 
__FUNCTION__
))

92 
OF_EXIT_FUNCTION


93  
OF_STATUS_OK
;

98 
ofcb
->
nb_»·œ_symbŞ_»ady
++;

99 #ifdeà
OF_DEBUG


100 
ofcb
->
¡©s_symbŞs
->
nb_»·œ_symbŞs_»ûived
++;

104 ià((
ofcb
->
’codšg_symbŞs_b
[
Ãw_symbŞ_esi
] = (*)

105 
	`of_m®loc
 (
ofcb
->
’codšg_symbŞ_Ëngth
)è=ğ
NULL
)

107 
no_mem
;

110 
	`memıy
 (
ofcb
->
’codšg_symbŞs_b
[
Ãw_symbŞ_esi
], 
Ãw_symbŞ
, ofcb->
’codšg_symbŞ_Ëngth
);

112 
	`OF_TRACE_LVL
 (1, ("%s:‚ew %s symbol (esi=%d),otal of %d/%d source/repair symbols„eady\n",

113 
__FUNCTION__
, (
	`of_is_sourû_symbŞ
 ((
of_cb_t
*)
ofcb
, 
Ãw_symbŞ_esi
)) ? "source" : "parity",

114 
Ãw_symbŞ_esi
, 
ofcb
->
nb_sourû_symbŞ_»ady
, ofcb->
nb_»·œ_symbŞ_»ady
))

120 
e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
ofcb
->
pchk_m©rix
, 
	`of_g‘_symbŞ_cŞ
 ((
of_cb_t
*)ofcb, 
Ãw_symbŞ_esi
)); !
	`of_mod2¥¬£_©_’d_cŞ
 (e); )

124 
row
 = 
e
->row;

125 
ofcb
->
b_nb_unknown_symbŞs
[
row
]--;

126 
cÚ¡_‹rm
 = 
ofcb
->
b_cÚ¡_‹rm_of_equ
[
row
];

127 ià((
cÚ¡_‹rm
 =ğ
NULL
è&& ((
ofcb
->
b_nb_unknown_symbŞs
[
row
] == 1)))

132 
cÚ¡_‹rm
 = (*è
	`of_ÿÎoc
 (1, 
ofcb
->
’codšg_symbŞ_Ëngth
);

133 ià((
ofcb
->
b_cÚ¡_‹rm_of_equ
[
row
] = 
cÚ¡_‹rm
è=ğ
NULL
)

135 
no_mem
;

138 ià(
cÚ¡_‹rm
 !ğ
NULL
)

140 
mod_’Œy_to_d–‘e
 = 
e
;

141 
of_mod2’Œy
 *
tmp_e
;

142 
UINT32
 
tmp_esi
;

143 *
tmp_symbŞ
;

146 ià(
ofcb
->
b_nb_’c_symbŞs_³r_equ
[
row
] > 1)

150 
	`of_add_to_symbŞ
 (
cÚ¡_‹rm
, 
Ãw_symbŞ
, 
ofcb
->
’codšg_symbŞ_Ëngth


151 #ifdeà
OF_DEBUG


152 , &(
ofcb
->
¡©s_xÜ
->
nb_xÜ_fÜ_IT
)

160 
e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e);

161 
	`of_mod2¥¬£_d–‘e
 (
ofcb
->
pchk_m©rix
, 
mod_’Œy_to_d–‘e
);

162 
ofcb
->
b_nb_’c_symbŞs_³r_equ
[
row
]--;

163 ià(
	`of_is_»·œ_symbŞ
 ((
of_cb_t
*)
ofcb
, 
Ãw_symbŞ_esi
))

165 
ofcb
->
b_nb_equ_fÜ_»·œ
[
Ãw_symbŞ_esi
 - ofcb->
nb_sourû_symbŞs
]--;

170 
tmp_e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
ofcb
->
pchk_m©rix
, 
row
); !
	`of_mod2¥¬£_©_’d_row
 (tmp_e); )

172 
tmp_esi
 = 
	`of_g‘_symbŞ_esi
 ((
of_cb_t
*)
ofcb
, 
tmp_e
->
cŞ
);

173 
tmp_symbŞ
 = 
ofcb
->
’codšg_symbŞs_b
[
tmp_esi
];

174 ià(
tmp_symbŞ
 !ğ
NULL
)

177 
	`of_add_to_symbŞ
 (
cÚ¡_‹rm
, 
tmp_symbŞ
, 
ofcb
->
’codšg_symbŞ_Ëngth


178 #ifdeà
OF_DEBUG


179 , &(
ofcb
->
¡©s_xÜ
->
nb_xÜ_fÜ_IT
)

183 
mod_’Œy_to_d–‘e
 = 
tmp_e
;

184 
tmp_e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (tmp_e);

185 
	`of_mod2¥¬£_d–‘e
 (
ofcb
->
pchk_m©rix
, 
mod_’Œy_to_d–‘e
);

186 
ofcb
->
b_nb_’c_symbŞs_³r_equ
[
row
]--;

187 ià(
	`of_is_»·œ_symbŞ
 ((
of_cb_t
*)
ofcb
, 
tmp_esi
))

189 
ofcb
->
b_nb_equ_fÜ_»·œ
[
tmp_esi
 - ofcb->
nb_sourû_symbŞs
]--;

190 #iâdeà
ML_DECODING


193 ià(
ofcb
->
b_nb_equ_fÜ_»·œ
[
tmp_esi
 - ofcb->
nb_sourû_symbŞs
] == 0)

195 
	`of_ä“
 (
tmp_symbŞ
);

196 
ofcb
->
’codšg_symbŞs_b
[
tmp_esi
] = 
NULL
;

204 
tmp_e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (tmp_e);

212 
e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e);

214 ià(
ofcb
->
b_nb_’c_symbŞs_³r_equ
[
row
] == 1)

218 ià(
bË_of_check_deg_1
 =ğ
NULL
)

221 
size_of_bË_of_check_deg_1
 = 4;

222 ià((
bË_of_check_deg_1
 = (
UINT32
*è
	`of_ÿÎoc
 (
size_of_bË_of_check_deg_1
,  (UINT32*))è=ğ
NULL
)

224 
no_mem
;

227 ià(
bË_of_check_deg_1_nb
 =ğ
size_of_bË_of_check_deg_1
)

230 
size_of_bË_of_check_deg_1
 += 4;

231 ià((
bË_of_check_deg_1
 = (
UINT32
*è
	`of_»®loc
 (bË_of_check_deg_1, 
size_of_bË_of_check_deg_1
 *  (UINT32*))è=ğ
NULL
)

233 
no_mem
;

236 
bË_of_check_deg_1
[
bË_of_check_deg_1_nb
++] = 
row
;

243 
bË_of_check_deg_1_nb
--;able_of_check_deg_1_nb >= 0;able_of_check_deg_1_nb--)

245 ià(
	`of_is_decodšg_com¶‘e
 ((
of_£ssiÚ_t
*)
ofcb
))

252 
row
 = 
bË_of_check_deg_1
[
bË_of_check_deg_1_nb
];

253 ià(
ofcb
->
b_nb_’c_symbŞs_³r_equ
[
row
] == 1)

259 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
ofcb
->
pchk_m©rix
, 
row
);

260 
	`ASSERT
 (!
	`of_mod2¥¬£_©_’d_row
 (
e
è&& of_mod2¥¬£_©_’d_row (e->
right
))

261 
decoded_symbŞ_esi
 = 
	`of_g‘_symbŞ_esi
 ((
of_cb_t
*)
ofcb
, 
e
->
cŞ
);

263 
cÚ¡_‹rm
 = 
ofcb
->
b_cÚ¡_‹rm_of_equ
[
row
];

264 
ofcb
->
b_cÚ¡_‹rm_of_equ
[
row
] = 
NULL
;

265 
ofcb
->
b_nb_’c_symbŞs_³r_equ
[
row
]--;

266 ià(
	`of_is_»·œ_symbŞ
 ((
of_cb_t
*)
ofcb
, 
decoded_symbŞ_esi
))

268 
ofcb
->
b_nb_equ_fÜ_»·œ
[
decoded_symbŞ_esi
 - ofcb->
nb_sourû_symbŞs
]--;

270 
	`of_mod2¥¬£_d–‘e
 (
ofcb
->
pchk_m©rix
, 
e
);

271 
	`OF_TRACE_LVL
 (1, ("%s: REBUILT % symbŞ %d\n", 
__FUNCTION__
,

272 (
	`of_is_»·œ_symbŞ
 ((
of_cb_t
*)
ofcb
, 
decoded_symbŞ_esi
)) ? "Parity" : "Source",

273 
decoded_symbŞ_esi
));

274 ià(
	`of_is_sourû_symbŞ
 ((
of_cb_t
*)
ofcb
, 
decoded_symbŞ_esi
))

277 *
decoded_symbŞ_d¡
;

278 #ifdeà
OF_DEBUG


279 
ofcb
->
¡©s_symbŞs
->
nb_sourû_symbŞs_but_w™h_™
++;

280 
ofcb
->
¡©s_symbŞs
->
nb_sourû_symbŞs_»ûived
--;

283 ià(
ofcb
->
decoded_sourû_symbŞ_ÿÎback
 !ğ
NULL
)

287 ià((
decoded_symbŞ_d¡
 = 
ofcb
->
	`decoded_sourû_symbŞ_ÿÎback
(

288 
ofcb
->
cÚ‹xt_4_ÿÎback
,

289 
ofcb
->
’codšg_symbŞ_Ëngth
,

290 
decoded_symbŞ_esi
)è!ğ
NULL
)

293 
	`memıy
 (
decoded_symbŞ_d¡
, 
cÚ¡_‹rm
, 
ofcb
->
’codšg_symbŞ_Ëngth
);

295 
	`of_ä“
 (
cÚ¡_‹rm
);

300 
decoded_symbŞ_d¡
 = 
cÚ¡_‹rm
;

306 
decoded_symbŞ_d¡
 = 
cÚ¡_‹rm
;

309 
	`of_lš—r_bš¬y_code_decode_w™h_Ãw_symbŞ
 (
ofcb
, 
decoded_symbŞ_d¡
, 
decoded_symbŞ_esi
);

313 #ifdeà
OF_DEBUG


314 
ofcb
->
¡©s_symbŞs
->
nb_»·œ_symbŞs_but_w™h_™
++;

315 
ofcb
->
¡©s_symbŞs
->
nb_»·œ_symbŞs_»ûived
--;

318 ià(
ofcb
->
decoded_»·œ_symbŞ_ÿÎback
 !ğ
NULL
)

320 
ofcb
->
	`decoded_»·œ_symbŞ_ÿÎback
 (ofcb->
cÚ‹xt_4_ÿÎback
,

321 
ofcb
->
’codšg_symbŞ_Ëngth
,

322 
decoded_symbŞ_esi
);

325 
	`of_lš—r_bš¬y_code_decode_w™h_Ãw_symbŞ
 (
ofcb
, 
cÚ¡_‹rm
, 
decoded_symbŞ_esi
);

327 
	`of_ä“
 (
cÚ¡_‹rm
);

331 ià(
bË_of_check_deg_1
 !ğ
NULL
)

333 
	`of_ä“
 (
bË_of_check_deg_1
);

337 
OF_EXIT_FUNCTION


338  
OF_STATUS_OK
;

340 
no_mem
:

341 
	`OF_PRINT_ERROR
(("out of memory\n"));

342 
OF_EXIT_FUNCTION


343  
OF_STATUS_FATAL_ERROR
;

344 
	}
}

	@src/lib_common/linear_binary_codes_utils/it_decoding/of_it_decoding.h

34 #iâdeà
IT_DECODING_H


35 
	#IT_DECODING_H


	)

38 #ifdeà
OF_USE_DECODER


39 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


52 
of_¡©us_t
 
of_lš—r_bš¬y_code_decode_w™h_Ãw_symbŞ
(
of_lš—r_bš¬y_code_cb_t
* 
ofcb
,* 
Ãw_symbŞ
,
UINT32
 
Ãw_symbŞ_esi
);

	@src/lib_common/linear_binary_codes_utils/ml_decoding/of_ml_decoding.c

34 
	~"../of_lš—r_bš¬y_code.h
"

37 #ifdeà
OF_USE_DECODER


38 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


39 #ifdeà
ML_DECODING


52 
of_¡©us_t


53 
of_lš—r_bš¬y_code_´•¬_lš—r_sy¡em
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
);

68 
of_¡©us_t


69 
of_lš—r_bš¬y_code_sim¶ify_lš—r_sy¡em_w™h_a_symbŞ
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
,

70 cÚ¡ *
Ãw_symbŞ
,

71 
UINT32
 
Ãw_symbŞ_esi
);

81 
of_¡©us_t


82 
of_lš—r_bš¬y_code_ü—‹_sim¶if›d_lš—r_sy¡em
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
);

88 
of_¡©us_t


89 
	$of_lš—r_bš¬y_code_fšish_decodšg_w™h_ml
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
)

91 
INT32
 
i
;

92 
UINT32
 *
³rmutiÚ_¬¿y
 = 
NULL
;

93 
of_mod2d’£
 *
d’£_pchk_m©rix_sim¶if›d
 = 
NULL
;

94 
INT32
 *
cŞumn_idx
 = 
NULL
;

95 **
cÚ¡_‹rm
 = 
NULL
;

96 **
v¬ŸbË_memb”
 = 
NULL
;

97 
UINT32
 
nb_compu‹d_»·œ_š_ml
;

98 #ifdeà
DEBUG


99 
timev®
 
gdtv0
;

100 
timev®
 
gdtv1
;

101 
timev®
 
gdtv_d–
;

104 
OF_ENTER_FUNCTION


105 
	`OF_TRACE_LVL
 (1, ("ML decoding on…arity check matrix\n"))

115 
ofcb
->
»maš_rows
 = ofcb->
nb_»·œ_symbŞs
;

116 
ofcb
->
»maš_cŞs
 = ofcb->
nb_sourû_symbŞs
 + ofcb->
nb_»·œ_symbŞs
;

117 ià(
	`of_lš—r_bš¬y_code_´•¬_lš—r_sy¡em
 (
ofcb
è!ğ
OF_STATUS_OK
)

119 ià(
ofcb
->
»maš_cŞs
 == 0)

122 
	`OF_TRACE_LVL
 (1, ("Create simplified†inear system says it's finished!\n"))

123 
OF_EXIT_FUNCTION


124  
OF_STATUS_FAILURE
;

127 
	`OF_TRACE_LVL
 (1, ("C»©sim¶if›d†š—¸sy¡em faed, ofcb->»maš_cŞs=%d\n", 
ofcb
->
»maš_cŞs
))

128 
OF_EXIT_FUNCTION


129  
OF_STATUS_FAILURE
;

134 
i
 = 0 ; i < 
ofcb
->
nb_sourû_symbŞs
 ; i++)

136 ià(
ofcb
->
’codšg_symbŞs_b
[
i
] !ğ
NULL
)

138 ià(
	`of_lš—r_bš¬y_code_sim¶ify_lš—r_sy¡em_w™h_a_symbŞ
 (
ofcb
, ofcb->
’codšg_symbŞs_b
[
i
], iè!ğ
OF_STATUS_OK
)

140 
	`OF_TRACE_LVL
(0,("Simplifyinghe matrix with source symbols failed\n"))

141 
OF_EXIT_FUNCTION


142  
OF_STATUS_FAILURE
;

150 
³rmutiÚ_¬¿y
 = (
UINT32
 *è
	`of_m®loc
 (
ofcb
->
nb_»·œ_symbŞs
 * (UINT32));

151 
i
 = 0 ; i < 
ofcb
->
nb_»·œ_symbŞs
 ; i++)

153 
³rmutiÚ_¬¿y
[
i
] = i;

155 
i
 = 0 ; i < 
ofcb
->
nb_»·œ_symbŞs
 ; i++)

157 
INT32
 
backup
;

158 
INT32
 
¿nd_v®
;

160 
backup
 = 
³rmutiÚ_¬¿y
[
i
];

161 
¿nd_v®
 = 
	`¿nd
(è% 
ofcb
->
nb_»·œ_symbŞs
;

162 
³rmutiÚ_¬¿y
[
i
] =…”mutiÚ_¬¿y[
¿nd_v®
];

163 
³rmutiÚ_¬¿y
[
¿nd_v®
] = 
backup
;

166 
i
 = 0 ; i < 
ofcb
->
nb_»·œ_symbŞs
 ; i++)

168 ià(
ofcb
->
’codšg_symbŞs_b
[ofcb->
nb_sourû_symbŞs
+
³rmutiÚ_¬¿y
[
i
]] !ğ
NULL
)

170 ià(
	`of_lš—r_bš¬y_code_sim¶ify_lš—r_sy¡em_w™h_a_symbŞ
 (
ofcb
, ofcb->
’codšg_symbŞs_b
[ofcb->
nb_sourû_symbŞs
+
³rmutiÚ_¬¿y
[
i
]],

171 
	`of_g‘_symbŞ_esi
 ((
of_cb_t
*)
ofcb
, 
³rmutiÚ_¬¿y
[
i
])è!ğ
OF_STATUS_OK
)

173 
	`OF_TRACE_LVL
(0,("Simplifyinghe matrix with…arity symbols failed\n"))

174 
çu»
;

178 
	`of_ä“
 (
³rmutiÚ_¬¿y
);

179 
³rmutiÚ_¬¿y
 = 
NULL
;

180 
	`OF_TRACE_LVL
 (1, ("%s: ofcb->»maš_rows=%d, ofcb->»maš_cŞs=%d\n", 
__FUNCTION__
, 
ofcb
->
»maš_rows
, ofcb->
»maš_cŞs
))

181 ià(
	`of_lš—r_bš¬y_code_ü—‹_sim¶if›d_lš—r_sy¡em
 (
ofcb
è!ğ
OF_STATUS_OK
)

183 
	`OF_TRACE_LVL
(0, ("Create Simplified Linear System failed\n"))

184 
çu»
;

186 #ifdeà
IL_SUPPORT


187 
	`of_mod2¥¬£_´št_b™m­
(
ofcb
->
pchk_m©rix_sim¶if›d
);

192 
d’£_pchk_m©rix_sim¶if›d
 = 
	`of_mod2d’£_®loÿ‹
 (
ofcb
->
pchk_m©rix_sim¶if›d
->
n_rows
, ofcb->pchk_m©rix_sim¶if›d->
n_cŞs
);

193 
	`of_mod2¥¬£_to_d’£
 (
ofcb
->
pchk_m©rix_sim¶if›d
, 
d’£_pchk_m©rix_sim¶if›d
);

195 
	`of_mod2¥¬£_ä“
 (
ofcb
->
pchk_m©rix_sim¶if›d
);

196 
	`of_ä“
 (
ofcb
->
pchk_m©rix_sim¶if›d
);

197 
ofcb
->
pchk_m©rix_sim¶if›d
 = 
NULL
;

199 #ifdeà
DEBUG


200 
	`g‘timeofday
 (&
gdtv0
, 
NULL
);

201 
	`OF_TRACE_LVL
 (1, ("gauss_decodšg_¡¬t=%ld.%ld\n", 
gdtv0
.
tv_£c
, gdtv0.
tv_u£c
))

203 ià((
cŞumn_idx
 = (
INT32
 *è
	`of_m®loc
 (
	`of_mod2d’£_cŞs
 (
d’£_pchk_m©rix_sim¶if›d
è*  (INT32))è=ğ
NULL
)

205 
no_mem
;

207 
i
 = 0; i < 
	`of_mod2d’£_cŞs
 (
d’£_pchk_m©rix_sim¶if›d
); i++)

209 
cŞumn_idx
[
i
] = i;

211 ià((
cÚ¡_‹rm
 = (**è
	`of_m®loc
 (
	`of_mod2d’£_rows
 (
d’£_pchk_m©rix_sim¶if›d
è*  (*))è=ğ
NULL
)

213 
no_mem
;

215 
i
 = 0; i < 
	`of_mod2d’£_rows
 (
d’£_pchk_m©rix_sim¶if›d
); i++)

217 
cÚ¡_‹rm
[
i
] = 
ofcb
->
b_cÚ¡_‹rm_of_equ
[ofcb->
šdex_rows
[i]];

218 
ofcb
->
b_cÚ¡_‹rm_of_equ
[ofcb->
šdex_rows
[
i
]] = 
NULL
;

220 ià((
v¬ŸbË_memb”
 = (**è
	`of_ÿÎoc
 (
	`of_mod2d’£_cŞs
 (
d’£_pchk_m©rix_sim¶if›d
),  (*))è=ğ
NULL
)

222 
no_mem
;

227 ià(
	`of_lš—r_bš¬y_code_sŞve_d’£_sy¡em
 (
ofcb
, 
d’£_pchk_m©rix_sim¶if›d
, 
cÚ¡_‹rm
, 
v¬ŸbË_memb”
è!ğ
OF_STATUS_OK
)

229 
	`OF_TRACE_LVL
(0,("Solve dense system failed\n"))

230 
çu»
;

235 
	`OF_TRACE_LVL
 (1, ("Solve dense system successful\n"))

236 
nb_compu‹d_»·œ_š_ml
 = 
ofcb
->
nb_»·œ_symbŞs
 - ofcb->
nb_»·œ_symbŞ_»ady
;

238 
i
 = 0; i < 
nb_compu‹d_»·œ_š_ml
; i++)

240 ià(
v¬ŸbË_memb”
[
i
] !ğ
NULL
)

241 
	`of_ä“
(
v¬ŸbË_memb”
[
i
]);

244 
i
 = 0; i < 
ofcb
->
nb_sourû_symbŞs
; i++)

246 ià(
ofcb
->
’codšg_symbŞs_b
[
i
] =ğ
NULL
)

248 
ofcb
->
’codšg_symbŞs_b
[
i
] = 
v¬ŸbË_memb”
[
nb_compu‹d_»·œ_š_ml
];

249 
nb_compu‹d_»·œ_š_ml
++;

252 #ifdeà
DEBUG


253 ià(
	`of_is_decodšg_com¶‘e
 (
ofcb
))

255 
	`OF_TRACE_LVL
 (1, ("ML decoding successful\n"))

257 
	`g‘timeofday
 (&
gdtv1
, 
NULL
);

258 
	`tim”sub
 (&
gdtv1
, &
gdtv0
, &
gdtv_d–
);

259 
	`OF_TRACE_LVL
 (1, ("gauss_decoding_end=%ld.%ld gauss_decoding_time=%ld.%06ld \n",

260 
gdtv1
.
tv_£c
, gdtv1.
tv_u£c
, 
gdtv_d–
.tv_sec, gdtv_delta.tv_usec))

263 
i
 = 0; i < 
	`of_mod2d’£_rows
 (
d’£_pchk_m©rix_sim¶if›d
); i++)

265 ià(
cÚ¡_‹rm
[
i
])

267 
	`of_ä“
(
cÚ¡_‹rm
[
i
]);

270 
	`of_ä“
(
cÚ¡_‹rm
);

271 
cÚ¡_‹rm
 = 
NULL
;

272 
	`of_ä“
(
v¬ŸbË_memb”
);

273 
v¬ŸbË_memb”
 = 
NULL
;

274 
	`of_ä“
(
cŞumn_idx
);

275 
cŞumn_idx
 = 
NULL
;

276 
	`of_mod2d’£_ä“
(
d’£_pchk_m©rix_sim¶if›d
);

277 
d’£_pchk_m©rix_sim¶if›d
 = 
NULL
;

278 
OF_EXIT_FUNCTION


279  
OF_STATUS_OK
;

281 
çu»
:

282 ià(
³rmutiÚ_¬¿y
 !ğ
NULL
)

284 
	`of_ä“
 (
³rmutiÚ_¬¿y
);

285 
³rmutiÚ_¬¿y
 = 
NULL
;

287 ià(
cÚ¡_‹rm
 !ğ
NULL
)

289 
i
 = 0; i < 
	`of_mod2d’£_rows
 (
d’£_pchk_m©rix_sim¶if›d
); i++)

291 ià(
cÚ¡_‹rm
[
i
])

293 
	`of_ä“
(
cÚ¡_‹rm
[
i
]);

296 
	`of_ä“
(
cÚ¡_‹rm
);

297 
cÚ¡_‹rm
 = 
NULL
;

299 ià(
v¬ŸbË_memb”
 !ğ
NULL
)

301 
	`of_ä“
(
v¬ŸbË_memb”
);

302 
v¬ŸbË_memb”
 = 
NULL
;

304 ià(
cŞumn_idx
 !ğ
NULL
)

306 
	`of_ä“
(
cŞumn_idx
);

307 
cŞumn_idx
 = 
NULL
;

309 ià(
d’£_pchk_m©rix_sim¶if›d
 !ğ
NULL
)

311 
	`of_mod2d’£_ä“
(
d’£_pchk_m©rix_sim¶if›d
);

312 
d’£_pchk_m©rix_sim¶if›d
 = 
NULL
;

314 
OF_EXIT_FUNCTION


315  
OF_STATUS_FAILURE
;

317 
no_mem
:

318 
	`OF_PRINT_ERROR
(("out of memory"))

319 
OF_EXIT_FUNCTION


320  
OF_STATUS_FATAL_ERROR
;

321 
	}
}

327 
of_¡©us_t


328 
	$of_lš—r_bš¬y_code_´•¬_lš—r_sy¡em
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
)

330 
INT32
 
_row
;

331 
INT32
 
_cŞ
;

333 
OF_ENTER_FUNCTION


334 ià(
ofcb
->
šdex_rows
 =ğ
NULL
)

336 
ofcb
->
šdex_rows
 = (
UINT32
*è
	`of_ÿÎoc
 (ofcb->
nb_»·œ_symbŞs
,  (UINT32));

338 ià(
ofcb
->
šdex_cŞs
 =ğ
NULL
)

340 
ofcb
->
šdex_cŞs
 = (
UINT32
*è
	`of_ÿÎoc
 (ofcb->
nb_tÙ®_symbŞs
,  (UINT32));

342 
_row
 = 0; _row < 
ofcb
->
nb_»·œ_symbŞs
; _row++)

344 
ofcb
->
šdex_rows
[
_row
] = _row;

346 
ofcb
->
»maš_rows
 = 
_row
;

347 
_cŞ
 = 0; _cŞ < 
ofcb
->
nb_tÙ®_symbŞs
; _col++)

349 
ofcb
->
šdex_cŞs
[
_cŞ
] = _col;

351 
ofcb
->
»maš_cŞs
 = 
_cŞ
;

353 
_row
 = 0 ; _row < 
ofcb
->
nb_»·œ_symbŞs
 ; _row++)

355 
of_mod2’Œy
 *
e
;

357 
ofcb
->
b_nb_’c_symbŞs_³r_equ
[
_row
] = 0;

358 
ofcb
->
b_nb_unknown_symbŞs
[
_row
] = 0;

359 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
ofcb
->
pchk_m©rix
, 
_row
); !
	`of_mod2¥¬£_©_’d
 (e);ƒ = 
	`of_mod2¥¬£_Ãxt_š_row
 (e))

361 
ofcb
->
b_nb_’c_symbŞs_³r_equ
[
_row
]++;

362 
ofcb
->
b_nb_unknown_symbŞs
[
_row
]++;

365 
OF_EXIT_FUNCTION


366  
OF_STATUS_OK
;

367 
	}
}

370 
of_¡©us_t


371 
	$of_lš—r_bš¬y_code_sim¶ify_lš—r_sy¡em_w™h_a_symbŞ
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
,

372 cÚ¡ *
Ãw_symbŞ
,

373 
UINT32
 
Ãw_symbŞ_esi
)

375 
of_mod2’Œy
 *
_e
;

376 
of_mod2’Œy
 *
_d–_me
;

377 
INT32
 
_row
;

379 
OF_ENTER_FUNCTION


380 ià(
	`of_mod2¥¬£_em±y_cŞ
 (
ofcb
->
pchk_m©rix
, 
	`of_g‘_symbŞ_cŞ
((
of_cb_t
*)ofcb, 
Ãw_symbŞ_esi
)))

382 
	`OF_TRACE_LVL
 (1, (("‚othingo do, colƒmpty\n")))

383 
OF_EXIT_FUNCTION


384  
OF_STATUS_OK
;

386 ià(
	`of_is_sourû_symbŞ
((
of_cb_t
*)
ofcb
, 
Ãw_symbŞ_esi
è&& 
	`of_is_decodšg_com¶‘e
((
of_£ssiÚ_t
*)ofcb))

389 
	`OF_TRACE_LVL
 (1, ((" decoding is finished!\n")))

390 
OF_EXIT_FUNCTION


391  
OF_STATUS_OK
;

393 
_e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
ofcb
->
pchk_m©rix
, 
	`of_g‘_symbŞ_cŞ
((
of_cb_t
*)ofcb, 
Ãw_symbŞ_esi
));

394 !
	`of_mod2¥¬£_©_’d_cŞ
 (
_e
))

396 
_row
 = 
	`of_mod2¥¬£_row
 (
_e
);

398 ià(
ofcb
->
b_cÚ¡_‹rm_of_equ
[
_row
] =ğ
NULL
)

400 ià((
ofcb
->
b_cÚ¡_‹rm_of_equ
[
_row
] = 
	`of_m®loc
 (ofcb->
’codšg_symbŞ_Ëngth
)è=ğ
NULL
)

402 
no_mem
;

404 
	`memıy
(
ofcb
->
b_cÚ¡_‹rm_of_equ
[
_row
], 
Ãw_symbŞ
, ofcb->
’codšg_symbŞ_Ëngth
);

409 
	`of_add_to_symbŞ
((
ofcb
->
b_cÚ¡_‹rm_of_equ
[
_row
]), 
Ãw_symbŞ
, ofcb->
’codšg_symbŞ_Ëngth


410 #ifdeà
OF_DEBUG


411 , &(
ofcb
->
¡©s_xÜ
->
nb_xÜ_fÜ_ML
)

416 
ofcb
->
b_nb_unknown_symbŞs
[
_row
]--;

418 
_d–_me
 = 
_e
;

419 
_e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (_e);

420 
	`of_mod2¥¬£_d–‘e
 (
ofcb
->
pchk_m©rix
, 
_d–_me
);

422 ià(
ofcb
->
b_nb_unknown_symbŞs
[
_row
] == 1)

424 
of_mod2’Œy
 *
__r
;

425 
UINT32
 
decoded_symbŞ_£qno
;

428 
__r
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
ofcb
->
pchk_m©rix
, 
_row
);

429 
decoded_symbŞ_£qno
 = 
	`of_g‘_symbŞ_esi
 ((
of_cb_t
*)
ofcb
, 
	`of_mod2¥¬£_cŞ
 (
__r
));

431 ià(
	`of_is_sourû_symbŞ
 ((
of_cb_t
*)
ofcb
, 
decoded_symbŞ_£qno
))

433 ià(
ofcb
->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
] =ğ
NULL
)

435 ià(
ofcb
->
decoded_sourû_symbŞ_ÿÎback
 !ğ
NULL
)

437 
ofcb
->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
] =

438 
ofcb
->
	`decoded_sourû_symbŞ_ÿÎback
(ofcb->
cÚ‹xt_4_ÿÎback
,

439 
ofcb
->
’codšg_symbŞ_Ëngth
,

440 
decoded_symbŞ_£qno
);

444 
ofcb
->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
] = 
	`of_m®loc
 (ofcb->
’codšg_symbŞ_Ëngth
);

446 ià(
ofcb
->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
] =ğ
NULL
)

448 
no_mem
;

451 
	`memıy
((
ofcb
->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
]),

452 (
ofcb
->
b_cÚ¡_‹rm_of_equ
[
_row
]),

453 
ofcb
->
’codšg_symbŞ_Ëngth
);

454 
	`of_ä“
 (
ofcb
->
b_cÚ¡_‹rm_of_equ
[
_row
]);

455 
ofcb
->
b_cÚ¡_‹rm_of_equ
[
_row
] = 
NULL
;

457 
ofcb
->
b_nb_unknown_symbŞs
[
_row
]--;

458 
	`of_mod2¥¬£_d–‘e
 (
ofcb
->
pchk_m©rix
, 
__r
);

459 
	`of_lš—r_bš¬y_code_sim¶ify_lš—r_sy¡em_w™h_a_symbŞ
 (
ofcb
, ofcb->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
],

460 
decoded_symbŞ_£qno
);

461 
ofcb
->
nb_sourû_symbŞ_»ady
++;

467 ià(
ofcb
->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
] =ğ
NULL
)

469 ià(
ofcb
->
decoded_»·œ_symbŞ_ÿÎback
 !ğ
NULL
)

471 
ofcb
->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
] =

472 
ofcb
->
	`decoded_»·œ_symbŞ_ÿÎback
(ofcb->
cÚ‹xt_4_ÿÎback
,

473 
ofcb
->
’codšg_symbŞ_Ëngth
,

474 
decoded_symbŞ_£qno
);

478 
ofcb
->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
] = 
	`of_m®loc
 (ofcb->
’codšg_symbŞ_Ëngth
);

480 ià(
ofcb
->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
] =ğ
NULL
)

482 
no_mem
;

485 
	`memıy
(
ofcb
->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
],

486 
ofcb
->
b_cÚ¡_‹rm_of_equ
[
_row
],

487 
ofcb
->
’codšg_symbŞ_Ëngth
);

488 
	`of_ä“
 (
ofcb
->
b_cÚ¡_‹rm_of_equ
[
_row
]);

489 
ofcb
->
b_cÚ¡_‹rm_of_equ
[
_row
] = 
NULL
;

491 
ofcb
->
b_nb_unknown_symbŞs
[
_row
]--;

492 
ofcb
->
b_nb_equ_fÜ_»·œ
[
decoded_symbŞ_£qno
 - ofcb->
nb_sourû_symbŞs
]--;

493 
	`of_mod2¥¬£_d–‘e
 (
ofcb
->
pchk_m©rix
, 
__r
);

494 
	`of_lš—r_bš¬y_code_sim¶ify_lš—r_sy¡em_w™h_a_symbŞ
 (
ofcb
, ofcb->
’codšg_symbŞs_b
[
decoded_symbŞ_£qno
],

495 
decoded_symbŞ_£qno
);

496 
ofcb
->
nb_»·œ_symbŞ_»ady
++;

499 
ofcb
->
»maš_rows
--;

502 
ofcb
->
»maš_cŞs
--;

503 
OF_EXIT_FUNCTION


504  
OF_STATUS_OK
;

506 
no_mem
:

507 
	`OF_PRINT_ERROR
(("out of memory"))

508 
OF_EXIT_FUNCTION


509  
OF_STATUS_FATAL_ERROR
;

510 
	}
}

513 
of_¡©us_t
 
	$of_lš—r_bš¬y_code_ü—‹_sim¶if›d_lš—r_sy¡em
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
)

515 
INT32
 
_row
;

516 
INT32
 
_cŞ
;

517 
of_mod2¥¬£
 *
__pchk_m©rix_sim¶if›d_cŞs
;

518 
UINT32
 *
šdex_rows
;

519 
UINT32
 *
šdex_cŞs
;

521 
OF_ENTER_FUNCTION


522 
ofcb
->
»maš_rows
 = 0;

523 
ofcb
->
»maš_cŞs
 = 0;

524 ià(
ofcb
->
šdex_rows
 =ğ
NULL
)

526 ià((
ofcb
->
šdex_rows
 = (
UINT32
 *è
	`of_ÿÎoc
 (ofcb->
nb_»·œ_symbŞs
,  (UINT32))è=ğ
NULL
)

528 
no_mem
;

531 ià(
ofcb
->
šdex_cŞs
 =ğ
NULL
)

533 ià((
ofcb
->
šdex_cŞs
 = (
UINT32
 *è
	`of_ÿÎoc
 (ofcb->
nb_tÙ®_symbŞs
 - ofcb->
nb_»·œ_symbŞ_»ady
 - ofcb->
nb_sourû_symbŞ_»ady
,

534  (
UINT32
))è=ğ
NULL
)

536 
no_mem
;

539 
šdex_rows
 = (
UINT32
*è
	`of_m®loc
(
ofcb
->
nb_»·œ_symbŞs
 * (UINT32));

540 
šdex_cŞs
 = (
UINT32
*è
	`of_m®loc
(
ofcb
->
nb_tÙ®_symbŞs
 * (UINT32));

541 ià((
šdex_rows
 =ğ
NULL
è|| (
šdex_cŞs
 == NULL))

543 
no_mem
;

546 
_cŞ
 = 0 ; _cŞ < 
ofcb
->
nb_tÙ®_symbŞs
 ; _col++)

548 ià(!
	`of_mod2¥¬£_em±y_cŞ
 (
ofcb
->
pchk_m©rix
, 
_cŞ
))

551 
šdex_cŞs
[
_cŞ
] = 
ofcb
->
»maš_cŞs
;

552 
ofcb
->
šdex_cŞs
[ofcb->
»maš_cŞs
++] = 
_cŞ
;

556 
_row
 = 0 ; _row < 
ofcb
->
nb_»·œ_symbŞs
 ; _row++)

558 ià(!
	`of_mod2¥¬£_em±y_row
 (
ofcb
->
pchk_m©rix
, 
_row
))

561 
šdex_rows
[
_row
] = 
ofcb
->
»maš_rows
;

562 
ofcb
->
šdex_rows
[ofcb->
»maš_rows
++] = 
_row
;

565 ià(
ofcb
->
»maš_cŞs
 == 0)

568 
	`OF_PRINT_LVL
 (1, ("%s: Fau», in™ŸÈm©rix i nowƒm±y, ofcb->»maš_cŞs==0\n", 
__FUNCTION__
))

569 
çu»
;

571 ià(
ofcb
->
»maš_rows
 < ofcb->
»maš_cŞs
)

574 
	`OF_PRINT_LVL
 (1, ("%s: Failure, fewer„owshan columns, ofcb->remain_rows (%d) < ofcb->remain_cols (%d)\n",

575 
__FUNCTION__
, 
ofcb
->
»maš_rows
, ofcb->
»maš_cŞs
))

576 
çu»
;

578 
	`OF_TRACE_LVL
 (1, ("%s: Simplified Matrix: %dx%d;‡lready decoded symbols:„eady_src=%d,„eady_parity=%d„emaining_rows=%d„emaining_cols=%d\n",

579 
__FUNCTION__
, 
ofcb
->
»maš_rows
, ofcb->
»maš_cŞs
, ofcb->
nb_sourû_symbŞ_»ady
,

580 
ofcb
->
nb_»·œ_symbŞ_»ady
, ofcb->
»maš_rows
, ofcb->
»maš_cŞs
))

583 
ofcb
->
pchk_m©rix_sim¶if›d
 = 
	`of_mod2¥¬£_®loÿ‹
 (ofcb->
nb_»·œ_symbŞs
, ofcb->
»maš_cŞs
);

584 
	`of_mod2¥¬£_cİy_fËd_m©rix
(
ofcb
->
pchk_m©rix
, ofcb->
pchk_m©rix_sim¶if›d
, 
šdex_rows
, 
šdex_cŞs
);

585 
	`of_mod2¥¬£_ä“
 (
ofcb
->
pchk_m©rix
);

586 
	`of_ä“
 (
ofcb
->
pchk_m©rix
);

587 
ofcb
->
pchk_m©rix
 = 
NULL
;

589 
	`of_ä“
(
šdex_rows
);

590 
	`of_ä“
(
šdex_cŞs
);

591 
	`OF_TRACE_LVL
 (1, ("ok\n"))

592 
OF_EXIT_FUNCTION


593  
OF_STATUS_OK
;

595 
çu»
:

596 ià(
ofcb
->
šdex_rows
)

598 
	`of_ä“
 (
ofcb
->
šdex_rows
);

599 
ofcb
->
šdex_rows
 = 
NULL
;

601 ià(
ofcb
->
šdex_cŞs
)

603 
	`of_ä“
 (
ofcb
->
šdex_cŞs
);

604 
ofcb
->
šdex_cŞs
 = 
NULL
;

606 ià(
šdex_rows
)

607 
	`of_ä“
(
šdex_rows
);

608 ià(
šdex_cŞs
)

609 
	`of_ä“
(
šdex_cŞs
);

610 
OF_EXIT_FUNCTION


611  
OF_STATUS_FAILURE
;

613 
no_mem
:

614 
	`OF_PRINT_ERROR
(("out of memory"))

615 
OF_EXIT_FUNCTION


616  
OF_STATUS_FATAL_ERROR
;

617 
	}
}

	@src/lib_common/linear_binary_codes_utils/ml_decoding/of_ml_decoding.h

34 #iâdeà
ML_DECODING_H


35 
	#ML_DECODING_H


	)

39 #ifdeà
OF_USE_DECODER


40 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


41 #ifdeà
ML_DECODING


52 
of_¡©us_t
 
of_lš—r_bš¬y_code_fšish_decodšg_w™h_ml
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
);

	@src/lib_common/linear_binary_codes_utils/ml_decoding/of_ml_tool.c

34 
	~"../of_lš—r_bš¬y_code.h
"

36 #ifdeà
OF_USE_DECODER


37 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


38 #ifdeà
ML_DECODING


54 
INT32


55 
of_lš—r_bš¬y_code_ŒŸnguÏrize_d’£_sy¡em
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
,

56 
of_mod2d’£
 *
m
,

57 **
cÚ¡ªt_b
);

71 
INT32


72 
of_lš—r_bš¬y_code_cŞ_fÜw¬d_–imš©iÚ
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
,

73 
of_mod2d’£
 *
m
,

74 **
cÚ¡ªt_b
,

75 
INT32
 
cŞ_idx
);

89 
INT32


90 
of_lš—r_bš¬y_code_backw¬d_sub¡™utiÚ
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
,

91 
of_mod2d’£
 *
m
,

92 *
v¬ŸbË_b
[],

93 *
cÚ¡ªt_b
[]);

104 
of_¡©us_t


105 
	$of_lš—r_bš¬y_code_sŞve_d’£_sy¡em
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
,

106 
of_mod2d’£
 *
m
,

107 **
cÚ¡ªt_b
,

108 **
v¬ŸbË_b
)

110 
OF_ENTER_FUNCTION


111 ià(!
	`of_lš—r_bš¬y_code_ŒŸnguÏrize_d’£_sy¡em
 (
ofcb
, 
m
, 
cÚ¡ªt_b
))

113 
	`OF_TRACE_LVL
(0,("%s:riangularize_dense_system failed for system with %d„ows, %d cols\n",

114 
__FUNCTION__
, 
	`of_mod2d’£_rows
(
m
), 
	`of_mod2d’£_cŞs
(m)))

115 
OF_EXIT_FUNCTION


116  
OF_STATUS_FAILURE
;

119 ià(!
	`of_lš—r_bš¬y_code_backw¬d_sub¡™utiÚ
 (
ofcb
, 
m
, 
v¬ŸbË_b
, 
cÚ¡ªt_b
))

121 
	`OF_TRACE_LVL
(0,("%s: backw¬d_sub¡™utiÚ faed\n", 
__FUNCTION__
))

122 
OF_EXIT_FUNCTION


123  
OF_STATUS_FAILURE
;

125 
OF_EXIT_FUNCTION


126  
OF_STATUS_OK
;

127 
	}
}

134 
INT32
 
	$of_lš—r_bš¬y_code_ŒŸnguÏrize_d’£_sy¡em
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
,

135 
of_mod2d’£
 *
m
,

136 **
cÚ¡ªt_b
)

138 
INT32
 
i
, 
n
;

140 
OF_ENTER_FUNCTION


141 
n
 = 
	`of_mod2d’£_cŞs
 (
m
);

143 
i
 = 0; i < 
n
; i++)

145 ià(!
	`of_lš—r_bš¬y_code_cŞ_fÜw¬d_–imš©iÚ
(
ofcb
, 
m
, 
cÚ¡ªt_b
, 
i
))

147 
OF_EXIT_FUNCTION


151 
OF_EXIT_FUNCTION


153 
	}
}

157 
INT32
 
	$of_lš—r_bš¬y_code_cŞ_fÜw¬d_–imš©iÚ
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
,

158 
of_mod2d’£
 *
m
,

159 **
cÚ¡ªt_b
,

160 
INT32
 
cŞ_idx
)

162 
of_mod2wÜd
 *
s
;

163 
of_mod2wÜd
 *
t
;

164 
INT32
 
i
, 
j
, 
k
;

165 
INT32
 
n
, 
p
;

166 
INT32
 
w
;

167 
INT32
 
w0
;

168 
INT32
 
b0
;

169 
INT32
 
symbŞ_size
;

170 *
tmp_bufãr
;

172 
OF_ENTER_FUNCTION


173 
symbŞ_size
 = 
ofcb
->
’codšg_symbŞ_Ëngth
;

174 
n
 = 
	`of_mod2d’£_cŞs
 (
m
);

175 
p
 = 
	`of_mod2d’£_rows
 (
m
);

176 
w
 = 
m
->
n_wÜds
;

177 
i
 = 
cŞ_idx
;

179 
w0
 = 
i
 >> 
of_mod2_wÜdsize_shiá
;

180 
b0
 = 
i
 & 
of_mod2_wÜdsize_mask
;

182 
j
 = 
i
; j < 
p
; j++)

184 ià(
	`of_mod2_g‘b™
(
m
->
row
[
j
][
w0
], 
b0
))

188 ià(
j
 =ğ
p
)

191 
OF_EXIT_FUNCTION


194 ià(
j
 !ğ
i
)

198 
t
 = 
m
->
row
[
i
];

199 
m
->
row
[
i
] = m->row[
j
];

200 
m
->
row
[
j
] = 
t
;

202 
tmp_bufãr
 = 
cÚ¡ªt_b
[
i
];

203 
cÚ¡ªt_b
[
i
] = cÚ¡ªt_b[
j
];

204 
cÚ¡ªt_b
[
j
] = 
tmp_bufãr
;

209 
ofcb
->
nb_tmp_symbŞs
 = 0;

210 
j
 = 
i
 + 1; j < 
p
; j++)

212 ià(
	`of_mod2_g‘b™
(
m
->
row
[
j
][
w0
], 
b0
))

216 
s
 = 
m
->
row
[
j
];

217 
t
 = 
m
->
row
[
i
];

218 
s
 +ğ
w0
;

219 
t
 +ğ
w0
;

220 
k
 = 
w0
; k < 
w
; k++)

222 *
s
 ^ğ*
t
;

223 
s
++;

224 
t
++;

227 ià(
cÚ¡ªt_b
[
i
] !ğ
NULL
)

231 ià(
cÚ¡ªt_b
[
j
] =ğ
NULL
)

233 
cÚ¡ªt_b
[
j
] = 
	`of_m®loc
 (
symbŞ_size
);

235 
	`memıy
 (
cÚ¡ªt_b
[
j
], cÚ¡ªt_b[
i
], 
symbŞ_size
);

240 
ofcb
->
tmp_b_symbŞs
[ofcb->
nb_tmp_symbŞs
++] = 
cÚ¡ªt_b
[
j
];

245 
cÚ¡ªt_b
[
i
] = 
	`of_ÿÎoc
 (1, 
symbŞ_size
);

249 ià(
ofcb
->
nb_tmp_symbŞs
 != 0)

251 ià(
ofcb
->
nb_tmp_symbŞs
 == 1)

253 
	`of_add_to_symbŞ
 (
ofcb
->
tmp_b_symbŞs
[0], 
cÚ¡ªt_b
[
i
], 
symbŞ_size
 
OP_ARG_VAL
);

257 
	`of_add_to_muÉË_symbŞs
 (
ofcb
->
tmp_b_symbŞs
,

258 
cÚ¡ªt_b
[
i
],

259 
ofcb
->
nb_tmp_symbŞs
,

260 
ofcb
->
’codšg_symbŞ_Ëngth


261 #ifdeà
OF_DEBUG


262 , &(
ofcb
->
¡©s_xÜ
->
nb_xÜ_fÜ_ML
)

267 
OF_EXIT_FUNCTION


269 
	}
}

274 
INT32
 
	$of_lš—r_bš¬y_code_backw¬d_sub¡™utiÚ
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
,

275 
of_mod2d’£
 *
m
,

276 *
v¬ŸbË_b
[],

277 *
cÚ¡ªt_b
[])

279 
INT32
 
i
;

280 
INT32
 
j
;

281 
INT32
 
n
;

282 
INT32
 
w0
;

283 
INT32
 
b0
;

285 
OF_ENTER_FUNCTION


286 
n
 = 
	`of_mod2d’£_cŞs
 (
m
);

288 
i
 = 
n
 - 1; i >= 0; i--)

290 
	`ASSERT
(
v¬ŸbË_b
[
i
] =ğ
NULL
);

293 
of_mod2wÜd
 *
row
 = 
m
->row[
i
];

294 #ifdeà
OF_DEBUG


295 
w0
 = 
i
 >> 
of_mod2_wÜdsize_shiá
;

296 
b0
 = 
i
 & 
of_mod2_wÜdsize_mask
;

297 
	`ASSERT
(
	`of_mod2_g‘b™
(
row
[
w0
], 
b0
))

304 
	`ASSERT
(
v¬ŸbË_b
[
i
] =ğ
NULL
);

305 
v¬ŸbË_b
[
i
] = 
cÚ¡ªt_b
[i];

306 
cÚ¡ªt_b
[
i
] = 
NULL
;

308 
ofcb
->
nb_tmp_symbŞs
 = 0;

309 
j
 = 
i
 + 1; j < 
n
; j++)

311 
w0
 = 
j
 >> 
of_mod2_wÜdsize_shiá
;

312 
b0
 = 
j
 & 
of_mod2_wÜdsize_mask
;

314 ià(
	`of_mod2_g‘b™
(
row
[
w0
], 
b0
))

317 
ofcb
->
tmp_b_symbŞs
[ofcb->
nb_tmp_symbŞs
++] = 
v¬ŸbË_b
[
j
];

320 ià(
ofcb
->
nb_tmp_symbŞs
 != 0)

322 
	`of_add_äom_muÉË_symbŞs
(
v¬ŸbË_b
[
i
], (cÚ¡ **)
ofcb
->
tmp_b_symbŞs
,

323 
ofcb
->
nb_tmp_symbŞs
, ofcb->
’codšg_symbŞ_Ëngth


324 #ifdeà
OF_DEBUG


325 , &(
ofcb
->
¡©s_xÜ
->
nb_xÜ_fÜ_ML
)

331 
OF_EXIT_FUNCTION


333 
	}
}

	@src/lib_common/linear_binary_codes_utils/ml_decoding/of_ml_tool.h

34 #iâdeà
OF_ML_TOOL


35 
	#OF_ML_TOOL


	)

38 #ifdeà
OF_USE_DECODER


39 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


40 #ifdeà
ML_DECODING


42 #ifdeà
OF_DEBUG


43 
	#OP_ARGS
 ,
UINT32
* 
İ


	)

44 
	#OP_ARG_VAL
 ,&(
ofcb
->
¡©s_xÜ
->
nb_xÜ_fÜ_ML
)

	)

46 
	#OP_ARGS


	)

47 
	#OP_ARG_VAL


	)

63 
of_¡©us_t


64 
of_lš—r_bš¬y_code_sŞve_d’£_sy¡em
 (
of_lš—r_bš¬y_code_cb_t
 *
ofcb
,

65 
of_mod2d’£
 *
m
,

66 **
cÚ¡ªt_b
,

67 **
v¬ŸbË_b
);

	@src/lib_common/linear_binary_codes_utils/of_create_pchk.c

17 
	~"of_lš—r_bš¬y_code.h
"

20 
of_mod2¥¬£
* 
	$of_ü—‹_pchk_m©rix
 (
UINT32
 
nb_rows
,

21 
UINT32
 
nb_cŞs
,

22 
make_m‘hod
 make_method,

23 
UINT32
 
Ëá_deg»e
,

24 
UINT32
 
£ed
,

25 
boŞ
 
no4cyşe
,

26 
of_£ssiÚ_ty³
 
ty³
,

27 
UINT8
 
v”bos™y
)

29 
OF_ENTER_FUNCTION


30 
of_mod2¥¬£
* 
m
;

31 
ty³
) {

32 
Ty³REGULAR_LDPC
:

33 
m
 = 
	`of_ü—‹_pchk_m©rix_g’”®
 (
nb_rows
, 
nb_cŞs
, 
make_m‘hod
, 
Ëá_deg»e
,

34 
£ed
, 
no4cyşe
, 
ty³
, 
v”bos™y
);

37 
Ty³2DMATRIX
:

38 
m
 = 
	`of_ü—‹_2D_pchk_m©rix
 (
nb_rows
, 
nb_cŞs
, 
ty³
, 
v”bos™y
);

42 
	`abÜt
();

43 
OF_EXIT_FUNCTION


44  
NULL
;

46 
OF_EXIT_FUNCTION


47  
m
;

48 
	}
}

51 
of_mod2¥¬£
* 
	$of_ü—‹_pchk_m©rix_g’”®
 (
UINT32
 
nb_rows
,

52 
UINT32
 
nb_cŞs
,

53 
make_m‘hod
 make_method,

54 
UINT32
 
Ëá_deg»e
,

55 
UINT32
 
£ed
,

56 
boŞ
 
no4cyşe
,

57 
of_£ssiÚ_ty³
 
ty³
,

58 
UINT8
 
v”bos™y
)

60 
UINT32
 
row_¡¬t
 = 0;

61 
UINT32
 
row_’d
 = 0;

62 
UINT32
 
cŞ_¡¬t
 = 0;

63 
UINT32
 
cŞ_’d
 = 0;

64 
INT32
 
i
;

65 
of_mod2¥¬£
 *
pchkM©rix
 = 
NULL
;

67 
OF_ENTER_FUNCTION


68 ià(
ty³
 !ğ
Ty³LDGM
 &&y³ !ğ
Ty³STAIRS
 &&y³ !ğ
Ty³TRIANGLE
 &&y³ !ğ
Ty³REGULAR_LDPC
)

71 
	`OF_PRINT_ERROR
(("unsuµÜ‹d codty³ (%d)\n", 
ty³
));

72 
OF_EXIT_FUNCTION


73  
NULL
;

76 ià(
Ëá_deg»e
 > 
nb_rows
)

78 
	`OF_PRINT_ERROR
(("number of checks…er bit (%d) is greaterhanotal checks (%d)\n",

79 
Ëá_deg»e
, 
nb_rows
));

80 
OF_EXIT_FUNCTION


81  
NULL
;

83 ià(
no4cyşe
)

85 
	`OF_PRINT_ERROR
(("no4cycle mode is‚o†onger supported!"));

86 
OF_EXIT_FUNCTION


87  
NULL
;

89 
	`of_rfc5170_¤ªd
 (
£ed
);

90 
pchkM©rix
 = 
	`of_mod2¥¬£_®loÿ‹
 (
nb_rows
, 
nb_cŞs
);

92 
ty³
) {

93 
Ty³LDGM
:

94 
row_¡¬t
 = 0;

95 
row_’d
 = 
nb_rows
;

96 
cŞ_¡¬t
 = 
nb_rows
;

97 
cŞ_’d
 = 
nb_cŞs
;

100 
Ty³REGULAR_LDPC
:

101 
row_¡¬t
 = 0;

102 
row_’d
 = 
nb_rows
;

103 
cŞ_¡¬t
 = 0;

104 
cŞ_’d
 = 
nb_cŞs
;

110 
	`of_fl_»guÏr_pchk_m©rix
 (
pchkM©rix
, 
row_¡¬t
, 
row_’d
, 
cŞ_¡¬t
, 
cŞ_’d
, 
make_m‘hod
,

111 
Ëá_deg»e
, 
no4cyşe
, 
v”bos™y
);

113 
ty³
) {

114 
Ty³LDGM
:

115 
i
 = 0; i < 
nb_rows
; i++)

118 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
i
, i);

127 
OF_EXIT_FUNCTION


128  
pchkM©rix
;

129 
	}
}

132 
of_mod2¥¬£
* 
	$of_ü—‹_2D_pchk_m©rix
 (
UINT32
 
nb_rows
,

133 
UINT32
 
nb_cŞs
,

134 
of_£ssiÚ_ty³
 
ty³
,

135 
UINT8
 
v”bos™y
)

137 
OF_ENTER_FUNCTION


138 
of_mod2¥¬£
 *
pchkM©rix
;

139 
d
,
l
;

141 ià(
nb_rows
 >ğ
nb_cŞs
)

143 
	`OF_PRINT_ERROR
(("In 2D…arity check matrix,‚umber of„ows must‚ot be greaterhan‚umber of cols.\n"))

144 
”rÜ
;

146 
d
 = 
	`æoÜ
(
	`sq¹
(
nb_cŞs
)); d > 0; d-- )

148 
l
 = (()((
nb_cŞs
-
nb_rows
))è/ 
d
;

149 ià(
l
 - 
	`æoÜ
Öè=ğ0 && ((
d
 +†è=ğ
nb_rows
))

152 
pchkM©rix
 = 
	`of_mod2¥¬£_®loÿ‹
((
l
 + 
d
), (l * d) + (l + d));

153 
	`of_fl_2D_pchk_m©rix
(
pchkM©rix
, 
l
, 
d
, 
v”bos™y
);

154 
OF_EXIT_FUNCTION


155  
pchkM©rix
;

159 
”rÜ
:

160 
OF_EXIT_FUNCTION


161  
NULL
;

162 
	}
}

165 
of_mod2¥¬£
* 
	$of_fl_2D_pchk_m©rix
 (
of_mod2¥¬£
 *
m
,

166 
UINT32
 
d
,

167 
UINT32
 
l
,

168 
UINT8
 
v”bos™y
)

170 
OF_ENTER_FUNCTION


171 
UINT32
 
i
, 
j
;

173 
i
 = 0; i < (
l
+
d
); i++)

175 
	`of_mod2¥¬£_š£¹
(
m
, 
i
, i);

178 
i
 = 0; i < 
d
; i++)

181 
j
 = 0; j < 
l
; j++)

183 
	`of_mod2¥¬£_š£¹
(
m
, 
i
, 
j
 + (˜* 
l
è+† + 
d
);

187 
i
 = 
d
; i < 
l
 + d; i++)

189 
j
 = 0; j < 
d
; j++)

191 
	`of_mod2¥¬£_š£¹
(
m
, 
i
, 4 * 
j
 + ( i - 
d
 )+
l
+d);

194  
m
;

195 
OF_EXIT_FUNCTION


196 
	}
}

199 
of_mod2¥¬£
* 
	$of_fl_»guÏr_pchk_m©rix
 (
of_mod2¥¬£
 *
m
,

200 
UINT32
 
row_¡¬t
,

201 
UINT32
 
row_’d
,

202 
UINT32
 
cŞ_¡¬t
,

203 
UINT32
 
cŞ_’d
,

204 
make_m‘hod
 make_method,

205 
UINT32
 
Ëá_deg»e
,

206 
boŞ
 
no4cyşe
,

207 
UINT8
 
v”bos™y
)

209 
of_mod2’Œy
 *
e
;

210 
UINT32
 
added
, 
uÃv’
;

211 
INT32
 
i
, 
j
, 
k
, 
t
;

212 
UINT32
 *
u
;

213 
of_mod2¥¬£
 *
pchkM©rix
 = 
m
;

214 
UINT32
 
nb_cŞ
, 
nb_row
;

216 
OF_ENTER_FUNCTION


217 
nb_cŞ
 = 
cŞ_’d
 - 
cŞ_¡¬t
;

218 
nb_row
 = 
row_’d
 - 
row_¡¬t
;

221 
make_m‘hod
)

223 
Ev’cŞ
:

224 
j
 = 
cŞ_¡¬t
; j < 
cŞ_’d
; j++)

226 
k
 = 0; k < 
Ëá_deg»e
; k++)

230 
i
 = 
	`of_rfc5170_¿nd
 (
nb_row
);

232 
	`of_mod2¥¬£_fšd
 (
pchkM©rix
, 
i
, 
j
));

233 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
i
, 
j
);

238 
Ev’bÙh
:

239 
u
 = (
UINT32
*è
	`of_ÿÎoc
 (
Ëá_deg»e
 * 
nb_cŞ
,  * u);

242 
k
 = 
Ëá_deg»e
 * 
nb_cŞ
 - 1; k >= 0; k--)

244 
u
[
k
] = k % 
nb_row
;

246 
uÃv’
 = 0;

247 
t
 = 0;

248 
j
 = 
cŞ_¡¬t
; j < 
cŞ_’d
; j++)

251 
k
 = 0; k < 
Ëá_deg»e
; k++)

255 
i
 = 
t
; i < 
Ëá_deg»e
*
nb_cŞ
 && 
	`of_mod2¥¬£_fšd
 (
pchkM©rix
, 
u
[i], 
j
); i++)

258 ià(
i
 < 
Ëá_deg»e
*
nb_cŞ
)

263 
i
 = 
t
 + 
	`of_rfc5170_¿nd
 (
Ëá_deg»e
 * 
nb_cŞ
 -);

265 
	`of_mod2¥¬£_fšd
 (
pchkM©rix
, 
u
[
i
], 
j
));

266 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
u
[
i
], 
j
);

268 
u
[
i
] = u[
t
];

269 
t
++;

274 
uÃv’
 += 1;

277 
i
 = 
	`of_rfc5170_¿nd
 (
nb_row
);

279 
	`of_mod2¥¬£_fšd
 (
pchkM©rix
, 
i
, 
j
));

280 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
i
, 
j
);

285 ià(
uÃv’
 > 0 && 
v”bos™y
 >= 1)

287 
	`OF_PRINT_ERROR
(("HadØ¶aû %d check š„ow uÃv’ly\n", 
uÃv’
));

289 
	`of_ä“
 (
u
);

293 
	`abÜt
();

297 
added
 = 0;

298 
i
 = 
row_¡¬t
; i < 
row_’d
; i++)

300 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
pchkM©rix
, 
i
);

301 ià(
	`of_mod2¥¬£_©_’d
 (
e
))

303 
j
 = (
	`of_rfc5170_¿nd
 (
nb_cŞ
è+ 
cŞ_¡¬t
);

304 
e
 = 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
i
, 
j
);

305 
added
 ++;

307 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
pchkM©rix
, 
i
);

308 ià(
	`of_mod2¥¬£_©_’d
 (
	`of_mod2¥¬£_Ãxt_š_row
 (
e
)è&& 
nb_cŞ
 > 1)

312 
j
 = (
	`of_rfc5170_¿nd
 (
nb_cŞ
)è+ 
cŞ_¡¬t
;

314 
j
 =ğ
	`of_mod2¥¬£_cŞ
 (
e
));

315 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
i
, 
j
);

316 
added
 ++;

320 ià(
added
 > 0 && 
v”bos™y
 >= 1)

322 
	`OF_PRINT_ERROR
(("Added %dƒxŒ¨b™-check tØmakrow couÁ ©†—¡wo\n", 
added
));

326 ià(
Ëá_deg»e
 % 2 =ğ0 &&†eá_deg»< 
nb_row
 && 
nb_cŞ
 > 1 && 
added
 < 2)

328 
UINT32
 
a
;

329 
a
 = 0; 
added
 +‡ < 2;‡++)

333 
i
 = 
	`of_rfc5170_¿nd
 (
nb_row
);

334 
j
 = (
	`of_rfc5170_¿nd
 (
nb_cŞ
)è+ 
cŞ_¡¬t
;

336 
	`of_mod2¥¬£_fšd
 (
pchkM©rix
, 
i
, 
j
));

337 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
i
, 
j
);

339 ià(
v”bos™y
 >= 1)

341 
	`OF_PRINT_ERROR
(("Added %dƒxŒ¨b™-check tØŒyØavoid…robËm äomƒv’ cŞumÀcouÁs\n", 
a
));

343 
	`OF_PRINT_LVL
 (1, ("Added %dƒxŒ¨b™-check tØŒyØavoid…robËm äomƒv’ cŞumÀcouÁs\n", 
a
));

346 
OF_EXIT_FUNCTION


348  
pchkM©rix
;

349 
	}
}

	@src/lib_common/linear_binary_codes_utils/of_create_pchk.h

17 #iâdeà
OF_LDPC_CREATE_PCHK


18 
	#OF_LDPC_CREATE_PCHK


	)

25 
	emake_m‘hod_’um


27 
	mEv’cŞ
,

28 
	mEv’bÙh


29 } 
	tmake_m‘hod
;

36 
	eSessiÚTy³_’um


38 
	mTy³LDGM
,

39 
	mTy³STAIRS
,

40 
	mTy³TRIANGLE
,

41 
	mTy³READ_FROM_FILE
,

42 
	mTy³READ_QC_FROM_FILE
,

43 
	mTy³LDPC_QC
,

44 
	mTy³REGULAR_LDPC
,

45 
	mTy³2DMATRIX


46 } 
	tof_£ssiÚ_ty³
;

64 
of_mod2¥¬£
* 
of_ü—‹_pchk_m©rix
 (
UINT32
 
nb_rows
,

65 
UINT32
 
nb_cŞs
,

66 
make_m‘hod
 make_method,

67 
UINT32
 
Ëá_deg»e
,

68 
UINT32
 
£ed
,

69 
boŞ
 
no4cyşe
,

70 
of_£ssiÚ_ty³
 
ty³
,

71 
UINT8
 
v”bos™y
);

88 
of_mod2¥¬£
* 
of_ü—‹_pchk_m©rix_g’”®
 (
UINT32
 
nb_rows
,

89 
UINT32
 
nb_cŞs
,

90 
make_m‘hod
 make_method,

91 
UINT32
 
Ëá_deg»e
,

92 
UINT32
 
£ed
,

93 
boŞ
 
no4cyşe
,

94 
of_£ssiÚ_ty³
 
ty³
,

95 
UINT8
 
v”bos™y
);

113 
of_mod2¥¬£
* 
of_fl_»guÏr_pchk_m©rix
 (of_mod2¥¬£* 
m
,

114 
UINT32
 
row_¡¬t
,

115 
UINT32
 
row_’d
,

116 
UINT32
 
cŞ_¡¬t
,

117 
UINT32
 
cŞ_’d
,

118 
make_m‘hod
 make_method,

119 
UINT32
 
Ëá_deg»e
,

120 
boŞ
 
no4cyşe
,

121 
UINT8
 
v”bos™y
);

134 
of_mod2¥¬£
* 
of_ü—‹_2D_pchk_m©rix
 (
UINT32
 
nb_rows
,

135 
UINT32
 
nb_cŞs
,

136 
of_£ssiÚ_ty³
 
ty³
,

137 
UINT8
 
v”bos™y
);

150 
of_mod2¥¬£
* 
of_fl_2D_pchk_m©rix
 (of_mod2¥¬£* 
m
,

151 
UINT32
 
d
,

152 
UINT32
 
l
,

153 
UINT8
 
v”bos™y
);

	@src/lib_common/linear_binary_codes_utils/of_linear_binary_code.h

34 #iâdeà
LINEAR_BINARY_CODE_H


35 
	#LINEAR_BINARY_CODE_H


	)

37 
	~<¡dio.h
>

38 
	~<¡dlib.h
>

39 
	~<m©h.h
>

40 
	~<¡ršg.h
>

45 
	~"../of_İ’ãc_­i.h
"

47 #ifdeà
IL_SUPPORT


48 
	~<IL/.h
>

51 #ifdeà
ASSEMBLY_SSE_OPT


52 
	~<xmmšŒš.h
>

55 
	~"../of_¿nd.h
"

56 
	~"../of_cb.h
"

57 
	~"../of_mem.h
"

58 
	~"of_symbŞ.h
"

59 
	~"../¡©i¡ics/of_¡©i¡ics.h
"

61 
	~"bš¬y_m©rix/of_m©rix_¥¬£.h
"

62 
	~"bš¬y_m©rix/of_m©rix_d’£.h
"

63 
	~"of_ü—‹_pchk.h
"

65 
	~"bš¬y_m©rix/of_m©rix_cÚv”t.h
"

66 
	~"bš¬y_m©rix/of_hammšg_weight.h
"

67 
	~"bš¬y_m©rix/of_toŞs.h
"

73 
	sof_lš—r_bš¬y_code_cb


78 
of_codec_id_t
 
	mcodec_id
;

79 
of_codec_ty³_t
 
	mcodec_ty³
;

80 
UINT32
 
	mnb_sourû_symbŞs
;

81 
UINT32
 
	mnb_»·œ_symbŞs
;

82 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

85 
UINT32
 
	mnb_tÙ®_symbŞs
;

87 
of_mod2¥¬£
* 
	mpchk_m©rix
;

90 
of_symbŞ_¡©s_İ_t
 *
	m¡©s_xÜ
;

91 #ifdeà
OF_DEBUG


92 
of_symbŞs_¡©s_t
 *
	m¡©s_symbŞs
;

95 
UINT32
 
	mnb_sourû_symbŞ_»ady
;

96 
UINT32
 
	mnb_»·œ_symbŞ_»ady
;

98 #ifdeà
ML_DECODING


99 
UINT32
 *
	mšdex_rows
;

100 
UINT32
 *
	mšdex_cŞs
;

101 
UINT32
 
	m»maš_cŞs
;

102 
UINT32
 
	m»maš_rows
;

104 
of_mod2¥¬£
 *
	mpchk_m©rix_sim¶if›d
;

105 
of_mod2¥¬£
 *
	mÜigš®_pchkM©rix
;

106 
of_mod2¥¬£
 *
	mpchk_m©rix_gauss
;

108 
UINT32
 
	mdec_¡•
;

109 
UINT32
 
	mth»shŞd_sim¶ifiÿtiÚ
;

113 #ifdeà
OF_USE_DECODER


115 ** 
	mb_cÚ¡_‹rm_of_equ
;

117 
UINT16
* 
	mb_nb_’c_symbŞs_³r_equ
;

120 
UINT16
* 
	mb_nb_unknown_symbŞs
;

122 
UINT16
* 
	mb_nb_equ_fÜ_»·œ
;

124 ** 
	m»·œ_symbŞs_v®ues
;

125 ** 
	mtmp_b_symbŞs
;

126 
UINT16
 
	mnb_tmp_symbŞs
;

129 **
	m’codšg_symbŞs_b
;

132 * (*
	mdecoded_sourû_symbŞ_ÿÎback
è(*
	mcÚ‹xt
,

133 
UINT32
 
	msize
,

134 
UINT32
 
	mesi
);

135 * (*
	mdecoded_»·œ_symbŞ_ÿÎback
è(*
	mcÚ‹xt
,

136 
UINT32
 
	msize
,

137 
UINT32
 
	mesi
);

138 * 
	mcÚ‹xt_4_ÿÎback
;

139 } 
	tof_lš—r_bš¬y_code_cb_t
;

142 
	~"™_decodšg/of_™_decodšg.h
"

143 
	~"ml_decodšg/of_ml_decodšg.h
"

144 
	~"ml_decodšg/of_ml_toŞ.h
"

	@src/lib_common/linear_binary_codes_utils/of_symbol.c

34 
	~"of_lš—r_bš¬y_code.h
"

37 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


40 #iâdeà
OF_DEBUG


41 
	$of_add_äom_muÉË_symbŞs
 (*
to
,

42 cÚ¡ **
äom
,

43 
UINT32
 
äom_size
,

44 
UINT32
 
symbŞ_size
)

46 
	$of_add_äom_muÉË_symbŞs
 (*
to
,

47 cÚ¡ **
äom
,

48 
UINT32
 
äom_size
,

49 
UINT32
 
symbŞ_size
,

50 
UINT32
 *
İ
)

53 
OF_ENTER_FUNCTION


54 #ifdeà
OF_DEBUG


55 ià(
İ
 !ğ
NULL
)

56 (*
İ
)+=
äom_size
;

58 
UINT32
 
i
;

60 
UINT32
 
symbŞSize32
;

61 
UINT32
 
symbŞSize32»m
;

64 
symbŞSize32
 = 
symbŞ_size
 >> 2;

65 
symbŞSize32»m
 = 
symbŞ_size
 % 4;

68 #ià
	`defšed
 (
__LP64__
è|| (
__WORDSIZE
 == 64)

73 
UINT32
 
symbŞSize64
;

76 
symbŞSize64
 = 
symbŞ_size
 >> 3;

77 
äom_size
 >=8)

79 
UINT64
* 
t
 = (UINT64*è
to
;

80 
UINT64
* 
ps1
 = (UINT64*)
äom
[0];

81 
UINT64
* 
ps2
 = (UINT64*)
äom
[1];

82 
UINT64
* 
ps3
 = (UINT64*)
äom
[2];

83 
UINT64
* 
ps4
 = (UINT64*)
äom
[3];

84 
UINT64
* 
ps5
 = (UINT64*)
äom
[4];

85 
UINT64
* 
ps6
 = (UINT64*)
äom
[5];

86 
UINT64
* 
ps7
 = (UINT64*)
äom
[6];

87 
UINT64
* 
ps8
 = (UINT64*)
äom
[7];

88 
äom_size
-=8;

89 
äom
+=8;

90 
i
 = 
symbŞSize64
; i > 0; i--)

92 *
t
 ^ğ(*
ps1
 ^ *
ps2
 ^ *
ps3
 ^ *
ps4
 ^ *
ps5
 ^ *
ps6
 ^ *
ps7
 ^ *
ps8
);

93 
t
++;

94 
ps1
++;

95 
ps2
++;

96 
ps3
++;

97 
ps4
++;

98 
ps5
++;

99 
ps6
++;

100 
ps7
++;

101 
ps8
++;

103 
UINT32
* 
t32
 = (UINT32*è
t
;

104 
UINT32
* 
ps1_32
 = (UINT32*è
ps1
;

105 
UINT32
* 
ps2_32
 = (UINT32*è
ps2
;

106 
UINT32
* 
ps3_32
 = (UINT32*è
ps3
;

107 
UINT32
* 
ps4_32
 = (UINT32*è
ps4
;

108 
UINT32
* 
ps5_32
 = (UINT32*è
ps5
;

109 
UINT32
* 
ps6_32
 = (UINT32*è
ps6
;

110 
UINT32
* 
ps7_32
 = (UINT32*è
ps7
;

111 
UINT32
* 
ps8_32
 = (UINT32*è
ps8
;

114 iàĞ(
symbŞSize64
 << 1è< 
symbŞSize32
)

116 * (
UINT32
*è
t32
 ^ğ(* (UINT32*è
ps1_32
 ^ * (UINT32*è
ps2_32
 ^ * (UINT32*è
ps3_32
 ^ * (UINT32*è
ps4_32
 ^

117 * (
UINT32
*è
ps5_32
 ^ * (UINT32*è
ps6_32
 ^ * (UINT32*è
ps7_32
 ^ * (UINT32*è
ps8_32
);

118 
ps1_32
++;

119 
ps2_32
++;

120 
ps3_32
++;

121 
ps4_32
++;

122 
ps5_32
++;

123 
ps6_32
++;

124 
ps7_32
++;

125 
ps8_32
++;

126 
t32
++;

128 ià(
symbŞSize32»m
 > 0)

130 
i
 = 0; i < 
symbŞSize32»m
; i++)

132 * (
UINT8
*èĞ(UINT8*è
t32
 + 
i
è^ğ((* (UINT8*èĞ(UINT8*è
ps1_32
 + i)è^ (* (UINT8*èĞ(UINT8*è
ps2_32
 + i) ) ^

133 (* (
UINT8
*èĞ(UINT8*è
ps3_32
 + 
i
èè^ (* (UINT8*èĞ(UINT8*è
ps4_32
 + i) ) ^

134 (* (
UINT8
*èĞ(UINT8*è
ps5_32
 + 
i
èè^ (* (UINT8*èĞ(UINT8*è
ps6_32
 + i) ) ^

135 (* (
UINT8
*èĞ(UINT8*è
ps7_32
 + 
i
èè^ (* (UINT8*èĞ(UINT8*è
ps8_32
 + i) ) );

139 
äom_size
 >=4)

141 
UINT64
* 
t
 = (UINT64*è
to
;

142 
UINT64
* 
ps1
 = (UINT64*)
äom
[0];

143 
UINT64
* 
ps2
 = (UINT64*)
äom
[1];

144 
UINT64
* 
ps3
 = (UINT64*)
äom
[2];

145 
UINT64
* 
ps4
 = (UINT64*)
äom
[3];

146 
äom_size
-=4;

147 
äom
+=4;

148 
i
 = 
symbŞSize64
; i > 0; i--)

150 *
t
 ^ğ(*
ps1
 ^ *
ps2
 ^ *
ps3
 ^ *
ps4
);

151 
t
++;

152 
ps1
++;

153 
ps2
++;

154 
ps3
++;

155 
ps4
++;

157 
UINT32
* 
t32
 = (UINT32*è
t
;

158 
UINT32
* 
ps1_32
 = (UINT32*è
ps1
;

159 
UINT32
* 
ps2_32
 = (UINT32*è
ps2
;

160 
UINT32
* 
ps3_32
 = (UINT32*è
ps3
;

161 
UINT32
* 
ps4_32
 = (UINT32*è
ps4
;

164 iàĞ(
symbŞSize64
 << 1è< 
symbŞSize32
)

166 * (
UINT32
*è
t32
 ^ğ(* (UINT32*è
ps1_32
 ^ * (UINT32*è
ps2_32
 ^ * (UINT32*è
ps3_32
 ^ * (UINT32*è
ps4_32
 );

167 
ps1_32
++;

168 
ps2_32
++;

169 
ps3_32
++;

170 
ps4_32
++;

171 
t32
++;

173 ià(
symbŞSize32»m
 > 0)

175 
i
 = 0; i < 
symbŞSize32»m
; i++)

177 * (
UINT8
*èĞ(UINT8*è
t32
 + 
i
è^ğ((* (UINT8*èĞ(UINT8*è
ps1_32
 + i)è^ (* (UINT8*èĞ(UINT8*è
ps2_32
 + i) ) ^

178 (* (
UINT8
*èĞ(UINT8*è
ps3_32
 + 
i
èè^ (* (UINT8*èĞ(UINT8*è
ps4_32
 + i) ) );

182 
äom_size
 >=2)

184 
UINT64
* 
t
 = (UINT64*è
to
;

185 
UINT64
* 
ps1
 = (UINT64*)
äom
[0];

186 
UINT64
* 
ps2
 = (UINT64*)
äom
[1];

187 
äom
+=2;

188 
äom_size
-=2;

189 
i
 = 
symbŞSize64
; i > 0; i--)

191 *
t
 ^ğ(*
ps1
 ^ *
ps2
);

192 
t
++;

193 
ps1
++;

194 
ps2
++;

196 
UINT32
* 
t32
 = (UINT32*è
t
;

197 
UINT32
* 
ps1_32
 = (UINT32*è
ps1
;

198 
UINT32
* 
ps2_32
 = (UINT32*è
ps2
;

200 iàĞ(
symbŞSize64
 << 1è< 
symbŞSize32
)

202 * (
UINT32
*è
t32
 ^ğ(* (UINT32*è
ps1_32
 ^ * (UINT32*è
ps2_32
);

203 
ps1_32
++;

204 
ps2_32
++;

205 
t32
++;

207 ià(
symbŞSize32»m
 > 0)

209 
i
 = 0; i < 
symbŞSize32»m
; i++)

211 * (
UINT8
*èĞ(UINT8*è
t32
 + 
i
è^ğ((* (UINT8*èĞ(UINT8*è
ps1_32
 + i)è^ (* (UINT8*èĞ(UINT8*è
ps2_32
 + i) ));

216 ià(
äom_size
 == 0) ;

218 
UINT64
 *
t
 = (UINT64*è
to
;

219 
UINT64
 *
f
 = (UINT64*è
äom
[0];

220 
i
 = 
symbŞSize64
; i > 0; i--)

222 *
t
 ^ğ*
f
;

223 
t
++;

224 
f
++;

226 
UINT32
 *
t32
 = (UINT32*è
t
;

227 
UINT32
 *
f32
 = (UINT32*è
f
;

229 iàĞ(
symbŞSize64
 << 1è< 
symbŞSize32
)

231 * (
UINT32
*è
t32
 ^ğ* (UINT32*è
f32
;

232 
t32
++;

233 
f32
++;

237 ià(
symbŞSize32»m
 > 0)

239 
i
 = 0; i < 
symbŞSize32»m
; i++)

241 * (
UINT8
*èĞ(UINT8*è
t32
 + 
i
è^ğ* (UINT8*èĞ(UINT8*è
f32
 + i);

250 
UINT32
 *
t32
 = (UINT32*è
to
;

251 
UINT32
 *
f32
 = (UINT32*è
äom
;

253 
i
 = 
symbŞSize32
; i > 0; i--)

255 *
t32
 ^ğ*
f32
;

256 
t32
++;

257 
f32
++;

261 ià(
symbŞSize32»m
 > 0)

263 
i
 = 0; i < 
symbŞSize32»m
; i++)

265 * (
UINT8
*èĞ(UINT8*è
t32
 + 
i
è^ğ* (UINT8*èĞ(UINT8*è
f32
 + i);

273 
	}
}

276 #iâdeà
OF_DEBUG


277 
	$of_add_to_muÉË_symbŞs
 (**
to
,

278 cÚ¡ *
äom
,

279 
UINT32
 
to_size
,

280 
UINT32
 
symbŞ_size
)

282 
	$of_add_to_muÉË_symbŞs
 (**
to
,

283 cÚ¡ *
äom
,

284 
UINT32
 
to_size
,

285 
UINT32
 
symbŞ_size
,

286 
UINT32
 *
İ
)

289 
OF_ENTER_FUNCTION


290 #ifdeà
OF_DEBUG


291 ià(
İ
 !ğ
NULL
)

292 (*
İ
è+ğ
to_size
;

294 
UINT32
 
i
;

296 
UINT32
 
symbŞSize32
;

297 
UINT32
 
symbŞSize32»m
;

299 
symbŞSize32
 = 
symbŞ_size
 >> 2;

300 
symbŞSize32»m
 = 
symbŞ_size
 % 4;

302 #ià
	`defšed
 (
__LP64__
è|| (
__WORDSIZE
 == 64)

306 
UINT32
 
symbŞSize64
;

309 
symbŞSize64
 = 
symbŞ_size
 >> 3;

310 
UINT64
 *
±1
, *
±2
, *
±3
, *
±4
, *
±5
, *
±6
, *
±7
, *
±8
, *
äom_s
, 
äom_v®ue
;

312 
to_size
 >= 8)

314 
äom_s
 = (
UINT64
*è
äom
;

315 
±1
 = (
UINT64
*)
to
[0];

316 
±2
 = (
UINT64
*)
to
[1];

317 
±3
 = (
UINT64
*)
to
[2];

318 
±4
 = (
UINT64
*)
to
[3];

319 
±5
 = (
UINT64
*)
to
[4];

320 
±6
 = (
UINT64
*)
to
[5];

321 
±7
 = (
UINT64
*)
to
[6];

322 
±8
 = (
UINT64
*)
to
[7];

323 
to
 += 8;

324 
to_size
 -= 8;

325 
i
 = 
symbŞSize64
; i > 0; i--)

327 
äom_v®ue
 = *
äom_s
;

328 *
±1
 ^ğ
äom_v®ue
;

329 *
±2
 ^ğ
äom_v®ue
 ;

330 *
±3
 ^ğ
äom_v®ue
 ;

331 *
±4
 ^ğ
äom_v®ue
 ;

332 *
±5
 ^ğ
äom_v®ue
 ;

333 *
±6
 ^ğ
äom_v®ue
 ;

334 *
±7
 ^ğ
äom_v®ue
 ;

335 *
±8
 ^ğ
äom_v®ue
 ;

336 
äom_s
++;

337 
±1
++;

338 
±2
++;

339 
±3
++;

340 
±4
++;

341 
±5
++;

342 
±6
++;

343 
±7
++;

344 
±8
++;

346 
UINT32
* 
äom_s32
 = (UINT32*è
äom_s
;

348 
äom_s32
 = (
UINT32
*è
äom_s
;

349 iàĞ(
symbŞSize64
 << 1è< 
symbŞSize32
)

351 (* (
UINT32
*è
±1
++è^ğ*
äom_s32
;

352 (* (
UINT32
*è
±2
++è^ğ*
äom_s32
;

353 (* (
UINT32
*è
±3
++è^ğ*
äom_s32
;

354 (* (
UINT32
*è
±4
++è^ğ*
äom_s32
;

355 (* (
UINT32
*è
±5
++è^ğ*
äom_s32
;

356 (* (
UINT32
*è
±6
++è^ğ*
äom_s32
;

357 (* (
UINT32
*è
±7
++è^ğ*
äom_s32
;

358 (* (
UINT32
*è
±8
++è^ğ*
äom_s32
;

359 
äom_s32
++;

361 ià(
symbŞSize32»m
 > 0)

363 
UINT8
* 
s8
;

364 
i
 = 0; i < 
symbŞSize32»m
; i++)

366 
s8
 = ( (
UINT8
*è
äom_s32
 + 
i
);

367 (* (
UINT8
*èĞ(UINT8*è
±1
 + 
i
)è^ğ* (UINT8*è
s8
;

368 (* (
UINT8
*èĞ(UINT8*è
±2
 + 
i
)è^ğ* (UINT8*è
s8
;

369 (* (
UINT8
*èĞ(UINT8*è
±3
 + 
i
)è^ğ* (UINT8*è
s8
;

370 (* (
UINT8
*èĞ(UINT8*è
±4
 + 
i
)è^ğ* (UINT8*è
s8
;

371 (* (
UINT8
*èĞ(UINT8*è
±5
 + 
i
)è^ğ* (UINT8*è
s8
;

372 (* (
UINT8
*èĞ(UINT8*è
±6
 + 
i
)è^ğ* (UINT8*è
s8
;

373 (* (
UINT8
*èĞ(UINT8*è
±7
 + 
i
)è^ğ* (UINT8*è
s8
;

374 (* (
UINT8
*èĞ(UINT8*è
±8
 + 
i
)è^ğ* (UINT8*è
s8
;

378 
to_size
 >= 4)

380 
UINT32
 *
äom_s32
;

382 
äom_s
 = (
UINT64
*è
äom
;

383 
±1
 = (
UINT64
*)
to
[0];

384 
±2
 = (
UINT64
*)
to
[1];

385 
±3
 = (
UINT64
*)
to
[2];

386 
±4
 = (
UINT64
*)
to
[3];

387 
to
 += 4;

388 
to_size
 -= 4;

389 
i
 = 
symbŞSize64
; i > 0; i--)

391 
äom_v®ue
 = *
äom_s
;

392 *
±1
 ^ğ
äom_v®ue
;

393 *
±2
 ^ğ
äom_v®ue
;

394 *
±3
 ^ğ
äom_v®ue
;

395 *
±4
 ^ğ
äom_v®ue
;

396 
äom_s
++;

397 
±1
++;

398 
±2
++;

399 
±3
++;

400 
±4
++;

403 
äom_s32
 = (
UINT32
*è
äom_s
;

404 iàĞ(
symbŞSize64
 << 1è< 
symbŞSize32
)

406 (* (
UINT32
*è
±1
++è^ğ*
äom_s32
;

407 (* (
UINT32
*è
±2
++è^ğ*
äom_s32
;

408 (* (
UINT32
*è
±3
++è^ğ*
äom_s32
;

409 (* (
UINT32
*è
±4
++è^ğ*
äom_s32
;

410 
äom_s32
++;

412 ià(
symbŞSize32»m
 > 0)

414 
UINT8
 *
s8
;

415 
i
 = 0; i < 
symbŞSize32»m
; i++)

417 
s8
 = ( (
UINT8
*è
äom_s32
 + 
i
);

418 (* (
UINT8
*èĞ(UINT8*è
±1
 + 
i
)è^ğ* (UINT8*è
s8
;

419 (* (
UINT8
*èĞ(UINT8*è
±2
 + 
i
)è^ğ* (UINT8*è
s8
;

420 (* (
UINT8
*èĞ(UINT8*è
±3
 + 
i
)è^ğ* (UINT8*è
s8
;

421 (* (
UINT8
*èĞ(UINT8*è
±4
 + 
i
)è^ğ* (UINT8*è
s8
;

425 
to_size
 >= 2)

427 
UINT32
 *
äom_s32
;

429 
äom_s
 = (
UINT64
*è
äom
;

430 
±1
 = (
UINT64
*)
to
[0];

431 
±2
 = (
UINT64
*)
to
[1];

433 
to
 += 2;

434 
to_size
 -= 2;

435 
i
 = 
symbŞSize64
; i > 0; i--)

437 *
±1
 ^ğ*
äom_s
 ;

438 *
±2
 ^ğ*
äom_s
 ;

439 
äom_s
++;

440 
±1
++;

441 
±2
++;

444 
äom_s32
 = (
UINT32
*è
äom_s
;

445 iàĞ(
symbŞSize64
 << 1è< 
symbŞSize32
)

447 (* (
UINT32
*è
±1
++è^ğ*
äom_s32
;

448 (* (
UINT32
*è
±2
++è^ğ*
äom_s32
;

449 
äom_s32
++;

451 ià(
symbŞSize32»m
 > 0)

453 
UINT8
 *
s8
;

454 
i
 = 0; i < 
symbŞSize32»m
; i++)

456 
s8
 = ( (
UINT8
*è
äom_s32
 + 
i
);

457 (* (
UINT8
*èĞ(UINT8*è
±1
 + 
i
)è^ğ* (UINT8*è
s8
;

458 (* (
UINT8
*èĞ(UINT8*è
±2
 + 
i
)è^ğ* (UINT8*è
s8
;

463 ià(
to_size
 == 0) ;

465 
UINT64
 *
t
 = (UINT64*è
to
[0];

466 
UINT64
 *
f
 = (UINT64*è
äom
;

467 
i
 = 
symbŞSize64
; i > 0; i--)

469 *
t
 ^ğ*
f
;

470 
t
++;

471 
f
++;

473 
UINT32
* 
t32
 = (UINT32*è
t
;

474 
UINT32
 *
f32
 = (UINT32*è
f
;

476 iàĞ(
symbŞSize64
 << 1è< 
symbŞSize32
)

478 * (
UINT32
*è
t32
 ^ğ* (UINT32*è
f32
;

479 
t32
++;

480 
f32
++;

484 ià(
symbŞSize32»m
 > 0)

486 
i
 = 0; i < 
symbŞSize32»m
; i++)

488 * (
UINT8
*èĞ(UINT8*è
t32
 + 
i
è^ğ* (UINT8*èĞ(UINT8*è
f32
 + i);

497 
UINT32
 *
t32
 = (UINT32*è
to
;

498 
UINT32
 *
f32
 = (UINT32*è
äom
;

500 
i
 = 
symbŞSize32
; i > 0; i--)

502 *
t32
 ^ğ*
f32
;

503 
t32
++;

504 
f32
++;

508 ià(
symbŞSize32»m
 > 0)

510 
i
 = 0; i < 
symbŞSize32»m
; i++)

512 * (
UINT8
*èĞ(UINT8*è
t32
 + 
i
è^ğ* (UINT8*èĞ(UINT8*è
f32
 + i);

520 
	}
}

524 #ifdeà
OF_DEBUG


525 
	$of_add_to_symbŞ
 (*
to
,

526 cÚ¡ *
äom
,

527 
UINT32
 
symbŞ_size
,

528 
UINT32
 *
İ
)

530 
	$of_add_to_symbŞ
 (*
to
,

531 cÚ¡ *
äom
,

532 
UINT32
 
symbŞ_size
)

536 
UINT32
 
i
;

537 #ifdeà
OF_DEBUG


538 ià(
İ
 !ğ
NULL
)

539 (*
İ
)++;

541 #iâdeà
ASSEMBLY_SSE_OPT


542 
UINT32
 
symbŞSize32
;

543 
UINT32
 
symbŞSize32»m
;

545 
symbŞSize32
 = 
symbŞ_size
 >> 2;

546 
symbŞSize32»m
 = 
symbŞ_size
 % 4;

549 #ià
	`defšed
 (
__LP64__
è|| (
__WORDSIZE
 == 64)

554 
UINT32
 
symbŞSize64
;

557 
symbŞSize64
 = 
symbŞ_size
 >> 3;

559 
UINT64
 *
t
 = (UINT64*è
to
;

560 
UINT64
 *
f
 = (UINT64*è
äom
;

561 
i
 = 
symbŞSize64
; i > 0; i--)

563 *
t
 ^ğ*
f
;

564 
t
++;

565 
f
++;

567 
UINT32
 *
t32
 = (UINT32*è
t
;

568 
UINT32
 *
f32
 = (UINT32*è
f
;

570 iàĞ(
symbŞSize64
 << 1è< 
symbŞSize32
)

572 * (
UINT32
*è
t32
 ^ğ* (UINT32*è
f32
;

573 
t32
++;

574 
f32
++;

578 ià(
symbŞSize32»m
 > 0)

580 
i
 = 0; i < 
symbŞSize32»m
; i++)

582 * (
UINT8
*èĞ(UINT8*è
t32
 + 
i
è^ğ* (UINT8*èĞ(UINT8*è
f32
 + i);

591 
UINT32
 *
t32
 = (UINT32*è
to
;

592 
UINT32
 *
f32
 = (UINT32*è
äom
;

594 
i
 = 
symbŞSize32
; i > 0; i--)

596 *
t32
 ^ğ*
f32
;

597 
t32
++;

598 
f32
++;

602 ià(
symbŞSize32»m
 > 0)

604 
i
 = 0; i < 
symbŞSize32»m
; i++)

606 * (
UINT8
*èĞ(UINT8*è
t32
 + 
i
è^ğ* (UINT8*èĞ(UINT8*è
f32
 + i);

617 
UINT32
 
symbŞSize32»m
 = 
symbŞ_size
 % 16;

619 
UINT32
 
symbŞSize128
;

620 
symbŞSize128
 = 
symbŞ_size
 >> 4;

621 *
d¡128
;

622 *
¤c128
;

623 
d¡128
 = (*è
to
;

624 
¤c128
 = (*è
äom
;

625 
__m128
 
a
, 
b
;

627 
i
 = 
symbŞSize128
 ; i-- ;)

629 
a
 = 
	`_mm_lßd_ps
 (
d¡128
);

630 
b
 = 
	`_mm_lßd_ps
 (
¤c128
);

631 
a
 = 
	`_mm_xÜ_ps
 (a, 
b
);

632 
	`_mm_¡Üe_ps
 (
d¡128
, 
a
);

633 
d¡128
 += 4;

634 
¤c128
 += 4;

636 ià(
symbŞSize32»m
 > 0)

638 
i
 = 0; i < 
symbŞSize32»m
; i++)

640 * (
UINT8
*èĞ(UINT8*è
d¡128
 + 
i
è^ğ* (UINT8*èĞ(UINT8*è
¤c128
 + i);

644 
OF_EXIT_FUNCTION


645 
	}
}

648 
	$of_´št_xÜ_symbŞs_¡©i¡ics
 (
of_symbŞ_¡©s_İ_t
 *
xÜ
)

650 ià(
xÜ
 !ğ
NULL
)

652 
	`OF_TRACE_LVL
(0, ("XOR stats:\n\tnb_xor_for_IT=%u‚b_xor_for_ML=%u\n",

653 
xÜ
->
nb_xÜ_fÜ_IT
, xÜ->
nb_xÜ_fÜ_ML
))

655 
	}
}

	@src/lib_common/linear_binary_codes_utils/of_symbol.h

34 #iâdeà
OF_SYMBOL


35 
	#OF_SYMBOL


	)

38 #ifdeà
OF_USE_LINEAR_BINARY_CODES_UTILS


41 
	sof_symbŞ_¡©s_İ


43 
UINT32
 
	mnb_xÜ_fÜ_IT
;

44 
UINT32
 
	mnb_xÜ_fÜ_ML
;

45 } 
	tof_symbŞ_¡©s_İ_t
;

54 
	#of_is_sourû_symbŞ
(
ofcb
,
Ãw_symbŞ_esi
è((Òew_symbŞ_esiè< (ofcb)->
nb_sourû_symbŞs
è? 
Œue
 : 
çl£
)

	)

62 
	#of_is_»·œ_symbŞ
(
ofcb
,
Ãw_symbŞ_esi
è((Òew_symbŞ_esiè< (ofcb)->
nb_sourû_symbŞs
è? 
çl£
 : 
Œue
)

	)

70 
	#of_g‘_symbŞ_esi
(
ofcb
,
m©rix_cŞ
è(((m©rix_cŞè< (ofcb)->
nb_»·œ_symbŞs
è? (
INT32
)((m©rix_cŞè+ (ofcb)->
nb_sourû_symbŞs
è: (INT32)((m©rix_cŞè- (ofcb)->nb_»·œ_symbŞs))

	)

78 
	#of_g‘_symbŞ_cŞ
(
ofcb
,
esi
è((Ósiè< (ofcb)->
nb_sourû_symbŞs
è? (
INT32
)(Ósiè+ (ofcb)->
nb_»·œ_symbŞs
è: (INT32)(Ósiè- (ofcb)->nb_sourû_symbŞs))

	)

90 #ifdeà
OF_DEBUG


91 
of_add_to_symbŞ
 (*
to
,

92 cÚ¡ *
äom
,

93 
UINT32
 
symbŞ_size
,

94 
UINT32
*);

96 
of_add_to_symbŞ
 (*
to
,

97 cÚ¡ *
äom
,

98 
UINT32
 
symbŞ_size
);

112 #ifdeà
OF_DEBUG


113 
of_add_äom_muÉË_symbŞs
 (*
to
,

114 cÚ¡ **
äom
,

115 
UINT32
 
äom_size
,

116 
UINT32
 
symbŞ_size
,

117 
UINT32
*);

119 
of_add_äom_muÉË_symbŞs
 (*
to
,

120 cÚ¡ **
äom
,

121 
UINT32
 
äom_size
,

122 
UINT32
 
symbŞ_size
);

136 #ifdeà
OF_DEBUG


137 
of_add_to_muÉË_symbŞs
 (**
to
,

138 cÚ¡ *
äom
,

139 
UINT32
 
to_size
,

140 
UINT32
 
symbŞ_size
,

141 
UINT32
*);

143 
of_add_to_muÉË_symbŞs
 (**
to
,

144 cÚ¡ *
äom
,

145 
UINT32
 
to_size
,

146 
UINT32
 
symbŞ_size
);

149 #ifdeà
OF_DEBUG


150 
of_´št_xÜ_symbŞs_¡©i¡ics
(
of_symbŞ_¡©s_İ_t
*);

	@src/lib_common/of_cb.h

34 #iâdeà
OF_CB


35 
	#OF_CB


	)

45 
	sof_cb


47 
of_codec_id_t
 
	mcodec_id
;

48 
of_codec_ty³_t
 
	mcodec_ty³
;

49 
UINT32
 
	mnb_sourû_symbŞs
;

50 
UINT32
 
	mnb_»·œ_symbŞs
;

51 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

52 } 
	tof_cb_t
;

	@src/lib_common/of_debug.h

34 #iâdeà
OF_DEBUG_H


35 
	#OF_DEBUG_H


	)

36 
	~<¡dio.h
>

37 
	~<¡dlib.h
>

38 
	~<”ºo.h
>

39 
	~<¡ršg.h
>

44 
	#OF_ENTER_FUNCTION
 
	`OF_TRACE_LVL
(2, ("-> %s:\n",
__FUNCTION__
))

	)

45 
	#OF_EXIT_FUNCTION
 
	`OF_TRACE_LVL
(2, ("<- %s:\n",
__FUNCTION__
))

	)

58 
	#OF_PRINT
(
a
è{ 
´štf
‡; 
	`fæush
(
¡dout
); }

	)

63 
	#OF_PRINT_LVL
(
l
, 
a
èià(
of_v”bos™y
 >= (l)) { \

64 
´štf
 
a
; \

65 
	`fæush
(
¡dout
); \

66 }

	)

71 
	#OF_PRINT_ERROR
(
a
è{ 
	`årštf
(
¡d”r
, "ERROR in \"%s\":%d:%s(): ", \

72 
__FILE__
, 
__LINE__
, 
__FUNCTION__
); \

73 
´štf
 
a
; 
	`fæush
(
¡d”r
); fæush(
¡dout
); }

	)

74 
	#OF_PRINT_FAILURE
(
a
è{ 
	`årštf
(
¡d”r
, "Failure in \"%s\":%d:%s(): ", \

75 
__FILE__
, 
__LINE__
, 
__FUNCTION__
); \

76 
´štf
 
a
; 
	`fæush
(
¡d”r
); fæush(
¡dout
); }

	)

78 
	#OF_PRINT_INFO
(
a
è{ 
	`årštf
("[info] \"%s\":%d:%s(): ", \

79 
__FILE__
, 
__LINE__
, 
__FUNCTION__
); \

80 
´štf
 
a
; 
	`fæush
(
¡dout
); }

	)

85 #ifdeà
OF_DEBUG


86 
	#OF_TRACE_LVL
(
l
, 
a
èià(
of_v”bos™y
 >= (l)) { \

87 
	`´štf
("[info] \"%s\":%d:%s(): ", \

88 
__FILE__
, 
__LINE__
, 
__FUNCTION__
); \

89 
´štf
 
a
; \

90 
	`fæush
(
¡dout
); \

91 }

	)

93 
	#OF_TRACE_LVL
(
l
, 
a
)

	)

100 #ifdeà
ASSERT


101 #undeà
ASSERT


103 #ifdeà
OF_DEBUG


104 
	#ASSERT
(
c
) if (!(c)) { \

105 
	`årštf
(
¡d”r
, "ASSERT [%s:%d] failed\n", \

106 
__FILE__
, 
__LINE__
); \

107 
	`fæush
(
¡d”r
); \

108 
	`ex™
(-1); \

109 }

	)

111 
	#ASSERT
(
c
)

	)

	@src/lib_common/of_mem.c

34 
	~<¡dio.h
>

35 
	~<¡dlib.h
>

36 
	~"of_İ’ãc_­i.h
"

37 
	~"of_mem.h
"

39 * 
	$of_m®loc
 (
size_t
 
size
)

41  
	`m®loc
 (
size
);

42 
	}
}

45 * 
	$of_ÿÎoc
 (
size_t
 
nmemb
,

46 
size_t
 
size
)

48  
	`ÿÎoc
 (
nmemb
, 
size
);

49 
	}
}

52 * 
	$of_»®loc
 (* 
±r
,

53 
size_t
 
size
)

55  
	`»®loc
 (
±r
, 
size
);

57 
	}
}

60 
	$of_ä“
 (* 
±r
)

62 ià(
±r
) {

63 
	`ä“
 (
±r
);

65 
	}
}

69 
	$of_dump_bufãr
 (* 
buf
, 
UINT32
 
size
)

71 
UINT32
 
i
;

72 
UINT32
 *
s32
;

74 ià(
size
 % 4 != 0)

76 
size
 = (size % 4) * 4;

78 
i
 = 0, 
s32
 = (
UINT32
*)
buf
; i < 
size
; i += 4, s32++)

80 
	`´štf
 ("%08x ", *
s32
);

82 
	`´štf
 ("\n");

83 
	}
}

	@src/lib_common/of_mem.h

39 #iâdeà
OF_MEM_H


40 
	#OF_MEM_H


	)

49 * 
of_m®loc
 (
size_t
 
size
);

58 * 
of_ÿÎoc
 (
size_t
 
nmemb
, size_ˆ
size
);

67 * 
of_»®loc
 (* 
±r
, 
size_t
 
size
);

75 
of_ä“
 (* 
±r
);

	@src/lib_common/of_openfec_api.c

33 
	~"of_İ’ãc_­i.h
"

35 #ifdeà
OF_USE_REED_SOLOMON_CODEC


36 
	~"../lib_¡abË/»ed-sŞomÚ_gf_2_8/of_»ed-sŞomÚ_gf_2_8_šşudes.h
"

38 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


39 
	~"../lib_¡abË/»ed-sŞomÚ_gf_2_m/of_»ed-sŞomÚ_gf_2_m_šşudes.h
"

41 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


42 
	~"../lib_¡abË/ldpc_¡aœÿ£/of_ldpc_šşudes.h
"

44 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


45 
	~"../lib_¡abË/2d_·r™y_m©rix/of_2d_·r™y_šşudes.h
"

47 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


48 
	~"../lib_advªûd/ldpc_äom_fe/of_ldpc_ff_šşudes.h
"

51 
UINT32
 
	gof_v”bos™y
;

54 
	$Of_SaveFe
(* 
feName
, **
pBuf
, 
symbŞSize
, 
tÙ®SymbŞ
)

57 
FILE
* 
pFe
 = 
NULL
;

58 
UINT32
 
s32R‘
 = 0;

59 
UINT32
 
i
 = 0;

60 
UINT32
 
j
 = 0;

61 *
psymb
 = 
NULL
;

63 
pFe
 = 
	`fİ’
(
feName
, "ab");

64 ià(
pFe
 =ğ
NULL
 || 
pBuf
 == NULL)

66 
	`OF_PRINT
(("open fileƒrr…File 0x%p…Buf 0x%p\n",

67 
pFe
, 
pBuf
));

72 
i
 = 0; i < 
tÙ®SymbŞ
; i++)

74 
psymb
 = 
pBuf
[
i
];

76 
	`fwr™e
(
psymb
, 
symbŞSize
, 1, 
pFe
);

77 
	`fæush
(
pFe
);

80 
	`fşo£
(
pFe
);

83 
	}
}

86 
of_¡©us_t
 
	$of_ü—‹_codec_š¡ªû
 (
of_£ssiÚ_t
** 
£s
,

87 
of_codec_id_t
 
codec_id
,

88 
of_codec_ty³_t
 
codec_ty³
,

89 
UINT32
 
v”bos™y
)

91 
of_¡©us_t
 
¡©us
;

93 
OF_ENTER_FUNCTION


94 
of_v”bos™y
 = 
v”bos™y
;

98 (*
£s
èğ
	`of_ÿÎoc
 (1,  (
of_cb_t
));

99 ià(*
£s
 =ğ
NULL
)

101 
	`OF_PRINT_ERROR
 ( ("Error, of_calloc failed\n"))

102 
”rÜ2
;

104 ((
of_cb_t
*è(*
£s
))->
codec_ty³
 = codec_type;

105 ((
of_cb_t
*è(*
£s
))->
codec_id
 = codec_id;

107 
codec_id
)

109 #ifdeà
OF_USE_REED_SOLOMON_CODEC


110 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

111 
¡©us
 = 
	`of_rs_ü—‹_codec_š¡ªû
 ( (
of_rs_cb_t
**è
£s
);

114 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


115 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

116 
¡©us
 = 
	`of_rs_2_m_ü—‹_codec_š¡ªû
 ( (
of_rs_2_m_cb_t
**è
£s
);

119 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


120 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

121 
¡©us
 = 
	`of_ldpc_¡aœÿ£_ü—‹_codec_š¡ªû
 ( (
of_ldpc_¡aœÿ£_cb_t
**è
£s
);

124 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


125 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

126 
¡©us
 = 
	`of_2d_·r™y_ü—‹_codec_š¡ªû
 ( (
of_2d_·r™y_cb_t
**è
£s
);

129 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


130 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

131 
¡©us
 = 
	`of_ldpc_ff_ü—‹_codec_š¡ªû
 ( (
of_ldpc_ff_cb_t
**è
£s
);

135 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", 
codec_id
))

136 
”rÜ
;

138 
OF_EXIT_FUNCTION


139  
¡©us
;

141 
”rÜ
:

142 
	`of_ä“
(*
£s
);

143 *
£s
 = 
NULL
;

144 
”rÜ2
:

145 
OF_EXIT_FUNCTION


146  
OF_STATUS_FATAL_ERROR
;

147 
	}
}

150 
of_¡©us_t
 
	$of_»Ëa£_codec_š¡ªû
 (
of_£ssiÚ_t
* 
£s
)

152 
of_¡©us_t
 
¡©us
;

154 
OF_ENTER_FUNCTION


155 ià(
£s
 !ğ
NULL
)

157  ( (
of_cb_t
*è
£s
)->
codec_id
)

159 #ifdeà
OF_USE_REED_SOLOMON_CODEC


160 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

161 
¡©us
 = 
	`of_rs_»Ëa£_codec_š¡ªû
 ( (
of_rs_cb_t
*è
£s
);

164 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


165 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

166 
¡©us
 = 
	`of_rs_2_m_»Ëa£_codec_š¡ªû
 ( (
of_rs_2_m_cb_t
*è
£s
);

169 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


170 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

171 
¡©us
 = 
	`of_ldpc_¡aœÿ£_»Ëa£_codec_š¡ªû
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
);

174 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


175 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

176 
¡©us
 = 
	`of_2d_·r™y_»Ëa£_codec_š¡ªû
Ğ(
of_2d_·r™y_cb_t
*è
£s
);

179 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


180 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

181 
¡©us
 = 
	`of_ldpc_¡aœÿ£_»Ëa£_codec_š¡ªû
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
);

185 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

186 
”rÜ
;

188 
	`of_ä“
(
£s
);

189 
£s
 = 
NULL
;

191 
OF_EXIT_FUNCTION


192  
¡©us
;

194 
”rÜ
:

195 
OF_EXIT_FUNCTION


196  
OF_STATUS_FATAL_ERROR
;

197 
	}
}

200 
of_¡©us_t
 
	$of_£t_ãc_·¿m‘”s
 (
of_£ssiÚ_t
* 
£s
, 
of_·¿m‘”s_t
* 
·¿ms
)

202 
of_¡©us_t
 
¡©us
;

204 
OF_ENTER_FUNCTION


205 ià((
£s
 =ğ
NULL
è|| (
·¿ms
 == NULL))

207 
	`OF_PRINT_ERROR
 ( ("Error, bad ses or…arams…ointer (null)\n"))

208 
”rÜ
;

210 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


211 ià(Ğ(
of_cb_t
*è
£s
)->
codec_id
 !ğ
OF_CODEC_LDPC_FROM_FILE_ADVANCED
 &&

212 ((
·¿ms
->
nb_sourû_symbŞs
 <ğ0è|| (·¿ms->
nb_»·œ_symbŞs
 <= 0)) ||

213 (
·¿ms
->
’codšg_symbŞ_Ëngth
 <= 0))

215 
	`OF_PRINT_ERROR
 ( ("Error, bad…arameters:"))

216 if(
·¿ms
->
nb_sourû_symbŞs
 <= 0)

218 
	`OF_PRINT_ERROR
 ( ("nb_sourû_symbŞ %d <ğ0\n", 
·¿ms
->
nb_sourû_symbŞs
))

220 if(
·¿ms
->
nb_»·œ_symbŞs
 <= 0)

222 
	`OF_PRINT_ERROR
 ( ("nb_»·œ_symbŞ %d <ğ0\n", 
·¿ms
->
nb_»·œ_symbŞs
))

224 if(
·¿ms
->
’codšg_symbŞ_Ëngth
 <= 0)

226 
	`OF_PRINT_ERROR
 ( ("’codšg_symbŞ_Ëngth %d <ğ0\n", 
·¿ms
->
’codšg_symbŞ_Ëngth
))

228 
”rÜ
;

231  ( (
of_cb_t
*è
£s
)->
codec_id
)

233 #ifdeà
OF_USE_REED_SOLOMON_CODEC


234 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

235 
¡©us
 = 
	`of_rs_£t_ãc_·¿m‘”s
 ( (
of_rs_cb_t
*è
£s
, (
of_rs_·¿m‘”s_t
*è
·¿ms
);

238 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


239 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

240 
¡©us
 = 
	`of_rs_2_m_£t_ãc_·¿m‘”s
 ( (
of_rs_2_m_cb_t
*è
£s
, (
of_rs_2_m_·¿m‘”s_t
*è
·¿ms
);

243 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


244 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

245 
¡©us
 = 
	`of_ldpc_¡aœÿ£_£t_ãc_·¿m‘”s
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
, (
of_ldpc_·¿m‘”s_t
*è
·¿ms
);

248 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


249 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

250 
¡©us
 = 
	`of_2d_·r™y_£t_ãc_·¿m‘”s
Ğ(
of_2d_·r™y_cb_t
*è
£s
, (
of_2d_·r™y_·¿m‘”s_t
*è
·¿ms
);

253 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


254 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

255 
¡©us
 = 
	`of_ldpc_ff_£t_ãc_·¿m‘”s
 ((
of_ldpc_ff_cb_t
*è
£s
, (
of_ldpc_ff_·¿m‘”s_t
*è
·¿ms
);

259 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

260 
”rÜ
;

262 
OF_EXIT_FUNCTION


263  
¡©us
;

265 
”rÜ
:

266 
OF_EXIT_FUNCTION


267  
OF_STATUS_FATAL_ERROR
;

268 
	}
}

271 
of_¡©us_t
 
	$of_£t_ÿÎback_funùiÚs_Ãw
 (
of_£ssiÚ_t
 *
£s
,

272 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

273 **
d©a
,

274 **
h—d
,

275 
size
,

276 
h—d_size
,

277 
esi
),

278 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

279 **
d©a
,

280 **
h—d
,

281 
size
,

282 
h—d_size
,

283 
esi
),

284 * 
cÚ‹xt_4_ÿÎback
)

286 
of_¡©us_t
 
¡©us
;

288 
OF_ENTER_FUNCTION


289 ià(
£s
 =ğ
NULL
)

291 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

292 
”rÜ
;

294 ià((
decoded_sourû_symbŞ_ÿÎback
 =ğ
NULL
è&& (
decoded_»·œ_symbŞ_ÿÎback
 == NULL))

296 
	`OF_PRINT_ERROR
 ( ("decoded_source_symbol_callback‡nd decoded_repair_symbol_callback or both NULL\n"))

297 
”rÜ
;

299  ( (
of_cb_t
*è
£s
)->
codec_id
)

301 #ifdeà
OF_USE_REED_SOLOMON_CODEC


302 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

303 
¡©us
 = 
	`of_rs_£t_ÿÎback_funùiÚs_Ãw
((
of_rs_cb_t
*è
£s
,

304 
decoded_sourû_symbŞ_ÿÎback
,

305 
decoded_»·œ_symbŞ_ÿÎback
,

306 
cÚ‹xt_4_ÿÎback
);

344 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

345 
”rÜ
;

347 
OF_EXIT_FUNCTION


348  
¡©us
;

350 
”rÜ
:

351 
OF_EXIT_FUNCTION


352  
OF_STATUS_FATAL_ERROR
;

353 
	}
}

355 
of_¡©us_t
 
	$of_£t_ÿÎback_funùiÚs
 (
of_£ssiÚ_t
 *
£s
,

356 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

357 
UINT32
 
size
,

358 
UINT32
 
esi
),

359 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

360 
UINT32
 
size
,

361 
UINT32
 
esi
),

362 * 
cÚ‹xt_4_ÿÎback
)

364 
of_¡©us_t
 
¡©us
;

366 
OF_ENTER_FUNCTION


367 ià(
£s
 =ğ
NULL
)

369 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

370 
”rÜ
;

372 ià((
decoded_sourû_symbŞ_ÿÎback
 =ğ
NULL
è&& (
decoded_»·œ_symbŞ_ÿÎback
 == NULL))

374 
	`OF_PRINT_ERROR
 ( ("decoded_source_symbol_callback‡nd decoded_repair_symbol_callback or both NULL\n"))

375 
”rÜ
;

377  ( (
of_cb_t
*è
£s
)->
codec_id
)

379 #ifdeà
OF_USE_REED_SOLOMON_CODEC


380 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

381 
¡©us
 = 
	`of_rs_£t_ÿÎback_funùiÚs
((
of_rs_cb_t
*è
£s
,

382 
decoded_sourû_symbŞ_ÿÎback
,

383 
decoded_»·œ_symbŞ_ÿÎback
,

384 
cÚ‹xt_4_ÿÎback
);

387 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


388 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

389 
¡©us
 = 
	`of_rs_2_m_£t_ÿÎback_funùiÚs
((
of_rs_2_m_cb_t
*è
£s
,

390 
decoded_sourû_symbŞ_ÿÎback
,

391 
decoded_»·œ_symbŞ_ÿÎback
,

392 
cÚ‹xt_4_ÿÎback
);

395 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


396 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

397 
¡©us
 = 
	`of_ldpc_¡aœÿ£_£t_ÿÎback_funùiÚs
((
of_ldpc_¡aœÿ£_cb_t
*è
£s
,

398 
decoded_sourû_symbŞ_ÿÎback
,

399 
decoded_»·œ_symbŞ_ÿÎback
,

400 
cÚ‹xt_4_ÿÎback
);

403 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


404 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

405 
¡©us
 = 
	`of_2d_·r™y_£t_ÿÎback_funùiÚs
Ğ(
of_2d_·r™y_cb_t
*è
£s
,

406 
decoded_sourû_symbŞ_ÿÎback
,

407 
decoded_»·œ_symbŞ_ÿÎback
,

408 
cÚ‹xt_4_ÿÎback
);

411 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


412 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

413 
¡©us
 = 
	`of_ldpc_¡aœÿ£_£t_ÿÎback_funùiÚs
((
of_ldpc_¡aœÿ£_cb_t
*è
£s
,

414 
decoded_sourû_symbŞ_ÿÎback
,

415 
decoded_»·œ_symbŞ_ÿÎback
,

416 
cÚ‹xt_4_ÿÎback
);

420 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

421 
”rÜ
;

423 
OF_EXIT_FUNCTION


424  
¡©us
;

426 
”rÜ
:

427 
OF_EXIT_FUNCTION


428  
OF_STATUS_FATAL_ERROR
;

429 
	}
}

432 
of_¡©us_t
 
	$of_mÜe_about
 (
of_£ssiÚ_t
* 
£s
,

433 ** 
v”siÚ_¡r
,

434 ** 
cİyrights_¡r
)

436 
OF_ENTER_FUNCTION


437 
of_v”siÚ_¡ršg
[] = "OpenFEC.org - Version 1.4.2, December 16th, 2014\n";

438 
of_cİyrights_¡ršg
[] ="\n\
.org - Because free, open source AL-FEC codes‡nd codecs matter\n\
 (c) 2003-2014 INRIA - All„ights„eserved\n\
\n\
 codecs:\n\
 (c) 2003-2014 INRIA - All„ights„eserved\n\
†ibrary contains code from R. Neal:\n\
 (c) 1995-2003 by Radford M. Neal\n\
\n\
-Solomon codecs:\n\
†ibrary contains code from L. Rizzo:\n\
 (c) 1997-98 Luigi Rizzo (luigi@iet.unipi.it)\n\
 derived from code by Phil Karn (karn@ka9q.ampr.org), \n\
 Morelos-Zaragoza (robert@spectra.eng.hawaii.edu)‡nd Hari \n\
 (harit@spectra.eng.hawaii.edu), Aug 1995 \n\
\n\
he‡ssociated LICENCE.TXT file for†icence information\n";

456 ià(
v”siÚ_¡r
)

458 *
v”siÚ_¡r
 = 
of_v”siÚ_¡ršg
;

460 ià(
cİyrights_¡r
)

462 *
cİyrights_¡r
 = 
of_cİyrights_¡ršg
;

464 
OF_EXIT_FUNCTION


465  
OF_STATUS_OK
;

466 
	}
}

469 #ifdeà
OF_USE_ENCODER


471 
of_¡©us_t
 
	$of_bud_»·œ_symbŞ
 (
of_£ssiÚ_t
* 
£s
, * 
’codšg_symbŞs_b
[],

472 * 
’codšg_h—ds_b
[],
UINT32
 
esi_of_symbŞ_to_bud
,

473 
UINT32
 
’codšg_symbŞ_Ëngth
, UINT32 
’codšg_h—d_Ëngth
)

475 
of_¡©us_t
 
¡©us
;

477 
OF_ENTER_FUNCTION


478 ià(
£s
 =ğ
NULL
)

480 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

481 
”rÜ
;

483 ià(!(((
of_cb_t
*è
£s
)->
codec_ty³
 & 
OF_ENCODER
))

485 
	`OF_PRINT_ERROR
 ( ("Error, bad codec_type\n"))

486 
”rÜ
;

488  ( (
of_cb_t
*è
£s
)->
codec_id
)

490 #ifdeà
OF_USE_REED_SOLOMON_CODEC


491 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

492 
¡©us
 = 
	`of_rs_bud_»·œ_symbŞ
 ((
of_rs_cb_t
*è
£s
, 
’codšg_symbŞs_b
,

493 
’codšg_h—ds_b
,
esi_of_symbŞ_to_bud
,

494 
’codšg_symbŞ_Ëngth
, 
’codšg_h—d_Ëngth
);

497 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


498 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

499 
¡©us
 = 
	`of_rs_2_m_bud_»·œ_symbŞ
 ((
of_rs_2_m_cb_t
*è
£s
, 
’codšg_symbŞs_b
,

500 
’codšg_h—ds_b
, 
esi_of_symbŞ_to_bud
);

503 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


504 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

505 
¡©us
 = 
	`of_ldpc_¡aœÿ£_bud_»·œ_symbŞ
 ((
of_ldpc_¡aœÿ£_cb_t
*è
£s
, 
’codšg_symbŞs_b
, 
esi_of_symbŞ_to_bud
);

508 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


509 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

510 
¡©us
 = 
	`of_2d_·r™y_bud_»·œ_symbŞ
Ğ(
of_2d_·r™y_cb_t
*è
£s
, 
’codšg_symbŞs_b
, 
esi_of_symbŞ_to_bud
);

513 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


514 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

515 
¡©us
 = 
	`of_ldpc_ff_bud_»·œ_symbŞ
 ((
of_ldpc_ff_cb_t
*è
£s
, 
’codšg_symbŞs_b
, 
esi_of_symbŞ_to_bud
);

519 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

520 
”rÜ
;

522 
OF_EXIT_FUNCTION


523  
¡©us
;

525 
”rÜ
:

526 
OF_EXIT_FUNCTION


527  
OF_STATUS_FATAL_ERROR
;

528 
	}
}

533 #ifdeà
OF_USE_DECODER


535 
of_¡©us_t
 
	$of_decode_w™h_Ãw_symbŞ
 (
of_£ssiÚ_t
* 
£s
,

536 * cÚ¡ 
Ãw_symbŞ_buf
,

537 * cÚ¡ 
Ãw_symbŞh—d_buf
,

538 
UINT32
 
Ãw_symbŞ_esi
)

540 
of_¡©us_t
 
¡©us
;

542 
OF_ENTER_FUNCTION


543 ià(
£s
 =ğ
NULL
)

545 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

546 
”rÜ
;

548 iàĞ
Ãw_symbŞ_esi
 >ğ(((
of_cb_t
*è
£s
)->
nb_sourû_symbŞs
 + ((of_cb_t*è£s)->
nb_»·œ_symbŞs
) )

550 
	`OF_PRINT_ERROR
 ( ("E¼Ü, bad…¬am‘” Ãw_symbŞ_esi(%dèouˆoà¿nge\n",
Ãw_symbŞ_esi
))

551 
”rÜ
;

553 ià(
Ãw_symbŞ_buf
 =ğ
NULL
 ||

554 
Ãw_symbŞ_esi
 >ğ(((
of_cb_t
*è
£s
)->
nb_sourû_symbŞs
 + ((of_cb_t*è£s)->
nb_»·œ_symbŞs
) ||

555 !(Ğ(
of_cb_t
*è
£s
)->
codec_ty³
 & 
OF_DECODER
))

557 
	`OF_PRINT_ERROR
 ( ("Error, bad…arameters‚ew_symbol_esi %d‚ew_symbol_buf %p‚b_source_symbols %d‚b_repair_symbols %d codec_type %d",

558 
Ãw_symbŞ_esi
,

559 
Ãw_symbŞ_buf
,

560 ((
of_cb_t
*è
£s
)->
nb_sourû_symbŞs
,

561 ((
of_cb_t
*è
£s
)->
nb_»·œ_symbŞs
,

562 ((
of_cb_t
*è
£s
)->
codec_ty³
))

563 
”rÜ
;

565  ( (
of_cb_t
*è
£s
)->
codec_id
)

567 #ifdeà
OF_USE_REED_SOLOMON_CODEC


568 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

569 
¡©us
 = 
	`of_rs_decode_w™h_Ãw_symbŞ
 ( (
of_rs_cb_t
*è
£s
, 
Ãw_symbŞ_buf
, 
Ãw_symbŞh—d_buf
, 
Ãw_symbŞ_esi
);

572 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


573 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

574 
¡©us
 = 
	`of_rs_2_m_decode_w™h_Ãw_symbŞ
 ( (
of_rs_2_m_cb_t
*è
£s
, 
Ãw_symbŞ_buf
, 
Ãw_symbŞh—d_buf
, 
Ãw_symbŞ_esi
);

577 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


578 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

579 
¡©us
 = 
	`of_ldpc_¡aœÿ£_decode_w™h_Ãw_symbŞ
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
, 
Ãw_symbŞ_buf
, 
Ãw_symbŞ_esi
);

582 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


583 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

584 
¡©us
 = 
	`of_2d_·r™y_decode_w™h_Ãw_symbŞ
Ğ(
of_2d_·r™y_cb_t
*è
£s
, 
Ãw_symbŞ_buf
, 
Ãw_symbŞ_esi
);

587 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


588 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

589 
¡©us
 = 
	`of_ldpc_¡aœÿ£_decode_w™h_Ãw_symbŞ
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
, 
Ãw_symbŞ_buf
, 
Ãw_symbŞ_esi
);

593 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

594 
”rÜ
;

596 
OF_EXIT_FUNCTION


597  
¡©us
;

599 
”rÜ
:

600 
OF_EXIT_FUNCTION


601  
OF_STATUS_FATAL_ERROR
;

602 
	}
}

605 
of_¡©us_t
 
	$of_£t_avaabË_symbŞs
 (
of_£ssiÚ_t
* 
£s
,

606 * cÚ¡ 
’codšg_symbŞs_b
[],

607 * cÚ¡ 
’codšg_symbŞh—ds_b
[])

609 
of_¡©us_t
 
¡©us
;

611 
OF_ENTER_FUNCTION


612 ià(
£s
 =ğ
NULL
)

614 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

615 
”rÜ
;

617 ià(
’codšg_symbŞs_b
 =ğ
NULL
)

619 
	`OF_PRINT_ERROR
 ( ("Error, badƒncoding_symbols_tab (null)\n"))

620 
”rÜ
;

622 ià(!((
of_cb_t
*è
£s
)->
codec_ty³
 & 
OF_DECODER
)

624 
	`OF_PRINT_ERROR
 ( ("Error, bad codec_type\n"))

625 
”rÜ
;

627  ( (
of_cb_t
*è
£s
)->
codec_id
)

629 #ifdeà
OF_USE_REED_SOLOMON_CODEC


630 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

631 
¡©us
 = 
	`of_rs_£t_avaabË_symbŞs
 ( (
of_rs_cb_t
*è
£s
, 
’codšg_symbŞs_b
, 
’codšg_symbŞh—ds_b
);

634 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


635 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

636 
¡©us
 = 
	`of_rs_2_m_£t_avaabË_symbŞs
 ( (
of_rs_2_m_cb_t
*è
£s
, 
’codšg_symbŞs_b
, 
’codšg_symbŞh—ds_b
);

639 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


640 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

641 
¡©us
 = 
	`of_ldpc_¡aœÿ£_£t_avaabË_symbŞs
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
, 
’codšg_symbŞs_b
);

644 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


645 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

646 
¡©us
 = 
	`of_ldpc_¡aœÿ£_£t_avaabË_symbŞs
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
, 
’codšg_symbŞs_b
);

649 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


650 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

651 
¡©us
 = 
	`of_2d_·r™y_£t_avaabË_symbŞs
 ( (
of_2d_·r™y_cb_t
*è
£s
, 
’codšg_symbŞs_b
);

655 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

656 
”rÜ
;

658 
OF_EXIT_FUNCTION


659  
¡©us
;

661 
”rÜ
:

662 
OF_EXIT_FUNCTION


663  
OF_STATUS_FATAL_ERROR
;

664 
	}
}

667 
of_¡©us_t
 
	$of_fšish_decodšg
 (
of_£ssiÚ_t
* 
£s
)

669 
of_¡©us_t
 
¡©us
;

671 
OF_ENTER_FUNCTION


672 ià(
£s
 =ğ
NULL
)

674 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

675 
”rÜ
;

677 ià(!((
of_cb_t
*è
£s
)->
codec_ty³
 & 
OF_DECODER
)

679 
	`OF_PRINT_ERROR
 ( ("Error, bad codec_type\n"))

680 
”rÜ
;

682  ( (
of_cb_t
*è
£s
)->
codec_id
)

684 #ifdeà
OF_USE_REED_SOLOMON_CODEC


685 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

686 
¡©us
 = 
	`of_rs_fšish_decodšg
 ( (
of_rs_cb_t
*è
£s
);

689 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


690 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

691 
¡©us
 = 
	`of_rs_2_m_fšish_decodšg
 ( (
of_rs_2_m_cb_t
*è
£s
);

694 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


695 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

696 
¡©us
 = 
	`of_ldpc_¡aœÿ£_fšish_decodšg
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
);

699 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


700 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

701 
¡©us
 = 
	`of_2d_·r™y_fšish_decodšg
 ( (
of_2d_·r™y_cb_t
*è
£s
);

704 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


705 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

706 
¡©us
 = 
	`of_ldpc_¡aœÿ£_fšish_decodšg
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
);

710 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

711 
”rÜ
;

713 
OF_EXIT_FUNCTION


714  
¡©us
;

716 
”rÜ
:

717 
OF_EXIT_FUNCTION


718  
OF_STATUS_FATAL_ERROR
;

719 
	}
}

721 
of_¡©us_t
 
	$of_»£t_decodšg_¡©u
(
of_£ssiÚ_t
* 
£s
){

722 
of_¡©us_t
 
¡©us
 = 
OF_STATUS_FAILURE
;

724 
OF_ENTER_FUNCTION


725 ià(
£s
 =ğ
NULL
)

727 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

728 
”rÜ
;

730 ià(!((
of_cb_t
*è
£s
)->
codec_ty³
 & 
OF_DECODER
)

732 
	`OF_PRINT_ERROR
 ( ("Error, bad codec_type\n"))

733 
”rÜ
;

735  ( (
of_cb_t
*è
£s
)->
codec_id
)

737 #ifdeà
OF_USE_REED_SOLOMON_CODEC


738 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

739 
¡©us
 = 
	`of_rs_»£t_decodšg_¡©u
 ( (
of_rs_cb_t
*è
£s
);

742 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


743 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

744 
¡©us
 = 
	`of_rs_2_m_»£t_decodšg_¡©u
 ( (
of_rs_2_m_cb_t
*è
£s
);

747 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


748 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

749 
¡©us
 = 
	`of_ldpc_¡aœÿ£_»£t_decodšg_¡©u
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
);

752 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


753 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

754 
¡©us
 = 
	`of_ldpc_¡aœÿ£_»£t_decodšg_¡©u
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
);

757 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


758 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

759 
¡©us
 = 
	`of_2d_·r™y_»£t_decodšg_¡©u
 ( (
of_2d_·r™y_cb_t
*è
£s
);

763 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

764 
”rÜ
;

766 
OF_EXIT_FUNCTION


767  
¡©us
;

769 
”rÜ
:

770 
OF_EXIT_FUNCTION


773  
¡©us
;

774 
	}
}

777 
boŞ
 
	$of_is_decodšg_com¶‘e
 (
of_£ssiÚ_t
* 
£s
)

779 
of_¡©us_t
 
¡©us
;

781 
OF_ENTER_FUNCTION


782 ià(
£s
 =ğ
NULL
)

784 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

785 
”rÜ
;

787 ià(!((
of_cb_t
*è
£s
)->
codec_ty³
 & 
OF_DECODER
)

789 
	`OF_PRINT_ERROR
 ( ("Error, bad codec_type\n"))

790 
”rÜ
;

792  ( (
of_cb_t
*è
£s
)->
codec_id
)

794 #ifdeà
OF_USE_REED_SOLOMON_CODEC


795 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

796 
¡©us
 = 
	`of_rs_is_decodšg_com¶‘e
 ( (
of_rs_cb_t
*è
£s
);

799 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


800 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

801 
¡©us
 = 
	`of_rs_2_m_is_decodšg_com¶‘e
 ( (
of_rs_2_m_cb_t
*è
£s
);

804 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


805 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

806 
¡©us
 = 
	`of_ldpc_¡aœÿ£_is_decodšg_com¶‘e
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
);

809 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


810 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

811 
¡©us
 = 
	`of_ldpc_¡aœÿ£_is_decodšg_com¶‘e
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
);

814 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


815 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

816 
¡©us
 = 
	`of_2d_·r™y_is_decodšg_com¶‘e
 ( (
of_2d_·r™y_cb_t
*è
£s
);

820 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

821 
”rÜ
;

823 
OF_EXIT_FUNCTION


824  
¡©us
;

826 
”rÜ
:

827 
OF_EXIT_FUNCTION


830  
çl£
;

831 
	}
}

833 
of_¡©us_t
 
	$of_g‘_sourû_symbŞs_b_Ãw
 (
of_£ssiÚ_t
* 
£s
,

834 * 
sourû_symbŞs_b
[],

835 * 
sourû_h—d_symbŞs_b
[])

837 
of_¡©us_t
 
¡©us
;

839 
OF_ENTER_FUNCTION


840 ià(
£s
 =ğ
NULL
)

842 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

843 
”rÜ
;

845 ià(!((
of_cb_t
*è
£s
)->
codec_ty³
 & 
OF_DECODER
)

847 
	`OF_PRINT_ERROR
 ( ("Error, bad codec_type\n"))

848 
”rÜ
;

850  ( (
of_cb_t
*è
£s
)->
codec_id
)

852 #ifdeà
OF_USE_REED_SOLOMON_CODEC


853 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

854 
¡©us
 = 
	`of_rs_g‘_sourû_symbŞs_b_Ãw
 ( (
of_rs_cb_t
*è
£s
, 
sourû_symbŞs_b
, 
sourû_h—d_symbŞs_b
);

880 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

881 
”rÜ
;

883 
OF_EXIT_FUNCTION


884  
¡©us
;

886 
”rÜ
:

887 
OF_EXIT_FUNCTION


888  
OF_STATUS_FATAL_ERROR
;

889 
	}
}

891 
of_¡©us_t
 
	$of_g‘_sourû_symbŞs_b
 (
of_£ssiÚ_t
* 
£s
,

892 * 
sourû_symbŞs_b
[])

894 
of_¡©us_t
 
¡©us
;

896 
OF_ENTER_FUNCTION


897 ià(
£s
 =ğ
NULL
)

899 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

900 
”rÜ
;

902 ià(!((
of_cb_t
*è
£s
)->
codec_ty³
 & 
OF_DECODER
)

904 
	`OF_PRINT_ERROR
 ( ("Error, bad codec_type\n"))

905 
”rÜ
;

907  ( (
of_cb_t
*è
£s
)->
codec_id
)

909 #ifdeà
OF_USE_REED_SOLOMON_CODEC


910 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

911 
¡©us
 = 
	`of_rs_g‘_sourû_symbŞs_b
 ( (
of_rs_cb_t
*è
£s
, 
sourû_symbŞs_b
);

914 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


915 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

916 
¡©us
 = 
	`of_rs_2_m_g‘_sourû_symbŞs_b
 ( (
of_rs_2_m_cb_t
*è
£s
, 
sourû_symbŞs_b
);

919 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


920 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

921 
¡©us
 = 
	`of_ldpc_¡aœÿ£_g‘_sourû_symbŞs_b
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
, 
sourû_symbŞs_b
);

924 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


925 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

926 
¡©us
 = 
	`of_2d_·r™y_g‘_sourû_symbŞs_b
 ( (
of_2d_·r™y_cb_t
*è
£s
, 
sourû_symbŞs_b
);

929 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


930 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

931 
¡©us
 = 
	`of_ldpc_¡aœÿ£_g‘_sourû_symbŞs_b
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
, 
sourû_symbŞs_b
);

935 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

936 
”rÜ
;

938 
OF_EXIT_FUNCTION


939  
¡©us
;

941 
”rÜ
:

942 
OF_EXIT_FUNCTION


943  
OF_STATUS_FATAL_ERROR
;

944 
	}
}

947 
of_¡©us_t
 
	$of_£t_cÚŒŞ_·¿m‘”
 (
of_£ssiÚ_t
* 
£s
,

948 
UINT32
 
ty³
,

949 * 
v®ue
,

950 
UINT32
 
Ëngth
)

952 
of_¡©us_t
 
¡©us
;

954 
OF_ENTER_FUNCTION


955 ià(
£s
 =ğ
NULL
)

957 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

958 
”rÜ
;

960  ( (
of_cb_t
*è
£s
)->
codec_id
)

962 #ifdeà
OF_USE_REED_SOLOMON_CODEC


963 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

967 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


968 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

969 
¡©us
 = 
	`of_rs_2_m_£t_cÚŒŞ_·¿m‘”
 ( (
of_rs_2_m_cb_t
*è
£s
, 
ty³
, 
v®ue
, 
Ëngth
);

972 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


973 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

974 
¡©us
 = 
	`of_ldpc_¡aœÿ£_£t_cÚŒŞ_·¿m‘”
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
, 
ty³
, 
v®ue
, 
Ëngth
);

977 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


978 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

979 
¡©us
 = 
	`of_2d_·r™y_£t_cÚŒŞ_·¿m‘”
 ( (
of_2d_·r™y_cb_t
*è
£s
, 
ty³
, 
v®ue
, 
Ëngth
);

982 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


983 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

984 
¡©us
 = 
	`of_ldpc_ff_£t_cÚŒŞ_·¿m‘”
 ( (
of_ldpc_ff_cb_t
*è
£s
, 
ty³
, 
v®ue
, 
Ëngth
);

988 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

989 
”rÜ
;

991 
OF_EXIT_FUNCTION


992  
¡©us
;

994 
”rÜ
:

995 
OF_EXIT_FUNCTION


996  
OF_STATUS_FATAL_ERROR
;

997 
	}
}

1000 
of_¡©us_t
 
	$of_g‘_cÚŒŞ_·¿m‘”
 (
of_£ssiÚ_t
* 
£s
, 
UINT32
 
ty³
, * 
v®ue
, UINT32 
Ëngth
)

1002 
of_¡©us_t
 
¡©us
;

1004 
OF_ENTER_FUNCTION


1005 ià(
£s
 =ğ
NULL
)

1007 
	`OF_PRINT_ERROR
 ( ("Error, bad ses…ointer (null)\n"))

1008 
”rÜ
;

1010  ( (
of_cb_t
*è
£s
)->
codec_id
)

1012 #ifdeà
OF_USE_REED_SOLOMON_CODEC


1013 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
:

1014 
¡©us
 = 
	`of_rs_g‘_cÚŒŞ_·¿m‘”
 ( (
of_rs_cb_t
*è
£s
, 
ty³
, 
v®ue
, 
Ëngth
);

1017 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


1018 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
:

1019 
¡©us
 = 
	`of_rs_2_m_g‘_cÚŒŞ_·¿m‘”
 ( (
of_rs_2_m_cb_t
*è
£s
, 
ty³
, 
v®ue
, 
Ëngth
);

1022 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


1023 
OF_CODEC_LDPC_STAIRCASE_STABLE
:

1024 
¡©us
 = 
	`of_ldpc_¡aœÿ£_g‘_cÚŒŞ_·¿m‘”
 ( (
of_ldpc_¡aœÿ£_cb_t
*è
£s
, 
ty³
, 
v®ue
, 
Ëngth
);

1027 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


1028 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

1029 
¡©us
 = 
	`of_ldpc_ff_g‘_cÚŒŞ_·¿m‘”
 ( (
of_ldpc_ff_cb_t
*è
£s
, 
ty³
, 
v®ue
, 
Ëngth
);

1032 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


1033 
OF_CODEC_2D_PARITY_MATRIX_STABLE
:

1034 
¡©us
 = 
	`of_2d_·r™y_g‘_cÚŒŞ_·¿m‘”
 ( (
of_2d_·r™y_cb_t
*è
£s
, 
ty³
, 
v®ue
, 
Ëngth
);

1038 
	`OF_PRINT_ERROR
 ( ("E¼Ü, codeø%d‚Ú‡vaabË\n", ((
of_cb_t
*)
£s
)->
codec_id
))

1039 
”rÜ
;

1041 
OF_EXIT_FUNCTION


1042  
¡©us
;

1044 
”rÜ
:

1045 
OF_EXIT_FUNCTION


1046  
OF_STATUS_FATAL_ERROR
;

1047 
	}
}

	@src/lib_common/of_openfec_api.h

36 #iâdeà
OPENFEC_API_H


37 
	#OPENFEC_API_H


	)

40 
	~"of_İ’ãc_´ofe.h
"

41 
	~"of_ty³s.h
"

43 #ifdeà
OF_USE_REED_SOLOMON_CODEC


44 
	~"../lib_¡abË/»ed-sŞomÚ_gf_2_8/of_»ed-sŞomÚ_gf_2_8_­i.h
"

46 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


47 
	~"../lib_¡abË/»ed-sŞomÚ_gf_2_m/of_»ed-sŞomÚ_gf_2_m_­i.h
"

49 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


50 
	~"../lib_¡abË/ldpc_¡aœÿ£/of_ldpc_¡aœÿ£_­i.h
"

52 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


53 
	~"../lib_¡abË/2d_·r™y_m©rix/of_2d_·r™y_­i.h
"

55 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


56 
	~"../lib_advªûd/ldpc_äom_fe/of_ldpc_ff_­i.h
"

58 
	~"of_debug.h
"

114 
	mOF_CODEC_NIL
 = 0,

115 
	mOF_CODEC_REED_SOLOMON_GF_2_8_STABLE
 = 1,

116 
	mOF_CODEC_REED_SOLOMON_GF_2_M_STABLE
 = 2,

117 
	mOF_CODEC_LDPC_STAIRCASE_STABLE
 = 3,

119 
	mOF_CODEC_2D_PARITY_MATRIX_STABLE
 = 5,

120 
	mOF_CODEC_LDPC_FROM_FILE_ADVANCED
 = 6

121 } 
	tof_codec_id_t
;

128 
UINT8
 
	tof_codec_ty³_t
;

130 
	#OF_ENCODER
 0x1

	)

131 
	#OF_DECODER
 0x2

	)

132 
	#OF_ENCODER_AND_DECODER
 (
OF_ENCODER
 | 
OF_DECODER
)

	)

154 
	mOF_STATUS_OK
 = 0,

155 
	mOF_STATUS_FAILURE
,

156 
	mOF_STATUS_ERROR
,

157 
	mOF_STATUS_FATAL_ERROR


158 } 
	tof_¡©us_t
;

170 
	sof_£ssiÚ


172 
of_codec_id_t
 
	mcodec_id
;

173 
of_codec_ty³_t
 
	mcodec_ty³
;

174 } 
	tof_£ssiÚ_t
;

185 
	sof_·¿m‘”s


187 
UINT32
 
	mnb_sourû_symbŞs
;

188 
UINT32
 
	mnb_»·œ_symbŞs
;

189 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

190 
UINT32
 
	m’codšg_h—d_Ëngth
;

191 
UINT16
 
	mm
;

192 } 
	tof_·¿m‘”s_t
;

196 
UINT32
 
of_v”bos™y
;

224 
of_¡©us_t
 
of_ü—‹_codec_š¡ªû
 (
of_£ssiÚ_t
** 
£s
,

225 
of_codec_id_t
 
codec_id
,

226 
of_codec_ty³_t
 
codec_ty³
,

227 
UINT32
 
v”bos™y
);

241 
of_¡©us_t
 
of_»Ëa£_codec_š¡ªû
 (
of_£ssiÚ_t
* 
£s
);

265 
of_¡©us_t
 
of_£t_ãc_·¿m‘”s
 (
of_£ssiÚ_t
* 
£s
,

266 
of_·¿m‘”s_t
* 
·¿ms
);

315 
of_¡©us_t
 
of_£t_ÿÎback_funùiÚs
 (
of_£ssiÚ_t
 *
£s
,

316 * (*
decoded_sourû_symbŞ_ÿÎback
) (

317 *
cÚ‹xt
,

318 
UINT32
 
size
,

319 
UINT32
 
esi
),

320 * (*
decoded_»·œ_symbŞ_ÿÎback
) (

321 *
cÚ‹xt
,

322 
UINT32
 
size
,

323 
UINT32
 
esi
),

324 * 
cÚ‹xt_4_ÿÎback
);

326 
of_¡©us_t
 
of_£t_ÿÎback_funùiÚs_Ãw
 (
of_£ssiÚ_t
 *
£s
,

327 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

328 **
d©a
,

329 **
h—d
,

330 
size
,

331 
h—d_size
,

332 
esi
),

333 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

334 **
d©a
,

335 **
h—d
,

336 
size
,

337 
h—d_size
,

338 
esi
),

339 * 
cÚ‹xt_4_ÿÎback
);

341 #ifdeà
OF_USE_ENCODER


373 
of_¡©us_t
 
of_bud_»·œ_symbŞ
 (
of_£ssiÚ_t
* 
£s
,

374 * 
’codšg_symbŞs_b
[],

375 * 
’codšg_h—ds_b
[],

376 
UINT32
 
esi_of_symbŞ_to_bud
,

377 
UINT32
 
’codšg_symbŞ_Ëngth
,

378 
UINT32
 
’codšg_h—d_Ëngth
);

383 #ifdeà
OF_USE_DECODER


413 
of_¡©us_t
 
of_decode_w™h_Ãw_symbŞ
 (
of_£ssiÚ_t
* 
£s
,

414 * cÚ¡ 
Ãw_symbŞ_buf
,

415 * cÚ¡ 
Ãw_symbŞh—d_buf
,

416 
UINT32
 
Ãw_symbŞ_esi
);

442 
of_¡©us_t
 
of_£t_avaabË_symbŞs
 (
of_£ssiÚ_t
* 
£s
,

443 * cÚ¡ 
’codšg_symbŞs_b
[],

444 * cÚ¡ 
’codšg_symbŞh—ds_b
[]);

451 
of_¡©us_t
 
of_£t_avaabË_symbŞ_li¡
 (
of_£ssiÚ_t
* 
£s
,

452 
of_es_li¡_t
 
’codšg_symbŞs_li¡
);

473 
of_¡©us_t
 
of_fšish_decodšg
 (
of_£ssiÚ_t
* 
£s
);

486 
boŞ
 
of_is_decodšg_com¶‘e
 (
of_£ssiÚ_t
* 
£s
);

502 
of_¡©us_t
 
of_g‘_sourû_symbŞs_b
 (
of_£ssiÚ_t
* 
£s
,

503 * 
sourû_symbŞs_b
[]);

506 
of_¡©us_t
 
of_»£t_decodšg_¡©u
(
of_£ssiÚ_t
* 
£s
);

508 
of_¡©us_t
 
of_g‘_sourû_symbŞs_b_Ãw
 (
of_£ssiÚ_t
* 
£s
,

509 * 
sourû_symbŞs_b
[],

510 * 
sourû_h—d_symbŞs_b
[]);

537 
of_¡©us_t
 
of_mÜe_about
 (
of_£ssiÚ_t
* 
£s
,

538 ** 
v”siÚ_¡r
,

539 ** 
cİyrights_¡r
);

553 
of_¡©us_t
 
of_£t_cÚŒŞ_·¿m‘”
 (
of_£ssiÚ_t
* 
£s
,

554 
UINT32
 
ty³
,

555 * 
v®ue
,

556 
UINT32
 
Ëngth
);

572 
of_¡©us_t
 
of_g‘_cÚŒŞ_·¿m‘”
 (
of_£ssiÚ_t
* 
£s
,

573 
UINT32
 
ty³
,

574 * 
v®ue
,

575 
UINT32
 
Ëngth
);

596 
	#OF_CTRL_GET_MAX_K
 1

	)

606 
	#OF_CTRL_GET_MAX_N
 2

	)

613 
	#OF_RS_CTRL_SET_FIELD_SIZE
 1024

	)

625 
boŞ
 
of_g‘_decodšg_sucûss_´oba
 (
of_£ssiÚ_t
* 
£s
,

626 
UINT32
 
nb_avaabË_sourû_symbŞs
,

627 
UINT32
 
nb_avaabË_»·œ_symbŞs
);

	@src/lib_common/of_openfec_profile.h

34 #iâdeà
OF_OPENFEC_PROFILE_H


35 
	#OF_OPENFEC_PROFILE_H


	)

37 
	#OF_USE_ENCODER


	)

38 
	#OF_USE_DECODER


	)

52 
	~"../lib_¡abË/»ed-sŞomÚ_gf_2_8/of_codec_´ofe.h
"

53 
	~"../lib_¡abË/»ed-sŞomÚ_gf_2_m/of_codec_´ofe.h
"

54 
	~"../lib_¡abË/ldpc_¡aœÿ£/of_codec_´ofe.h
"

55 
	~"../lib_¡abË/2d_·r™y_m©rix/of_codec_´ofe.h
"

69 
	#OF_USE_LINEAR_BINARY_CODES_UTILS


	)

70 
	#OF_USE_GALOIS_FIELD_CODES_UTILS


	)

	@src/lib_common/of_rand.c

204 
	~<¡dio.h
>

205 
	~"of_İ’ãc_­i.h
"

206 
	~"of_¿nd.h
"

209 
UINT64
 
	gof_£ed
;

217 #ià
CHECK_PRNG_CONFORMITY


222 
	$of_check_´ng
 ()

224 
OF_ENTER_FUNCTION


225 
INT32
 
i
;

226 
UINT64
 
v®
;

228 
of_£ed
 = 1;

229 
i
 = 0; i < 10000; i++)

231 
v®
 = 
	`of_¿nd
 (0x7FFFFFFF);

233 ià(
v®
 != 1043618065)

235 
	`årštf
 (
¡d”r
, "ldpc_¿nd: ERROR, inv®id PRNG, 10,000th v®ui %d\n", 
v®
);

236 
OF_EXIT_FUNCTION


241 
	`årštf
 (
¡d”r
, "ldpc_¿nd: okay, PRNG i v®id, 10,000th v®ui %d\n", 
v®
);

243 
OF_EXIT_FUNCTION


244 
	}
}

252 
	$of_rfc5170_¤ªd
 (
UINT64
 
s
)

254 
OF_ENTER_FUNCTION


255 iàĞ(
s
 >= 1) && (s <= 0x7FFFFFFE))

256 
of_£ed
 = 
s
;

259 
	`årštf
 (
¡d”r
, "ldpc_¿nd: ERROR, s“d (%Îuèouˆoà¿nge\n", 
of_£ed
);

260 
OF_EXIT_FUNCTION


263 #ià
CHECK_PRNG_CONFORMITY


264 
	`check_PRNG
();

265 
of_£ed
 = 
s
;

267 
OF_EXIT_FUNCTION


268 
	}
}

282 
UINT64


283 
	$of_rfc5170_¿nd
 (
UINT64
 
maxv
)

286 
UINT64
 
hi
, 
lo
;

287 
lo
 = 16807 * (
of_£ed
 & 0xFFFF);

288 
hi
 = 16807 * (
of_£ed
 >> 16);

289 
lo
 +ğ(
hi
 & 0x7FFF) << 16;

290 
lo
 +ğ
hi
 >> 15;

291 ià(
lo
 > 0x7FFFFFFF)

292 
lo
 -= 0x7FFFFFFF;

293 
of_£ed
 = (
UINT64
è
lo
;

295  ( (
UINT64
)

296 Ğ(è
of_£ed
 * (è
maxv
 / () 0x7FFFFFFF));

297 
	}
}

	@src/lib_common/of_rand.h

34 #iâdeà
OF_RAND


35 
	#OF_RAND


	)

45 
of_rfc5170_¤ªd
 (
UINT64
 
s
);

60 
UINT64
 
of_rfc5170_¿nd
 (UINT64 
maxv
);

	@src/lib_common/of_types.h

35 #iâdeà
OF_TYPES


36 
	#OF_TYPES


	)

39 #iâdeà
__ılu¥lus


40 #iâdeà
boŞ


41 
	#boŞ
 
UINT32


	)

42 
	#Œue
 1

	)

43 
	#çl£
 0

	)

47 #iâdeà
UINT32


48 
	#INT8
 

	)

49 
	#INT16
 

	)

50 
	#UINT8
 

	)

51 
	#UINT16
 

	)

53 #ià
defšed
(
__LP64__
è|| (
__WORDSIZE
 == 64)

54 
	#INT32
 

	)

55 
	#UINT32
 

	)

59 
	#INT32
 

	)

60 
	#UINT32
 

	)

65 #iâdeà
UINT64


66 #ifdeà
WIN32


67 
	#INT64
 
__št64


	)

68 
	#UINT64
 
__ušt64


	)

70 
	#INT64
 

	)

71 
	#UINT64
 

	)

80 
	tgf
;

	@src/lib_common/statistics/of_statistics.c

34 
	~<¡dio.h
>

35 
	~"../of_ty³s.h
"

36 
	~"../of_debug.h
"

37 
	~"../of_İ’ãc_­i.h
"

38 
	~"of_¡©i¡ics.h
"

41 #ifdeà
OF_DEBUG


44 
	$of_´št_symbŞs_¡©s
(
of_symbŞs_¡©s_t
* 
¡©s
)

46 
	`OF_TRACE_LVL
(0,("nb sourû symbŞ »ûived: %u\n", 
¡©s
->
nb_sourû_symbŞs_»ûived
))

47 
	`OF_TRACE_LVL
(0,("nb„•aœ symbŞ »ûived: %u\n", 
¡©s
->
nb_»·œ_symbŞs_»ûived
));

48 
	`OF_TRACE_LVL
(0,("nb sourû symbŞ buˆduršg IT decodšg: %i\n", 
¡©s
->
nb_sourû_symbŞs_but_w™h_™
));

49 
	`OF_TRACE_LVL
(0,("nb„•aœ symbŞ buˆduršg IT decodšg: %i\n", 
¡©s
->
nb_»·œ_symbŞs_but_w™h_™
));

50 
	`OF_TRACE_LVL
(0,("nb sourû symbŞ buˆduršg ML decodšg: %i\n", 
¡©s
->
nb_sourû_symbŞs_but_w™h_ml
));

51 
	`OF_TRACE_LVL
(0,("nb„•aœ symbŞ buˆduršg ML decodšg: %i\n", 
¡©s
->
nb_»·œ_symbŞs_but_w™h_ml
));

52 
	`OF_TRACE_LVL
(0,("nb sourû symbŞ ignÜed: %i\n", 
¡©s
->
nb_sourû_symbŞs_ignÜed
));

53 
	`OF_TRACE_LVL
(0,("nb„•aœ symbŞ ignÜed: %i\n", 
¡©s
->
nb_»·œ_symbŞs_ignÜed
));

54 
	}
}

	@src/lib_common/statistics/of_statistics.h

34 #iâdeà
STATISTICS_H


35 
	#STATISTICS_H


	)

38 #ifdeà
OF_DEBUG


44 
	sof_symbŞs_¡©s


47 
UINT32
 
	mnb_sourû_symbŞs_»ûived
;

49 
UINT32
 
	mnb_»·œ_symbŞs_»ûived
;

51 
UINT32
 
	mnb_sourû_symbŞs_but_w™h_™
;

53 
UINT32
 
	mnb_sourû_symbŞs_but_w™h_ml
;

55 
UINT32
 
	mnb_»·œ_symbŞs_but_w™h_™
;

57 
UINT32
 
	mnb_»·œ_symbŞs_but_w™h_ml
;

59 
UINT32
 
	mnb_sourû_symbŞs_ignÜed
;

61 
UINT32
 
	mnb_»·œ_symbŞs_ignÜed
;

62 } 
	tof_symbŞs_¡©s_t
;

68 
of_´št_symbŞs_¡©s
(
of_symbŞs_¡©s_t
*);

	@src/lib_stable/2d_parity_matrix/of_2d_parity.h

34 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


36 #iâdeà
OF_2D_PARITY_H


37 
	#OF_2D_PARITY_H


	)

39 
	sof_2d_symbŞ_¡©s_İ


41 
UINT32
 
	mnb_xÜ_fÜ_IT
;

42 
UINT32
 
	mnb_xÜ_fÜ_ML
;

43 } 
	tof_2d_symbŞ_¡©s_İ_t
;

48 
	sof_2d_·r™y_cb


57 
of_codec_id_t
 
	mcodec_id
;

58 
of_codec_ty³_t
 
	mcodec_ty³
;

59 
UINT32
 
	mnb_sourû_symbŞs
;

60 
UINT32
 
	mnb_»·œ_symbŞs
;

61 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

64 
UINT32
 
	mnb_tÙ®_symbŞs
;

67 
of_mod2¥¬£
* 
	mpchk_m©rix
;

70 
of_symbŞ_¡©s_İ_t
 *
	m¡©s_xÜ
;

71 #ifdeà
OF_DEBUG


72 
of_symbŞs_¡©s_t
* 
	m¡©s_symbŞs
;

74 
UINT32
 
	mnb_sourû_symbŞ_»ady
;

75 
UINT32
 
	mnb_»·œ_symbŞ_»ady
;

77 #ifdeà
ML_DECODING


78 
UINT32
 *
	mšdex_rows
;

79 
UINT32
 *
	mšdex_cŞs
;

80 
UINT32
 
	m»maš_cŞs
;

81 
UINT32
 
	m»maš_rows
;

83 
of_mod2¥¬£
 *
	mpchk_m©rix_sim¶if›d
;

84 
of_mod2¥¬£
 *
	mÜigš®_pchkM©rix
;

85 
of_mod2¥¬£
* 
	mpchk_m©rix_gauss
;

87 
UINT32
 
	mdec_¡•
;

88 
UINT32
 
	mth»shŞd_sim¶ifiÿtiÚ
;

92 #ifdeà
OF_USE_DECODER


94 ** 
	mb_cÚ¡_‹rm_of_equ
;

96 
UINT16
* 
	mb_nb_’c_symbŞs_³r_equ
;

99 
UINT16
* 
	mb_nb_unknown_symbŞs
;

101 
UINT16
* 
	mb_nb_equ_fÜ_»·œ
;

103 ** 
	m»·œ_symbŞs_v®ues
;

106 **
	m’codšg_symbŞs_b
;

109 * (*
	mdecoded_sourû_symbŞ_ÿÎback
è(*
	mcÚ‹xt
,

110 
UINT32
 
	msize
,

111 
UINT32
 
	mesi
);

112 * (*
	mdecoded_»·œ_symbŞ_ÿÎback
è(*
	mcÚ‹xt
,

113 
UINT32
 
	msize
,

114 
UINT32
 
	mesi
);

115 * 
	mcÚ‹xt_4_ÿÎback
;

118 * (*
	mdecoded_sourû_symbŞ_ÿÎback_Ãw
è(*
	mcÚ‹xt
,

119 **
	md©a
,

120 **
	mh—d
,

121 
UINT32
 
	msize
,

122 
UINT32
 
	mh—d_size
,

123 
UINT32
 
	mesi
);

124 * (*
	mdecoded_»·œ_symbŞ_ÿÎback_Ãw
è(*
	mcÚ‹xt
,

125 **
	md©a
,

126 **
	mh—d
,

127 
UINT32
 
	msize
,

128 
UINT32
 
	mh—d_size
,

129 
UINT32
 
	mesi
);

132 
UINT32
 
	mmax_nb_sourû_symbŞs
;

134 
UINT32
 
	mmax_nb_’codšg_symbŞs
;

138 
UINT32
 
	mfœ¡_nÚ_decoded
;

140 } 
	tof_2d_·r™y_cb_t
;

158 
of_¡©us_t
 
of_2d_·r™y_ü—‹_codec_š¡ªû
 (
of_2d_·r™y_cb_t
** 
of_cb
);

172 
of_¡©us_t
 
of_2d_·r™y_»Ëa£_codec_š¡ªû
 (
of_2d_·r™y_cb_t
* 
ofcb
);

183 
of_¡©us_t
 
of_2d_·r™y_£t_ãc_·¿m‘”s
 (
of_2d_·r™y_cb_t
* 
ofcb
,

184 
of_2d_·r™y_·¿m‘”s_t
* 
·¿ms
);

210 
of_¡©us_t
 
of_2d_·r™y_£t_ÿÎback_funùiÚs
 (
of_2d_·r™y_cb_t
* 
ofcb
,

211 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

212 
UINT32
 
size
,

213 
UINT32
 
esi
),

214 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

215 
UINT32
 
size
,

216 
UINT32
 
esi
),

217 * 
cÚ‹xt_4_ÿÎback
);

219 
of_¡©us_t
 
of_2d_·r™y_£t_ÿÎback_funùiÚs_Ãw
 (

220 
of_2d_·r™y_cb_t
* 
ofcb
,

221 * (*
decoded_sourû_symbŞ_ÿÎback
) (

222 *
cÚ‹xt
,

223 **
d©a
,

224 **
h—d
,

225 
UINT32
 
size
,

226 
UINT32
 
h—d_size
,

227 
UINT32
 
esi
),

228 * (*
decoded_»·œ_symbŞ_ÿÎback
) (

229 *
cÚ‹xt
,

230 **
d©a
,

231 **
h—d
,

232 
UINT32
 
size
,

233 
UINT32
 
h—d_size
,

234 
UINT32
 
esi
),

235 * 
cÚ‹xt_4_ÿÎback
);

236 #ifdeà
OF_USE_ENCODER


250 
of_¡©us_t
 
of_2d_·r™y_bud_»·œ_symbŞ
 (
of_2d_·r™y_cb_t
* 
ofcb
,

251 * 
’codšg_symbŞs_b
[],

252 
UINT32
 
esi_of_symbŞ_to_bud
);

255 #ifdeà
OF_USE_DECODER


266 
of_¡©us_t
 
of_2d_·r™y_decode_w™h_Ãw_symbŞ
 (
of_2d_·r™y_cb_t
* 
ofcb
,

267 * 
Ãw_symbŞ
,

268 
UINT32
 
Ãw_symbŞ_esi
);

280 
of_¡©us_t
 
of_2d_·r™y_£t_avaabË_symbŞs
 (
of_2d_·r™y_cb_t
* 
ofcb
,

281 * cÚ¡ 
’codšg_symbŞs_b
[]);

291 
of_¡©us_t
 
of_2d_·r™y_fšish_decodšg
 (
of_2d_·r™y_cb_t
* 
ofcb
);

294 
of_¡©us_t
 
of_2d_·r™y_»£t_decodšg_¡©u
(
of_2d_·r™y_cb_t
* 
ofcb
);

302 
boŞ
 
of_2d_·r™y_is_decodšg_com¶‘e
 (
of_2d_·r™y_cb_t
* 
ofcb
);

312 
of_¡©us_t
 
of_2d_·r™y_g‘_sourû_symbŞs_b
 (
of_2d_·r™y_cb_t
* 
ofcb
,

313 * 
sourû_symbŞs_b
[]);

325 
of_¡©us_t
 
of_2d_·r™y_£t_cÚŒŞ_·¿m‘”
(
of_2d_·r™y_cb_t
* 
ofcb
,

326 
UINT32
 
ty³
,

327 * 
v®ue
,

328 
UINT32
 
Ëngth
);

342 
of_¡©us_t
 
of_2d_·r™y_g‘_cÚŒŞ_·¿m‘”
(
of_2d_·r™y_cb_t
* 
ofcb
,

343 
UINT32
 
ty³
,

344 * 
v®ue
,

345 
UINT32
 
Ëngth
);

	@src/lib_stable/2d_parity_matrix/of_2d_parity_api.c

34 
	~"of_2d_·r™y_šşudes.h
"

36 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


40 
of_¡©us_t
 
	$of_2d_·r™y_ü—‹_codec_š¡ªû
 (
of_2d_·r™y_cb_t
** 
of_cb
)

42 
of_codec_ty³_t
 
codec_ty³
;

43 
of_2d_·r™y_cb_t
 *
cb
;

45 
OF_ENTER_FUNCTION


46 
cb
 = (
of_2d_·r™y_cb_t
*è
	`of_»®loc
 (*
of_cb
,  (of_2d_parity_cb_t));

49 
codec_ty³
 = 
cb
->codec_type;

50 
	`mem£t
(
cb
, 0, (*cb));

51 *
of_cb
 = 
cb
;

52 
cb
->
codec_id
 = 
OF_CODEC_2D_PARITY_MATRIX_STABLE
;

53 
cb
->
codec_ty³
 = codec_type;

54 
cb
->
max_nb_sourû_symbŞs
 = 
OF_2D_PARITY_MATRIX_MAX_NB_SOURCE_SYMBOLS_DEFAULT
;

55 
cb
->
max_nb_’codšg_symbŞs
 = 
OF_2D_PARITY_MATRIX_MAX_NB_ENCODING_SYMBOLS_DEFAULT
;

56 
OF_EXIT_FUNCTION


57  
OF_STATUS_OK
;

58 
	}
}

61 
of_¡©us_t
 
	$of_2d_·r™y_»Ëa£_codec_š¡ªû
 (
of_2d_·r™y_cb_t
* 
ofcb
)

63 
UINT32
 
i
;

65 
OF_ENTER_FUNCTION


66 ià(
ofcb
->
pchk_m©rix
 !ğ
NULL
)

68 
	`of_mod2¥¬£_ä“
(
ofcb
->
pchk_m©rix
);

69 
	`of_ä“
 (
ofcb
->
pchk_m©rix
);

70 
ofcb
->
pchk_m©rix
 = 
NULL
;

72 ià(
ofcb
->
’codšg_symbŞs_b
 !ğ
NULL
)

76 
i
 = 
ofcb
->
nb_sourû_symbŞs
; i < ofcb->
nb_tÙ®_symbŞs
; i++)

78 ià(
ofcb
->
’codšg_symbŞs_b
[
i
] !ğ
NULL
)

80 
	`of_ä“
 (
ofcb
->
’codšg_symbŞs_b
[
i
]);

81 
ofcb
->
’codšg_symbŞs_b
[
i
] = 
NULL
;

84 
	`of_ä“
 (
ofcb
->
’codšg_symbŞs_b
);

85 
ofcb
->
’codšg_symbŞs_b
 = 
NULL
;

87 #ifdeà
OF_USE_DECODER


88 if(
ofcb
->
codec_ty³
 & 
OF_DECODER
)

90 ià(
ofcb
->
b_nb_’c_symbŞs_³r_equ
 !ğ
NULL
)

92 
	`of_ä“
 (
ofcb
->
b_nb_’c_symbŞs_³r_equ
);

93 
ofcb
->
b_nb_’c_symbŞs_³r_equ
 = 
NULL
;

95 ià(
ofcb
->
b_nb_equ_fÜ_»·œ
 !ğ
NULL
)

97 
	`of_ä“
 (
ofcb
->
b_nb_equ_fÜ_»·œ
);

98 
ofcb
->
b_nb_equ_fÜ_»·œ
 = 
NULL
;

100 ià(
ofcb
->
b_nb_unknown_symbŞs
 !ğ
NULL
)

102 
	`of_ä“
 (
ofcb
->
b_nb_unknown_symbŞs
);

103 
ofcb
->
b_nb_unknown_symbŞs
 = 
NULL
;

105 ià(
ofcb
->
b_cÚ¡_‹rm_of_equ
 !ğ
NULL
)

107 
i
 = 0; i < 
ofcb
->
nb_»·œ_symbŞs
; i++)

109 ià(
ofcb
->
b_cÚ¡_‹rm_of_equ
[
i
] !ğ
NULL
)

111 
	`of_ä“
 (
ofcb
->
b_cÚ¡_‹rm_of_equ
[
i
]);

112 
ofcb
->
b_cÚ¡_‹rm_of_equ
[
i
] = 
NULL
;

115 
	`of_ä“
(
ofcb
->
b_cÚ¡_‹rm_of_equ
);

120 #ifdeà
OF_2D_PARITY_ML_DECODING


121 ià(
ofcb
->
šdex_rows
 !ğ
NULL
)

123 
	`of_ä“
 (
ofcb
->
šdex_rows
);

124 
ofcb
->
šdex_rows
 = 
NULL
;

126 ià(
ofcb
->
šdex_cŞs
 !ğ
NULL
)

128 
	`of_ä“
 (
ofcb
->
šdex_cŞs
);

129 
ofcb
->
šdex_cŞs
 = 
NULL
;

131 ià(
ofcb
->
pchk_m©rix_sim¶if›d
 !ğ
NULL
)

133 
	`of_mod2¥¬£_ä“
 (
ofcb
->
pchk_m©rix_sim¶if›d
);

134 
	`of_ä“
(
ofcb
->
pchk_m©rix_sim¶if›d
);

135 
ofcb
->
pchk_m©rix_sim¶if›d
 = 
NULL
;

137 ià(
ofcb
->
Üigš®_pchkM©rix
 !ğ
NULL
)

139 
	`of_mod2¥¬£_ä“
 (
ofcb
->
Üigš®_pchkM©rix
);

140 
ofcb
->
Üigš®_pchkM©rix
 = 
NULL
;

142 ià(
ofcb
->
pchk_m©rix_gauss
 !ğ
NULL
)

144 
	`of_mod2¥¬£_ä“
 (
ofcb
->
pchk_m©rix_gauss
);

145 
ofcb
->
pchk_m©rix_gauss
 = 
NULL
;

148 #ifdeà
OF_DEBUG


149 ià(
ofcb
->
¡©s_xÜ
 !ğ
NULL
)

151 
	`of_´št_xÜ_symbŞs_¡©i¡ics
(
ofcb
->
¡©s_xÜ
);

152 
	`of_ä“
(
ofcb
->
¡©s_xÜ
);

155 
OF_EXIT_FUNCTION


156  
OF_STATUS_OK
;

157 
	}
}

160 
of_¡©us_t
 
	$of_2d_·r™y_£t_ãc_·¿m‘”s
 (
of_2d_·r™y_cb_t
* 
ofcb
,

161 
of_2d_·r™y_·¿m‘”s_t
* 
·¿ms
)

163 
of_mod2’Œy
 *
e
;

164 
UINT32
 
row
;

165 
UINT32
 
£q
;

167 
OF_ENTER_FUNCTION


169 #ifdeà
OF_DEBUG


170 
ofcb
->
¡©s_xÜ
 = 
	`of_ÿÎoc
(1, (
of_2d_symbŞ_¡©s_İ_t
));

171 
ofcb
->
¡©s_symbŞs
 = 
	`of_ÿÎoc
(1,(
of_symbŞs_¡©s_t
));

173 ià((
ofcb
->
nb_sourû_symbŞs
 = 
·¿ms
->nb_sourû_symbŞsè> ofcb->
max_nb_sourû_symbŞs
) {

174 
	`OF_PRINT_ERROR
(("of_2d_parity_set_fec_parameters: ERROR, invalid‚b_source_symbols…arameter (got %d, maximum is %d)",

175 
ofcb
->
nb_sourû_symbŞs
, ofcb->
max_nb_sourû_symbŞs
));

176 
”rÜ
;

178 
ofcb
->
nb_»·œ_symbŞs
 = 
·¿ms
->nb_repair_symbols;

179 
ofcb
->
nb_tÙ®_symbŞs
 = ofcb->
nb_sourû_symbŞs
 + ofcb->
nb_»·œ_symbŞs
;

180 ià(
ofcb
->
nb_tÙ®_symbŞs
 > ofcb->
max_nb_’codšg_symbŞs
) {

181 
	`OF_PRINT_ERROR
(("of_2d_parity_set_fec_parameters: ERROR, invalid‚umber ofƒncoding symbols (got %d, maximum is %d)",

182 
ofcb
->
nb_tÙ®_symbŞs
, ofcb->
max_nb_’codšg_symbŞs
));

183 
”rÜ
;

185 
ofcb
->
’codšg_symbŞ_Ëngth
 = 
·¿ms
->encoding_symbol_length;

186 
	`OF_TRACE_LVL
 (1, ("%s: k=%u,‚-k=%u,‚=%u, symbŞ_Ëngth=%u, PRNG s“d=%u, N1=%u\n", 
__FUNCTION__
,

187 
ofcb
->
nb_sourû_symbŞs
, ofcb->
nb_»·œ_symbŞs
, ofcb->
nb_tÙ®_symbŞs
,

188 
ofcb
->
’codšg_symbŞ_Ëngth
, 0, 0))

189 
ofcb
->
pchk_m©rix
 = 
	`of_ü—‹_pchk_m©rix
 (ofcb->
nb_»·œ_symbŞs
, ofcb->
nb_tÙ®_symbŞs
, 
Ev’bÙh
,

190 0, 0, 
çl£
, 
Ty³2DMATRIX
, 1);

192 ià(
ofcb
->
pchk_m©rix
 =ğ
NULL
)

194 
	`OF_PRINT_ERROR
(("of_2d_parity_set_fec_parameters : ERROR,…arity check matrix can't be created withhis…arameters.."))

195 
”rÜ
;

197 #ifdeà
OF_DEBUG


198 ià(
of_v”bos™y
 >= 2)

200 
	`of_mod2¥¬£_m©rix_¡©s
(
¡dout
, 
ofcb
->
pchk_m©rix
, ofcb->
nb_sourû_symbŞs
, ofcb->
nb_»·œ_symbŞs
);

204 #ifdeà
OF_2D_PARITY_ML_DECODING


205 
ofcb
->
pchk_m©rix_sim¶if›d
 = 
NULL
;

207 ià((
ofcb
->
’codšg_symbŞs_b
 = (**è
	`of_ÿÎoc
 (ofcb->
nb_tÙ®_symbŞs
,  (*))è=ğ
NULL
) {

208 
no_mem
;

210 #ifdeà
OF_USE_DECODER


211 ià(
ofcb
->
codec_ty³
 & 
OF_DECODER
)

213 
ofcb
->
b_nb_unknown_symbŞs
 = (
UINT16
*)

214 
	`of_ÿÎoc
 (
ofcb
->
nb_»·œ_symbŞs
,  (
UINT16
));

215 
ofcb
->
b_cÚ¡_‹rm_of_equ
 = (**)

216 
	`of_ÿÎoc
 (
ofcb
->
nb_»·œ_symbŞs
,  (*));

217 
ofcb
->
b_nb_equ_fÜ_»·œ
 = (
UINT16
*)

218 
	`of_ÿÎoc
 (
ofcb
->
nb_»·œ_symbŞs
,  (
UINT16
));

219 
ofcb
->
b_nb_’c_symbŞs_³r_equ
 = (
UINT16
*)

220 
	`of_ÿÎoc
 (
ofcb
->
nb_»·œ_symbŞs
,  (
UINT16
));

221 ià(
ofcb
->
b_nb_unknown_symbŞs
 =ğ
NULL
 || ofcb->
b_cÚ¡_‹rm_of_equ
 == NULL ||

222 
ofcb
->
b_nb_equ_fÜ_»·œ
 =ğ
NULL
 || ofcb->
b_nb_’c_symbŞs_³r_equ
 == NULL) {

223 
no_mem
;

226 
row
 = 0;„ow < 
ofcb
->
nb_»·œ_symbŞs
;„ow++)

228 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
ofcb
->
pchk_m©rix
, 
row
);

229 !
	`of_mod2¥¬£_©_’d
 (
e
);

230 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e))

232 
ofcb
->
b_nb_’c_symbŞs_³r_equ
[
row
]++;

233 
ofcb
->
b_nb_unknown_symbŞs
[
row
]++;

236 
£q
 = 
ofcb
->
nb_sourû_symbŞs
; seq < (ofcb->
nb_tÙ®_symbŞs
); seq++)

238 
e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
ofcb
->
pchk_m©rix
, 
	`of_g‘_symbŞ_cŞ
 ((
of_cb_t
*)ofcb, 
£q
));

239 !
	`of_mod2¥¬£_©_’d
 (
e
);

240 
e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e))

242 
ofcb
->
b_nb_equ_fÜ_»·œ
[
£q
 - ofcb->
nb_sourû_symbŞs
]++;

247 
ofcb
->
nb_sourû_symbŞ_»ady
 = 0;

248 
ofcb
->
nb_»·œ_symbŞ_»ady
 = 0;

250 #ifdeà
OF_2D_PARITY_ML_DECODING


251 
ofcb
->
šdex_rows
 = 
NULL
;

252 
ofcb
->
šdex_cŞs
 = 
NULL
;

253 
ofcb
->
»maš_cŞs
 = 0;

254 
ofcb
->
»maš_rows
 = 0;

255 
ofcb
->
pchk_m©rix_sim¶if›d
 = 
NULL
;

256 
ofcb
->
Üigš®_pchkM©rix
 = 
NULL
;

257 
ofcb
->
pchk_m©rix_gauss
 = 
NULL
;

259 
ofcb
->
dec_¡•
 = 0;

260 
ofcb
->
th»shŞd_sim¶ifiÿtiÚ
 = 0;

264 
OF_EXIT_FUNCTION


265  
OF_STATUS_OK
;

266 
no_mem
:

267 
	`OF_PRINT_ERROR
(("out of memory"));

268 
”rÜ
:

269 
OF_EXIT_FUNCTION


270  
OF_STATUS_FATAL_ERROR
;

271 
	}
}

273 
of_¡©us_t
 
	$of_2d_·r™y_£t_ÿÎback_funùiÚs_Ãw
 (

274 
of_2d_·r™y_cb_t
* 
ofcb
,

275 * (*
decoded_sourû_symbŞ_ÿÎback
) (

276 *
cÚ‹xt
,

277 **
d©a
,

278 **
h—d
,

279 
UINT32
 
size
,

280 
UINT32
 
h—d_size
,

281 
UINT32
 
esi
),

282 * (*
decoded_»·œ_symbŞ_ÿÎback
) (

283 *
cÚ‹xt
,

284 **
d©a
,

285 **
h—d
,

286 
UINT32
 
size
,

287 
UINT32
 
h—d_size
,

288 
UINT32
 
esi
),

289 * 
cÚ‹xt_4_ÿÎback
)

291 
OF_ENTER_FUNCTION


292 
ofcb
->
decoded_sourû_symbŞ_ÿÎback_Ãw
 = 
decoded_sourû_symbŞ_ÿÎback
;

293 
ofcb
->
decoded_»·œ_symbŞ_ÿÎback_Ãw
 = 
decoded_»·œ_symbŞ_ÿÎback
;

294 
ofcb
->
cÚ‹xt_4_ÿÎback
 = context_4_callback;

295 
OF_EXIT_FUNCTION


296  
OF_STATUS_OK
;

297 
	}
}

299 
of_¡©us_t
 
	$of_2d_·r™y_£t_ÿÎback_funùiÚs
 (

300 
of_2d_·r™y_cb_t
* 
ofcb
,

301 * (*
decoded_sourû_symbŞ_ÿÎback
) (

302 *
cÚ‹xt
,

303 
UINT32
 
size
,

304 
UINT32
 
esi
),

305 * (*
decoded_»·œ_symbŞ_ÿÎback
) (

306 *
cÚ‹xt
,

307 
UINT32
 
size
,

308 
UINT32
 
esi
),

309 * 
cÚ‹xt_4_ÿÎback
)

311 
OF_ENTER_FUNCTION


312 
ofcb
->
decoded_sourû_symbŞ_ÿÎback
 = decoded_source_symbol_callback;

313 
ofcb
->
decoded_»·œ_symbŞ_ÿÎback
 = decoded_repair_symbol_callback;

314 
ofcb
->
cÚ‹xt_4_ÿÎback
 = context_4_callback;

315 
OF_EXIT_FUNCTION


316  
OF_STATUS_OK
;

317 
	}
}

319 #ifdeà
OF_USE_ENCODER


321 
of_¡©us_t
 
	$of_2d_·r™y_bud_»·œ_symbŞ
 (
of_2d_·r™y_cb_t
* 
ofcb
,

322 * 
’codšg_symbŞs_b
[],

323 
UINT32
 
esi_of_symbŞ_to_bud
)

325 
of_mod2’Œy
 *
e
;

326 
UINT32
 
cŞ_to_bud
;

327 
UINT32
 
esi
;

328 *
to_add_buf
;

329 *
·r™y_symbŞ
;

330 
OF_ENTER_FUNCTION


331 ià(
esi_of_symbŞ_to_bud
< 
ofcb
->
nb_sourû_symbŞs
 ||ƒsi_of_symbŞ_to_bud >ğofcb->
nb_tÙ®_symbŞs
)

333 
	`OF_PRINT_ERROR
(("of_2d_·r™y_bud_»·œ_symbŞ: E¼Ü, badƒs˜oà’codšg symbŞ (%d)", 
esi_of_symbŞ_to_bud
))

334 
”rÜ
;

336 
·r™y_symbŞ
 = 
’codšg_symbŞs_b
[
esi_of_symbŞ_to_bud
];

337 
	`mem£t
 (
·r™y_symbŞ
, 0, 
ofcb
->
’codšg_symbŞ_Ëngth
);

338 
cŞ_to_bud
 = 
	`of_g‘_symbŞ_cŞ
 ((
of_cb_t
*)
ofcb
, 
esi_of_symbŞ_to_bud
);

339 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
ofcb
->
pchk_m©rix
, 
cŞ_to_bud
);

340 !
	`of_mod2¥¬£_©_’d
 (
e
))

343 ià(
e
->
cŞ
 !ğ
cŞ_to_bud
)

346 
esi
 = 
	`of_g‘_symbŞ_esi
 ((
of_cb_t
*)
ofcb
, 
e
->
cŞ
);

347 
to_add_buf
 = (*è
’codšg_symbŞs_b
[
esi
];

348 ià(
to_add_buf
 =ğ
NULL
)

350 
	`OF_PRINT_ERROR
(("symbŞ %d i nÙ‡Îoÿ‹d", 
esi
));

351 
”rÜ
;

353 #ifdeà
OF_DEBUG


354 
	`of_add_to_symbŞ
 (
·r™y_symbŞ
, 
to_add_buf
, 
ofcb
->
’codšg_symbŞ_Ëngth
, &(ofcb->
¡©s_xÜ
->
nb_xÜ_fÜ_IT
));

356 
	`of_add_to_symbŞ
 (
·r™y_symbŞ
, 
to_add_buf
, 
ofcb
->
’codšg_symbŞ_Ëngth
);

359 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e);

361 
	`OF_TRACE_LVL
 (1, ("%s:„•aœ symbŞ (esi=%dèbut\n", 
__FUNCTION__
, 
esi_of_symbŞ_to_bud
))

362 
OF_EXIT_FUNCTION


363  
OF_STATUS_OK
;

365 
”rÜ
:

366 
OF_EXIT_FUNCTION


367  
OF_STATUS_ERROR
;

368 
	}
}

372 #ifdeà
OF_USE_DECODER


374 
of_¡©us_t
 
	$of_2d_·r™y_decode_w™h_Ãw_symbŞ
 (
of_2d_·r™y_cb_t
* 
ofcb
,

375 * 
Ãw_symbŞ
,

376 
UINT32
 
Ãw_symbŞ_esi
)

378 
OF_ENTER_FUNCTION


379  
	`of_lš—r_bš¬y_code_decode_w™h_Ãw_symbŞ
((
of_lš—r_bš¬y_code_cb_t
*)
ofcb
,
Ãw_symbŞ
,
Ãw_symbŞ_esi
);

380 
	}
}

383 
of_¡©us_t
 
	$of_2d_·r™y_£t_avaabË_symbŞs
 (
of_2d_·r™y_cb_t
* 
ofcb
,

384 * cÚ¡ 
’codšg_symbŞs_b
[])

386 
OF_ENTER_FUNCTION


387 
UINT32
 
i
;

388 
i
 = 0; i < 
ofcb
->
nb_tÙ®_symbŞs
; i++)

390 ià(
’codšg_symbŞs_b
[
i
] !ğ
NULL
)

392 
ofcb
->
’codšg_symbŞs_b
[
i
] = 
	`of_ÿÎoc
 (1, ofcb->
’codšg_symbŞ_Ëngth
);

393 
	`memıy
 (
ofcb
->
’codšg_symbŞs_b
[
i
],ƒncodšg_symbŞs_b[i], ofcb->
’codšg_symbŞ_Ëngth
);

396 
OF_EXIT_FUNCTION


397  
OF_STATUS_OK
;

398 
	}
}

401 
of_¡©us_t
 
	$of_2d_·r™y_fšish_decodšg
 (
of_2d_·r™y_cb_t
* 
ofcb
)

403 
OF_ENTER_FUNCTION


404 #ifdeà
OF_2D_PARITY_ML_DECODING


405  
	`of_lš—r_bš¬y_code_fšish_decodšg_w™h_ml
 ((
of_lš—r_bš¬y_code_cb_t
*)
ofcb
);

407  
OF_STATUS_ERROR
;

409 
	}
}

411 
of_¡©us_t
 
	$of_2d_·r™y_»£t_decodšg_¡©u
(
of_2d_·r™y_cb_t
* 
ofcb
){

412 
OF_ENTER_FUNCTION


413 
OF_EXIT_FUNCTION


414  
OF_STATUS_OK
;

415 
	}
}

417 
boŞ
 
	$of_2d_·r™y_is_decodšg_com¶‘e
 (
of_2d_·r™y_cb_t
* 
ofcb
)

419 ; 
ofcb
->
fœ¡_nÚ_decoded
 < ofcb->
nb_sourû_symbŞs
; ofcb->first_non_decoded++)

421 ià(
ofcb
->
’codšg_symbŞs_b
[ofcb->
fœ¡_nÚ_decoded
] =ğ
NULL
)

423 
	`OF_TRACE_LVL
 (1, ("decoding‚ot complete (%u source symbols„eady, %uƒxpected)\n",

424 
ofcb
->
nb_sourû_symbŞ_»ady
, ofcb->
nb_sourû_symbŞs
))

426  
çl£
;

429 
	`OF_TRACE_LVL
 (1, ("decoding is complete\n"))

431  
Œue
;

432 
	}
}

435 
of_¡©us_t
 
	$of_2d_·r™y_g‘_sourû_symbŞs_b
(
of_2d_·r™y_cb_t
* 
ofcb
,

436 * 
sourû_symbŞs_b
[])

438 
OF_ENTER_FUNCTION


439 
	`memıy
 (
sourû_symbŞs_b
, 
ofcb
->
’codšg_symbŞs_b
,  (*è* ofcb->
nb_sourû_symbŞs
);

440 
OF_EXIT_FUNCTION


441  
OF_STATUS_OK
;

442 
	}
}

446 
of_¡©us_t
 
	$of_2d_·r™y_£t_cÚŒŞ_·¿m‘”
 (
of_2d_·r™y_cb_t
* 
ofcb
,

447 
UINT32
 
ty³
,

448 * 
v®ue
,

449 
UINT32
 
Ëngth
)

451 
	`OF_PRINT_ERROR
(("of_2d_parity_set_control_parameter: ERROR,‚ot implemented...\n"))

452  
OF_STATUS_ERROR
;

453 
	}
}

456 
of_¡©us_t
 
	$of_2d_·r™y_g‘_cÚŒŞ_·¿m‘”
 (
of_2d_·r™y_cb_t
* 
ofcb
,

457 
UINT32
 
ty³
,

458 * 
v®ue
,

459 
UINT32
 
Ëngth
)

461 
OF_ENTER_FUNCTION


462 
ty³
) {

463 
OF_CTRL_GET_MAX_K
:

464 ià(
v®ue
 =ğ
NULL
 || 
Ëngth
 !ğ(
UINT32
)) {

465 
	`OF_PRINT_ERROR
(("%s: OF_CTRL_GET_MAX_K ERROR:‚ull value or bad†ength (got %d,ƒxpected %ld)\n",

466 
__FUNCTION__
, 
Ëngth
, (
UINT32
)))

467 
”rÜ
;

469 *(
UINT32
*)
v®ue
 = 
ofcb
->
max_nb_sourû_symbŞs
;

470 
	`OF_TRACE_LVL
(1, ("%s: OF_CTRL_GET_MAX_K (%d)\n", 
__FUNCTION__
, *(
UINT32
*)
v®ue
))

473 
OF_CTRL_GET_MAX_N
:

474 ià(
v®ue
 =ğ
NULL
 || 
Ëngth
 !ğ(
UINT32
)) {

475 
	`OF_PRINT_ERROR
(("%s: OF_CTRL_GET_MAX_N ERROR:‚ull value or bad†ength (got %d,ƒxpected %ld)\n",

476 
__FUNCTION__
, 
Ëngth
, (
UINT32
)))

477 
”rÜ
;

479 *(
UINT32
*)
v®ue
 = 
ofcb
->
max_nb_’codšg_symbŞs
;

480 
	`OF_TRACE_LVL
(1, ("%s: OF_CTRL_GET_MAX_N (%d)\n", 
__FUNCTION__
, *(
UINT32
*)
v®ue
))

484 
	`OF_PRINT_ERROR
(("%s: unknowÀty³ (%d)\n", 
__FUNCTION__
, 
ty³
))

485 
”rÜ
;

487 
OF_EXIT_FUNCTION


488  
OF_STATUS_OK
;

490 
”rÜ
:

491 
OF_EXIT_FUNCTION


492  
OF_STATUS_ERROR
;

493 
	}
}

	@src/lib_stable/2d_parity_matrix/of_2d_parity_api.h

33 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


35 #iâdeà
OF_CODEC_STABLE_2D_PARITY_API


36 
	#OF_CODEC_STABLE_2D_PARITY_API


	)

39 
	~"../../lib_commÚ/of_ty³s.h
"

49 
	sof_2d_·r™y_·¿m‘”s


51 
UINT32
 
	mnb_sourû_symbŞs
;

52 
UINT32
 
	mnb_»·œ_symbŞs
;

53 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

54 
UINT32
 
	m’codšg_h—d_Ëngth
;

58 } 
	tof_2d_·r™y_·¿m‘”s_t
;

	@src/lib_stable/2d_parity_matrix/of_2d_parity_includes.h

33 #iâdeà
OF_2D_PARITY_INCLUDES


34 
	#OF_2D_PARITY_INCLUDES


	)

36 
	~<¡dio.h
>

37 
	~<¡dlib.h
>

38 
	~<¡dšt.h
>

39 
	~<¡ršg.h
>

41 
	~"../../lib_commÚ/of_İ’ãc_­i.h
"

47 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


49 
	~"../../lib_commÚ/lš—r_bš¬y_codes_uts/of_lš—r_bš¬y_code.h
"

51 
	~"of_2d_·r™y_­i.h
"

52 
	~"of_2d_·r™y.h
"

	@src/lib_stable/2d_parity_matrix/of_codec_profile.h

36 
	#OF_USE_2D_PARITY_MATRIX_CODEC


	)

38 #ifdeà
OF_DEBUG


40 
	#MEM_STATS_ARG
 ,
ofcb
->
¡©s


	)

41 
	#MEM_STATS
 ,
¡©s


	)

43 
	#MEM_STATS_ARG


	)

44 
	#MEM_STATS


	)

59 
	#ML_DECODING


	)

61 #ifdeà
ML_DECODING


62 
	#OF_2D_PARITY_ML_DECODING


	)

73 #ià
defšed
 (
__LP64__
è|| (
__WORDSIZE
 == 64)

104 #iâdeà
OF_2D_PARITY_MATRIX_MAX_NB_SOURCE_SYMBOLS_DEFAULT


105 #ifdeà
ML_DECODING


106 
	#OF_2D_PARITY_MATRIX_MAX_NB_SOURCE_SYMBOLS_DEFAULT
 16

	)

107 
	#OF_2D_PARITY_MATRIX_MAX_NB_ENCODING_SYMBOLS_DEFAULT
 24

	)

109 
	#OF_2D_PARITY_MATRIX_MAX_NB_SOURCE_SYMBOLS_DEFAULT
 16

	)

110 
	#OF_2D_PARITY_MATRIX_MAX_NB_ENCODING_SYMBOLS_DEFAULT
 24

	)

	@src/lib_stable/ldpc_staircase/of_codec_profile.h

37 
	#OF_USE_LDPC_STAIRCASE_CODEC


	)

39 #ifdeà
OF_DEBUG


41 
	#MEM_STATS_ARG
 ,
ofcb
->
¡©s


	)

42 
	#MEM_STATS
 ,
¡©s


	)

44 
	#MEM_STATS_ARG


	)

45 
	#MEM_STATS


	)

60 
	#ML_DECODING


	)

62 #ifdeà
ML_DECODING


63 
	#OF_LDPC_STAIRCASE_ML_DECODING


	)

91 #iâdeà
OF_LDPC_STAIRCASE_MAX_NB_SOURCE_SYMBOLS_DEFAULT


92 #ifdeà
ML_DECODING


93 
	#OF_LDPC_STAIRCASE_MAX_NB_SOURCE_SYMBOLS_DEFAULT
 50000

	)

94 
	#OF_LDPC_STAIRCASE_MAX_NB_ENCODING_SYMBOLS_DEFAULT
 50000

	)

96 
	#OF_LDPC_STAIRCASE_MAX_NB_SOURCE_SYMBOLS_DEFAULT
 100000

	)

97 
	#OF_LDPC_STAIRCASE_MAX_NB_ENCODING_SYMBOLS_DEFAULT
 100000

	)

	@src/lib_stable/ldpc_staircase/of_ldpc_includes.h

34 #iâdeà
OF_LDPC_INCLUDES


35 
	#OF_LDPC_INCLUDES


	)

37 
	~<¡dio.h
>

38 
	~<¡dlib.h
>

39 
	~<¡dšt.h
>

40 
	~<¡ršg.h
>

42 
	~"../../lib_commÚ/of_İ’ãc_­i.h
"

48 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


50 
	~"../../lib_commÚ/lš—r_bš¬y_codes_uts/of_lš—r_bš¬y_code.h
"

52 
	~"of_ldpc_¡aœÿ£_­i.h
"

53 
	~"of_ldpc_¡aœÿ£.h
"

	@src/lib_stable/ldpc_staircase/of_ldpc_staircase.h

34 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


36 #iâdeà
OF_LDPC_STAIRCASE_H


37 
	#OF_LDPC_STAIRCASE_H


	)

42 
	sof_ldpc_¡aœÿ£_cb


46 
of_codec_id_t
 
	mcodec_id
;

47 
of_codec_ty³_t
 
	mcodec_ty³
;

48 
UINT32
 
	mnb_sourû_symbŞs
;

49 
UINT32
 
	mnb_»·œ_symbŞs
;

50 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

53 
UINT32
 
	mnb_tÙ®_symbŞs
;

56 
of_mod2¥¬£
 *
	mpchk_m©rix
;

59 
of_symbŞ_¡©s_İ_t
 *
	m¡©s_xÜ
;

60 #ifdeà
OF_DEBUG


61 
of_symbŞs_¡©s_t
 *
	m¡©s_symbŞs
;

63 
UINT32
 
	mnb_sourû_symbŞ_»ady
;

64 
UINT32
 
	mnb_»·œ_symbŞ_»ady
;

66 #ifdeà
ML_DECODING


67 
UINT32
 *
	mšdex_rows
;

68 
UINT32
 *
	mšdex_cŞs
;

69 
UINT32
 
	m»maš_cŞs
;

70 
UINT32
 
	m»maš_rows
;

72 
of_mod2¥¬£
 *
	mpchk_m©rix_sim¶if›d
;

73 
of_mod2¥¬£
 *
	mÜigš®_pchkM©rix
;

74 
of_mod2¥¬£
 *
	mpchk_m©rix_gauss
;

75 
UINT32
 
	mdec_¡•
;

76 
UINT32
 
	mth»shŞd_sim¶ifiÿtiÚ
;

80 #ifdeà
OF_USE_DECODER


82 ** 
	mb_cÚ¡_‹rm_of_equ
;

84 
UINT16
* 
	mb_nb_’c_symbŞs_³r_equ
;

87 
UINT16
* 
	mb_nb_unknown_symbŞs
;

89 
UINT16
* 
	mb_nb_equ_fÜ_»·œ
;

91 ** 
	m»·œ_symbŞs_v®ues
;

92 ** 
	mtmp_b_symbŞs
;

93 
UINT16
 
	mnb_tmp_symbŞs
;

96 **
	m’codšg_symbŞs_b
;

99 * (*
	mdecoded_sourû_symbŞ_ÿÎback_Ãw
è(*
	mcÚ‹xt
,

100 **
	md©a
,

101 **
	mh—d
,

102 
UINT32
 
	msize
,

103 
UINT32
 
	mh—d_size
,

104 
UINT32
 
	mesi
);

105 * (*
	mdecoded_»·œ_symbŞ_ÿÎback_Ãw
è(*
	mcÚ‹xt
,

106 **
	md©a
,

107 **
	mh—d
,

108 
UINT32
 
	msize
,

109 
UINT32
 
	mh—d_size
,

110 
UINT32
 
	mesi
);

112 * (*
	mdecoded_sourû_symbŞ_ÿÎback
è(*
	mcÚ‹xt
,

113 
UINT32
 
	msize
,

114 
UINT32
 
	mesi
);

115 * (*
	mdecoded_»·œ_symbŞ_ÿÎback
è(*
	mcÚ‹xt
,

116 
UINT32
 
	msize
,

117 
UINT32
 
	mesi
);

118 * 
	mcÚ‹xt_4_ÿÎback
;

123 
UINT32
 
	mmax_nb_sourû_symbŞs
;

125 
UINT32
 
	mmax_nb_’codšg_symbŞs
;

127 
UINT32
 
	m´ng_£ed
;

129 
UINT8
 
	mN1
;

131 
boŞ
 
	mexŒa_’Œ›s_added_š_pchk
;

133 
UINT32
 
	mfœ¡_nÚ_decoded
;

134 } 
	tof_ldpc_¡aœÿ£_cb_t
;

152 
of_¡©us_t
 
of_ldpc_¡aœÿ£_ü—‹_codec_š¡ªû
 (
of_ldpc_¡aœÿ£_cb_t
** 
of_cb
);

165 
of_¡©us_t
 
of_ldpc_¡aœÿ£_»Ëa£_codec_š¡ªû
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
);

176 
of_¡©us_t
 
of_ldpc_¡aœÿ£_£t_ãc_·¿m‘”s
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

177 
of_ldpc_·¿m‘”s_t
* 
·¿ms
);

204 
of_¡©us_t
 
of_ldpc_¡aœÿ£_£t_ÿÎback_funùiÚs
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

205 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

206 
UINT32
 
size
,

207 
UINT32
 
esi
),

208 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

209 
UINT32
 
size
,

210 
UINT32
 
esi
),

211 * 
cÚ‹xt_4_ÿÎback
);

213 
of_¡©us_t
 
of_ldpc_¡aœÿ£_£t_ÿÎback_funùiÚs_Ãw
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

214 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

215 **
d©a
,

216 **
h—d
,

217 
UINT32
 
size
,

218 
UINT32
 
h—d_size
,

219 
UINT32
 
esi
),

220 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

221 **
d©a
,

222 **
h—d
,

223 
UINT32
 
size
,

224 
UINT32
 
h—d_size
,

225 
UINT32
 
esi
),

226 * 
cÚ‹xt_4_ÿÎback
);

227 #ifdeà
OF_USE_ENCODER


241 
of_¡©us_t
 
of_ldpc_¡aœÿ£_bud_»·œ_symbŞ
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

242 * 
’codšg_symbŞs_b
[],

243 
UINT32
 
esi_of_symbŞ_to_bud
);

246 #ifdeà
OF_USE_DECODER


257 
of_¡©us_t
 
of_ldpc_¡aœÿ£_decode_w™h_Ãw_symbŞ
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

258 * 
Ãw_symbŞ
,

259 
UINT32
 
Ãw_symbŞ_esi
);

271 
of_¡©us_t
 
of_ldpc_¡aœÿ£_£t_avaabË_symbŞs
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

272 * cÚ¡ 
’codšg_symbŞs_b
[]);

282 
of_¡©us_t
 
of_ldpc_¡aœÿ£_fšish_decodšg
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
);

285 
of_¡©us_t
 
of_ldpc_¡aœÿ£_»£t_decodšg_¡©u
(
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
);

293 
boŞ
 
of_ldpc_¡aœÿ£_is_decodšg_com¶‘e
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
);

303 
of_¡©us_t
 
of_ldpc_¡aœÿ£_g‘_sourû_symbŞs_b
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

304 * 
sourû_symbŞs_b
[]);

316 
of_¡©us_t
 
of_ldpc_¡aœÿ£_£t_cÚŒŞ_·¿m‘”
(
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

317 
UINT32
 
ty³
,

318 * 
v®ue
,

319 
UINT32
 
Ëngth
);

333 
of_¡©us_t
 
of_ldpc_¡aœÿ£_g‘_cÚŒŞ_·¿m‘”
(
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

334 
UINT32
 
ty³
,

335 * 
v®ue
,

336 
UINT32
 
Ëngth
);

347 
of_mod2¥¬£
* 
of_ü—‹_pchck_m©rix_rfc5170_com¶ŸÁ
 (
UINT32
 
nb_rows
,

348 
UINT32
 
nb_cŞs
,

349 
UINT32
 
Ëá_deg»e
,

350 
UINT32
 
£ed
,

351 
of_ldpc_¡aœÿ£_cb_t
 *
ofcb
);

	@src/lib_stable/ldpc_staircase/of_ldpc_staircase_api.c

34 
	~"of_ldpc_šşudes.h
"

35 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


38 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_ü—‹_codec_š¡ªû
 (
of_ldpc_¡aœÿ£_cb_t
** 
of_cb
)

40 
of_codec_ty³_t
 
codec_ty³
;

41 
of_ldpc_¡aœÿ£_cb_t
 *
cb
;

43 
OF_ENTER_FUNCTION


44 
cb
 = (
of_ldpc_¡aœÿ£_cb_t
*è
	`of_»®loc
 (*
of_cb
,  (of_ldpc_staircase_cb_t));

47 
codec_ty³
 = 
cb
->codec_type;

48 
	`mem£t
(
cb
, 0, (*cb));

49 *
of_cb
 = 
cb
;

50 
cb
->
codec_id
 = 
OF_CODEC_LDPC_STAIRCASE_STABLE
;

51 
cb
->
codec_ty³
 = codec_type;

52 
cb
->
max_nb_sourû_symbŞs
 = 
OF_LDPC_STAIRCASE_MAX_NB_SOURCE_SYMBOLS_DEFAULT
;

53 
cb
->
max_nb_’codšg_symbŞs
 = 
OF_LDPC_STAIRCASE_MAX_NB_ENCODING_SYMBOLS_DEFAULT
;

54 
OF_EXIT_FUNCTION


55  
OF_STATUS_OK
;

56 
	}
}

59 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_»Ëa£_codec_š¡ªû
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
)

61 
OF_ENTER_FUNCTION


62 
UINT32
 
i
;

63 ià(
ofcb
->
pchk_m©rix
 !ğ
NULL
)

65 
	`of_mod2¥¬£_ä“
(
ofcb
->
pchk_m©rix
);

66 
	`of_ä“
 (
ofcb
->
pchk_m©rix
);

67 
ofcb
->
pchk_m©rix
 = 
NULL
;

69 ià(
ofcb
->
’codšg_symbŞs_b
 !ğ
NULL
)

73 
i
 = 
ofcb
->
nb_sourû_symbŞs
; i < ofcb->
nb_tÙ®_symbŞs
; i++)

75 ià(
ofcb
->
’codšg_symbŞs_b
[
i
] !ğ
NULL
)

77 
	`of_ä“
 (
ofcb
->
’codšg_symbŞs_b
[
i
]);

78 
ofcb
->
’codšg_symbŞs_b
[
i
] = 
NULL
;

81 
	`of_ä“
 (
ofcb
->
’codšg_symbŞs_b
);

82 
ofcb
->
’codšg_symbŞs_b
 = 
NULL
;

84 #ifdeà
OF_USE_DECODER


85 ià(
ofcb
->
codec_ty³
 & 
OF_DECODER
)

87 ià(
ofcb
->
tmp_b_symbŞs
 !ğ
NULL
)

89 
	`of_ä“
(
ofcb
->
tmp_b_symbŞs
);

90 
ofcb
->
tmp_b_symbŞs
 = 
NULL
;

92 ià(
ofcb
->
b_nb_’c_symbŞs_³r_equ
 !ğ
NULL
)

94 
	`of_ä“
 (
ofcb
->
b_nb_’c_symbŞs_³r_equ
);

95 
ofcb
->
b_nb_’c_symbŞs_³r_equ
 = 
NULL
;

97 ià(
ofcb
->
b_nb_equ_fÜ_»·œ
 !ğ
NULL
)

99 
	`of_ä“
 (
ofcb
->
b_nb_equ_fÜ_»·œ
);

100 
ofcb
->
b_nb_equ_fÜ_»·œ
 = 
NULL
;

102 ià(
ofcb
->
b_nb_unknown_symbŞs
 !ğ
NULL
)

104 
	`of_ä“
 (
ofcb
->
b_nb_unknown_symbŞs
);

105 
ofcb
->
b_nb_unknown_symbŞs
 = 
NULL
;

107 ià(
ofcb
->
b_cÚ¡_‹rm_of_equ
 !ğ
NULL
)

109 
i
 = 0; i < 
ofcb
->
nb_»·œ_symbŞs
; i++)

111 ià(
ofcb
->
b_cÚ¡_‹rm_of_equ
[
i
] !ğ
NULL
)

113 
	`of_ä“
 (
ofcb
->
b_cÚ¡_‹rm_of_equ
[
i
]);

114 
ofcb
->
b_cÚ¡_‹rm_of_equ
[
i
] = 
NULL
;

117 
	`of_ä“
(
ofcb
->
b_cÚ¡_‹rm_of_equ
);

119 
	`of_ä“
(
ofcb
->
tmp_b_symbŞs
);

120 
ofcb
->
tmp_b_symbŞs
=
NULL
;

124 #ifdeà
OF_LDPC_STAIRCASE_ML_DECODING


125 ià(
ofcb
->
šdex_rows
 !ğ
NULL
)

127 
	`of_ä“
 (
ofcb
->
šdex_rows
);

128 
ofcb
->
šdex_rows
 = 
NULL
;

130 ià(
ofcb
->
šdex_cŞs
 !ğ
NULL
)

132 
	`of_ä“
 (
ofcb
->
šdex_cŞs
);

133 
ofcb
->
šdex_cŞs
 = 
NULL
;

135 ià(
ofcb
->
pchk_m©rix_sim¶if›d
 !ğ
NULL
)

137 
	`of_mod2¥¬£_ä“
 (
ofcb
->
pchk_m©rix_sim¶if›d
);

138 
	`of_ä“
(
ofcb
->
pchk_m©rix_sim¶if›d
);

139 
ofcb
->
pchk_m©rix_sim¶if›d
 = 
NULL
;

141 ià(
ofcb
->
Üigš®_pchkM©rix
 !ğ
NULL
)

143 
	`of_mod2¥¬£_ä“
 (
ofcb
->
Üigš®_pchkM©rix
);

144 
ofcb
->
Üigš®_pchkM©rix
 = 
NULL
;

146 ià(
ofcb
->
pchk_m©rix_gauss
 !ğ
NULL
)

148 
	`of_mod2¥¬£_ä“
 (
ofcb
->
pchk_m©rix_gauss
);

149 
ofcb
->
pchk_m©rix_gauss
 = 
NULL
;

152 #ifdeà
OF_DEBUG


153 ià(
ofcb
->
¡©s_xÜ
 !ğ
NULL
) {

154 
	`of_´št_xÜ_symbŞs_¡©i¡ics
(
ofcb
->
¡©s_xÜ
);

155 
	`of_ä“
(
ofcb
->
¡©s_xÜ
);

157 ià(
ofcb
->
¡©s_symbŞs
 !ğ
NULL
) {

158 
	`of_ä“
(
ofcb
->
¡©s_symbŞs
);

161 
OF_EXIT_FUNCTION


162  
OF_STATUS_OK
;

163 
	}
}

166 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_£t_ãc_·¿m‘”s
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

167 
of_ldpc_·¿m‘”s_t
* 
·¿ms
)

169 
of_mod2’Œy
 *
e
;

170 
UINT32
 
row
;

171 
UINT32
 
£q
;

173 
OF_ENTER_FUNCTION


175 #ifdeà
OF_DEBUG


176 
ofcb
->
¡©s_xÜ
 = 
	`of_ÿÎoc
(1, (
of_symbŞ_¡©s_İ_t
));

177 
ofcb
->
¡©s_symbŞs
 = 
	`of_ÿÎoc
(1, (
of_symbŞs_¡©s_t
));

179 ià(
·¿ms
->
N1
 < 3)

181 
	`OF_PRINT_ERROR
(("of_ldpc_staircase_set_fec_parameters: invalid N1 value (%d), must be‡t†eastƒqualo 3.\n",

182 
·¿ms
->
N1
))

183 
”rÜ
;

185 ià((
ofcb
->
nb_sourû_symbŞs
 = 
·¿ms
->nb_sourû_symbŞsè> ofcb->
max_nb_sourû_symbŞs
)

187 
	`OF_PRINT_ERROR
(("of_ldpc_staircase_set_fec_parameters: ERROR, invalid‚b_source_symbols…arameter (got %d, maximum is %d)\n",

188 
ofcb
->
nb_sourû_symbŞs
, ofcb->
max_nb_sourû_symbŞs
));

189 
”rÜ
;

191 ià((
ofcb
->
nb_»·œ_symbŞs
 = 
·¿ms
->nb_»·œ_symbŞsè> ofcb->
max_nb_’codšg_symbŞs
)

197 
	`OF_PRINT_ERROR
(("of_ldpc_staircase_set_fec_parameters: ERROR, invalid‚umber of„epair symbols (got %d, maximum‚umber ofƒncoding symbols is %d)\n",

198 
ofcb
->
nb_»·œ_symbŞs
, ofcb->
max_nb_’codšg_symbŞs
));

199 
”rÜ
;

201 
ofcb
->
nb_tÙ®_symbŞs
 = ofcb->
nb_sourû_symbŞs
 + ofcb->
nb_»·œ_symbŞs
;

202 ià(
ofcb
->
nb_tÙ®_symbŞs
 > ofcb->
max_nb_’codšg_symbŞs
)

204 
	`OF_PRINT_ERROR
(("of_ldpc_staircase_set_fec_parameters: ERROR, invalid‚umber ofƒncoding symbols (got %d, maximum is %d)\n",

205 
ofcb
->
nb_tÙ®_symbŞs
, ofcb->
max_nb_’codšg_symbŞs
));

206 
”rÜ
;

208 
ofcb
->
’codšg_symbŞ_Ëngth
 = 
·¿ms
->encoding_symbol_length;

209 
ofcb
->
´ng_£ed
 = 
·¿ms
->prng_seed;

210 
ofcb
->
N1
 = 
·¿ms
->N1;

211 
	`OF_TRACE_LVL
 (1, ("%s: k=%u,‚-k=%u,‚=%u, symbŞ_Ëngth=%u, PRNG s“d=%u, N1=%u\n", 
__FUNCTION__
,

212 
ofcb
->
nb_sourû_symbŞs
, ofcb->
nb_»·œ_symbŞs
, ofcb->
nb_tÙ®_symbŞs
,

213 
ofcb
->
’codšg_symbŞ_Ëngth
, ofcb->
´ng_£ed
, ofcb->
N1
))

215 
ofcb
->
pchk_m©rix
 = 
of_ü—‹_pchck_m©rix_rfc5170_com¶ŸÁ


216 (
ofcb
->
nb_»·œ_symbŞs
,

217 
ofcb
->
nb_tÙ®_symbŞs
,

218 
ofcb
->
N1
,

219 
ofcb
->
´ng_£ed
,

220 
ofcb
);

221 ià(
ofcb
->
pchk_m©rix
 =ğ
NULL
)

223 
	`OF_PRINT_ERROR
(("of_ldpc_staircase_set_fec_parameters : ERROR,…arity check matrix can't be created withhis…arameters..\n"))

224 
”rÜ
;

226 #ifdeà
IL_SUPPORT


228 
	`of_mod2¥¬£_´št_b™m­
(
ofcb
->
pchk_m©rix
);

233 #ià
	`defšed
(
OF_DEBUG
è&& defšed(
PRINT_LDGM_VARIANT
è&& defšed(
IL_SUPPORT
)

239 
of_mod2d’£
 *
dm
 = 
NULL
;

241 
dm
 = 
	`of_mod2d’£_®loÿ‹
(
ofcb
->
nb_»·œ_symbŞs
, ofcb->
nb_tÙ®_symbŞs
, 
NULL
);

242 
	`of_mod2¥¬£_to_d’£
(
ofcb
->
pchk_m©rix
, 
dm
);

243 
row
 = 0;„ow < 
ofcb
->
nb_»·œ_symbŞs
 - 1;„ow++)

245 
	`of_mod2d’£_xÜ_rows
(
dm
, 
row
,„ow + 1);

247 
	`of_mod2d’£_´št_b™m­
(
dm
);

248 
	`of_mod2d’£_d’s™y
(
dm
);

249 
	`of_mod2d’£_ä“
(
dm
, 
NULL
);

253 ià((
ofcb
->
’codšg_symbŞs_b
 = (**è
	`of_ÿÎoc
 (ofcb->
nb_tÙ®_symbŞs
,  (*))è=ğ
NULL
) {

254 
no_mem
;

256 #ifdeà
OF_USE_DECODER


257 ià(
ofcb
->
codec_ty³
 & 
OF_DECODER
)

259 
ofcb
->
b_nb_unknown_symbŞs
 = (
UINT16
*)

260 
	`of_ÿÎoc
 (
ofcb
->
nb_»·œ_symbŞs
,  (
UINT16
));

261 
ofcb
->
b_cÚ¡_‹rm_of_equ
 = (**)

262 
	`of_ÿÎoc
 (
ofcb
->
nb_»·œ_symbŞs
,  (*));

263 
ofcb
->
b_nb_equ_fÜ_»·œ
 = (
UINT16
*)

264 
	`of_ÿÎoc
 (
ofcb
->
nb_»·œ_symbŞs
,  (
UINT16
));

265 
ofcb
->
b_nb_’c_symbŞs_³r_equ
 = (
UINT16
*)

266 
	`of_ÿÎoc
 (
ofcb
->
nb_»·œ_symbŞs
,  (
UINT16
));

267 ià(
ofcb
->
b_nb_unknown_symbŞs
 =ğ
NULL
 || ofcb->
b_cÚ¡_‹rm_of_equ
 == NULL ||

268 
ofcb
->
b_nb_equ_fÜ_»·œ
 =ğ
NULL
 || ofcb->
b_nb_’c_symbŞs_³r_equ
 == NULL) {

269 
no_mem
;

272 
row
 = 0;„ow < 
ofcb
->
nb_»·œ_symbŞs
;„ow++)

274 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
ofcb
->
pchk_m©rix
, 
row
);

275 !
	`of_mod2¥¬£_©_’d
 (
e
);

276 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e))

278 
ofcb
->
b_nb_’c_symbŞs_³r_equ
[
row
]++;

279 
ofcb
->
b_nb_unknown_symbŞs
[
row
]++;

282 
£q
 = 
ofcb
->
nb_sourû_symbŞs
; seq < (ofcb->
nb_tÙ®_symbŞs
); seq++)

284 
e
 = 
	`of_mod2¥¬£_fœ¡_š_cŞ
 (
ofcb
->
pchk_m©rix
, 
	`of_g‘_symbŞ_cŞ
 ((
of_cb_t
*)ofcb, 
£q
));

285 !
	`of_mod2¥¬£_©_’d
 (
e
);

286 
e
 = 
	`of_mod2¥¬£_Ãxt_š_cŞ
 (e))

288 
ofcb
->
b_nb_equ_fÜ_»·œ
[
£q
 - ofcb->
nb_sourû_symbŞs
]++;

291 
ofcb
->
tmp_b_symbŞs
 = (**)
	`of_m®loc
((*)*ofcb->
nb_tÙ®_symbŞs
);

294 
ofcb
->
nb_sourû_symbŞ_»ady
 = 0;

295 
ofcb
->
nb_»·œ_symbŞ_»ady
 = 0;

297 #ifdeà
OF_LDPC_STAIRCASE_ML_DECODING


298 
ofcb
->
šdex_rows
 = 
NULL
;

299 
ofcb
->
šdex_cŞs
 = 
NULL
;

300 
ofcb
->
»maš_cŞs
 = 0;

301 
ofcb
->
»maš_rows
 = 0;

302 
ofcb
->
pchk_m©rix_sim¶if›d
 = 
NULL
;

303 
ofcb
->
Üigš®_pchkM©rix
 = 
NULL
;

304 
ofcb
->
pchk_m©rix_gauss
 = 
NULL
;

306 
ofcb
->
dec_¡•
 = 0;

307 
ofcb
->
th»shŞd_sim¶ifiÿtiÚ
 = 0;

310 #ifdeà
OF_USE_DECODER


315 ià(
ofcb
->
codec_ty³
 & 
OF_DECODER
)

317 
boŞ
 
is_nuÎ
;

319 ià(
	`of_ldpc_¡aœÿ£_g‘_cÚŒŞ_·¿m‘”
(
ofcb
, 
OF_CRTL_LDPC_STAIRCASE_IS_LAST_SYMBOL_NULL
,

320 (*)&
is_nuÎ
, (is_nuÎ)è!ğ
OF_STATUS_OK
) {

321 
	`OF_PRINT_ERROR
(("%s: ERROR: of_ldpc_¡aœÿ£_g‘_cÚŒŞ_·¿m‘”(èçed\n", 
__FUNCTION__
))

322 
”rÜ
;

324 ià(
is_nuÎ
)

329 *
nuÎ_symbŞ
;

331 ià((
nuÎ_symbŞ
 = 
	`of_ÿÎoc
(1, 
ofcb
->
’codšg_symbŞ_Ëngth
)è=ğ
NULL
)

333 
no_mem
;

335 
	`OF_TRACE_LVL
(1, ("%s:†a¡„•aœ i nuÎ,…»‹nd w»ûived it\n", 
__FUNCTION__
))

336 ià(
	`of_ldpc_¡aœÿ£_decode_w™h_Ãw_symbŞ
 (
ofcb
, 
nuÎ_symbŞ
, ofcb->
nb_tÙ®_symbŞs
 - 1)

337 !ğ
OF_STATUS_OK
)

339 
	`OF_PRINT_ERROR
(("%s: ERROR: of_ldpc_¡aœÿ£_decode_w™h_Ãw_symbŞ(èçed\n", 
__FUNCTION__
))

340 
”rÜ
;

345 
OF_EXIT_FUNCTION


346  
OF_STATUS_OK
;

348 
no_mem
:

349 
	`OF_PRINT_ERROR
(("out of memory\n"));

350 
”rÜ
:

351 
OF_EXIT_FUNCTION


352  
OF_STATUS_FATAL_ERROR
;

353 
	}
}

355 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_£t_ÿÎback_funùiÚs_Ãw
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

356 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

357 **
d©a
,

358 **
h—d
,

359 
UINT32
 
size
,

360 
UINT32
 
h—d_size
,

361 
UINT32
 
esi
),

362 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

363 **
d©a
,

364 **
h—d
,

365 
UINT32
 
size
,

366 
UINT32
 
h—d_size
,

367 
UINT32
 
esi
),

368 * 
cÚ‹xt_4_ÿÎback
)

370 
OF_ENTER_FUNCTION


371 
ofcb
->
decoded_sourû_symbŞ_ÿÎback_Ãw
 = 
decoded_sourû_symbŞ_ÿÎback
;

372 
ofcb
->
decoded_»·œ_symbŞ_ÿÎback_Ãw
 = 
decoded_»·œ_symbŞ_ÿÎback
;

373 
ofcb
->
cÚ‹xt_4_ÿÎback
 = context_4_callback;

374 
OF_EXIT_FUNCTION


375  
OF_STATUS_OK
;

376 
	}
}

378 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_£t_ÿÎback_funùiÚs
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

379 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

380 
UINT32
 
size
,

381 
UINT32
 
esi
),

382 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

383 
UINT32
 
size
,

384 
UINT32
 
esi
),

385 * 
cÚ‹xt_4_ÿÎback
)

387 
OF_ENTER_FUNCTION


388 
ofcb
->
decoded_sourû_symbŞ_ÿÎback
 = decoded_source_symbol_callback;

389 
ofcb
->
decoded_»·œ_symbŞ_ÿÎback
 = decoded_repair_symbol_callback;

390 
ofcb
->
cÚ‹xt_4_ÿÎback
 = context_4_callback;

391 
OF_EXIT_FUNCTION


392  
OF_STATUS_OK
;

393 
	}
}

396 #ifdeà
OF_USE_ENCODER


398 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_bud_»·œ_symbŞ
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

399 * 
’codšg_symbŞs_b
[],

400 
UINT32
 
esi_of_symbŞ_to_bud
)

402 
of_mod2’Œy
 *
e
;

403 
UINT32
 
cŞ_to_bud
;

404 
UINT32
 
esi
;

405 *
to_add_buf
;

406 *
·r™y_symbŞ
;

407 
OF_ENTER_FUNCTION


408 ià(
esi_of_symbŞ_to_bud
 < 
ofcb
->
nb_sourû_symbŞs
 ||ƒsi_of_symbŞ_to_bud >ğofcb->
nb_tÙ®_symbŞs
)

410 
	`OF_PRINT_ERROR
(("of_ldpc_¡aœÿ£_bud_»·œ_symbŞ: E¼Ü, badƒs˜oà’codšg symbŞ (%d)\n", 
esi_of_symbŞ_to_bud
))

411 
”rÜ
;

413 
·r™y_symbŞ
 = 
’codšg_symbŞs_b
[
esi_of_symbŞ_to_bud
];

414 
	`mem£t
 (
·r™y_symbŞ
, 0, 
ofcb
->
’codšg_symbŞ_Ëngth
);

415 
cŞ_to_bud
 = 
	`of_g‘_symbŞ_cŞ
 ((
of_cb_t
*)
ofcb
, 
esi_of_symbŞ_to_bud
);

416 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
ofcb
->
pchk_m©rix
, 
cŞ_to_bud
);

417 !
	`of_mod2¥¬£_©_’d
 (
e
))

420 ià(
e
->
cŞ
 !ğ
cŞ_to_bud
)

423 
esi
 = 
	`of_g‘_symbŞ_esi
 ((
of_cb_t
*)
ofcb
, 
e
->
cŞ
);

424 
to_add_buf
 = (*è
’codšg_symbŞs_b
[
esi
];

425 ià(
to_add_buf
 =ğ
NULL
)

427 
	`OF_PRINT_ERROR
(("symbŞ %d i nÙ‡Îoÿ‹d\n", 
esi
));

428 
”rÜ
;

430 #ifdeà
OF_DEBUG


431 
	`of_add_to_symbŞ
 (
·r™y_symbŞ
, 
to_add_buf
, 
ofcb
->
’codšg_symbŞ_Ëngth
,&(ofcb->
¡©s_xÜ
->
nb_xÜ_fÜ_IT
));

433 
	`of_add_to_symbŞ
 (
·r™y_symbŞ
, 
to_add_buf
, 
ofcb
->
’codšg_symbŞ_Ëngth
);

436 
e
 = 
	`of_mod2¥¬£_Ãxt_š_row
 (e);

438 
	`OF_TRACE_LVL
 (1, ("%s:„•aœ symbŞ (esi=%dèbut\n", 
__FUNCTION__
, 
esi_of_symbŞ_to_bud
))

439 
OF_EXIT_FUNCTION


440  
OF_STATUS_OK
;

442 
”rÜ
:

443 
OF_EXIT_FUNCTION


444  
OF_STATUS_ERROR
;

445 
	}
}

450 #ifdeà
OF_USE_DECODER


452 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_decode_w™h_Ãw_symbŞ
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

453 * 
Ãw_symbŞ
,

454 
UINT32
 
Ãw_symbŞ_esi
)

456 
OF_ENTER_FUNCTION


457  
	`of_lš—r_bš¬y_code_decode_w™h_Ãw_symbŞ
((
of_lš—r_bš¬y_code_cb_t
*)
ofcb
, 
Ãw_symbŞ
, 
Ãw_symbŞ_esi
);

458 
	}
}

461 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_£t_avaabË_symbŞs
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

462 * cÚ¡ 
’codšg_symbŞs_b
[])

464 
UINT32
 
i
;

466 
OF_ENTER_FUNCTION


467 
i
 = 0; i < 
ofcb
->
nb_tÙ®_symbŞs
; i++)

469 ià(
’codšg_symbŞs_b
[
i
] =ğ
NULL
)

474 
	`of_lš—r_bš¬y_code_decode_w™h_Ãw_symbŞ
((
of_lš—r_bš¬y_code_cb_t
*)
ofcb
, 
’codšg_symbŞs_b
[
i
], i);

478 
OF_EXIT_FUNCTION


479  
OF_STATUS_OK
;

480 
	}
}

483 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_fšish_decodšg
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
)

485 
OF_ENTER_FUNCTION


486 #ifdeà
OF_LDPC_STAIRCASE_ML_DECODING


487  
	`of_lš—r_bš¬y_code_fšish_decodšg_w™h_ml
 ((
of_lš—r_bš¬y_code_cb_t
*)
ofcb
);

489  
OF_STATUS_ERROR
;

491 
	}
}

493 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_»£t_decodšg_¡©u
(
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
){

494 
OF_ENTER_FUNCTION


495 
OF_EXIT_FUNCTION


496  
OF_STATUS_OK
;

497 
	}
}

500 
boŞ
 
	$of_ldpc_¡aœÿ£_is_decodšg_com¶‘e
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
)

502 ; 
ofcb
->
fœ¡_nÚ_decoded
 < ofcb->
nb_sourû_symbŞs
; ofcb->first_non_decoded++)

504 ià(
ofcb
->
’codšg_symbŞs_b
[ofcb->
fœ¡_nÚ_decoded
] =ğ
NULL
)

506 
	`OF_TRACE_LVL
 (1, ("decoding‚ot complete (%u source symbols„eady, %uƒxpected)\n",

507 
ofcb
->
nb_sourû_symbŞ_»ady
, ofcb->
nb_sourû_symbŞs
))

509  
çl£
;

512 
	`OF_TRACE_LVL
 (1, ("decoding is complete\n"))

514  
Œue
;

515 
	}
}

518 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_g‘_sourû_symbŞs_b
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

519 * 
sourû_symbŞs_b
[])

521 
OF_ENTER_FUNCTION


523 
	`memıy
 (
sourû_symbŞs_b
, 
ofcb
->
’codšg_symbŞs_b
,  (*è* ofcb->
nb_sourû_symbŞs
);

524 
OF_EXIT_FUNCTION


525  
OF_STATUS_OK
;

526 
	}
}

531 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_£t_cÚŒŞ_·¿m‘”
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

532 
UINT32
 
ty³
,

533 * 
v®ue
,

534 
UINT32
 
Ëngth
)

536 
	`OF_PRINT_ERROR
(("of_ldpc_staircase_set_control_parameter: ERROR,‚ot implemented...\n"))

537  
OF_STATUS_ERROR
;

538 
	}
}

541 
of_¡©us_t
 
	$of_ldpc_¡aœÿ£_g‘_cÚŒŞ_·¿m‘”
 (
of_ldpc_¡aœÿ£_cb_t
* 
ofcb
,

542 
UINT32
 
ty³
,

543 * 
v®ue
,

544 
UINT32
 
Ëngth
)

546 
OF_ENTER_FUNCTION


547 
ty³
) {

548 
OF_CTRL_GET_MAX_K
:

549 ià(
v®ue
 =ğ
NULL
 || 
Ëngth
 !ğ(
UINT32
)) {

550 
	`OF_PRINT_ERROR
(("%s: OF_CTRL_GET_MAX_K ERROR:‚ull value or bad†ength (got %d,ƒxpected %ld)\n",

551 
__FUNCTION__
, 
Ëngth
, (
UINT32
)))

552 
”rÜ
;

554 *(
UINT32
*)
v®ue
 = 
ofcb
->
max_nb_sourû_symbŞs
;

555 
	`OF_TRACE_LVL
(1, ("%s: OF_CTRL_GET_MAX_K (%d)\n", 
__FUNCTION__
, *(
UINT32
*)
v®ue
))

558 
OF_CTRL_GET_MAX_N
:

559 ià(
v®ue
 =ğ
NULL
 || 
Ëngth
 !ğ(
UINT32
)) {

560 
	`OF_PRINT_ERROR
(("%s: OF_CTRL_GET_MAX_N ERROR:‚ull value or bad†ength (got %d,ƒxpected %ld)\n",

561 
__FUNCTION__
, 
Ëngth
, (
UINT32
)))

562 
”rÜ
;

564 *(
UINT32
*)
v®ue
 = 
ofcb
->
max_nb_’codšg_symbŞs
;

565 
	`OF_TRACE_LVL
(1, ("%s: OF_CTRL_GET_MAX_N (%d)\n", 
__FUNCTION__
, *(
UINT32
*)
v®ue
))

568 
OF_CRTL_LDPC_STAIRCASE_IS_LAST_SYMBOL_NULL
:

569 ià(
ofcb
->
exŒa_’Œ›s_added_š_pchk
 =ğ
Œue
)

573 *(
boŞ
*)
v®ue
 = 
çl£
;

574 
	`OF_TRACE_LVL
(1, ("%s: OF_CRTL_LDPC_STAIRCASE_IS_LAST_SYMBOL_NULL (çl£èÓxŒ¨’Œ› added iÀpchk)\n", 
__FUNCTION__
))

581 *(
boŞ
*)
v®ue
 = ((
ofcb
->
N1
 & 0x1è=ğ0è? 
Œue
 : 
çl£
;

582 
	`OF_TRACE_LVL
(1, ("%s: OF_CRTL_LDPC_STAIRCASE_IS_LAST_SYMBOL_NULL (%d)\n", 
__FUNCTION__
, *(
boŞ
*)
v®ue
))

587 
	`OF_PRINT_ERROR
(("%s: unknowÀty³ (%d)\n", 
__FUNCTION__
, 
ty³
))

588 
”rÜ
;

590 
OF_EXIT_FUNCTION


591  
OF_STATUS_OK
;

593 
”rÜ
:

594 
OF_EXIT_FUNCTION


595  
OF_STATUS_ERROR
;

596 
	}
}

	@src/lib_stable/ldpc_staircase/of_ldpc_staircase_api.h

34 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


36 #iâdeà
OF_CODEC_STABLE_LDPC_STAIRCASE_API


37 
	#OF_CODEC_STABLE_LDPC_STAIRCASE_API


	)

40 
	~"../../lib_commÚ/of_ty³s.h
"

49 
	sof_ldpc_·¿m‘”s


51 
UINT32
 
	mnb_sourû_symbŞs
;

52 
UINT32
 
	mnb_»·œ_symbŞs
;

53 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

54 
UINT32
 
	m’codšg_h—d_Ëngth
;

58 
INT32
 
	m´ng_£ed
;

59 
UINT8
 
	mN1
;

60 } 
	tof_ldpc_·¿m‘”s_t
;

78 
	#OF_CRTL_LDPC_STAIRCASE_IS_LAST_SYMBOL_NULL
 1024

	)

	@src/lib_stable/ldpc_staircase/of_ldpc_staircase_pchk.c

48 
	~"of_ldpc_šşudes.h
"

49 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


53 
of_mod2¥¬£
* 
	$of_ü—‹_pchck_m©rix_rfc5170_com¶ŸÁ
 (
UINT32
 
nb_rows
,

54 
UINT32
 
nb_cŞs
,

55 
UINT32
 
Ëá_deg»e
,

56 
UINT32
 
£ed
,

57 
of_ldpc_¡aœÿ£_cb_t
 *
ofcb
)

59 
OF_ENTER_FUNCTION


60 
of_mod2’Œy
 *
e
;

61 
UINT32
 
added
, 
uÃv’
;

62 
INT32
 
i
, 
j
, 
k
;

63 
INT32
 
t
;

64 
UINT32
 *
u
;

65 
of_mod2¥¬£
 *
pchkM©rix
 = 
NULL
;

66 
UINT32
 
skCŞs
 = 0;

67 
UINT32
 
nbD©aCŞs
 = 0;

69 
skCŞs
 = 
nb_rows
;

70 
nbD©aCŞs
 = 
nb_cŞs
 - 
skCŞs
;

72 ià(
Ëá_deg»e
 > 
nb_rows
)

74 
	`OF_PRINT_ERROR
(("number of 1s…er column (i.e. N1=%d…arameter) is greaterhanotal‚umber of„ows (i.e.‚-k=%d)\n",

75 
Ëá_deg»e
, 
nb_rows
));

76 
OF_EXIT_FUNCTION


77  
NULL
;

79 
	`of_rfc5170_¤ªd
 (
£ed
);

80 
pchkM©rix
 = 
	`of_mod2¥¬£_®loÿ‹
 (
nb_rows
, 
nb_cŞs
);

83 
u
 = (
UINT32
*è
	`of_ÿÎoc
 (
Ëá_deg»e
 * 
nbD©aCŞs
,  * u);

85 
k
 = 
Ëá_deg»e
 * 
nbD©aCŞs
 - 1; k >= 0; k--)

87 
u
[
k
] = k % 
nb_rows
;

89 
uÃv’
 = 0;

90 
t
 = 0;

91 
j
 = 
skCŞs
; j < 
nb_cŞs
; j++)

94 
k
 = 0; k < 
Ëá_deg»e
; k++)

98 
i
 = 
t
; i < 
Ëá_deg»e
 * 
nbD©aCŞs
 && 
	`of_mod2¥¬£_fšd
 (
pchkM©rix
, 
u
[i], 
j
); i++)

101 ià(
i
 < 
Ëá_deg»e
 * 
nbD©aCŞs
)

106 
i
 = 
t
 + 
	`of_rfc5170_¿nd
 (
Ëá_deg»e
 * 
nbD©aCŞs
 -);

108 
	`of_mod2¥¬£_fšd
 (
pchkM©rix
, 
u
[
i
], 
j
));

109 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
u
[
i
], 
j
);

111 
u
[
i
] = u[
t
];

112 
t
++;

120 
uÃv’
 += 1;

123 
i
 = 
	`of_rfc5170_¿nd
 (
nb_rows
);

125 
	`of_mod2¥¬£_fšd
 (
pchkM©rix
, 
i
, 
j
));

126 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
i
, 
j
);

130 ià(
uÃv’
 > 0 && 
of_v”bos™y
 >= 1)

132 
	`OF_PRINT_LVL
(1, ("%s: HadØ¶aû %d check š„ow uÃv’ly\n", 
__FUNCTION__
, 
uÃv’
))

134 
	`of_ä“
 (
u
);

136 
added
 = 0;

137 
i
 = 0; i < 
nb_rows
; i++)

139 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
pchkM©rix
, 
i
);

140 ià(
	`of_mod2¥¬£_©_’d
 (
e
))

142 
j
 = (
	`of_rfc5170_¿nd
 (
nbD©aCŞs
)è+ 
skCŞs
;

143 
e
 = 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
i
, 
j
);

144 
added
 ++;

146 
e
 = 
	`of_mod2¥¬£_fœ¡_š_row
 (
pchkM©rix
, 
i
);

147 ià(
	`of_mod2¥¬£_©_’d
 (
	`of_mod2¥¬£_Ãxt_š_row
 (
e
)è&& 
nbD©aCŞs
 > 1)

151 
j
 = (
	`of_rfc5170_¿nd
 (
nbD©aCŞs
)è+ 
skCŞs
;

153 
j
 =ğ
	`of_mod2¥¬£_cŞ
 (
e
));

154 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
i
, 
j
);

155 
added
 ++;

158 ià(
added
 >= 1)

160 
ofcb
->
exŒa_’Œ›s_added_š_pchk
 = 1;

161 
	`OF_TRACE_LVL
(1,("%s: Added %dƒxŒ¨b™-check tØmakrow Hammšg weighˆ©†—¡wo\n", 
__FUNCTION__
, 
added
));

165 
ofcb
->
exŒa_’Œ›s_added_š_pchk
 = 0;

168 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 0, 0);

169 
i
 = 1; i < 
nb_rows
; i++)

173 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
i
, i);

175 
	`of_mod2¥¬£_š£¹
 (
pchkM©rix
, 
i
, i - 1);

177 
OF_EXIT_FUNCTION


178  
pchkM©rix
;

179 
	}
}

	@src/lib_stable/reed-solomon_gf_2_8/of_codec_profile.h

38 
	#OF_USE_REED_SOLOMON_CODEC


	)

46 
	#OF_REED_SOLOMON_MAX_NB_SOURCE_SYMBOLS_DEFAULT
 255

	)

47 
	#OF_REED_SOLOMON_MAX_NB_ENCODING_SYMBOLS_DEFAULT
 255

	)

	@src/lib_stable/reed-solomon_gf_2_8/of_reed-solomon_gf_2_8.c

35 
	~"of_»ed-sŞomÚ_gf_2_8_šşudes.h
"

37 #ifdeà
OF_USE_REED_SOLOMON_CODEC


40 #ifdeà
_WIN32_WCE


41 
	#bz”o
(
to
,
sz
è
	`mem£t
(Ño), 0, (sz))

	)

43 
	#bcmp
(
a
,
b
,
sz
è
	`memcmp
(×), (b), (sz))

	)

49 #ià
defšed
(
WIN32
)

50 
	#NEED_BCOPY


	)

51 
	#bcmp
(
a
,
b
,
n
è
	`memcmp
×,b,n)

	)

54 #ifdeà
NEED_BCOPY


55 
	#bcİy
(
s
, 
d
, 
siz
è
	`memıy
((d), (s), (siz))

	)

56 
	#bz”o
(
d
, 
siz
è
	`mem£t
((d), '\0', (siz))

	)

59 #iâdeà
UINT32


60 
	#UINT32
 

	)

67 #ifdeà
TICK


68 #undeà
TICK


72 #ifdef 
TEST


74 
	#DEB
(
x
è
	)
x

75 
	#DDB
(
x
è
	)
x

76 
	#OF_RS_DEBUG
 4

	)

77 #ià
defšed
(
WIN32
)

78 
	~<time.h
>

79 
	stimev®


81 
	mticks
;

83 
	#g‘timeofday
(
x
, 
dummy
è{ (x)->
ticks
 = 
	`şock
(è; }

	)

84 
	#DIFF_T
(
a
,
b
è(1+ 1000000*×.
ticks
 - b.ticksè/ 
CLOCKS_PER_SEC
 )

	)

85 
	tUINT32
 ;

86 
	tu_shÜt
 ;

88 
	~<sys/time.h
>

89 
	#DIFF_T
(
a
,
b
) \

90 (1+ 1000000*(
a
.
tv_£c
 - 
b
.tv_£cè+ (a.
tv_u£c
 - b.tv_u£cè)

	)

93 
	#TICK
(
t
) \

94 {
timev®
 
x
 ; \

95 
	`g‘timeofday
(&
x
, 
NULL
) ; \

96 
t
 = 
x
.
tv_u£c
 + 1000000* (x.
tv_£c
 & 0xff ) ; \

97 }

	)

98 
	#TOCK
(
t
) \

99 { 
UINT32
 
t1
 ; 
	`TICK
(t1) ; \

100 ià(
t1
 < 
t
) = 256000000 +1 - ; \

101 
t
 = 
t1
 - ; \

102 ià(
t
 =ğ0èˆğ1 ;}

	)

104 
UINT32
 
	gticks
[10];

108 
	#DEB
(
x
)

	)

109 
	#DDB
(
x
)

	)

110 
	#TICK
(
x
)

	)

111 
	#TOCK
(
x
)

	)

127 #ià(
GF_BITS
 < 2 && GF_BITS >16)

136 
	#GF_SIZE
 ((1 << 
GF_BITS
è- 1è

	)

142 cÚ¡ *
	gof_rs_®lPp
[] =

144 
NULL
,

145 
NULL
,

173 
gf
 
	gof_rs_gf_exp
[2*
GF_SIZE
];

174 
	gof_rs_gf_log
[
GF_SIZE
 + 1];

175 
gf
 
	gof_rs_šv”£
[
GF_SIZE
+1];

182 
gf


183 
	$of_modÂ
 (
INT32
 
x
)

185 
x
 >ğ
GF_SIZE
)

187 
x
 -ğ
GF_SIZE
;

188 
x
 = (x >> 
GF_BITS
è+ (x & 
GF_SIZE
);

190  
x
;

191 
	}
}

193 
	#SWAP
(
a
,
b
,
t
è{ˆ
tmp
;mp÷;‡=b; bñmp;}

	)

205 #ià(
GF_BITS
 <= 8)

206 
gf
 
	gof_gf_mul_bË
[
GF_SIZE
 + 1][GF_SIZE + 1];

208 
	#of_gf_mul
(
x
,
y
è
of_gf_mul_bË
[x][y]

	)

210 
	#USE_GF_MULC
 
gf
 * 
__gf_mulc_


	)

211 
	#GF_MULC0
(
c
è
__gf_mulc_
 = 
of_gf_mul_bË
[c]

	)

212 
	#GF_ADDMULC
(
d¡
, 
x
èd¡ ^ğ
__gf_mulc_
[x]

	)

213 #ià
GF_BITS
 <8

214 
	#GF_ADDMULC_COMPACT
(
d¡
,
x
è{ 
gf
 
tmp
=x>>4;gà
_d¡1
=d¡>>4;_d¡1^=
__gf_mulc_
[tmp];m°ğx & 0x0F;gà
_d¡2
=d¡ & 0x0F;_d¡2 ^ğ__gf_mulc_[tmp]; d¡ = _d¡1<<4 | _d¡2; }

	)

216 
	#GF_ADDMULC_COMPACT
(
d¡
,
x
è{ 
	`GF_ADDMULC
(d¡, x);}

	)

220 
	$of_rs_š™_mul_bË
()

222 
OF_ENTER_FUNCTION


223 
i
, 
j
;

224 
i
 = 0; i < 
GF_SIZE
 + 1; i++)

225 
j
 = 0; j < 
GF_SIZE
 + 1; j++)

226 
of_gf_mul_bË
[
i
][
j
] = 
of_rs_gf_exp
[
	`of_modÂ
 (
of_rs_gf_log
[i] + of_rs_gf_log[j]) ] ;

228 
j
 = 0; j < 
GF_SIZE
 + 1; j++)

229 
of_gf_mul_bË
[0][
j
] = of_gf_mul_table[j][0] = 0;

230 
OF_EXIT_FUNCTION


231 
	}
}

233 
šlše
 
gf


234 
	$of_gf_mul
 (
x
, 
y
)

236 iàĞ(
x
è=ğ0 || (
y
) == 0)

239  
of_rs_gf_exp
[
of_rs_gf_log
[
x
] + of_rs_gf_log[
y
] ] ;

240 
	}
}

241 
	#of_rs_š™_mul_bË
()

	)

243 
	#USE_GF_MULC
 
gf
 * 
__gf_mulc_


	)

244 
	#GF_MULC0
(
c
è
__gf_mulc_
 = &
of_rs_gf_exp
[ 
of_rs_gf_log
[c] ]

	)

245 
	#GF_ADDMULC
(
d¡
, 
x
è{ ià(xèd¡ ^ğ
__gf_mulc_
[ 
of_rs_gf_log
[x] ] ; }

	)

264 
	$of_my_m®loc
 (
INT32
 
sz
, cÚ¡ *
”r_¡ršg
)

266 
OF_ENTER_FUNCTION


267 *
p
 = 
	`m®loc
 (
sz
);

268 ià(
p
 =ğ
NULL
)

270 
	`OF_PRINT_ERROR
 (("-- m®loøçu»‡ÎoÿtiÚ %s\n", 
”r_¡ršg
))

271 
OF_EXIT_FUNCTION


272  
NULL
;

274 
OF_EXIT_FUNCTION


275  
p
 ;

276 
	}
}

278 
	#NEW_GF_MATRIX
(
rows
, 
cŞs
) \

279 (
gf
 *)
	`of_my_m®loc
(
rows
 * 
cŞs
 * (gf), " ## __LINE__ ## " )

	)

285 
	$of_g’”©e_gf
 ()

287 
OF_ENTER_FUNCTION


288 
INT32
 
i
;

289 
gf
 
mask
;

290 cÚ¡ *
Pp
 = 
of_rs_®lPp
[
GF_BITS
] ;

292 
mask
 = 1;

293 
of_rs_gf_exp
[
GF_BITS
] = 0;

300 
i
 = 0; i < 
GF_BITS
; i++, 
mask
 <<= 1)

302 
of_rs_gf_exp
[
i
] = 
mask
;

303 
of_rs_gf_log
[
of_rs_gf_exp
[
i
]] = i;

308 ià(
Pp
[
i
] == '1')

309 
of_rs_gf_exp
[
GF_BITS
] ^ğ
mask
;

315 
of_rs_gf_log
[
of_rs_gf_exp
[
GF_BITS
]] = GF_BITS;

322 
mask
 = 1 << (
GF_BITS
 - 1) ;

323 
i
 = 
GF_BITS
 + 1; i < 
GF_SIZE
; i++)

325 ià(
of_rs_gf_exp
[
i
 - 1] >ğ
mask
)

326 
of_rs_gf_exp
[
i
] = of_rs_gf_exp[
GF_BITS
] ^ ( (of_rs_gf_exp[˜- 1] ^ 
mask
) << 1);

328 
of_rs_gf_exp
[
i
] = of_rs_gf_exp[i - 1] << 1;

329 
of_rs_gf_log
[
of_rs_gf_exp
[
i
]] = i;

334 
of_rs_gf_log
[0] = 
GF_SIZE
 ;

336 
i
 = 0 ; i < 
GF_SIZE
 ; i++)

337 
of_rs_gf_exp
[
i
 + 
GF_SIZE
] = of_rs_gf_exp[i] ;

344 
of_rs_šv”£
[0] = 0 ;

345 
of_rs_šv”£
[1] = 1;

346 
i
 = 2; i <ğ
GF_SIZE
; i++)

347 
of_rs_šv”£
[
i
] = 
of_rs_gf_exp
[
GF_SIZE
-
of_rs_gf_log
[i]];

348 
OF_EXIT_FUNCTION


349 
	}
}

362 
	#addmul
(
d¡
, 
¤c
, 
c
, 
sz
) \

363 ià(
c
 !ğ0è
	`of_addmul1
(
d¡
, 
¤c
, c, 
sz
)

	)

367 #ià
defšed
 (
__LP64__
è|| (
__WORDSIZE
 == 64)

368 
	#UNROLL
 16

	)

370 
	$of_addmul1
 (
gf
 *
d¡1
, gà*
¤c1
, gà
c
, 
sz
)

372 
USE_GF_MULC
 ;

373 
gf
 *
d¡
 = 
d¡1
, *
¤c
 = 
¤c1
 ;

374 
gf
 *
lim
 = &
d¡
[
sz
 - 
UNROLL
 + 1] ;

375 
UINT64
 
tmp
;

376 
UINT64
 *
d¡_64
 = (UINT64*)
d¡1
;

377 
	`GF_MULC0
 (
c
) ;

379 ; 
d¡
 < 
lim
 ; d¡ +ğ
UNROLL
, 
¤c
 += UNROLL)

382 
tmp
 = ((
UINT64
)
__gf_mulc_
[
¤c
[0]]) | ((UINT64)__gf_mulc_[src[1]]<<8) | ((UINT64)__gf_mulc_[src[2]]<<16) |

383 ((
UINT64
)
__gf_mulc_
[
¤c
[3]]<<24) | ((UINT64)__gf_mulc_[src[4]]<<32) | ((UINT64)__gf_mulc_[src[5]]<<40) |

384 ((
UINT64
)
__gf_mulc_
[
¤c
[6]]<<48) | ((UINT64)__gf_mulc_[src[7]]<<56) ;

385 *
d¡_64
 ^ğ
tmp
;

386 
d¡_64
++;

387 #ià(
UNROLL
 > 8)

388 
tmp
 = ((
UINT64
)
__gf_mulc_
[
¤c
[8]]) | ((UINT64)__gf_mulc_[src[9]]<<8) | ((UINT64)__gf_mulc_[src[10]]<<16) |

389 ((
UINT64
)
__gf_mulc_
[
¤c
[11]]<<24) | ((UINT64)__gf_mulc_[src[12]]<<32) | ((UINT64)__gf_mulc_[src[13]]<<40) |

390 ((
UINT64
)
__gf_mulc_
[
¤c
[14]]<<48) | ((UINT64)__gf_mulc_[src[15]]<<56) ;

391 *
d¡_64
 ^ğ
tmp
;

392 
d¡_64
++;

395 
lim
 +ğ
UNROLL
 - 1 ;

396 ; 
d¡
 < 
lim
; d¡++, 
¤c
++)

397 
	`GF_ADDMULC
 (*
d¡
 , *
¤c
);

398 
	}
}

402 
	#UNROLL
 16

	)

405 
	$of_addmul1
 (
gf
 *
d¡1
, gà*
¤c1
, gà
c
, 
sz
)

407 
USE_GF_MULC
 ;

408 
gf
 *
d¡
 = 
d¡1
, *
¤c
 = 
¤c1
 ;

410 
gf
 *
lim
 = &
d¡
[
sz
 - 
UNROLL
 + 1] ;

411 
	`GF_MULC0
 (
c
) ;

412 #ià(
UNROLL
 > 1)

413 ; 
d¡
 < 
lim
 ; d¡ +ğ
UNROLL
, 
¤c
 += UNROLL)

415 
	`GF_ADDMULC
 (
d¡
[0] , 
¤c
[0]);

416 
	`GF_ADDMULC
 (
d¡
[1] , 
¤c
[1]);

417 
	`GF_ADDMULC
 (
d¡
[2] , 
¤c
[2]);

418 
	`GF_ADDMULC
 (
d¡
[3] , 
¤c
[3]);

419 #ià(
UNROLL
 > 4)

420 
	`GF_ADDMULC
 (
d¡
[4] , 
¤c
[4]);

421 
	`GF_ADDMULC
 (
d¡
[5] , 
¤c
[5]);

422 
	`GF_ADDMULC
 (
d¡
[6] , 
¤c
[6]);

423 
	`GF_ADDMULC
 (
d¡
[7] , 
¤c
[7]);

425 #ià(
UNROLL
 > 8)

426 
	`GF_ADDMULC
 (
d¡
[8] , 
¤c
[8]);

427 
	`GF_ADDMULC
 (
d¡
[9] , 
¤c
[9]);

428 
	`GF_ADDMULC
 (
d¡
[10] , 
¤c
[10]);

429 
	`GF_ADDMULC
 (
d¡
[11] , 
¤c
[11]);

430 
	`GF_ADDMULC
 (
d¡
[12] , 
¤c
[12]);

431 
	`GF_ADDMULC
 (
d¡
[13] , 
¤c
[13]);

432 
	`GF_ADDMULC
 (
d¡
[14] , 
¤c
[14]);

433 
	`GF_ADDMULC
 (
d¡
[15] , 
¤c
[15]);

437 
lim
 +ğ
UNROLL
 - 1 ;

438 ; 
d¡
 < 
lim
; d¡++, 
¤c
++)

439 
	`GF_ADDMULC
 (*
d¡
 , *
¤c
);

440 
	}
}

448 
	$of_m©mul
 (
gf
 *
a
, gà*
b
, gà*
c
, 
n
, 
k
, 
m
)

450 
OF_ENTER_FUNCTION


451 
row
, 
cŞ
, 
i
 ;

453 
row
 = 0;„ow < 
n
 ;„ow++)

455 
cŞ
 = 0; cŞ < 
m
 ; col++)

457 
gf
 *
·
 = &
a
[ 
row
 * 
k
 ];

458 
gf
 *
pb
 = &
b
[ 
cŞ
 ];

459 
gf
 
acc
 = 0 ;

460 
i
 = 0; i < 
k
 ; i++, 
·
++, 
pb
 +ğ
m
)

461 
acc
 ^ğ
	`of_gf_mul
 (*
·
, *
pb
) ;

462 
c
[ 
row
 * 
m
 + 
cŞ
 ] = 
acc
 ;

465 
OF_EXIT_FUNCTION


466 
	}
}

468 #ifdeà
OF_RS_DEBUG


496 
DEB
 (
pivloİs
 = 0; 
pivsw­s
 = 0 ; )

498 
	$of_šv”t_m©
 (
gf
 *
¤c
, 
k
)

500 
OF_ENTER_FUNCTION


501 
gf
 
c
, *
p
 ;

502 
œow
, 
icŞ
, 
row
, 
cŞ
, 
i
, 
ix
 ;

504 
”rÜ
 = 1 ;

505 *
šdxc
 = (*è
	`of_my_m®loc
 (
k
 *  (), "indxc");

506 *
šdxr
 = (*è
	`of_my_m®loc
 (
k
 *  (), "indxr");

507 *
iv
 = (*è
	`of_my_m®loc
 (
k
 *  (), "ipiv");

508 
gf
 *
id_row
 = 
	`NEW_GF_MATRIX
 (1, 
k
);

509 
gf
 *
‹mp_row
 = 
	`NEW_GF_MATRIX
 (1, 
k
);

511 
	`bz”o
 (
id_row
, 
k
* (
gf
));

512 
	`DEB
 (
pivloİs
 = 0; 
pivsw­s
 = 0 ; )

516 
i
 = 0; i < 
k
 ; i++)

517 
iv
[
i
] = 0 ;

519 
cŞ
 = 0; cŞ < 
k
 ; col++)

521 
gf
 *
pivÙ_row
 ;

526 
œow
 = 
icŞ
 = -1 ;

527 ià(
iv
[
cŞ
] !ğ1 && 
¤c
[cŞ*
k
 + col] != 0)

529 
œow
 = 
cŞ
 ;

530 
icŞ
 = 
cŞ
 ;

531 
found_piv
 ;

533 
row
 = 0 ;„ow < 
k
 ;„ow++)

535 ià(
iv
[
row
] != 1)

537 
ix
 = 0 ; ix < 
k
 ; ix++)

539 
	`DEB
 (
pivloİs
++ ;)

540 ià(
iv
[
ix
] == 0)

542 ià(
¤c
[
row
*
k
 + 
ix
] != 0)

544 
œow
 = 
row
 ;

545 
icŞ
 = 
ix
 ;

546 
found_piv
 ;

550 ià(
iv
[
ix
] > 1)

553 
ç
 ;

558 ià(
icŞ
 == -1)

561 
ç
 ;

563 
found_piv
:

564 ++ (
iv
[
icŞ
]) ;

570 ià(
œow
 !ğ
icŞ
)

572 
ix
 = 0 ; ix < 
k
 ; ix++)

574 
	`SWAP
 (
¤c
[
œow
*
k
 + 
ix
], src[
icŞ
*k + ix], 
gf
) ;

577 
šdxr
[
cŞ
] = 
œow
 ;

578 
šdxc
[
cŞ
] = 
icŞ
 ;

579 
pivÙ_row
 = &
¤c
[
icŞ
*
k
] ;

580 
c
 = 
pivÙ_row
[
icŞ
] ;

581 ià(
c
 == 0)

583 
	`OF_PRINT_ERROR
(("singular matrix 2\n"))

584 
ç
 ;

586 ià(
c
 != 1)

593 
	`DEB
 (
pivsw­s
++ ;)

594 
c
 = 
of_rs_šv”£
[ c ] ;

595 
pivÙ_row
[
icŞ
] = 1 ;

596 
ix
 = 0 ; ix < 
k
 ; ix++)

597 
pivÙ_row
[
ix
] = 
	`of_gf_mul
 (
c
,…ivot_row[ix]);

606 
id_row
[
icŞ
] = 1;

607 ià(
	`bcmp
 (
pivÙ_row
, 
id_row
, 
k
* (
gf
)) != 0)

609 
p
 = 
¤c
, 
ix
 = 0 ; ix < 
k
 ; ix++,… += k)

611 ià(
ix
 !ğ
icŞ
)

613 
c
 = 
p
[
icŞ
] ;

614 
p
[
icŞ
] = 0 ;

615 
	`addmul
 (
p
, 
pivÙ_row
, 
c
, 
k
);

619 
id_row
[
icŞ
] = 0;

621 
cŞ
 = 
k
 - 1 ; col >= 0 ; col--)

623 ià(
šdxr
[
cŞ
] < 0 || indxr[cŞ] >ğ
k
)

624 
	`OF_PRINT_ERROR
(("AARGH, indxr[cŞ] %d\n", 
šdxr
[
cŞ
]))

626 ià(
šdxc
[
cŞ
] < 0 || indxc[cŞ] >ğ
k
)

627 
	`OF_PRINT_ERROR
(Ğ"AARGH, indxc[cŞ] %d\n", 
šdxc
[
cŞ
]))

629 ià(
šdxr
[
cŞ
] !ğ
šdxc
[col])

631 
row
 = 0 ;„ow < 
k
 ;„ow++)

633 
	`SWAP
 (
¤c
[
row
*
k
 + 
šdxr
[
cŞ
]], src[row*k + 
šdxc
[cŞ]], 
gf
) ;

637 
”rÜ
 = 0 ;

638 
ç
:

639 
	`ä“
 (
šdxc
);

640 
	`ä“
 (
šdxr
);

641 
	`ä“
 (
iv
);

642 
	`ä“
 (
id_row
);

643 
	`ä“
 (
‹mp_row
);

644 
OF_EXIT_FUNCTION


645  
”rÜ
 ;

646 
	}
}

661 
	$of_šv”t_vdm
 (
gf
 *
¤c
, 
k
)

663 
OF_ENTER_FUNCTION


664 
i
, 
j
, 
row
, 
cŞ
 ;

665 
gf
 *
b
, *
c
, *
p
;

666 
gf
 
t
, 
xx
 ;

668 ià(
k
 == 1)

674 
c
 = 
	`NEW_GF_MATRIX
 (1, 
k
);

675 
b
 = 
	`NEW_GF_MATRIX
 (1, 
k
);

677 
p
 = 
	`NEW_GF_MATRIX
 (1, 
k
);

679 
j
 = 1, 
i
 = 0 ; i < 
k
 ; i++, j += k)

681 
c
[
i
] = 0 ;

682 
p
[
i
] = 
¤c
[
j
] ;

690 
c
[
k
-1] = 
p
[0] ;

691 
i
 = 1 ; i < 
k
 ; i++)

693 
gf
 
p_i
 = 
p
[
i
] ;

694 
j
 = 
k
 - 1 - (
i
 - 1) ; j < k - 1 ; j++)

695 
c
[
j
] ^ğ
	`of_gf_mul
 (
p_i
, c[j+1]) ;

696 
c
[
k
-1] ^ğ
p_i
 ;

699 
row
 = 0 ;„ow < 
k
 ;„ow++)

704 
xx
 = 
p
[
row
] ;

705 
t
 = 1 ;

706 
b
[
k
-1] = 1 ;

707 
i
 = 
k
 - 2 ; i >= 0 ; i--)

709 
b
[
i
] = 
c
[i+1] ^ 
	`of_gf_mul
 (
xx
, b[i+1]) ;

710 
t
 = 
	`of_gf_mul
 (
xx
,è^ 
b
[
i
] ;

712 
cŞ
 = 0 ; cŞ < 
k
 ; col++)

713 
¤c
[
cŞ
*
k
 + 
row
] = 
	`of_gf_mul
 (
of_rs_šv”£
[
t
], 
b
[col]);

715 
	`ä“
 (
c
) ;

716 
	`ä“
 (
b
) ;

717 
	`ä“
 (
p
) ;

718 
OF_EXIT_FUNCTION


720 
	}
}

722 
	gof_rs_š™Ÿlized
 = 0 ;

725 
	$of_rs_š™
()

727 
OF_ENTER_FUNCTION


728 
	`TICK
 (
ticks
[0]);

729 
	`of_g’”©e_gf
();

730 
	`TOCK
 (
ticks
[0]);

731 
	`DDB
 (
	`´štf
("g’”©e_gàtook %ldus\n", 
ticks
[0]);)

732 
	`TICK
 (
ticks
[0]);

733 
	`of_rs_š™_mul_bË
();

734 
	`TOCK
 (
ticks
[0]);

735 
	`DDB
 (
	`´štf
("š™_mul_bËook %ldus\n", 
ticks
[0]);)

736 
of_rs_š™Ÿlized
 = 1 ;

737 
OF_EXIT_FUNCTION


738 
	}
}

746 
	#FEC_MAGIC
 0xFECC0DEC

	)

748 
	sãc_·rms


750 
UINT32
 
	mmagic
 ;

751 
INT32
 
	mk
, 
	mn
 ;

752 
gf
 *
	m’c_m©rix
 ;

756 
	#CPLUSPLUS_COMPATIBLE


	)

757 #ifdeà
CPLUSPLUS_COMPATIBLE


758 
	$of_rs_ä“
 (*
p_vp
)

760 
	$of_rs_ä“
 (
ãc_·rms
 *
p
)

763 
OF_ENTER_FUNCTION


764 #ifdeà
CPLUSPLUS_COMPATIBLE


765 
ãc_·rms
 *
p
 = (ãc_·rm *è
p_vp
;

767 ià(
p
 =ğ
NULL
)

771 
	`OF_PRINT_ERROR
 (("bad…arameterso fec_free\n"))

774 
	`ä“
 (
p
->
’c_m©rix
);

775 
	`ä“
 (
p
);

776 
OF_EXIT_FUNCTION


777 
	}
}

784 
	gãc_·rms
 *

788 
	$of_rs_Ãw
 (
UINT32
 
k
, UINT32 
n
)

790 
OF_ENTER_FUNCTION


791 
INT32
 
row
, 
cŞ
 ;

792 
gf
 *
p
, *
tmp_m
 ;

794 
ãc_·rms
 *
»tv®
 ;

796 ià(
of_rs_š™Ÿlized
 == 0)

797 
	`of_rs_š™
();

799 ià(
k
 > 
GF_SIZE
 + 1 || 
n
 > GF_SIZE + 1 || k >‚)

801 
	`OF_PRINT_ERROR
(( "Invalid…arameters k %d‚ %d GF_SIZE %d\n",

802 
k
, 
n
, 
GF_SIZE
))

803 
OF_EXIT_FUNCTION


804  
NULL
 ;

806 
»tv®
 = (
ãc_·rms
*è
	`of_my_m®loc
 ( (fec_parms), "new_code");

807 
»tv®
->
k
 = k ;

808 
»tv®
->
n
 =‚ ;

809 
»tv®
->
’c_m©rix
 = 
	`NEW_GF_MATRIX
 (
n
, 
k
);

814 
»tv®
->
magic
 = ( (
FEC_MAGIC
 ^ 
k
è^ 
n
è^ ((
ušŒ_t
)Ô‘v®->
’c_m©rix
) & 0xFFFFFFFF);

815 
tmp_m
 = 
	`NEW_GF_MATRIX
 (
n
, 
k
);

820 
tmp_m
[0] = 1 ;

821 
cŞ
 = 1; cŞ < 
k
 ; col++)

822 
tmp_m
[
cŞ
] = 0 ;

823 
p
 = 
tmp_m
 + 
k
, 
row
 = 0;„ow < 
n
 - 1 ;„ow++,… += k)

825 
cŞ
 = 0 ; cŞ < 
k
 ; col ++)

826 
p
[
cŞ
] = 
of_rs_gf_exp
[
	`of_modÂ
 (
row
*col) ];

834 
	`TICK
 (
ticks
[3]);

835 
	`of_šv”t_vdm
 (
tmp_m
, 
k
);

836 
	`of_m©mul
 (
tmp_m
 + 
k
*k,mp_m, 
»tv®
->
’c_m©rix
 + k*k, 
n
 - k, k, k);

840 
	`bz”o
 (
»tv®
->
’c_m©rix
, 
k
*k* (
gf
));

841 
p
 = 
»tv®
->
’c_m©rix
, 
cŞ
 = 0 ; cŞ < 
k
 ; col++,… += k + 1)

842 *
p
 = 1 ;

843 
	`ä“
 (
tmp_m
);

844 
	`TOCK
 (
ticks
[3]);

846 
	`DDB
 (
	`´štf
Ğ"--- %ld u tØbudƒncodšg m©rix\n", 
ticks
[3]);)

848 
OF_EXIT_FUNCTION


850  
»tv®
 ;

852  (*è
»tv®
 ;

854 
	}
}

865 
	#CPLUSPLUS_COMPATIBLE


	)

866 #ifdeà
CPLUSPLUS_COMPATIBLE


867 
of_¡©us_t


868 
	$of_rs_’code
 (*
code_vp
, **
¤c_vp
, *
ãc_vp
, 
šdex
, 
sz
)

870 
of_¡©us_t


871 
	$of_rs_’code
 (
ãc_·rms
 *
code
, 
gf
 *
¤c
[], gà*
ãc
, 
šdex
, 
sz
)

874 
OF_ENTER_FUNCTION


875 #ifdeà
CPLUSPLUS_COMPATIBLE


876 
ãc_·rms
 *
code
 = (ãc_·rms*è
code_vp
;

877 
gf
 **
¤c
 = (gf**è
¤c_vp
;

878 
gf
 *
ãc
 = (gf*è
ãc_vp
;

880 
i
, 
k
 = 
code
->k ;

881 
gf
 *
p
 ;

883 ià(
GF_BITS
 > 8)

884 
sz
 /= 2 ;

886 ià(
šdex
 < 
k
)

887 
	`bcİy
 (
¤c
[
šdex
], 
ãc
, 
sz
* (
gf
)) ;

888 ià(
šdex
 < 
code
->
n
)

890 
p
 = & (
code
->
’c_m©rix
[
šdex
*
k
]);

891 
	`bz”o
 (
ãc
, 
sz
* (
gf
));

892 
i
 = 0; i < 
k
 ; i++)

893 
	`addmul
 (
ãc
, 
¤c
[
i
], 
p
[i], 
sz
) ;

894  
OF_STATUS_OK
;

898 
	`OF_PRINT_ERROR
 (("Inv®id index %d (max %d)\n", 
šdex
, 
code
->
n
 - 1))

900 
OF_EXIT_FUNCTION


901  
OF_STATUS_ERROR
;

902 
	}
}

908 
	$of_shufæe
 (
gf
 *
pkt
[], gà*
pkth—d
[],
šdex
[], 
k
)

910 
OF_ENTER_FUNCTION


911 
i
;

913 
i
 = 0 ; i < 
k
 ;)

915 ià(
šdex
[
i
] >ğ
k
 || index[i] == i)

916 
i
++ ;

922 
c
 = 
šdex
[
i
] ;

924 ià(
šdex
[
c
] == c)

926 
	`DEB
 (
	`´štf
("\nshufæe,ƒ¼Ü‡ˆ%d\n", 
i
);)

927 
OF_EXIT_FUNCTION


930 
	`SWAP
 (
šdex
[
i
], index[
c
], ) ;

931 
	`SWAP
 (
pkt
[
i
],…kt[
c
], 
gf
 *) ;

932 
	`SWAP
 (
pkth—d
[
i
],…kth—d[
c
], 
gf
 *) ;

935 
	`DEB
 (

936 
i
 = 0 ; i < 
k
 ; i++)

938 ià(
šdex
[
i
] < 
k
 && index[i] != i)

940 
	`´štf
("shuffle:‡fter\n");

941 
i
 = 0; i < 
k
 ; i++)

942 
	`´štf
 ("%3d ", 
šdex
[
i
]);

943 
	`´štf
 ("\n");

944 
OF_EXIT_FUNCTION


949 
OF_EXIT_FUNCTION


951 
	}
}

959 
gf
 *

960 
	$of_bud_decode_m©rix
 (
ãc_·rms
 *
code
, 
šdex
[])

962 
OF_ENTER_FUNCTION


963 
i
 , 
k
 = 
code
->k ;

964 
gf
 *
p
, *
m©rix
 = 
	`NEW_GF_MATRIX
 (
k
, k);

966 
	`TICK
 (
ticks
[9]);

967 
i
 = 0, 
p
 = 
m©rix
 ; i < 
k
 ; i++,… += k)

970 ià(
šdex
[
i
] < 
k
)

972 
	`bz”o
 (
p
, 
k
* (
gf
));

973 
p
[
i
] = 1 ;

977 ià(
šdex
[
i
] < 
code
->
n
)

978 
	`bcİy
 (& (
code
->
’c_m©rix
[
šdex
[
i
]*
k
]), 
p
, k* (
gf
));

981 
	`OF_PRINT_ERROR
 ( ("decode: invalid index %d (max %d)\n",

982 
šdex
[
i
], 
code
->
n
 - 1))

983 
	`ä“
 (
m©rix
);

984 
OF_EXIT_FUNCTION


985  
NULL
 ;

988 
	`TICK
 (
ticks
[9]);

989 ià(
	`of_šv”t_m©
 (
m©rix
, 
k
))

991 
	`ä“
 (
m©rix
);

992 
m©rix
 = 
NULL
 ;

994 
	`TOCK
 (
ticks
[9]);

995 
OF_EXIT_FUNCTION


996  
m©rix
 ;

997 
	}
}

1014 
	#CPLUSPLUS_COMPATIBLE


	)

1015 #ifdeà
CPLUSPLUS_COMPATIBLE


1016 
of_¡©us_t


1017 
	$of_rs_decode
 (
of_rs_cb_t
* 
ofcb
, *
code_vp
, **
pkt_vp
, **
pkth—d_vp
,
šdex
[], 
sz
, 
h—dsz
)

1020 
	$of_rs_decode
 (
of_rs_cb_t
* 
ofcb
, 
ãc_·rms
 *
code
, 
gf
 *
pkt
[], gà*
pkth—d
[],
šdex
[], 
sz
, 
h—dsz
)

1023 
OF_ENTER_FUNCTION


1024 #ifdeà
CPLUSPLUS_COMPATIBLE


1025 
ãc_·rms
 *
code
 = (ãc_·rms*è
code_vp
;

1026 
gf
 **
pkt
 = (gf**è
pkt_vp
;

1027 
gf
 **
pkth—d
 = (gf**è
pkth—d_vp
;

1029 
gf
 *
m_dec
 ;

1031 **
ass_buf
;

1032 **
ass_h—dbuf
;

1033 
row
, 
cŞ
, 
k
 = 
code
->k ;

1034 
size
 = 
sz
;

1035 
h—dsize
 = 
h—dsz
;

1037 ià(
GF_BITS
 > 8){

1038 
size
 /= 2 ;

1039 
h—dsize
 /= 2;

1043 ià(
	`of_shufæe
 (
pkt
, 
pkth—d
, 
šdex
, 
k
))

1046 
OF_EXIT_FUNCTION


1047  
OF_STATUS_ERROR
 ;

1050 
m_dec
 = 
	`of_bud_decode_m©rix
 (
code
, 
šdex
);

1052 ià(
m_dec
 =ğ
NULL
)

1054 
OF_EXIT_FUNCTION


1055  
OF_STATUS_ERROR
 ;

1062 
row
 = 0 ;„ow < 
k
 ;„ow++)

1064 
	`OF_PRINT_LVL
(2,("decode„ow %d index %d\n",

1065 
row
, 
šdex
[row]));

1066 ià(
šdex
[
row
] >ğ
k
)

1068 
ass_buf
 = &(
ofcb
->
avaabË_symbŞs_b
[
row
]);

1069 
ass_h—dbuf
 = &(
ofcb
->
avaabË_h—dsymbŞs_b
[
row
]);

1070 
	`OF_PRINT_LVL
(2,("decode„ow %d index %d‡ss_buf %p\n",

1071 
row
, 
šdex
[row],
ass_buf
));

1072 
	`OF_PRINT_LVL
(2,("decode„ow %d index %d‡ss_buf %p‡ss_headbuf%p\n",

1073 
row
, 
šdex
[row],*
ass_buf
, *
ass_h—dbuf
));

1074 if(
NULL
 =ğ*
ass_buf
){

1075 ià(
ofcb
->
decoded_sourû_symbŞ_ÿÎback
 !ğ
NULL
)

1077 *
ass_buf
 = 
ofcb
->
	`decoded_sourû_symbŞ_ÿÎback
 (ofcb->
cÚ‹xt_4_ÿÎback
,

1078 
sz
, 
row
);

1080 if(
h—dsz
 != 0){

1081 *
ass_h—dbuf
 = 
ofcb
->
	`decoded_sourû_symbŞ_ÿÎback
 (ofcb->
cÚ‹xt_4_ÿÎback
,

1082 
h—dsz
, 
row
);

1086 ià(
ofcb
->
decoded_sourû_symbŞ_ÿÎback_Ãw
 !ğ
NULL
) {

1087 
ofcb
->
	`decoded_sourû_symbŞ_ÿÎback_Ãw
(ofcb->
cÚ‹xt_4_ÿÎback
,

1088 
ass_buf
, 
ass_h—dbuf
, 
sz
, 
h—dsz
, 
row
);

1092 *
ass_buf
 = (*è
	`of_m®loc
 (
sz
);

1093 
	`bz”o
 (*
ass_buf
, 
sz
 *  (
gf
)) ;

1094 if(
h—dsz
 != 0){

1095 *
ass_h—dbuf
 = (*è
	`of_m®loc
(
h—dsz
);

1096 
	`bz”o
 (*
ass_h—dbuf
, 
h—dsz
 *  (
gf
)) ;

1099 ià(*
ass_buf
 =ğ
NULL
)

1101 
	`OF_PRINT_ERROR
(("decode„ow %d index %d‡ss_buf %p\n",

1102 
row
, 
šdex
[row],*
ass_buf
));

1103 
”rÜ
;

1105 if(
h—dsz
 !ğ0 && *
ass_h—dbuf
 =ğ
NULL
){

1106 
	`OF_PRINT_ERROR
(("decode„ow %d index %d‡ss_headbuf %p\n",

1107 
row
, 
šdex
[row],*
ass_h—dbuf
));

1108 
”rÜ
;

1111 
	`OF_PRINT_LVL
(2,("decode„ow %d index %d‡ss_buf %p‡ss_headbuf %p\n",

1112 
row
, 
šdex
[row],*
ass_buf
, *
ass_h—dbuf
));

1115 
cŞ
 = 0 ; cŞ < 
k
 ; col++)

1117 
	`addmul
 ((
gf
 *)*
ass_buf
, 
pkt
[
cŞ
], 
m_dec
[
row
*
k
 + cŞ], 
size
) ;

1118 if(
h—dsz
 != 0)

1119 
	`addmul
 ((
gf
 *)*
ass_h—dbuf
, 
pkth—d
[
cŞ
], 
m_dec
[
row
*
k
 + cŞ], 
h—dsize
) ;

1122 
	`Of_SaveFe
("/mÁ/Üig_dec0", (
gf
 **)
ass_h—dbuf
, 
h—dsz
, 1);

1123 
	`Of_SaveFe
("/mÁ/Üig_dec0", (
gf
 **)
ass_buf
, 
sz
, 1);

1127 
	`Of_SaveFe
("/mÁ/Üig_dec0", &
pkth—d
[
row
], 
h—dsz
, 1);

1128 
	`Of_SaveFe
("/mÁ/Üig_dec0", &
pkt
[
row
], 
sz
, 1);

1137 
row
 = 0 ;„ow < 
k
 ;„ow++)

1139 ià(
šdex
[
row
] >ğ
k
)

1141 
	`bcİy
 (
Ãw_pkt
[
row
], 
pkt
[row], 
sz
* (
gf
));

1142 
	`ä“
 (
Ãw_pkt
[
row
]);

1145 
	`ä“
 (
Ãw_pkt
);

1147 
	`ä“
 (
m_dec
);

1149 
OF_EXIT_FUNCTION


1150  
OF_STATUS_OK
;

1151 
”rÜ
:

1152 
OF_EXIT_FUNCTION


1153  
OF_STATUS_ERROR
;

1154 
	}
}

1158 #ià
defšed
(
TEST
)

1160 
	$‹¡_gf
()

1162 
OF_ENTER_FUNCTION


1163 
i
 ;

1167 
i
 = 0; i <ğ
GF_SIZE
; i++)

1169 ià(
of_rs_gf_exp
[
of_rs_gf_log
[
i
]] != i)

1170 
	`OF_PRINT_ERROR
(("badƒxp/log i %d†og %dƒxp(log) %d\n",

1171 
i
, 
of_rs_gf_log
[i], 
of_rs_gf_exp
[of_rs_gf_log[i]]))

1173 ià(
i
 !ğ0 && 
	`of_gf_mul
 (i, 
of_rs_šv”£
[i]) != 1)

1174 
	`OF_PRINT_ERROR
(( "bad mul/inv i %d inv %d i*inv(i) %d\n",

1175 
i
, 
of_rs_šv”£
[i], 
	`of_gf_mul
 (i, of_rs_inverse[i])))

1176 ià(
	`of_gf_mul
 (0, 
i
) != 0)

1177 
	`OF_PRINT_ERROR
(("bad muÈbË 0,%d\n", 
i
))

1178 ià(
	`of_gf_mul
 (
i
, 0) != 0)

1179 
	`OF_PRINT_ERROR
(("bad muÈbË %d,0\n", 
i
))

1181 
OF_EXIT_FUNCTION


1182 
	}
}

	@src/lib_stable/reed-solomon_gf_2_8/of_reed-solomon_gf_2_8.h

34 #ifdeà
OF_USE_REED_SOLOMON_CODEC


36 #iâdeà
OF_REED_SOLOMON_GF_2_8_H


37 
	#OF_REED_SOLOMON_GF_2_8_H


	)

45 #iâdeà
GF_BITS


46 
	#GF_BITS
 8

	)

49 
	#GF_SIZE
 ((1 << 
GF_BITS
è- 1è

	)

55 
	sof_rs_cb


57 
of_codec_id_t
 
	mcodec_id
;

58 
of_codec_ty³_t
 
	mcodec_ty³
;

62 
UINT32
 
	mnb_sourû_symbŞs
;

63 
UINT32
 
	mnb_»·œ_symbŞs
;

64 
UINT32
 
	mnb_’codšg_symbŞs
;

66 
UINT32
 
	mmax_nb_sourû_symbŞs
;

68 
UINT32
 
	mmax_nb_’codšg_symbŞs
;

69 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

70 
UINT32
 
	m’codšg_h—d_Ëngth
;

72 *
	mrs_cb
;

74 #ifdeà
OF_USE_DECODER


82 ** 
	mavaabË_symbŞs_b
;

83 ** 
	mavaabË_h—dsymbŞs_b
;

86 
UINT32
 
	mnb_avaabË_symbŞs
;

88 
UINT32
 
	mnb_avaabË_sourû_symbŞs
;

89 
boŞ
 
	mdecodšg_fšished
;

93 * (*
	mdecoded_sourû_symbŞ_ÿÎback_Ãw
è(*
	mcÚ‹xt
,

94 **
	md©a
,

95 **
	mh—d
,

96 
UINT32
 
	msize
,

97 
UINT32
 
	mh—d_size
,

98 
UINT32
 
	mesi
);

99 * (*
	mdecoded_»·œ_symbŞ_ÿÎback_Ãw
è(*
	mcÚ‹xt
,

100 **
	md©a
,

101 **
	mh—d
,

102 
UINT32
 
	msize
,

103 
UINT32
 
	mh—d_size
,

104 
UINT32
 
	mesi
);

107 * (*
	mdecoded_sourû_symbŞ_ÿÎback
è(*
	mcÚ‹xt
,

108 
UINT32
 
	msize
,

109 
UINT32
 
	mesi
);

110 * (*
	mdecoded_»·œ_symbŞ_ÿÎback
è(*
	mcÚ‹xt
,

111 
UINT32
 
	msize
,

112 
UINT32
 
	mesi
);

113 * 
	mcÚ‹xt_4_ÿÎback
;

115 } 
	tof_rs_cb_t
;

133 
of_¡©us_t
 
of_rs_ü—‹_codec_š¡ªû
 (
of_rs_cb_t
** 
of_cb
);

146 
of_¡©us_t
 
of_rs_»Ëa£_codec_š¡ªû
 (
of_rs_cb_t
* 
ofcb
);

157 
of_¡©us_t
 
of_rs_£t_ãc_·¿m‘”s
 (
of_rs_cb_t
* 
ofcb
,

158 
of_rs_·¿m‘”s_t
* 
·¿ms
);

160 
of_¡©us_t
 
of_rs_£t_ÿÎback_funùiÚs_Ãw
 (
of_rs_cb_t
* 
ofcb
,

161 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

162 **
d©a
,

163 **
h—d
,

164 
UINT32
 
size
,

165 
UINT32
 
h—d_size
,

166 
UINT32
 
esi
),

167 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

168 **
d©a
,

169 **
h—d
,

170 
UINT32
 
size
,

171 
UINT32
 
h—d_size
,

172 
UINT32
 
esi
),

173 * 
cÚ‹xt_4_ÿÎback
);

200 
of_¡©us_t
 
of_rs_£t_ÿÎback_funùiÚs
 (
of_rs_cb_t
* 
ofcb
,

201 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

202 
UINT32
 
size
,

203 
UINT32
 
esi
),

204 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

205 
UINT32
 
size
,

206 
UINT32
 
esi
),

207 * 
cÚ‹xt_4_ÿÎback
);

209 #ifdeà
OF_USE_ENCODER


223 
of_¡©us_t
 
of_rs_bud_»·œ_symbŞ
 (
of_rs_cb_t
* 
ofcb
,

224 * 
’codšg_symbŞs_b
[],

225 * 
’codšg_h—ds_b
[],

226 
UINT32
 
esi_of_symbŞ_to_bud
,

227 
UINT32
 
’codšg_symbŞ_Ëngth
,

228 
UINT32
 
’codšg_h—d_Ëngth
);

231 #ifdeà
OF_USE_DECODER


242 
of_¡©us_t
 
of_rs_decode_w™h_Ãw_symbŞ
 (
of_rs_cb_t
* 
ofcb
,

243 * 
Ãw_symbŞ
,

244 * 
Ãw_symbŞh—d_buf
,

245 
UINT32
 
Ãw_symbŞ_esi
);

257 
of_¡©us_t
 
of_rs_£t_avaabË_symbŞs
 (
of_rs_cb_t
* 
ofcb
,

258 * cÚ¡ 
’codšg_symbŞs_b
[],

259 * cÚ¡ 
’codšg_symbŞh—ds_b
[]);

269 
of_¡©us_t
 
of_rs_fšish_decodšg
 (
of_rs_cb_t
* 
ofcb
);

278 
boŞ
 
of_rs_is_decodšg_com¶‘e
 (
of_rs_cb_t
* 
ofcb
);

280 
of_¡©us_t
 
of_rs_»£t_decodšg_¡©u
(
of_rs_cb_t
* 
ofcb
);

290 
of_¡©us_t
 
of_rs_g‘_sourû_symbŞs_b
 (
of_rs_cb_t
* 
ofcb
,

291 * 
sourû_symbŞs_b
[]);

293 
of_¡©us_t
 
of_rs_g‘_sourû_symbŞs_b_Ãw
 (
of_rs_cb_t
* 
ofcb
,

294 * 
sourû_symbŞs_b
[],

295 *
sourû_h—d_symbŞs_b
[]);

308 
of_¡©us_t
 
of_rs_£t_cÚŒŞ_·¿m‘”
 (
of_rs_cb_t
* 
ofcb
,

309 
UINT32
 
ty³
,

310 * 
v®ue
,

311 
UINT32
 
Ëngth
);

325 
of_¡©us_t
 
of_rs_g‘_cÚŒŞ_·¿m‘”
 (
of_rs_cb_t
* 
ofcb
,

326 
UINT32
 
ty³
,

327 * 
v®ue
,

328 
UINT32
 
Ëngth
);

335 
of_rs_ä“
 (*
p
) ;

337 * 
of_rs_Ãw
 (
UINT32
 
k
, UINT32 
n
) ;

339 
of_rs_š™
 () ;

341 
of_¡©us_t
 
of_rs_’code
 (*
code
, **
¤c
, *
d¡
, 
šdex
, 
sz
) ;

343 
of_¡©us_t
 
of_rs_decode
 (
of_rs_cb_t
* 
ofcb
,*
code
, **
pkt
, **
pkth—d
,
šdex
[], 
sz
 , 
h—dsz
) ;

345 
Of_SaveFe
(* 
feName
, **
pBuf
, 
symbŞSize
, 
tÙ®SymbŞ
);

	@src/lib_stable/reed-solomon_gf_2_8/of_reed-solomon_gf_2_8_api.c

34 
	~"of_»ed-sŞomÚ_gf_2_8_šşudes.h
"

36 #ifdeà
OF_USE_REED_SOLOMON_CODEC


39 
boŞ
 
	$of_rs_is_sourû_symbŞ
 (
of_rs_cb_t
* 
ofcb
,

40 
UINT32
 
Ãw_symbŞ_esi
)

42 ià(
Ãw_symbŞ_esi
 < 
ofcb
->
nb_sourû_symbŞs
)

43  
Œue
;

45  
çl£
;

46 
	}
}

49 
boŞ
 
	$of_rs_is_»·œ_symbŞ
 (
of_rs_cb_t
* 
ofcb
,

50 
UINT32
 
Ãw_symbŞ_esi
)

52 ià(
Ãw_symbŞ_esi
 < 
ofcb
->
nb_sourû_symbŞs
)

53  
çl£
;

55  
Œue
;

56 
	}
}

59 
of_¡©us_t
 
	$of_rs_ü—‹_codec_š¡ªû
 (
of_rs_cb_t
** 
of_cb
)

61 
of_codec_ty³_t
 
codec_ty³
;

62 
of_rs_cb_t
 *
cb
;

64 
OF_ENTER_FUNCTION


65 
cb
 = (
of_rs_cb_t
*è
	`of_»®loc
 (*
of_cb
,  (of_rs_cb_t));

66 *
of_cb
 = 
cb
;

69 
codec_ty³
 = 
cb
->codec_type;

70 
	`mem£t
(
cb
, 0, (*cb));

71 
cb
->
codec_ty³
 = codec_type;

72 
cb
->
codec_id
 = 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
;

73 
cb
->
max_nb_sourû_symbŞs
 = 
OF_REED_SOLOMON_MAX_NB_SOURCE_SYMBOLS_DEFAULT
;

74 
cb
->
max_nb_’codšg_symbŞs
 = 
OF_REED_SOLOMON_MAX_NB_ENCODING_SYMBOLS_DEFAULT
;

75 
OF_EXIT_FUNCTION


76  
OF_STATUS_OK
;

77 
	}
}

80 
of_¡©us_t
 
	$of_rs_»Ëa£_codec_š¡ªû
 (
of_rs_cb_t
* 
ofcb
)

82 
OF_ENTER_FUNCTION


83 
UINT32
 
i
;

84 ià(
ofcb
->
rs_cb
 !ğ
NULL
)

86 
	`of_rs_ä“
 (
ofcb
->
rs_cb
);

87 
ofcb
->
rs_cb
 = 
NULL
;

89 #ifdeà
OF_USE_DECODER


90 ià(
ofcb
->
avaabË_symbŞs_b
 !ğ
NULL
)

92 
	`of_ä“
(
ofcb
->
avaabË_symbŞs_b
);

93 
ofcb
->
avaabË_symbŞs_b
 = 
NULL
;

95 ià(
ofcb
->
avaabË_h—dsymbŞs_b
!ğ
NULL
)

97 
	`of_ä“
(
ofcb
->
avaabË_h—dsymbŞs_b
);

98 
ofcb
->
avaabË_h—dsymbŞs_b
ğ
NULL
;

101 
OF_EXIT_FUNCTION


102  
OF_STATUS_OK
;

103 
	}
}

106 
of_¡©us_t
 
	$of_rs_£t_ãc_·¿m‘”s
 (
of_rs_cb_t
* 
ofcb
,

107 
of_rs_·¿m‘”s_t
* 
·¿ms
)

109 
OF_ENTER_FUNCTION


110 ià((
ofcb
->
nb_sourû_symbŞs
 = 
·¿ms
->nb_sourû_symbŞsè> ofcb->
max_nb_sourû_symbŞs
) {

111 
	`OF_PRINT_ERROR
(("of_rs_set_fec_parameters: ERROR, invalid‚b_source_symbols…arameter (got %d, maximum is %d)",

112 
ofcb
->
nb_sourû_symbŞs
, ofcb->
max_nb_sourû_symbŞs
));

113 
”rÜ
;

115 
ofcb
->
nb_sourû_symbŞs
 = 
·¿ms
->nb_source_symbols;

116 
ofcb
->
nb_»·œ_symbŞs
 = 
·¿ms
->nb_repair_symbols;

117 
ofcb
->
’codšg_symbŞ_Ëngth
 = 
·¿ms
->encoding_symbol_length;

118 
ofcb
->
’codšg_h—d_Ëngth
 = 
·¿ms
->encoding_head_length;

119 
ofcb
->
nb_’codšg_symbŞs
 = ofcb->
nb_sourû_symbŞs
 + ofcb->
nb_»·œ_symbŞs
;

120 #ifdeà
OF_USE_DECODER


121 
ofcb
->
avaabË_symbŞs_b
 = (**è
	`of_ÿÎoc
 (ofcb->
nb_’codšg_symbŞs
,  (*));

122 
ofcb
->
avaabË_h—dsymbŞs_b
 = (**è
	`of_ÿÎoc
 (ofcb->
nb_’codšg_symbŞs
,  (*));

123 
ofcb
->
nb_avaabË_symbŞs
 = 0;

124 
ofcb
->
nb_avaabË_sourû_symbŞs
 = 0;

126 
OF_EXIT_FUNCTION


127  
OF_STATUS_OK
;

129 
”rÜ
:

130 
OF_EXIT_FUNCTION


131  
OF_STATUS_FATAL_ERROR
;

132 
	}
}

134 
of_¡©us_t
 
	$of_rs_£t_ÿÎback_funùiÚs_Ãw
 (
of_rs_cb_t
* 
ofcb
,

135 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

136 **
d©a
,

137 **
h—d
,

138 
UINT32
 
size
,

139 
UINT32
 
h—d_size
,

140 
UINT32
 
esi
),

141 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

142 **
d©a
,

143 **
h—d
,

144 
UINT32
 
size
,

145 
UINT32
 
h—d_size
,

146 
UINT32
 
esi
),

147 * 
cÚ‹xt_4_ÿÎback
)

149 
ofcb
->
decoded_sourû_symbŞ_ÿÎback_Ãw
 = 
decoded_sourû_symbŞ_ÿÎback
;

150 
ofcb
->
decoded_»·œ_symbŞ_ÿÎback_Ãw
 = 
decoded_»·œ_symbŞ_ÿÎback
;

151 
ofcb
->
cÚ‹xt_4_ÿÎback
 = context_4_callback;

152 ià(
ofcb
->
decoded_»·œ_symbŞ_ÿÎback_Ãw
 !ğ
NULL
)

154 
	`OF_PRINT_ERROR
(("of_rs_set_callback_functions: Warning,he decoded„epair symbol callback is‚ever called with Reed-Solomon codes, sincehose„epair symbols‡re‚ever decoded\n"))

156  
OF_STATUS_OK
;

157 
	}
}

159 
of_¡©us_t
 
	$of_rs_£t_ÿÎback_funùiÚs
 (
of_rs_cb_t
* 
ofcb
,

160 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

161 
UINT32
 
size
,

162 
UINT32
 
esi
),

163 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

164 
UINT32
 
size
,

165 
UINT32
 
esi
),

166 * 
cÚ‹xt_4_ÿÎback
)

168 
ofcb
->
decoded_sourû_symbŞ_ÿÎback
 = decoded_source_symbol_callback;

169 
ofcb
->
decoded_»·œ_symbŞ_ÿÎback
 = decoded_repair_symbol_callback;

170 
ofcb
->
cÚ‹xt_4_ÿÎback
 = context_4_callback;

171 ià(
ofcb
->
decoded_»·œ_symbŞ_ÿÎback
 !ğ
NULL
)

173 
	`OF_PRINT_ERROR
(("of_rs_set_callback_functions: Warning,he decoded„epair symbol callback is‚ever called with Reed-Solomon codes, sincehose„epair symbols‡re‚ever decoded\n"))

175  
OF_STATUS_OK
;

176 
	}
}

179 #ifdeà
OF_USE_ENCODER


180 
of_¡©us_t
 
	$of_rs_bud_»·œ_symbŞ
 (
of_rs_cb_t
* 
ofcb
,

181 * 
’codšg_symbŞs_b
[],

182 * 
’codšg_h—ds_b
[],

183 
UINT32
 
esi_of_symbŞ_to_bud
,

184 
UINT32
 
’codšg_symbŞ_Ëngth
,

185 
UINT32
 
’codšg_h—d_Ëngth
)

187 
OF_ENTER_FUNCTION


188 ià(
esi_of_symbŞ_to_bud
 < 
ofcb
->
nb_sourû_symbŞs
 ||ƒsi_of_symbŞ_to_bud >ğofcb->
nb_’codšg_symbŞs
)

190 
	`OF_PRINT_ERROR
(("of_rs_build_repair_symbol: Error, badƒsi ofƒncoding symbol (%d)[%d-%d]",

191 
esi_of_symbŞ_to_bud
, 
ofcb
->
nb_sourû_symbŞs
, ofcb->
nb_’codšg_symbŞs
))

192 
”rÜ
;

194 ià(
’codšg_symbŞs_b
[
esi_of_symbŞ_to_bud
] =ğ
NULL
)

196 ià((
’codšg_symbŞs_b
[
esi_of_symbŞ_to_bud
] = 
	`of_ÿÎoc
 (1, 
ofcb
->
’codšg_symbŞ_Ëngth
)è=ğ
NULL
)

198 
	`OF_PRINT_ERROR
(("of_rs_build_repair_symbol: Error,‚o memory\n"))

199 
”rÜ
;

203 ià(
’codšg_h—ds_b
[
esi_of_symbŞ_to_bud
] =ğ
NULL
)

205 ià((
’codšg_h—ds_b
[
esi_of_symbŞ_to_bud
] = 
	`of_ÿÎoc
 (1, 
ofcb
->
’codšg_h—d_Ëngth
)è=ğ
NULL
)

207 
	`OF_PRINT_ERROR
(("of_rs_build_repair_symbol: head Error,‚o memory\n"))

208 
”rÜ
;

211 ià(
ofcb
->
rs_cb
 =ğ
NULL
)

215 
ofcb
->
rs_cb
 = 
	`of_rs_Ãw
 (ofcb->
nb_sourû_symbŞs
, ofcb->
nb_’codšg_symbŞs
);

216 ià(
ofcb
->
rs_cb
 =ğ
NULL
)

218 
	`OF_PRINT_ERROR
(("of_rs_build_repair_symbol: Error, of_rs_new failed"))

219 
”rÜ
;

222 ià(
	`of_rs_’code
(
ofcb
->
rs_cb
,

223 
’codšg_symbŞs_b
,

224 
’codšg_symbŞs_b
[
esi_of_symbŞ_to_bud
],

225 
esi_of_symbŞ_to_bud
,

226 
’codšg_symbŞ_Ëngth
è!ğ
OF_STATUS_OK
)

228 
	`OF_PRINT_ERROR
(("of_rs_build_repair_symbol: Error, of_rs_encode failed"))

229 
”rÜ
;

231 ià(
	`of_rs_’code
(
ofcb
->
rs_cb
,

232 
’codšg_h—ds_b
,

233 
’codšg_h—ds_b
[
esi_of_symbŞ_to_bud
],

234 
esi_of_symbŞ_to_bud
,

235 
’codšg_h—d_Ëngth
è!ğ
OF_STATUS_OK
)

237 
	`OF_PRINT_ERROR
(("of_rs_build_repair_symbol: head Error, of_rs_encode failed"))

238 
”rÜ
;

240 
OF_EXIT_FUNCTION


241  
OF_STATUS_OK
;

243 
”rÜ
:

244 
OF_EXIT_FUNCTION


245  
OF_STATUS_ERROR
;

246 
	}
}

250 #ifdeà
OF_USE_DECODER


251 
of_¡©us_t
 
	$of_rs_decode_w™h_Ãw_symbŞ
 (
of_rs_cb_t
* 
ofcb
,

252 * 
Ãw_symbŞ
,

253 * 
Ãw_symbŞh—d_buf
,

254 
UINT32
 
Ãw_symbŞ_esi
)

256 
OF_ENTER_FUNCTION


257 
	`OF_TRACE_LVL
(2,("avail %d source %d decoding_finished %d\n",

258 
ofcb
->
nb_avaabË_symbŞs
,

259 
ofcb
->
nb_sourû_symbŞs
,

260 
ofcb
->
decodšg_fšished
))

261 ià(
ofcb
->
decodšg_fšished
)

263 
	`OF_TRACE_LVL
(2, ("of_rs_decode_with_new_symbol: decoding‡lready done\n"));

264  
OF_STATUS_OK
;

266 ià(
ofcb
->
avaabË_symbŞs_b
[
Ãw_symbŞ_esi
] !ğ
NULL
)

269 
	`OF_TRACE_LVL
(2, ("of_rs_decode_w™h_Ãw_symbŞ: symbŞ (esi=%dèdu¶iÿ‹d\n", 
Ãw_symbŞ_esi
));

270 
’d
;

272 
ofcb
->
avaabË_symbŞs_b
[
Ãw_symbŞ_esi
] = 
Ãw_symbŞ
;

273 
ofcb
->
avaabË_h—dsymbŞs_b
[
Ãw_symbŞ_esi
] = 
Ãw_symbŞh—d_buf
;

274 
ofcb
->
nb_avaabË_symbŞs
++;

275 ià(
Ãw_symbŞ_esi
 < 
ofcb
->
nb_sourû_symbŞs
)

278 
ofcb
->
nb_avaabË_sourû_symbŞs
++;

281 ià(
ofcb
->
nb_avaabË_sourû_symbŞs
 =ğofcb->
nb_sourû_symbŞs
)

286 
	`Of_SaveFe
("/háe¡/Üig_dec0", (
gf
 **)
ofcb
->
avaabË_symbŞs_b
,

287 
ofcb
->
’codšg_symbŞ_Ëngth
, ofcb->
nb_sourû_symbŞs
);

288 
ofcb
->
decodšg_fšished
 = 
Œue
;

289 
	`OF_TRACE_LVL
(2, ("of_rs_decode_with_new_symbol: done,‡ll source symbols have been„eceived\n"));

290 
OF_EXIT_FUNCTION


291  
OF_STATUS_OK
;

293 
	`OF_TRACE_LVL
(2,("avail %d source %d \n",

294 
ofcb
->
nb_avaabË_symbŞs
,

295 
ofcb
->
nb_sourû_symbŞs
))

296 ià(
ofcb
->
nb_avaabË_symbŞs
 >ğofcb->
nb_sourû_symbŞs
)

299 ià(
	`of_rs_fšish_decodšg
(
ofcb
è!ğ
OF_STATUS_OK
)

301 
	`OF_PRINT_ERROR
(("of_rs_decode_with_new_symbol: Error, of_rs_decode failure\n"))

302 
”rÜ
;

304 
	`ASSERT
(
ofcb
->
decodšg_fšished
 =ğ
Œue
);

305 
	`OF_TRACE_LVL
(2, ("of_rs_decode_with_new_symbol: done, decoding successful\n"));

306 
OF_EXIT_FUNCTION


307  
OF_STATUS_OK
;

309 
’d
:

310 
	`OF_TRACE_LVL
(2, ("of_rs_decode_with_new_symbol: okay, but‚ot yet finished\n"));

311 
OF_EXIT_FUNCTION


312  
OF_STATUS_OK
;

314 
”rÜ
:

315 
OF_EXIT_FUNCTION


316  
OF_STATUS_ERROR
;

317 
	}
}

320 
of_¡©us_t
 
	$of_rs_£t_avaabË_symbŞs
 (
of_rs_cb_t
* 
ofcb
,

321 * cÚ¡ 
’codšg_symbŞs_b
[],

322 * cÚ¡ 
’codšg_symbŞh—ds_b
[])

324 
UINT32
 
i
;

326 
OF_ENTER_FUNCTION


327 
ofcb
->
nb_avaabË_symbŞs
 = 0;

328 
ofcb
->
nb_avaabË_sourû_symbŞs
 = 0;

329 
i
 = 0; i < 
ofcb
->
nb_’codšg_symbŞs
; i++)

331 
ofcb
->
avaabË_h—dsymbŞs_b
[
i
] = 
’codšg_symbŞh—ds_b
[i];

332 ià((
ofcb
->
avaabË_symbŞs_b
[
i
] = 
’codšg_symbŞs_b
[i]è=ğ
NULL
)

336 ià(
i
 < 
ofcb
->
nb_sourû_symbŞs
)

338 
ofcb
->
nb_avaabË_sourû_symbŞs
++;

340 
ofcb
->
nb_avaabË_symbŞs
++;

342 
OF_EXIT_FUNCTION


343  
OF_STATUS_OK
;

344 
	}
}

347 
of_¡©us_t
 
	$of_rs_fšish_decodšg
 (
of_rs_cb_t
* 
ofcb
)

349 
UINT32
 
k
;

350 
UINT32
 
n
;

351 *
tmp_buf
[
GF_SIZE
];

352 
tmp_esi
[
GF_SIZE
];

353 *
tmp_h—dbuf
[
GF_SIZE
];

357 
INT32
 
tmp_idx
;

358 *
Ïrge_buf
 = 
NULL
;

359 
UINT32
 
off
;

360 **
ass_buf
;

362 **
ass_h—dbuf
;

363 
UINT32
 
ass_esi
;

364 **
¬s_buf
;

366 **
¬s_h—dbuf
;

367 
UINT32
 
¬s_esi
;

369 
OF_ENTER_FUNCTION


370 
	`OF_TRACE_LVL
(2,("decoding_finished %d‡vail %d %d source %dƒncode %d\n",

371 
ofcb
->
decodšg_fšished
,

372 
ofcb
->
nb_avaabË_symbŞs
,

373 
ofcb
->
nb_avaabË_sourû_symbŞs
,

374 
ofcb
->
nb_sourû_symbŞs
,

375 
ofcb
->
nb_’codšg_symbŞs
))

376 ià(
ofcb
->
decodšg_fšished
)

378  
OF_STATUS_OK
;

380 
k
 = 
ofcb
->
nb_sourû_symbŞs
;

381 
n
 = 
ofcb
->
nb_’codšg_symbŞs
;

382 ià(
ofcb
->
nb_avaabË_symbŞs
 < 
k
)

384 
	`OF_PRINT_ERROR
(("of_rs_finish_decoding: Error,‚b„eceived symbols %d <‚b source symbols %d\n",

385 
ofcb
->
nb_avaabË_symbŞs
, ofcb->
nb_sourû_symbŞs
))

386 
OF_EXIT_FUNCTION


387  
OF_STATUS_FAILURE
;

389 ià(
ofcb
->
nb_avaabË_sourû_symbŞs
 =ğ
k
)

394 
ofcb
->
decodšg_fšished
 = 
Œue
;

395 
OF_EXIT_FUNCTION


396  
OF_STATUS_OK
;

404 
Ïrge_buf
 = (*è
	`of_m®loc
(
k
 * 
ofcb
->
’codšg_symbŞ_Ëngth
);

405 ià(
Ïrge_buf
 =ğ
NULL
)

407 
no_mem
;

411 
tmp_idx
 = 0, 
off
 = 0;mp_idx < 
k
;mp_idx++, ofà+ğ
ofcb
->
’codšg_symbŞ_Ëngth
) {

412 
tmp_buf
[
tmp_idx
] = 
Ïrge_buf
 + 
off
;

414 
tmp_idx
 = 0;

423 
ass_esi
 = 0;

424 
¬s_esi
 = 
k
;

425 
ass_buf
 = 
ofcb
->
avaabË_symbŞs_b
;

426 
¬s_buf
 = 
ofcb
->
avaabË_symbŞs_b
 + 
k
;

428 
ass_h—dbuf
 = 
ofcb
->
avaabË_h—dsymbŞs_b
;

429 
¬s_h—dbuf
 = 
ofcb
->
avaabË_h—dsymbŞs_b
 + 
k
;

430 
tmp_idx
 = 0;mp_idx < 
k
;mp_idx++)

432 ià(*
ass_buf
 =ğ
NULL
)

435 *
¬s_buf
 =ğ
NULL
)

437 
¬s_esi
++;

438 
¬s_buf
++;

439 
¬s_h—dbuf
++;

441 
	`OF_TRACE_LVL
(2, ("of_rs_finish_decoding: copy„epair withƒsi=%d inmp_buf[%d %p %p]\n",

442 
¬s_esi
, 
tmp_idx
, *
¬s_buf
, *
¬s_h—dbuf
))

444 
tmp_buf
[
tmp_idx
] = *
¬s_buf
;

445 
tmp_h—dbuf
[
tmp_idx
] =*
¬s_h—dbuf
;

446 
tmp_esi
[
tmp_idx
] = 
¬s_esi
;

447 
¬s_esi
++;

448 
¬s_buf
++;

449 
¬s_h—dbuf
++;

453 
	`OF_TRACE_LVL
(2, ("of_rs_finish_decoding: copy source withƒsi=%d inmp_buf[%d %p %p]\n",

454 
ass_esi
, 
tmp_idx
 , *
ass_buf
, *
ass_h—dbuf
))

456 
tmp_buf
[
tmp_idx
] = *
ass_buf
;

457 
tmp_h—dbuf
[
tmp_idx
] =*
ass_h—dbuf
;

458 
tmp_esi
[
tmp_idx
] = 
ass_esi
;

460 
ass_esi
++;

461 
ass_buf
++;

462 
ass_h—dbuf
++;

465 
tmp_idx
 = 0;mp_idx < 
k
;mp_idx++)

467 
	`OF_TRACE_LVL
(2, ("BefÜof_rs_decode:ƒsi=%d, k=%d,mp_idx=%d\n", 
tmp_esi
[
tmp_idx
], 
k
,mp_idx))

474 if(
NULL
 =ğ
ofcb
->
rs_cb
){

475 
ofcb
->
rs_cb
 = 
	`of_rs_Ãw
 (ofcb->
nb_sourû_symbŞs
, ofcb->
nb_’codšg_symbŞs
);

477 ià(
	`of_rs_decode
 (
ofcb
, ofcb->
rs_cb
, (**)
tmp_buf
, (**)
tmp_h—dbuf
,

478 (*)
tmp_esi
,

479 
ofcb
->
’codšg_symbŞ_Ëngth
,

480 
ofcb
->
’codšg_h—d_Ëngth
è!ğ
OF_STATUS_OK
)

482 
	`OF_PRINT_ERROR
(("of_rs_finish_decoding: Error, of_rs_decode failure\n"))

483 
”rÜ
;

487 
ofcb
->
decodšg_fšished
 = 
Œue
;

488 
	`OF_TRACE_LVL
(2,("of_rs_finish_decoding: suc\n"))

490 
tmp_idx
 = 0;mp_idx < 
k
;mp_idx++)

492 
	`OF_TRACE_LVL
(2, ("Aá” of_rs_decode:ƒsi=%d, k=%d,mp_idx=%d\n", 
tmp_esi
[
tmp_idx
], 
k
,mp_idx))

499 
tmp_idx
 = 0;mp_idx < 
k
;mp_idx++)

501 
	`ASSERT
(
tmp_idx
 < 
k
);

502 
ass_buf
 = &(
ofcb
->
avaabË_symbŞs_b
[
tmp_idx
]);

503 ià(*
ass_buf
 !ğ
NULL
)

514 ià(
ofcb
->
decoded_sourû_symbŞ_ÿÎback
 !ğ
NULL
)

516 *
ass_buf
 = 
ofcb
->
	`decoded_sourû_symbŞ_ÿÎback
 (ofcb->
cÚ‹xt_4_ÿÎback
,

517 
ofcb
->
’codšg_symbŞ_Ëngth
, 
tmp_idx
);

521 *
ass_buf
 = (*è
	`of_m®loc
 (
ofcb
->
’codšg_symbŞ_Ëngth
);

523 ià(*
ass_buf
 =ğ
NULL
)

525 
no_mem
;

527 
	`memıy
(*
ass_buf
, 
tmp_buf
[
tmp_idx
], 
ofcb
->
’codšg_symbŞ_Ëngth
);

528 
	`OF_TRACE_LVL
(2, ("of_rs_finish_decoding: decoded source symbolƒsi=%d frommp_buf[%d]\n",

529 
tmp_idx
,mp_idx))

533 
OF_EXIT_FUNCTION


534  
OF_STATUS_OK
;

535 
no_mem
:

536 
	`OF_PRINT_ERROR
(("of_rs_finish_decoding: out of memory.\n"))

538 
”rÜ
:

539 
OF_EXIT_FUNCTION


540  
OF_STATUS_ERROR
;

541 
	}
}

543 
of_¡©us_t
 
	$of_rs_»£t_decodšg_¡©u
(
of_rs_cb_t
* 
ofcb
){

544 
OF_ENTER_FUNCTION


545 
OF_EXIT_FUNCTION


546 
i
 =0;

547 
ofcb
->
decodšg_fšished
 = 
çl£
;

548 
ofcb
->
nb_avaabË_symbŞs
 = 0;

549 
ofcb
->
nb_avaabË_sourû_symbŞs
 = 0;

550 
i
 =0 ; i < 
ofcb
->
nb_’codšg_symbŞs
; i++){

551 
ofcb
->
avaabË_symbŞs_b
[
i
] = 
NULL
;

552 
ofcb
->
avaabË_h—dsymbŞs_b
[
i
] = 
NULL
;

555  
OF_STATUS_OK
;

556 
	}
}

558 
boŞ
 
	$of_rs_is_decodšg_com¶‘e
 (
of_rs_cb_t
* 
ofcb
)

560 
OF_ENTER_FUNCTION


561 
OF_EXIT_FUNCTION


562  
ofcb
->
decodšg_fšished
;

563 
	}
}

565 
of_¡©us_t
 
	$of_rs_g‘_sourû_symbŞs_b_Ãw
 (
of_rs_cb_t
* 
ofcb
,

566 * 
sourû_symbŞs_b
[],

567 *
sourû_h—d_symbŞs_b
[])

569 
OF_ENTER_FUNCTION


570 ià(
	`of_rs_is_decodšg_com¶‘e
(
ofcb
è=ğ
çl£
)

572 
	`OF_PRINT_ERROR
(("of_rs_get_source_symbols_tab: Error, decoding‚ot complete.\n"))

573 
OF_EXIT_FUNCTION


574  
OF_STATUS_ERROR
;

577 
UINT32
 
i
;

578 
i
 = 0; i < 
ofcb
->
nb_sourû_symbŞs
; i++)

580 ià(
sourû_symbŞs_b
[
i
] =ğ
NULL
)

582 
sourû_symbŞs_b
[
i
] = 
ofcb
->
avaabË_symbŞs_b
[i];

586 
	`memıy
(
sourû_symbŞs_b
, 
ofcb
->
avaabË_symbŞs_b
, ofcb->
nb_sourû_symbŞs
 * (*));

587 
	`memıy
(
sourû_h—d_symbŞs_b
, 
ofcb
->
avaabË_h—dsymbŞs_b
, ofcb->
nb_sourû_symbŞs
 * (*));

589 
OF_EXIT_FUNCTION


590  
OF_STATUS_OK
;

591 
	}
}

593 
of_¡©us_t
 
	$of_rs_g‘_sourû_symbŞs_b
 (
of_rs_cb_t
* 
ofcb
,

594 * 
sourû_symbŞs_b
[])

596 
OF_ENTER_FUNCTION


597 ià(
	`of_rs_is_decodšg_com¶‘e
(
ofcb
è=ğ
çl£
)

599 
	`OF_PRINT_ERROR
(("of_rs_get_source_symbols_tab: Error, decoding‚ot complete.\n"))

600 
OF_EXIT_FUNCTION


601  
OF_STATUS_ERROR
;

604 
UINT32
 
i
;

605 
i
 = 0; i < 
ofcb
->
nb_sourû_symbŞs
; i++)

607 ià(
sourû_symbŞs_b
[
i
] =ğ
NULL
)

609 
sourû_symbŞs_b
[
i
] = 
ofcb
->
avaabË_symbŞs_b
[i];

613 
	`memıy
(
sourû_symbŞs_b
, 
ofcb
->
avaabË_symbŞs_b
, ofcb->
nb_sourû_symbŞs
 * (*));

615 
OF_EXIT_FUNCTION


616  
OF_STATUS_OK
;

617 
	}
}

622 
of_¡©us_t
 
	$of_rs_£t_cÚŒŞ_·¿m‘”
 (
of_rs_cb_t
* 
ofcb
,

623 
UINT32
 
ty³
,

624 * 
v®ue
,

625 
UINT32
 
Ëngth
)

627 
	`OF_PRINT_ERROR
(("of_rs_set_control_parameter: ERROR,‚ot implemented...\n"))

628  
OF_STATUS_ERROR
;

629 
	}
}

632 
of_¡©us_t
 
	$of_rs_g‘_cÚŒŞ_·¿m‘”
 (
of_rs_cb_t
* 
ofcb
,

633 
UINT32
 
ty³
,

634 * 
v®ue
,

635 
UINT32
 
Ëngth
)

637 
OF_ENTER_FUNCTION


638 
ty³
) {

639 
OF_CTRL_GET_MAX_K
:

640 ià(
v®ue
 =ğ
NULL
 || 
Ëngth
 !ğ(
UINT32
)) {

641 
	`OF_PRINT_ERROR
(("%s: OF_CTRL_GET_MAX_K ERROR:‚ull value or bad†ength (got %d,ƒxpected %ld)\n",

642 
__FUNCTION__
, 
Ëngth
, (
UINT32
)))

643 
”rÜ
;

645 *(
UINT32
*)
v®ue
 = 
ofcb
->
max_nb_sourû_symbŞs
;

646 
	`OF_TRACE_LVL
(1, ("%s: OF_CTRL_GET_MAX_K (%d)\n", 
__FUNCTION__
, *(
UINT32
*)
v®ue
))

649 
OF_CTRL_GET_MAX_N
:

650 ià(
v®ue
 =ğ
NULL
 || 
Ëngth
 !ğ(
UINT32
)) {

651 
	`OF_PRINT_ERROR
(("%s: OF_CTRL_GET_MAX_N ERROR:‚ull value or bad†ength (got %d,ƒxpected %ld)\n",

652 
__FUNCTION__
, 
Ëngth
, (
UINT32
)))

653 
”rÜ
;

655 *(
UINT32
*)
v®ue
 = 
ofcb
->
max_nb_’codšg_symbŞs
;

656 
	`OF_TRACE_LVL
(1, ("%s: OF_CTRL_GET_MAX_N (%d)\n", 
__FUNCTION__
, *(
UINT32
*)
v®ue
))

660 
	`OF_PRINT_ERROR
(("%s: unknowÀty³ (%d)\n", 
__FUNCTION__
, 
ty³
))

661 
”rÜ
;

663 
OF_EXIT_FUNCTION


664  
OF_STATUS_OK
;

666 
”rÜ
:

667 
OF_EXIT_FUNCTION


668  
OF_STATUS_ERROR
;

669 
	}
}

	@src/lib_stable/reed-solomon_gf_2_8/of_reed-solomon_gf_2_8_api.h

34 #ifdeà
OF_USE_REED_SOLOMON_CODEC


36 #iâdeà
OF_REED_SOLOMON_GF_2_8_API_H


37 
	#OF_REED_SOLOMON_GF_2_8_API_H


	)

46 
	sof_rs_·¿m‘”s


48 
UINT32
 
	mnb_sourû_symbŞs
;

49 
UINT32
 
	mnb_»·œ_symbŞs
;

50 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

51 
UINT32
 
	m’codšg_h—d_Ëngth
;

56 } 
	tof_rs_·¿m‘”s_t
;

	@src/lib_stable/reed-solomon_gf_2_8/of_reed-solomon_gf_2_8_includes.h

34 #iâdeà
OF_REED_SOLOMON_INCLUDES_H


35 
	#OF_REED_SOLOMON_INCLUDES_H


	)

37 
	~<¡dio.h
>

38 
	~<¡dlib.h
>

39 
	~<¡dšt.h
>

40 
	~<¡ršg.h
>

42 
	~"../../lib_commÚ/of_İ’ãc_­i.h
"

48 #ifdeà
OF_USE_REED_SOLOMON_CODEC


50 
	~"../../lib_commÚ/lš—r_bš¬y_codes_uts/of_lš—r_bš¬y_code.h
"

52 
	~"of_»ed-sŞomÚ_gf_2_8_­i.h
"

53 
	~"of_»ed-sŞomÚ_gf_2_8.h
"

	@src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/algebra_2_4.c

34 
	~"®geb¿_2_4.h
"

36 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


38 
	#UNROLL
 16

	)

39 
	#USE_GF_MULC
 
gf
 * 
__gf_mulc_


	)

40 
	#GF_MULC0
(
c
è
__gf_mulc_
 = (
gf
*)
of_gf_2_4_mul_bË
[c]

	)

41 
	#GF_OPT_MULC0
(
c
è
__gf_mulc_
 = (
gf
*)
of_gf_2_4_İt_mul_bË
[c]

	)

42 
	#GF_ADDMULC
(
d¡
, 
x
è{d¡ ^ğ
__gf_mulc_
[x];}

	)

43 
	#GF_ADDMULC_COMPACT
(
d¡
,
x
è{d¡ = (d¡>>4 ^ 
__gf_mulc_
[x>>4])<<4 |(d¡ & 0x0F ^ __gf_mulc_[x & 0x0F]); }

	)

58 
	$of_g®ois_f›ld_2_4_addmul1
(
gf
 *
d¡1
, gà*
¤c1
, gà
c
, 
sz
)

60 
USE_GF_MULC
 ;

61 
gf
 *
d¡
 = 
d¡1
, *
¤c
 = 
¤c1
 ;

62 if(
sz
 >= 8){

63 
	#UNROLL
 16

	)

65 
	#UNROLL
 8

	)

67 
gf
 *
lim
 = &
d¡
[
sz
 - 
UNROLL
 + 1] ;

68 #ià((
	`defšed
 (
__LP64__
è|| (
__WORDSIZE
 =ğ64)è&& !defšed (
OF_RS_2M_USE_32BITS
))

69 
UINT64
 
tmp
;

70 
UINT64
 *
d¡_64
 = (UINT64*)
d¡1
;

72 
UINT32
 
tmp
;

73 
UINT32
 *
d¡_32
 = (UINT32*)
d¡1
;

75 
	`GF_MULC0
 (
c
) ;

77 #ià(
UNROLL
 > 1)

78 ; 
d¡
 < 
lim
 ;d¡ +ğ
UNROLL
, 
¤c
 += UNROLL)

80 #ià((
	`defšed
 (
__LP64__
è|| (
__WORDSIZE
 =ğ64)è&& !defšed (
OF_RS_2M_USE_32BITS
))

82 
tmp
 = ((
UINT64
)
__gf_mulc_
[
¤c
[0]]) | ((UINT64)__gf_mulc_[src[1]]<<8) | ((UINT64)__gf_mulc_[src[2]]<<16) |

83 ((
UINT64
)
__gf_mulc_
[
¤c
[3]]<<24) | ((UINT64)__gf_mulc_[src[4]]<<32) | ((UINT64)__gf_mulc_[src[5]]<<40) |

84 ((
UINT64
)
__gf_mulc_
[
¤c
[6]]<<48) | ((UINT64)__gf_mulc_[src[7]]<<56) ;

85 *
d¡_64
 ^ğ
tmp
;

86 
d¡_64
++;

87 #ià(
UNROLL
 > 8)

88 
tmp
 = ((
UINT64
)
__gf_mulc_
[
¤c
[8]]) | ((UINT64)__gf_mulc_[src[9]]<<8) | ((UINT64)__gf_mulc_[src[10]]<<16) |

89 ((
UINT64
)
__gf_mulc_
[
¤c
[11]]<<24) | ((UINT64)__gf_mulc_[src[12]]<<32) | ((UINT64)__gf_mulc_[src[13]]<<40) |

90 ((
UINT64
)
__gf_mulc_
[
¤c
[14]]<<48) | ((UINT64)__gf_mulc_[src[15]]<<56) ;

91 *
d¡_64
 ^ğ
tmp
;

92 
d¡_64
++;

96 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[0]]) | ((UINT32)__gf_mulc_[src[1]]<<8) | ((UINT32)__gf_mulc_[src[2]]<<16) |

97 ((
UINT32
)
__gf_mulc_
[
¤c
[3]]<<24);

98 *
d¡_32
 ^ğ
tmp
;

99 
d¡_32
++;

100 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[4]]) | ((UINT32)__gf_mulc_[src[5]]<<8) | ((UINT32)__gf_mulc_[src[6]]<<16) |

101 ((
UINT32
)
__gf_mulc_
[
¤c
[7]]<<24);

102 *
d¡_32
 ^ğ
tmp
;

103 
d¡_32
++;

104 #ià(
UNROLL
 > 8)

105 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[8]]) | ((UINT32)__gf_mulc_[src[9]]<<8) | ((UINT32)__gf_mulc_[src[10]]<<16) |

106 ((
UINT32
)
__gf_mulc_
[
¤c
[11]]<<24);

107 *
d¡_32
 ^ğ
tmp
;

108 
d¡_32
++;

109 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[12]]) | ((UINT32)__gf_mulc_[src[13]]<<8) | ((UINT32)__gf_mulc_[src[14]]<<16) |

110 ((
UINT32
)
__gf_mulc_
[
¤c
[15]]<<24);

111 *
d¡_32
 ^ğ
tmp
;

112 
d¡_32
++;

117 
lim
 +ğ
UNROLL
 - 1 ;

118 ; 
d¡
 < 
lim
; d¡++, 
¤c
++) {

120 
	`GF_ADDMULC
 (*
d¡
 , *
¤c
);

122 
	}
}

135 
	$of_g®ois_f›ld_2_4_addmul1_com·ù
 (
gf
 *
d¡1
, gà*
¤c1
, gà
c
, 
sz
)

137 
USE_GF_MULC
 ;

138 
gf
 *
d¡
 = 
d¡1
, *
¤c
 = 
¤c1
 ;

139 if(
sz
 >= 8){

140 
	#UNROLL
 16

	)

142 
	#UNROLL
 8

	)

144 
gf
 *
lim
 = &
d¡
[
sz
 - 
UNROLL
 + 1] ;

145 #ià((
	`defšed
 (
__LP64__
è|| (
__WORDSIZE
 =ğ64)è&& !defšed (
OF_RS_2M_USE_32BITS
))

146 
UINT64
 
tmp
;

147 
UINT64
 *
d¡_64
 = (UINT64*)
d¡1
;

149 
UINT32
 
tmp
;

150 
UINT32
 *
d¡_32
 = (UINT32*)
d¡1
;

152 
	`GF_OPT_MULC0
(
c
);

154 #ià(
UNROLL
 > 1)

155 ; 
d¡
 < 
lim
 ;d¡ +ğ
UNROLL
, 
¤c
 += UNROLL)

157 #ià((
	`defšed
 (
__LP64__
è|| (
__WORDSIZE
 =ğ64)è&& !defšed (
OF_RS_2M_USE_32BITS
))

159 
tmp
 = ((
UINT64
)
__gf_mulc_
[
¤c
[0]]) | ((UINT64)__gf_mulc_[src[1]]<<8) | ((UINT64)__gf_mulc_[src[2]]<<16) |

160 ((
UINT64
)
__gf_mulc_
[
¤c
[3]]<<24) | ((UINT64)__gf_mulc_[src[4]]<<32) | ((UINT64)__gf_mulc_[src[5]]<<40) |

161 ((
UINT64
)
__gf_mulc_
[
¤c
[6]]<<48) | ((UINT64)__gf_mulc_[src[7]]<<56) ;

162 *
d¡_64
 ^ğ
tmp
;

163 
d¡_64
++;

164 #ià(
UNROLL
 > 8)

165 
tmp
 = ((
UINT64
)
__gf_mulc_
[
¤c
[8]]) | ((UINT64)__gf_mulc_[src[9]]<<8) | ((UINT64)__gf_mulc_[src[10]]<<16) |

166 ((
UINT64
)
__gf_mulc_
[
¤c
[11]]<<24) | ((UINT64)__gf_mulc_[src[12]]<<32) | ((UINT64)__gf_mulc_[src[13]]<<40) |

167 ((
UINT64
)
__gf_mulc_
[
¤c
[14]]<<48) | ((UINT64)__gf_mulc_[src[15]]<<56) ;

168 *
d¡_64
 ^ğ
tmp
;

169 
d¡_64
++;

173 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[0]]) | ((UINT32)__gf_mulc_[src[1]]<<8) | ((UINT32)__gf_mulc_[src[2]]<<16) |

174 ((
UINT32
)
__gf_mulc_
[
¤c
[3]]<<24);

175 *
d¡_32
 ^ğ
tmp
;

176 
d¡_32
++;

177 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[4]]) | ((UINT32)__gf_mulc_[src[5]]<<8) | ((UINT32)__gf_mulc_[src[6]]<<16) |

178 ((
UINT32
)
__gf_mulc_
[
¤c
[7]]<<24);

179 *
d¡_32
 ^ğ
tmp
;

180 
d¡_32
++;

181 #ià(
UNROLL
 > 8)

182 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[8]]) | ((UINT32)__gf_mulc_[src[9]]<<8) | ((UINT32)__gf_mulc_[src[10]]<<16) |

183 ((
UINT32
)
__gf_mulc_
[
¤c
[11]]<<24);

184 *
d¡_32
 ^ğ
tmp
;

185 
d¡_32
++;

186 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[12]]) | ((UINT32)__gf_mulc_[src[13]]<<8) | ((UINT32)__gf_mulc_[src[14]]<<16) |

187 ((
UINT32
)
__gf_mulc_
[
¤c
[15]]<<24);

188 *
d¡_32
 ^ğ
tmp
;

189 
d¡_32
++;

194 
lim
 +ğ
UNROLL
 - 1 ;

195 ; 
d¡
 < 
lim
; d¡++, 
¤c
++) {

197 
	`GF_ADDMULC_COMPACT
 (*
d¡
 , *
¤c
);

199 
	}
}

205 
	$of_g®ois_f›ld_2_4_m©mul
 (
gf
 *
a
, gà*
b
, gà*
c
, 
n
, 
k
, 
m
) {

206 
OF_ENTER_FUNCTION


207 
row
, 
cŞ
, 
i
 ;

209 
row
 = 0;„ow < 
n
 ;„ow++)

211 
cŞ
 = 0; cŞ < 
m
 ; col++)

213 
gf
 *
·
 = &
a
[ 
row
 * 
k
 ];

214 
gf
 *
pb
 = &
b
[ 
cŞ
 ];

215 
gf
 
acc
 = 0 ;

216 
i
 = 0; i < 
k
 ; i++, 
·
++, 
pb
 +ğ
m
)

217 
acc
 ^ğ
of_gf_2_4_mul_bË
[*
·
][ *
pb
] ;

218 
c
[ 
row
 * 
m
 + 
cŞ
 ] = 
acc
 ;

221 
OF_EXIT_FUNCTION


222 
	}
}

225 
	$of_g®ois_f›ld_2_4_šv”t_m©
 (
of_g®ois_f›ld_code_cb_t
* 
ofcb
, 
gf
 *
¤c
, 
k
) {

226 
OF_ENTER_FUNCTION


227 
gf
 
c
, *
p
 ;

228 
œow
, 
icŞ
, 
row
, 
cŞ
, 
i
, 
ix
 ;

230 
”rÜ
 = 1 ;

231 *
šdxc
 = (*è
	`of_m®loc
 (
k
 *  ());

232 *
šdxr
 = (*è
	`of_m®loc
 (
k
 *  ());

233 *
iv
 = (*è
	`of_m®loc
 (
k
 *  ());

234 
gf
 *
id_row
 = (gf*è
	`of_m®loc
 (1 * 
k
 * (gf));

235 
gf
 *
‹mp_row
 = (gf*è
	`of_m®loc
 (1 * 
k
 * (gf));

237 
	`bz”o
 (
id_row
, 
k
* (
gf
));

241 
i
 = 0; i < 
k
 ; i++)

242 
iv
[
i
] = 0 ;

244 
cŞ
 = 0; cŞ < 
k
 ; col++)

246 
gf
 *
pivÙ_row
 ;

251 
œow
 = 
icŞ
 = -1 ;

252 ià(
iv
[
cŞ
] !ğ1 && 
¤c
[cŞ*
k
 + col] != 0)

254 
œow
 = 
cŞ
 ;

255 
icŞ
 = 
cŞ
 ;

256 
found_piv
 ;

258 
row
 = 0 ;„ow < 
k
 ;„ow++)

260 ià(
iv
[
row
] != 1)

262 
ix
 = 0 ; ix < 
k
 ; ix++)

264 ià(
iv
[
ix
] == 0)

266 ià(
¤c
[
row
*
k
 + 
ix
] != 0)

268 
œow
 = 
row
 ;

269 
icŞ
 = 
ix
 ;

270 
found_piv
 ;

274 ià(
iv
[
ix
] > 1)

277 
ç
 ;

282 ià(
icŞ
 == -1)

285 
ç
 ;

287 
found_piv
:

288 ++ (
iv
[
icŞ
]) ;

294 ià(
œow
 !ğ
icŞ
)

296 
ix
 = 0 ; ix < 
k
 ; ix++)

298 
	`SWAP
 (
¤c
[
œow
*
k
 + 
ix
], src[
icŞ
*k + ix], 
gf
) ;

301 
šdxr
[
cŞ
] = 
œow
 ;

302 
šdxc
[
cŞ
] = 
icŞ
 ;

303 
pivÙ_row
 = &
¤c
[
icŞ
*
k
] ;

304 
c
 = 
pivÙ_row
[
icŞ
] ;

305 ià(
c
 == 0)

307 
	`OF_PRINT_ERROR
(("singular matrix 2\n"))

308 
ç
 ;

310 ià(
c
 != 1)

317 
c
 = 
of_gf_2_4_šv
[ c ] ;

318 
pivÙ_row
[
icŞ
] = 1 ;

319 
ix
 = 0 ; ix < 
k
 ; ix++)

320 
pivÙ_row
[
ix
] = 
of_gf_2_4_mul_bË
[
c
][…ivot_row[ix]];

329 
id_row
[
icŞ
] = 1;

330 ià(
	`bcmp
 (
pivÙ_row
, 
id_row
, 
k
* (
gf
)) != 0)

332 
p
 = 
¤c
, 
ix
 = 0 ; ix < 
k
 ; ix++,… += k)

334 ià(
ix
 !ğ
icŞ
)

336 
c
 = 
p
[
icŞ
] ;

337 
p
[
icŞ
] = 0 ;

338 ià(
c
 != 0)

339 
	`of_g®ois_f›ld_2_4_addmul1
 (
p
, 
pivÙ_row
, 
c
, 
k
);

343 
id_row
[
icŞ
] = 0;

345 
cŞ
 = 
k
 - 1 ; col >= 0 ; col--)

347 ià(
šdxr
[
cŞ
] < 0 || indxr[cŞ] >ğ
k
)

348 
	`OF_PRINT_ERROR
(("AARGH, indxr[cŞ] %d\n", 
šdxr
[
cŞ
]))

350 ià(
šdxc
[
cŞ
] < 0 || indxc[cŞ] >ğ
k
)

351 
	`OF_PRINT_ERROR
(Ğ"AARGH, indxc[cŞ] %d\n", 
šdxc
[
cŞ
]))

353 ià(
šdxr
[
cŞ
] !ğ
šdxc
[col])

355 
row
 = 0 ;„ow < 
k
 ;„ow++)

357 
	`SWAP
 (
¤c
[
row
*
k
 + 
šdxr
[
cŞ
]], src[row*k + 
šdxc
[cŞ]], 
gf
) ;

361 
”rÜ
 = 0 ;

362 
ç
:

363 
	`of_ä“
 (
šdxc
);

364 
	`of_ä“
 (
šdxr
);

365 
	`of_ä“
 (
iv
);

366 
	`of_ä“
 (
id_row
);

367 
	`of_ä“
 (
‹mp_row
);

368 
OF_EXIT_FUNCTION


369  
”rÜ
 ;

370 
	}
}

372 
	$of_g®ois_f›ld_2_4_šv”t_vdm
 (
of_g®ois_f›ld_code_cb_t
* 
ofcb
, 
gf
 *
¤c
, 
k
) {

373 
OF_ENTER_FUNCTION


374 
i
, 
j
, 
row
, 
cŞ
 ;

375 
gf
 *
b
, *
c
, *
p
;

376 
gf
 
t
, 
xx
 ;

378 ià(
k
 == 1)

384 
c
 = (
gf
*è
	`of_m®loc
(1 * 
k
 * (gf));

385 
b
 = (
gf
*è
	`of_m®loc
(1 * 
k
 * (gf));

386 
p
 = (
gf
*è
	`of_m®loc
(1 * 
k
 * (gf));

388 
j
 = 1, 
i
 = 0 ; i < 
k
 ; i++, j += k)

390 
c
[
i
] = 0 ;

391 
p
[
i
] = 
¤c
[
j
] ;

399 
c
[
k
-1] = 
p
[0] ;

400 
i
 = 1 ; i < 
k
 ; i++)

402 
gf
 
p_i
 = 
p
[
i
] ;

403 
j
 = 
k
 - 1 - (
i
 - 1) ; j < k - 1 ; j++)

404 
c
[
j
] ^ğ
of_gf_2_4_mul_bË
[
p_i
][ c[j+1]] ;

405 
c
[
k
-1] ^ğ
p_i
 ;

408 
row
 = 0 ;„ow < 
k
 ;„ow++)

413 
xx
 = 
p
[
row
] ;

414 
t
 = 1 ;

415 
b
[
k
-1] = 1 ;

416 
i
 = 
k
 - 2 ; i >= 0 ; i--)

418 
b
[
i
] = 
c
[i+1] ^ 
of_gf_2_4_mul_bË
[
xx
][ b[i+1]] ;

419 
t
 = 
of_gf_2_4_mul_bË
[
xx
][] ^ 
b
[
i
] ;

421 
cŞ
 = 0 ; cŞ < 
k
 ; col++)

422 
¤c
[
cŞ
*
k
 + 
row
] = 
of_gf_2_4_mul_bË
 [
of_gf_2_4_šv
[
t
]][ 
b
[col]];

424 
	`of_ä“
 (
c
);

425 
	`of_ä“
 (
b
);

426 
	`of_ä“
 (
p
);

427 
OF_EXIT_FUNCTION


429 
	}
}

	@src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/algebra_2_4.h

35 #iâdeà
OF_GALOIS_FIELD_ALGEBRA_2_4_H


36 
	#OF_GALOIS_FIELD_ALGEBRA_2_4_H


	)

38 
	~"../of_»ed-sŞomÚ_gf_2_m_šşudes.h
"

41 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


44 
	#SWAP
(
a
,
b
,
t
è{ˆ
tmp
;mp÷;‡=b; bñmp;}

	)

46 cÚ¡ 
gf
 
	gof_gf_2_4_log
[] = {15,0,1,4,2,8,5,10,3,14,9,7,6,13,11,12};

48 cÚ¡ 
gf
 
	gof_gf_2_4_exp
[] = {1,2,4,8,3,6,12,11,5,10,7,14,15,13,9,1};

49 cÚ¡ 
gf
 
	gof_gf_2_4_šv
[] = {0,1,9,14,13,11,7,6,15,2,12,5,10,4,3,8};

50 cÚ¡ 
gf
 
	gof_gf_2_4_mul_bË
[][16]={

68 cÚ¡ 
gf
 
	gof_gf_2_4_İt_mul_bË
[][256] = {

91 
of_g®ois_f›ld_2_4_addmul1
(
gf
 *
d¡1
, gà*
¤c1
, gà
c
, 
sz
);

103 
of_g®ois_f›ld_2_4_addmul1_com·ù
 (
gf
 *
d¡1
, gà*
¤c1
, gà
c
, 
sz
);

108 
of_g®ois_f›ld_2_4_m©mul
 (
gf
 *
a
, gà*
b
, gà*
c
, 
n
, 
k
, 
m
);

109 
of_g®ois_f›ld_2_4_šv”t_m©
 (
of_g®ois_f›ld_code_cb_t
* 
ofcb
, 
gf
 *
¤c
, 
k
);

110 
of_g®ois_f›ld_2_4_šv”t_vdm
 (
of_g®ois_f›ld_code_cb_t
* 
ofcb
, 
gf
 *
¤c
, 
k
);

	@src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/algebra_2_8.c

34 
	~"®geb¿_2_8.h
"

36 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


38 
	#UNROLL
 16

	)

39 
	#USE_GF_MULC
 
gf
 * 
__gf_mulc_


	)

40 
	#GF_MULC0
(
c
è
__gf_mulc_
 = (
gf
*)
of_gf_2_8_mul_bË
[c]

	)

41 
	#GF_ADDMULC
(
d¡
, 
x
è{d¡ ^ğ
__gf_mulc_
[x];}

	)

50 
	$of_g®ois_f›ld_2_8_addmul1
(
gf
 *
d¡1
, gà*
¤c1
, gà
c
, 
sz
) {

51 
USE_GF_MULC
 ;

52 
gf
 *
d¡
 = 
d¡1
, *
¤c
 = 
¤c1
 ;

53 if(
sz
 >= 8){

54 
	#UNROLL
 16

	)

56 
	#UNROLL
 8

	)

58 
gf
 *
lim
 = &
d¡
[
sz
 - 
UNROLL
 + 1] ;

59 #ià((
	`defšed
 (
__LP64__
è|| (
__WORDSIZE
 =ğ64)è&& !defšed (
OF_RS_2M_USE_32BITS
))

60 
UINT64
 
tmp
;

61 
UINT64
 *
d¡_64
 = (UINT64*)
d¡1
;

63 
UINT32
 
tmp
;

64 
UINT32
 *
d¡_32
 = (UINT32*)
d¡1
;

66 
	`GF_MULC0
 (
c
) ;

69 #ià(
UNROLL
 > 1)

71 ; 
d¡
 < 
lim
 ;d¡ +ğ
UNROLL
, 
¤c
 += UNROLL)

73 #ià((
	`defšed
 (
__LP64__
è|| (
__WORDSIZE
 =ğ64)è&& !defšed (
OF_RS_2M_USE_32BITS
))

74 
tmp
 = ((
UINT64
)
__gf_mulc_
[
¤c
[0]]) | ((UINT64)__gf_mulc_[src[1]]<<8) | ((UINT64)__gf_mulc_[src[2]]<<16) |

75 ((
UINT64
)
__gf_mulc_
[
¤c
[3]]<<24) | ((UINT64)__gf_mulc_[src[4]]<<32) | ((UINT64)__gf_mulc_[src[5]]<<40) |

76 ((
UINT64
)
__gf_mulc_
[
¤c
[6]]<<48) | ((UINT64)__gf_mulc_[src[7]]<<56) ;

77 *
d¡_64
 ^ğ
tmp
;

78 
d¡_64
++;

79 #ià(
UNROLL
 > 8)

80 
tmp
 = ((
UINT64
)
__gf_mulc_
[
¤c
[8]]) | ((UINT64)__gf_mulc_[src[9]]<<8) | ((UINT64)__gf_mulc_[src[10]]<<16) |

81 ((
UINT64
)
__gf_mulc_
[
¤c
[11]]<<24) | ((UINT64)__gf_mulc_[src[12]]<<32) | ((UINT64)__gf_mulc_[src[13]]<<40) |

82 ((
UINT64
)
__gf_mulc_
[
¤c
[14]]<<48) | ((UINT64)__gf_mulc_[src[15]]<<56) ;

83 *
d¡_64
 ^ğ
tmp
;

84 
d¡_64
++;

87 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[0]]) | ((UINT32)__gf_mulc_[src[1]]<<8) | ((UINT32)__gf_mulc_[src[2]]<<16) |

88 ((
UINT32
)
__gf_mulc_
[
¤c
[3]]<<24);

89 *
d¡_32
 ^ğ
tmp
;

90 
d¡_32
++;

91 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[4]]) | ((UINT32)__gf_mulc_[src[5]]<<8) | ((UINT32)__gf_mulc_[src[6]]<<16) |

92 ((
UINT32
)
__gf_mulc_
[
¤c
[7]]<<24);

93 *
d¡_32
 ^ğ
tmp
;

94 
d¡_32
++;

95 #ià(
UNROLL
 > 8)

96 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[8]]) | ((UINT32)__gf_mulc_[src[9]]<<8) | ((UINT32)__gf_mulc_[src[10]]<<16) |

97 ((
UINT32
)
__gf_mulc_
[
¤c
[11]]<<24);

98 *
d¡_32
 ^ğ
tmp
;

99 
d¡_32
++;

100 
tmp
 = ((
UINT32
)
__gf_mulc_
[
¤c
[12]]) | ((UINT32)__gf_mulc_[src[13]]<<8) | ((UINT32)__gf_mulc_[src[14]]<<16) |

101 ((
UINT32
)
__gf_mulc_
[
¤c
[15]]<<24);

102 *
d¡_32
 ^ğ
tmp
;

103 
d¡_32
++;

108 
lim
 +ğ
UNROLL
 - 1 ;

109 ; 
d¡
 < 
lim
; d¡++, 
¤c
++)

110 
	`GF_ADDMULC
 (*
d¡
 , *
¤c
);

111 
	}
}

116 
	$of_g®ois_f›ld_2_8_m©mul
 (
gf
 *
a
, gà*
b
, gà*
c
, 
n
, 
k
, 
m
) {

117 
OF_ENTER_FUNCTION


118 
row
, 
cŞ
, 
i
 ;

120 
row
 = 0;„ow < 
n
 ;„ow++)

122 
cŞ
 = 0; cŞ < 
m
 ; col++)

124 
gf
 *
·
 = &
a
[ 
row
 * 
k
 ];

125 
gf
 *
pb
 = &
b
[ 
cŞ
 ];

126 
gf
 
acc
 = 0 ;

127 
i
 = 0; i < 
k
 ; i++, 
·
++, 
pb
 +ğ
m
)

128 
acc
 ^ğ
of_gf_2_8_mul_bË
[*
·
][ *
pb
] ;

129 
c
[ 
row
 * 
m
 + 
cŞ
 ] = 
acc
 ;

132 
OF_EXIT_FUNCTION


133 
	}
}

135 
	$of_g®ois_f›ld_2_8_šv”t_m©
 (
of_g®ois_f›ld_code_cb_t
* 
ofcb
, 
gf
 *
¤c
, 
k
) {

136 
OF_ENTER_FUNCTION


137 
gf
 
c
, *
p
 ;

138 
œow
, 
icŞ
, 
row
, 
cŞ
, 
i
, 
ix
 ;

140 
”rÜ
 = 1 ;

141 *
šdxc
 = (*è
	`of_m®loc
 (
k
 *  ());

142 *
šdxr
 = (*è
	`of_m®loc
 (
k
 *  ());

143 *
iv
 = (*è
	`of_m®loc
 (
k
 *  ());

144 
gf
 *
id_row
 = (gf*è
	`of_m®loc
 (1 * 
k
 * (gf));

145 
gf
 *
‹mp_row
 = (gf*è
	`of_m®loc
 (1 * 
k
 * (gf));

147 
	`bz”o
 (
id_row
, 
k
* (
gf
));

151 
i
 = 0; i < 
k
 ; i++)

152 
iv
[
i
] = 0 ;

154 
cŞ
 = 0; cŞ < 
k
 ; col++)

156 
gf
 *
pivÙ_row
 ;

161 
œow
 = 
icŞ
 = -1 ;

162 ià(
iv
[
cŞ
] !ğ1 && 
¤c
[cŞ*
k
 + col] != 0)

164 
œow
 = 
cŞ
 ;

165 
icŞ
 = 
cŞ
 ;

166 
found_piv
 ;

168 
row
 = 0 ;„ow < 
k
 ;„ow++)

170 ià(
iv
[
row
] != 1)

172 
ix
 = 0 ; ix < 
k
 ; ix++)

174 ià(
iv
[
ix
] == 0)

176 ià(
¤c
[
row
*
k
 + 
ix
] != 0)

178 
œow
 = 
row
 ;

179 
icŞ
 = 
ix
 ;

180 
found_piv
 ;

183 ià(
iv
[
ix
] > 1)

186 
ç
 ;

191 ià(
icŞ
 == -1)

194 
ç
 ;

196 
found_piv
:

197 ++ (
iv
[
icŞ
]) ;

203 ià(
œow
 !ğ
icŞ
)

205 
ix
 = 0 ; ix < 
k
 ; ix++)

207 
	`SWAP
 (
¤c
[
œow
*
k
 + 
ix
], src[
icŞ
*k + ix], 
gf
) ;

210 
šdxr
[
cŞ
] = 
œow
 ;

211 
šdxc
[
cŞ
] = 
icŞ
 ;

212 
pivÙ_row
 = &
¤c
[
icŞ
*
k
] ;

213 
c
 = 
pivÙ_row
[
icŞ
] ;

214 ià(
c
 == 0)

216 
	`OF_PRINT_ERROR
(("singular matrix 2\n"))

217 
ç
 ;

219 ià(
c
 != 1)

226 
c
 = 
of_gf_2_8_šv
[ c ] ;

227 
pivÙ_row
[
icŞ
] = 1 ;

228 
ix
 = 0 ; ix < 
k
 ; ix++)

229 
pivÙ_row
[
ix
] = 
of_gf_2_8_mul_bË
[
c
][…ivot_row[ix]];

238 
id_row
[
icŞ
] = 1;

239 ià(
	`bcmp
 (
pivÙ_row
, 
id_row
, 
k
* (
gf
)) != 0)

241 
p
 = 
¤c
, 
ix
 = 0 ; ix < 
k
 ; ix++,… += k)

243 ià(
ix
 !ğ
icŞ
)

245 
c
 = 
p
[
icŞ
] ;

246 
p
[
icŞ
] = 0 ;

247 ià(
c
 != 0)

248 
	`of_g®ois_f›ld_2_8_addmul1
 (
p
, 
pivÙ_row
, 
c
, 
k
);

252 
id_row
[
icŞ
] = 0;

254 
cŞ
 = 
k
 - 1 ; col >= 0 ; col--)

256 ià(
šdxr
[
cŞ
] < 0 || indxr[cŞ] >ğ
k
)

257 
	`OF_PRINT_ERROR
(("AARGH, indxr[cŞ] %d\n", 
šdxr
[
cŞ
]))

258 ià(
šdxc
[
cŞ
] < 0 || indxc[cŞ] >ğ
k
)

259 
	`OF_PRINT_ERROR
(Ğ"AARGH, indxc[cŞ] %d\n", 
šdxc
[
cŞ
]))

260 ià(
šdxr
[
cŞ
] !ğ
šdxc
[col])

262 
row
 = 0 ;„ow < 
k
 ;„ow++)

264 
	`SWAP
 (
¤c
[
row
*
k
 + 
šdxr
[
cŞ
]], src[row*k + 
šdxc
[cŞ]], 
gf
) ;

268 
”rÜ
 = 0 ;

269 
ç
:

270 
	`of_ä“
 (
šdxc
);

271 
	`of_ä“
 (
šdxr
);

272 
	`of_ä“
 (
iv
);

273 
	`of_ä“
 (
id_row
);

274 
	`of_ä“
 (
‹mp_row
);

275 
OF_EXIT_FUNCTION


276  
”rÜ
 ;

277 
	}
}

279 
	$of_g®ois_f›ld_2_8_šv”t_vdm
 (
of_g®ois_f›ld_code_cb_t
* 
ofcb
, 
gf
 *
¤c
, 
k
) {

280 
OF_ENTER_FUNCTION


281 
i
, 
j
, 
row
, 
cŞ
 ;

282 
gf
 *
b
, *
c
, *
p
;

283 
gf
 
t
, 
xx
 ;

285 ià(
k
 == 1)

291 
c
 = (
gf
*è
	`of_m®loc
(1 * 
k
 * (gf));

292 
b
 = (
gf
*è
	`of_m®loc
(1 * 
k
 * (gf));

293 
p
 = (
gf
*è
	`of_m®loc
(1 * 
k
 * (gf));

295 
j
 = 1, 
i
 = 0 ; i < 
k
 ; i++, j += k)

297 
c
[
i
] = 0 ;

298 
p
[
i
] = 
¤c
[
j
] ;

306 
c
[
k
-1] = 
p
[0] ;

307 
i
 = 1 ; i < 
k
 ; i++)

309 
gf
 
p_i
 = 
p
[
i
] ;

310 
j
 = 
k
 - 1 - (
i
 - 1) ; j < k - 1 ; j++)

311 
c
[
j
] ^ğ
of_gf_2_8_mul_bË
[
p_i
][ c[j+1]] ;

312 
c
[
k
-1] ^ğ
p_i
 ;

315 
row
 = 0 ;„ow < 
k
 ;„ow++)

320 
xx
 = 
p
[
row
] ;

321 
t
 = 1 ;

322 
b
[
k
-1] = 1 ;

323 
i
 = 
k
 - 2 ; i >= 0 ; i--)

325 
b
[
i
] = 
c
[i+1] ^ 
of_gf_2_8_mul_bË
[
xx
][ b[i+1]] ;

326 
t
 = 
of_gf_2_8_mul_bË
[
xx
][] ^ 
b
[
i
] ;

328 
cŞ
 = 0 ; cŞ < 
k
 ; col++)

329 
¤c
[
cŞ
*
k
 + 
row
] = 
of_gf_2_8_mul_bË
 [
of_gf_2_8_šv
[
t
]][ 
b
[col]];

331 
	`of_ä“
 (
c
);

332 
	`of_ä“
 (
b
);

333 
	`of_ä“
 (
p
);

334 
OF_EXIT_FUNCTION


336 
	}
}

	@src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/algebra_2_8.h

34 #iâdeà
OF_GALOIS_FIELD_ALGEBRA_2_8_H


35 
	#OF_GALOIS_FIELD_ALGEBRA_2_8_H


	)

37 
	~"../of_»ed-sŞomÚ_gf_2_m_šşudes.h
"

40 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


43 
	#SWAP
(
a
,
b
,
t
è{ˆ
tmp
;mp÷;‡=b; bñmp;}

	)

45 cÚ¡ 
	gof_gf_2_8_log
[] = {255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175255,0,1,25,2,50,26,198,3,223,51,238,27,104,199,75,4,100,224,14,52,141,239,129,28,193,105,248,200,8,76,113,5,138,101,47,225,36,15,33,53,147,142,218,240,18,130,69,29,181,194,125,106,39,249,185,201,154,9,120,77,228,114,166,6,191,139,98,102,221,48,253,226,152,37,179,16,145,34,136,54,208,148,206,143,150,219,189,241,210,19,92,131,56,70,64,30,66,182,163,195,72,126,110,107,58,40,84,250,133,186,61,202,94,155,159,10,21,121,43,78,212,229,172,115,243,167,87,7,112,192,247,140,128,99,13,103,74,222,237,49,197,254,24,227,165,153,119,38,184,180,124,17,68,146,217,35,32,137,46,55,63,209,91,149,188,207,205,144,135,151,178,220,252,190,97,242,86,211,171,20,42,93,158,132,60,57,83,71,109,65,162,31,45,67,216,183,123,164,118,196,23,73,236,127,12,111,246,108,161,59,82,41,157,85,170,251,96,134,177,187,204,62,90,203,89,95,176,156,169,160,81,11,245,22,235,122,117,44,215,79,174,213,233,230,231,173,232,116,214,244,234,168,80,88,175};

47 cÚ¡ 
gf
 
	gof_gf_2_8_exp
[] = {1,2,4,8,16,32,64,128,29,58,116,232,205,135,19,38,76,152,45,90,180,117,234,201,143,3,6,12,24,48,96,192,157,39,78,156,37,74,148,53,106,212,181,119,238,193,159,35,70,140,5,10,20,40,80,160,93,186,105,210,185,111,222,161,95,190,97,194,153,47,94,188,101,202,137,15,30,60,120,240,253,231,211,187,107,214,177,127,254,225,223,163,91,182,113,226,217,175,67,134,17,34,68,136,13,26,52,104,208,189,103,206,129,31,62,124,248,237,199,147,59,118,236,197,151,51,102,204,133,23,46,92,184,109,218,169,79,158,33,66,132,21,42,84,168,77,154,41,82,164,85,170,73,146,57,114,228,213,183,115,230,209,191,99,198,145,63,126,252,229,215,179,123,246,241,255,227,219,171,75,150,49,98,196,149,55,110,220,165,87,174,65,130,25,50,100,200,141,7,14,28,56,112,224,221,167,83,166,81,162,89,178,121,242,249,239,195,155,43,86,172,69,138,9,18,36,72,144,61,122,244,245,247,243,251,235,203,139,11,22,44,88,176,125,250,233,207,131,27,54,108,216,173,71,142,1};

49 cÚ¡ 
gf
 
	gof_gf_2_8_šv
[] = {0,1,142,244,71,167,122,186,173,157,221,152,61,170,93,150,216,114,192,88,224,62,76,102,144,222,85,128,160,131,75,42,108,237,57,81,96,86,44,138,112,208,31,74,38,139,51,110,72,137,111,46,164,195,64,94,80,34,207,169,171,12,21,225,54,95,248,213,146,78,166,4,48,136,43,30,22,103,69,147,56,35,104,140,129,26,37,97,19,193,203,99,151,14,55,65,36,87,202,91,185,196,23,77,82,141,239,179,32,236,47,50,40,209,17,217,233,251,218,121,219,119,6,187,132,205,254,252,27,84,161,29,124,204,228,176,73,49,39,45,83,105,2,245,24,223,68,79,155,188,15,92,11,220,189,148,172,9,199,162,28,130,159,198,52,194,70,5,206,59,13,60,156,8,190,183,135,229,238,107,235,242,191,175,197,100,7,123,149,154,174,182,18,89,165,53,101,184,163,158,210,247,98,90,133,125,168,58,41,113,200,246,249,67,215,214,16,115,118,120,153,10,25,145,20,63,230,240,134,177,226,241,250,116,243,180,109,33,178,106,227,231,181,234,3,143,211,201,66,212,232,117,127,255,126,253};

51 cÚ¡ 
gf
 
	gof_gf_2_8_mul_bË
[][256] = {

318 
of_g®ois_f›ld_2_8_addmul1
 (
gf
 *
d¡1
, gà*
¤c1
, gà
c
, 
sz
);

323 
of_g®ois_f›ld_2_8_m©mul
 (
gf
 *
a
, gà*
b
, gà*
c
, 
n
, 
k
, 
m
);

324 
of_g®ois_f›ld_2_8_šv”t_m©
 (
of_g®ois_f›ld_code_cb_t
* 
ofcb
, 
gf
 *
¤c
, 
k
);

325 
of_g®ois_f›ld_2_8_šv”t_vdm
 (
of_g®ois_f›ld_code_cb_t
* 
ofcb
, 
gf
 *
¤c
, 
k
);

	@src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/of_galois_field_code.c

34 
	~"../of_»ed-sŞomÚ_gf_2_m_šşudes.h
"

37 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


40 
gf
 
	$of_modÂ
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
,
INT32
 
x
)

42 
UINT16
 
f›ld_size
 = 
ofcb
->field_size;

43 
x
 >ğ
f›ld_size
)

45 
x
 -ğ
f›ld_size
;

46 
x
 = (x >> 
ofcb
->
m
è+ (x & 
f›ld_size
);

48  
x
;

49 
	}
}

51 
	$of_rs_2m_di¥Ïy_gf
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
)

53 
OF_ENTER_FUNCTION


54 
i
;

55 
i
 = 0; i <ğ
ofcb
->
f›ld_size
; i++) {

56 
	`´štf
("i=%i,log(i)=%i,exp(i)=%i,expÖog(i))=%i\n",
i
,
ofcb
->
of_rs_gf_log
[i],ofcb->
of_rs_gf_exp
[i],ofcb->of_rs_gf_exp[ofcb->of_rs_gf_log[i]]);

58 
OF_EXIT_FUNCTION


59 
	}
}

66 
	$of_rs_2m_shufæe
 (
gf
 *
pkt
[], gà*
pkth—d
[],
šdex
[], 
k
)

68 
OF_ENTER_FUNCTION


69 
i
;

71 
i
 = 0 ; i < 
k
 ;)

73 ià(
šdex
[
i
] >ğ
k
 || index[i] == i)

74 
i
++ ;

80 
c
 = 
šdex
[
i
] ;

82 ià(
šdex
[
c
] == c)

84 
OF_EXIT_FUNCTION


87 
	`SWAP
 (
šdex
[
i
], index[
c
], ) ;

88 
	`SWAP
 (
pkt
[
i
],…kt[
c
], 
gf
 *) ;

89 
	`SWAP
 (
pkth—d
[
i
],…kth—d[
c
], 
gf
 *) ;

92 
OF_EXIT_FUNCTION


94 
	}
}

97 
	$of_rs_2m_»Ëa£
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
)

99 
OF_ENTER_FUNCTION


100 ià(
ofcb
->
’c_m©rix
 !ğ
NULL
)

102 
	`of_ä“
(
ofcb
->
’c_m©rix
);

103 
ofcb
->
’c_m©rix
=
NULL
;

105 ià(
ofcb
->
dec_m©rix
 !ğ
NULL
)

107 
	`of_ä“
(
ofcb
->
dec_m©rix
);

108 
ofcb
->
dec_m©rix
=
NULL
;

110 
OF_EXIT_FUNCTION


111 
	}
}

114 
of_¡©us_t
 
	$of_rs_2m_bud_’codšg_m©rix
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
)

116 
OF_ENTER_FUNCTION


117 
gf
 *
tmp_m
, *
p
;

118 
UINT32
 
k
,
r
,
cŞ
,
row
;

119 
k
=
ofcb
->
nb_sourû_symbŞs
;

120 
r
 = 
ofcb
->
nb_»·œ_symbŞs
;

121 ià((
ofcb
->
’c_m©rix
 = 
	`of_m®loc
((
k
+
r
)*(k))è=ğ
NULL
)

123 
no_mem
;

128 
ofcb
->
magic
 = ( (
FEC_MAGIC
 ^ 
k
è^ (k+
r
)è^ ((
ušŒ_t
)(ofcb->
’c_m©rix
) & 0xFFFFFFFF);

130 ià((
tmp_m
 = 
	`of_m®loc
((
k
+
r
)*(k))è=ğ
NULL
)

132 
no_mem
;

138 
tmp_m
[0] = 1 ;

139 
cŞ
 = 1; cŞ < 
k
 ; col++)

140 
tmp_m
[
cŞ
] = 0 ;

141 
p
 = 
tmp_m
 + 
k
, 
row
 = 0;„ow < k+
r
 - 1 ;„ow++,… += k)

143 
cŞ
 = 0 ; cŞ < 
k
 ; col ++)

144 
ofcb
->
m
) {

146 
p
[
cŞ
] = 
of_gf_2_4_exp
[
	`of_modÂ
 (
ofcb
,
row
*col) ];

149 
p
[
cŞ
] = 
of_gf_2_8_exp
[
	`of_modÂ
 (
ofcb
,
row
*col) ];

159 
ofcb
->
m
) {

161 
	`of_g®ois_f›ld_2_4_šv”t_vdm
(
ofcb
, 
tmp_m
, 
k
);

162 
	`of_g®ois_f›ld_2_4_m©mul
(
tmp_m
 + 
k
*k,mp_m, 
ofcb
->
’c_m©rix
 + k*k, 
r
, k, k);

165 
	`of_g®ois_f›ld_2_8_šv”t_vdm
(
ofcb
, 
tmp_m
, 
k
);

166 
	`of_g®ois_f›ld_2_8_m©mul
(
tmp_m
 + 
k
*k,mp_m, 
ofcb
->
’c_m©rix
 + k*k, 
r
, k, k);

172 
	`bz”o
 (
ofcb
->
’c_m©rix
, 
k
*k* (
gf
));

173 
p
 = 
ofcb
->
’c_m©rix
, 
cŞ
 = 0 ; cŞ < 
k
 ; col++,… += k + 1)

174 *
p
 = 1 ;

176 
	`of_ä“
 (
tmp_m
);

178 
OF_EXIT_FUNCTION


179  
OF_STATUS_OK
;

180 
no_mem
:

181 
	`OF_PRINT_ERROR
(("out of memory\n"));

182 
”rÜ
:

183 
OF_EXIT_FUNCTION


184  
OF_STATUS_FATAL_ERROR
;

185 
	}
}

188 #ifdeà
OF_USE_DECODER


189 
of_¡©us_t
 
	$of_rs_2m_bud_decodšg_m©rix
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
, *
šdex
)

191 
OF_ENTER_FUNCTION


192 
UINT32
 
k
,
r
,
i
;

193 
gf
 *
p
;

194 
k
 = 
ofcb
->
nb_sourû_symbŞs
;

195 
r
 = 
ofcb
->
nb_»·œ_symbŞs
;

196 ià((
ofcb
->
dec_m©rix
 = 
	`of_m®loc
((
k
)*(k))è=ğ
NULL
)

198 
no_mem
;

200 
i
 = 0, 
p
 = 
ofcb
->
dec_m©rix
 ; i < 
k
 ; i++,… += k)

203 ià(
šdex
[
i
] < 
k
)

205 
	`bz”o
 (
p
, 
k
* (
gf
));

206 
p
[
i
] = 1 ;

210 ià(
šdex
[
i
] < (
k
+
r
))

211 
	`bcİy
 (& (
ofcb
->
’c_m©rix
[
šdex
[
i
]*
k
]), 
p
, k* (
gf
));

214 
	`OF_PRINT_ERROR
 ( ("decode: invalid index %d (max %d)\n",

215 
šdex
[
i
], 
k
+
r
 - 1))

216 
	`of_ä“
 (
ofcb
->
dec_m©rix
);

217 
OF_EXIT_FUNCTION


218  
OF_STATUS_FATAL_ERROR
 ;

221 
»suÉ
;

222 
ofcb
->
m
)

225 
»suÉ
 = 
	`of_g®ois_f›ld_2_4_šv”t_m©
(
ofcb
, ofcb->
dec_m©rix
, 
k
);

228 
»suÉ
 = 
	`of_g®ois_f›ld_2_8_šv”t_m©
(
ofcb
, ofcb->
dec_m©rix
, 
k
);

231 ià(
»suÉ
)

233 
	`of_ä“
 (
ofcb
->
dec_m©rix
);

234 
ofcb
->
dec_m©rix
 = 
NULL
 ;

236 
OF_EXIT_FUNCTION


237  
OF_STATUS_OK
;

239 
no_mem
:

240 
	`OF_PRINT_ERROR
(("out of memory\n"));

241 
”rÜ
:

242 
OF_EXIT_FUNCTION


243  
OF_STATUS_FATAL_ERROR
;

244 
	}
}

247 
of_¡©us_t
 
	$of_rs_2m_decode
 (
of_g®ois_f›ld_code_cb_t
* 
ofcb
, 
gf
 *
_pkt
[], gà*
_pk‹ad
[], 
šdex
[], 
sz
, 
h—dsz
)

249 
OF_ENTER_FUNCTION


250 
gf
 **
pkt
 = (gf**è
_pkt
;

251 
gf
 **
pkth—d
 = (gf**è
_pk‹ad
;

253 **
ass_buf
;

254 **
ass_h—dbuf
;

255 
row
, 
cŞ
, 
k
 = 
ofcb
->
nb_sourû_symbŞs
 ;

256 
size
 = 
sz
;

257 
h—dsize
 = 
h—dsz
;

259 ià(
ofcb
->
m
 > 8){

260 
size
 /= 2 ;

261 
h—dsize
 /= 2;

264 ià(
	`of_rs_2m_shufæe
 (
pkt
, 
pkth—d
, 
šdex
, 
k
))

267 
OF_EXIT_FUNCTION


268  
OF_STATUS_ERROR
 ;

270 ià(
	`of_rs_2m_bud_decodšg_m©rix
 (
ofcb
, 
šdex
è!ğ
OF_STATUS_OK
)

272 
	`OF_PRINT_ERROR
(("of_rs_2m_decode : cannot build decoding matrix."))

273 
”rÜ
;

280 
row
 = 0 ;„ow < 
k
 ;„ow++)

282 ià(
šdex
[
row
] >ğ
k
)

284 
ass_buf
 = &(
ofcb
->
avaabË_symbŞs_b
[
row
]);

285 
ass_h—dbuf
 = &(
ofcb
->
avaabË_symbŞh—ds_b
[
row
]);

286 
	`OF_PRINT_LVL
(2,("decode„ow %d index %d‡ss_buf %p\n",

287 
row
, 
šdex
[row],
ass_buf
));

288 
	`OF_PRINT_LVL
(2,("decode„ow %d index %d‡ss_buf %p‡ss_headbuf%p\n",

289 
row
, 
šdex
[row],*
ass_buf
, *
ass_h—dbuf
));

290 if(
NULL
 =ğ*
ass_buf
){

291 ià(
ofcb
->
decoded_sourû_symbŞ_ÿÎback
 !ğ
NULL
)

293 *
ass_buf
 = 
ofcb
->
	`decoded_sourû_symbŞ_ÿÎback
 (ofcb->
cÚ‹xt_4_ÿÎback
,

294 
sz
, 
row
);

295 if(
h—dsz
 != 0){

296 *
ass_h—dbuf
 = 
ofcb
->
	`decoded_sourû_symbŞ_ÿÎback
 (ofcb->
cÚ‹xt_4_ÿÎback
,

297 
h—dsz
, 
row
);

300 ià(
ofcb
->
decoded_sourû_symbŞ_ÿÎback_Ãw
 !ğ
NULL
) {

301 
ofcb
->
	`decoded_sourû_symbŞ_ÿÎback_Ãw
(ofcb->
cÚ‹xt_4_ÿÎback
,

302 
ass_buf
, 
ass_h—dbuf
, 
sz
, 
h—dsz
, 
row
);

306 *
ass_buf
 = (*è
	`of_m®loc
 (
sz
);

307 
	`bz”o
 (*
ass_buf
, 
sz
 *  (
gf
)) ;

308 if(
h—dsz
 != 0){

309 *
ass_h—dbuf
 = (*è
	`of_m®loc
(
h—dsz
);

310 
	`bz”o
 (*
ass_h—dbuf
, 
h—dsz
 *  (
gf
)) ;

313 ià(*
ass_buf
 =ğ
NULL
)

315 
	`OF_PRINT_ERROR
(("decode„ow %d index %d‡ss_buf %p\n",

316 
row
, 
šdex
[row],*
ass_buf
));

317 
”rÜ
;

319 if(
h—dsz
 !ğ0 && *
ass_h—dbuf
 =ğ
NULL
){

320 
	`OF_PRINT_ERROR
(("decode„ow %d index %d‡ss_headbuf %p\n",

321 
row
, 
šdex
[row],*
ass_h—dbuf
));

322 
”rÜ
;

326 
cŞ
 = 0 ; cŞ < 
k
 ; col++)

328 ià(
ofcb
->
dec_m©rix
[
row
*
k
 + 
cŞ
] != 0)

330 
ofcb
->
m
)

333 
	`of_g®ois_f›ld_2_4_addmul1_com·ù
((
gf
 *)*
ass_buf
, 
pkt
[
cŞ
], 
ofcb
->
dec_m©rix
[
row
*
k
 + cŞ], 
size
);

334 if(
h—dsz
 > 0){

335 
	`of_g®ois_f›ld_2_4_addmul1_com·ù
((
gf
 *)*
ass_h—dbuf
, 
pkth—d
[
cŞ
], 
ofcb
->
dec_m©rix
[
row
*
k
 + cŞ], 
h—dsize
);

340 
	`of_g®ois_f›ld_2_8_addmul1
((
gf
 *)*
ass_buf
, 
pkt
[
cŞ
], 
ofcb
->
dec_m©rix
[
row
*
k
 + cŞ], 
size
);

341 if(
h—dsz
 > 0){

342 
	`of_g®ois_f›ld_2_8_addmul1
((
gf
 *)*
ass_h—dbuf
, 
pkth—d
[
cŞ
], 
ofcb
->
dec_m©rix
[
row
*
k
 + cŞ], 
h—dsize
);

348 
	`Of_SaveFe
("/mÁ/Üig_dec0", (
gf
 **)
ass_h—dbuf
, 
h—dsz
, 1);

349 
	`Of_SaveFe
("/mÁ/Üig_dec0", (
gf
 **)
ass_buf
, 
sz
, 1);

353 
	`Of_SaveFe
("/mÁ/Üig_dec0", &
pkth—d
[
row
], 
h—dsz
, 1);

354 
	`Of_SaveFe
("/mÁ/Üig_dec0", &
pkt
[
row
], 
sz
, 1);

364 
row
 = 0 ;„ow < 
k
 ;„ow++)

366 ià(
šdex
[
row
] >ğ
k
)

368 
	`bcİy
 (
Ãw_pkt
[
row
], 
pkt
[row], 
sz
* (
gf
));

369 
	`of_ä“
 (
Ãw_pkt
[
row
]);

373 
	`of_ä“
 (
Ãw_pkt
);

375 
	`of_ä“
(
ofcb
->
dec_m©rix
);

376 
ofcb
->
dec_m©rix
 = 
NULL
;

377 
OF_EXIT_FUNCTION


378  
OF_STATUS_OK
;

380 
”rÜ
:

381 
OF_EXIT_FUNCTION


382  
OF_STATUS_FATAL_ERROR
;

383 
	}
}

387 #ifdeà
OF_USE_ENCODER


388 
of_¡©us_t
 
	$of_rs_2m_’code
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
,
gf
 *
_¤c
[], gà*
_ãc
, 
šdex
, 
sz
)

390 
OF_ENTER_FUNCTION


391 
gf
 **
¤c
 = (gf**è
_¤c
;

392 
gf
 *
ãc
 = (gf*è
_ãc
;

393 
i
, 
k
 = 
ofcb
->
nb_sourû_symbŞs
 ;

394 
gf
 *
p
 ;

396 ià(
ofcb
->
m
 > 8)

397 
sz
 /= 2 ;

399 ià(
šdex
 < 
k
)

401 
	`bcİy
 (
¤c
[
šdex
], 
ãc
, 
sz
 * (
gf
));

403 ià(
šdex
 < (
ofcb
->
nb_sourû_symbŞs
 + ofcb->
nb_»·œ_symbŞs
))

405 
p
 = & (
ofcb
->
’c_m©rix
[
šdex
*
k
]);

406 
	`bz”o
 (
ãc
, 
sz
 *  (
gf
));

407 
i
 = 0; i < 
k
 ; i++)

409 ià(
p
[
i
] != 0 )

411 
ofcb
->
m
)

414 
	`of_g®ois_f›ld_2_4_addmul1_com·ù
(
ãc
, 
¤c
[
i
], 
p
[i], 
sz
);

417 
	`of_g®ois_f›ld_2_8_addmul1
(
ãc
, 
¤c
[
i
], 
p
[i], 
sz
);

422  
OF_STATUS_OK
;

426 
	`OF_PRINT_ERROR
 (("Inv®id index %d (max %d)\n", 
šdex
, 
ofcb
->
nb_sourû_symbŞs
+ofcb->
nb_»·œ_symbŞs
 - 1))

428 
OF_EXIT_FUNCTION


429  
OF_STATUS_ERROR
;

430 
	}
}

	@src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/of_galois_field_code.h

34 #iâdeà
GALOIS_FIELD_CODE_H


35 
	#GALOIS_FIELD_CODE_H


	)

37 
	~"../of_»ed-sŞomÚ_gf_2_m_šşudes.h
"

39 
	#bcmp
(
s1
 ,
s2
, 
n
è
	`memcmp
((s1), (s2), (
size_t
)Ò))

	)

41 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


43 
	#FEC_MAGIC
 0xFECC0DEC

	)

51 cÚ¡ *
	gof_rs_®lPp
[] =

53 
NULL
,

54 
NULL
,

76 
of_rs_2_m_cb_t
 
	tof_g®ois_f›ld_code_cb_t
;

81 
of_¡©us_t
 
of_rs_2m_š™
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
);

86 
of_rs_2m_»Ëa£
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
);

91 
of_¡©us_t
 
of_rs_2m_bud_’codšg_m©rix
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
);

93 #ifdeà
OF_USE_DECODER


94 
of_¡©us_t
 
of_rs_2m_bud_decodšg_m©rix
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
,* 
šdex
);

95 
of_¡©us_t
 
of_rs_2m_decode
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
,
gf
 *
pkt
[], gà*
pkth—d
[],
šdex
[], 
sz
, 
h—dsz
);

98 #ifdeà
OF_USE_ENCODER


99 
of_¡©us_t
 
of_rs_2m_’code
(
of_g®ois_f›ld_code_cb_t
* 
ofcb
,
gf
 *
_¤c
[], gà*
_ãc
, 
šdex
, 
sz
);

	@src/lib_stable/reed-solomon_gf_2_m/of_codec_profile.h

38 
	#OF_USE_REED_SOLOMON_2_M_CODEC


	)

40 #ifdeà
OF_DEBUG


42 
	#MEM_STATS_ARG
 ,
ofcb
->
¡©s


	)

43 
	#MEM_STATS
 ,
¡©s


	)

45 
	#MEM_STATS_ARG


	)

46 
	#MEM_STATS


	)

60 
	#OF_REED_SOLOMON_2_M_MAX_M
 8

	)

	@src/lib_stable/reed-solomon_gf_2_m/of_reed-solomon_gf_2_m.h

34 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


36 #iâdeà
OF_REED_SOLOMON_GF_2_M_H


37 
	#OF_REED_SOLOMON_GF_2_M_H


	)

44 
	sof_rs_2_m_cb


52 
of_codec_id_t
 
	mcodec_id
;

53 
of_codec_ty³_t
 
	mcodec_ty³
;

54 
UINT32
 
	mnb_sourû_symbŞs
;

55 
UINT32
 
	mnb_»·œ_symbŞs
;

56 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

57 
UINT32
 
	m’codšg_symbŞh—d_Ëngth
;

60 
UINT16
 
	mm
;

61 
UINT16
 
	mf›ld_size
;

62 
gf
* 
	mof_rs_gf_exp
;

63 * 
	mof_rs_gf_log
;

64 
gf
* 
	mof_rs_šv”£
;

65 
gf
** 
	mof_gf_mul_bË
;

73 
gf
 *
	m’c_m©rix
 ;

75 #ifdeà
OF_USE_DECODER


79 
gf
 *
	mdec_m©rix
;

83 
UINT32
 
	mmagic
;

86 
UINT32
 
	mmax_nb_sourû_symbŞs
;

88 
UINT32
 
	mmax_nb_’codšg_symbŞs
;

90 
UINT16
 
	mmax_m
;

91 
UINT32
 
	mnb_’codšg_symbŞs
;

92 #ifdeà
OF_USE_DECODER


100 ** 
	mavaabË_symbŞs_b
;

101 ** 
	mavaabË_symbŞh—ds_b
;

104 
UINT32
 
	mnb_avaabË_symbŞs
;

106 
UINT32
 
	mnb_avaabË_sourû_symbŞs
;

107 
boŞ
 
	mdecodšg_fšished
;

112 * (*
	mdecoded_sourû_symbŞ_ÿÎback_Ãw
è(*
	mcÚ‹xt
,

113 **
	md©a
,

114 **
	mh—d
,

115 
UINT32
 
	msize
,

116 
UINT32
 
	mh—d_size
,

117 
UINT32
 
	mesi
);

118 * (*
	mdecoded_»·œ_symbŞ_ÿÎback_Ãw
è(*
	mcÚ‹xt
,

119 **
	md©a
,

120 **
	mh—d
,

121 
UINT32
 
	msize
,

122 
UINT32
 
	mh—d_size
,

123 
UINT32
 
	mesi
);

125 * (*
	mdecoded_sourû_symbŞ_ÿÎback
è(*
	mcÚ‹xt
,

126 
UINT32
 
	msize
,

127 
UINT32
 
	mesi
);

128 * (*
	mdecoded_»·œ_symbŞ_ÿÎback
è(*
	mcÚ‹xt
,

129 
UINT32
 
	msize
,

130 
UINT32
 
	mesi
);

131 * 
	mcÚ‹xt_4_ÿÎback
;

133 } 
	tof_rs_2_m_cb_t
;

151 
of_¡©us_t
 
of_rs_2_m_ü—‹_codec_š¡ªû
 (
of_rs_2_m_cb_t
** 
of_cb
);

164 
of_¡©us_t
 
of_rs_2_m_»Ëa£_codec_š¡ªû
 (
of_rs_2_m_cb_t
* 
ofcb
);

175 
of_¡©us_t
 
of_rs_2_m_£t_ãc_·¿m‘”s
 (
of_rs_2_m_cb_t
* 
ofcb
,

176 
of_rs_2_m_·¿m‘”s_t
* 
·¿ms
);

203 
of_¡©us_t
 
of_rs_2_m_£t_ÿÎback_funùiÚs
 (
of_rs_2_m_cb_t
* 
ofcb
,

204 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

205 
UINT32
 
size
,

206 
UINT32
 
esi
),

207 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

208 
UINT32
 
size
,

209 
UINT32
 
esi
),

210 * 
cÚ‹xt_4_ÿÎback
);

211 
of_¡©us_t
 
of_rs_2_m_£t_ÿÎback_funùiÚs_Ãw
 (
of_rs_2_m_cb_t
* 
ofcb
,

212 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

213 **
d©a
,

214 **
h—d
,

215 
UINT32
 
size
,

216 
UINT32
 
h—d_size
,

217 
UINT32
 
esi
),

218 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

219 **
d©a
,

220 **
h—d
,

221 
UINT32
 
size
,

222 
UINT32
 
h—d_size
,

223 
UINT32
 
esi
),

224 * 
cÚ‹xt_4_ÿÎback
);

226 #ifdeà
OF_USE_ENCODER


240 
of_¡©us_t
 
of_rs_2_m_bud_»·œ_symbŞ
 (
of_rs_2_m_cb_t
* 
ofcb
,

241 * 
’codšg_symbŞs_b
[],

242 * 
’codšg_symbŞh—ds_b
[],

243 
UINT32
 
esi_of_symbŞ_to_bud
);

246 #ifdeà
OF_USE_DECODER


257 
of_¡©us_t
 
of_rs_2_m_decode_w™h_Ãw_symbŞ
 (
of_rs_2_m_cb_t
* 
ofcb
,

258 * 
Ãw_symbŞ
,

259 * 
Ãw_symbŞh—d_buf
,

260 
UINT32
 
Ãw_symbŞ_esi
);

272 
of_¡©us_t
 
of_rs_2_m_£t_avaabË_symbŞs
 (
of_rs_2_m_cb_t
* 
ofcb
,

273 * cÚ¡ 
’codšg_symbŞs_b
[],

274 * cÚ¡ 
’codšg_symbŞh—ds_b
[]);

284 
of_¡©us_t
 
of_rs_2_m_fšish_decodšg
 (
of_rs_2_m_cb_t
* 
ofcb
);

287 
of_¡©us_t
 
of_rs_2_m_»£t_decodšg_¡©u
(
of_rs_2_m_cb_t
* 
ofcb
);

296 
boŞ
 
of_rs_2_m_is_decodšg_com¶‘e
 (
of_rs_2_m_cb_t
* 
ofcb
);

306 
of_¡©us_t
 
of_rs_2_m_g‘_sourû_symbŞs_b
 (
of_rs_2_m_cb_t
* 
ofcb
,

307 * 
sourû_symbŞs_b
[]);

321 
of_¡©us_t
 
of_rs_2_m_£t_cÚŒŞ_·¿m‘”
 (
of_rs_2_m_cb_t
* 
ofcb
,

322 
UINT32
 
ty³
,

323 * 
v®ue
,

324 
UINT32
 
Ëngth
);

338 
of_¡©us_t
 
of_rs_2_m_g‘_cÚŒŞ_·¿m‘”
 (
of_rs_2_m_cb_t
* 
ofcb
,

339 
UINT32
 
ty³
,

340 * 
v®ue
,

341 
UINT32
 
Ëngth
);

	@src/lib_stable/reed-solomon_gf_2_m/of_reed-solomon_gf_2_m_api.c

34 
	~"of_»ed-sŞomÚ_gf_2_m_šşudes.h
"

37 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


40 
of_¡©us_t
 
	$of_rs_2_m_ü—‹_codec_š¡ªû
 (
of_rs_2_m_cb_t
** 
of_cb
)

42 
of_codec_ty³_t
 
codec_ty³
;

43 
of_rs_2_m_cb_t
 *
cb
;

45 
OF_ENTER_FUNCTION


46 
cb
 = (
of_rs_2_m_cb_t
*è
	`of_»®loc
 (*
of_cb
,  (of_rs_2_m_cb_t));

47 *
of_cb
 = 
cb
;

50 
codec_ty³
 = 
cb
->codec_type;

51 
	`mem£t
(
cb
, 0, (*cb));

52 
cb
->
codec_ty³
 = codec_type;

53 
cb
->
codec_id
 = 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
;

58 
cb
->
max_m
 = 
OF_REED_SOLOMON_2_M_MAX_M
;

59 
OF_EXIT_FUNCTION


60  
OF_STATUS_OK
;

61 
	}
}

64 
of_¡©us_t
 
	$of_rs_2_m_»Ëa£_codec_š¡ªû
 (
of_rs_2_m_cb_t
* 
ofcb
)

66 
OF_ENTER_FUNCTION


67 
	`of_rs_2m_»Ëa£
((
of_g®ois_f›ld_code_cb_t
*)
ofcb
);

68 #ifdeà
OF_USE_DECODER


69 ià(
ofcb
->
avaabË_symbŞs_b
 !ğ
NULL
)

71 
	`of_ä“
(
ofcb
->
avaabË_symbŞs_b
);

72 
ofcb
->
avaabË_symbŞs_b
 = 
NULL
;

74 ià(
ofcb
->
avaabË_symbŞh—ds_b
!ğ
NULL
)

76 
	`of_ä“
(
ofcb
->
avaabË_symbŞh—ds_b
);

77 
ofcb
->
avaabË_symbŞh—ds_b
 = 
NULL
;

80 #ifdeà
OF_DEBUG


81 
	`OF_TRACE_LVL
(2, ("\tTo be‡dded: Reed-Solomon GF(2^4):otal of %ld bytes for…recalculatedables (incl. %ld forhe optimized multable)\n",

82 (
of_gf_2_4_log
è+ (
of_gf_2_4_exp
è+ (
of_gf_2_4_šv
è+ (
of_gf_2_4_mul_bË
è+ (
of_gf_2_4_İt_mul_bË
), (of_gf_2_4_opt_mul_table)))

83 
	`OF_TRACE_LVL
(2, ("\tTo be‡dded: Reed-Solomon GF(2^8):otal of %ld bytes for…recalculatedables (incl. %ld for multable)\n",

84 (
of_gf_2_8_log
è+ (
of_gf_2_8_exp
è+ (
of_gf_2_8_šv
è+ (
of_gf_2_8_mul_bË
), (of_gf_2_8_mul_table)))

86 
OF_EXIT_FUNCTION


87  
OF_STATUS_OK
;

88 
	}
}

91 
of_¡©us_t
 
	$of_rs_2_m_£t_ãc_·¿m‘”s
 (
of_rs_2_m_cb_t
* 
ofcb
,

92 
of_rs_2_m_·¿m‘”s_t
* 
·¿ms
)

94 
OF_ENTER_FUNCTION


95 
ofcb
->
m
 = 
·¿ms
->m;

98 ià((
ofcb
->
m
 != 4) && (ofcb->m != 8)) {

99 
	`OF_PRINT_ERROR
(("ERROR: invalid m…arameter (must be 4 or 8)"));

100 
”rÜ
;

102 
ofcb
->
f›ld_size
 = (1 << ofcb->
m
) - 1;

103 
ofcb
->
max_nb_’codšg_symbŞs
 = ofcb->
max_nb_sourû_symbŞs
 = ofcb->
f›ld_size
;

104 ià((
ofcb
->
nb_sourû_symbŞs
 = 
·¿ms
->nb_sourû_symbŞsè> ofcb->
max_nb_sourû_symbŞs
) {

105 
	`OF_PRINT_ERROR
(("ERROR: invalid‚b_source_symbols…arameter (got %d, maximum is %d)",

106 
ofcb
->
nb_sourû_symbŞs
, ofcb->
max_nb_sourû_symbŞs
))

107 
”rÜ
;

109 
ofcb
->
nb_sourû_symbŞs
 = 
·¿ms
->nb_source_symbols;

110 
ofcb
->
nb_»·œ_symbŞs
 = 
·¿ms
->nb_repair_symbols;

111 
ofcb
->
’codšg_symbŞ_Ëngth
ğ
·¿ms
->encoding_symbol_length;

112 
ofcb
->
’codšg_symbŞh—d_Ëngth
 = 
·¿ms
->
’codšg_h—d_Ëngth
;

113 
ofcb
->
nb_’codšg_symbŞs
 = ofcb->
nb_sourû_symbŞs
 + ofcb->
nb_»·œ_symbŞs
;

114 #ifdeà
OF_USE_DECODER


115 
ofcb
->
avaabË_symbŞs_b
 = (**è
	`of_ÿÎoc
 (ofcb->
nb_’codšg_symbŞs
,  (*));

116 
ofcb
->
avaabË_symbŞh—ds_b
ğ(**è
	`of_ÿÎoc
 (ofcb->
nb_’codšg_symbŞs
,  (*));

117 
ofcb
->
nb_avaabË_symbŞs
 = 0;

118 
ofcb
->
nb_avaabË_sourû_symbŞs
 = 0;

120 
OF_EXIT_FUNCTION


121  
OF_STATUS_OK
;

123 
”rÜ
:

124 
OF_EXIT_FUNCTION


125  
OF_STATUS_FATAL_ERROR
;

126 
	}
}

128 
of_¡©us_t
 
	$of_rs_2_m_£t_ÿÎback_funùiÚs_Ãw
 (
of_rs_2_m_cb_t
* 
ofcb
,

129 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

130 **
d©a
,

131 **
h—d
,

132 
UINT32
 
size
,

133 
UINT32
 
h—d_size
,

134 
UINT32
 
esi
),

135 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

136 **
d©a
,

137 **
h—d
,

138 
UINT32
 
size
,

139 
UINT32
 
h—d_size
,

140 
UINT32
 
esi
),

141 * 
cÚ‹xt_4_ÿÎback
)

143 
ofcb
->
decoded_sourû_symbŞ_ÿÎback_Ãw
 = 
decoded_sourû_symbŞ_ÿÎback
;

144 
ofcb
->
decoded_»·œ_symbŞ_ÿÎback_Ãw
 = 
decoded_»·œ_symbŞ_ÿÎback
;

145 
ofcb
->
cÚ‹xt_4_ÿÎback
 = context_4_callback;

146 ià(
ofcb
->
decoded_»·œ_symbŞ_ÿÎback_Ãw
 !ğ
NULL
)

148 
	`OF_PRINT_ERROR
(("WARNING,he decoded„epair symbol callback is‚ever called with Reed-Solomon codes, sincehose„epair symbols‡re‚ever decoded\n"))

150  
OF_STATUS_OK
;

151 
	}
}

153 
of_¡©us_t
 
	$of_rs_2_m_£t_ÿÎback_funùiÚs
 (
of_rs_2_m_cb_t
* 
ofcb
,

154 * (*
decoded_sourû_symbŞ_ÿÎback
è(*
cÚ‹xt
,

155 
UINT32
 
size
,

156 
UINT32
 
esi
),

157 * (*
decoded_»·œ_symbŞ_ÿÎback
è(*
cÚ‹xt
,

158 
UINT32
 
size
,

159 
UINT32
 
esi
),

160 * 
cÚ‹xt_4_ÿÎback
)

162 
ofcb
->
decoded_sourû_symbŞ_ÿÎback
 = decoded_source_symbol_callback;

163 
ofcb
->
decoded_»·œ_symbŞ_ÿÎback
 = decoded_repair_symbol_callback;

164 
ofcb
->
cÚ‹xt_4_ÿÎback
 = context_4_callback;

165 ià(
ofcb
->
decoded_»·œ_symbŞ_ÿÎback
 !ğ
NULL
)

167 
	`OF_PRINT_ERROR
(("WARNING,he decoded„epair symbol callback is‚ever called with Reed-Solomon codes, sincehose„epair symbols‡re‚ever decoded\n"))

169  
OF_STATUS_OK
;

170 
	}
}

173 #ifdeà
OF_USE_ENCODER


175 
of_¡©us_t
 
	$of_rs_2_m_bud_»·œ_symbŞ
 (
of_rs_2_m_cb_t
* 
ofcb
,

176 * 
’codšg_symbŞs_b
[],

177 * 
’codšg_symbŞh—ds_b
[],

178 
UINT32
 
esi_of_symbŞ_to_bud
)

180 
OF_ENTER_FUNCTION


181 ià(
esi_of_symbŞ_to_bud
 < 
ofcb
->
nb_sourû_symbŞs
 ||ƒsi_of_symbŞ_to_bud >ğofcb->
nb_’codšg_symbŞs
)

183 
	`OF_PRINT_ERROR
(("ERROR: badƒs˜oà’codšg symbŞ (%d)\n", 
esi_of_symbŞ_to_bud
))

184 
”rÜ
;

186 ià(
’codšg_symbŞs_b
[
esi_of_symbŞ_to_bud
] =ğ
NULL
)

188 ià((
’codšg_symbŞs_b
[
esi_of_symbŞ_to_bud
] = 
	`of_ÿÎoc
 (1, 
ofcb
->
’codšg_symbŞ_Ëngth
)è=ğ
NULL
)

190 
	`OF_PRINT_ERROR
(("ERROR:‚o memory\n"))

191 
”rÜ
;

194 ià(
’codšg_symbŞh—ds_b
[
esi_of_symbŞ_to_bud
] =ğ
NULL
)

196 ià((
’codšg_symbŞh—ds_b
[
esi_of_symbŞ_to_bud
] = 
	`of_ÿÎoc
 (1, 
ofcb
->
’codšg_symbŞh—d_Ëngth
)è=ğ
NULL
)

198 
	`OF_PRINT_ERROR
(("ERROR:‚o memory\n"))

199 
”rÜ
;

202 ià(
ofcb
->
’c_m©rix
 =ğ
NULL
)

204 ià(
	`of_rs_2m_bud_’codšg_m©rix
((
of_g®ois_f›ld_code_cb_t
*)
ofcb
è!ğ
OF_STATUS_OK
)

206 
	`OF_PRINT_ERROR
(("ERROR: creatingƒncoding matrix failed\n"))

207 
”rÜ
;

210 ià(
	`of_rs_2m_’code
((
of_g®ois_f›ld_code_cb_t
*è
ofcb
,

211 (
gf
**)
’codšg_symbŞs_b
,

212 
’codšg_symbŞs_b
[
esi_of_symbŞ_to_bud
],

213 
esi_of_symbŞ_to_bud
,

214 
ofcb
->
’codšg_symbŞ_Ëngth
è!ğ
OF_STATUS_OK
)

216 
	`OF_PRINT_ERROR
(("ERROR: of_rs_encode failed\n"))

217 
”rÜ
;

219 ià(
	`of_rs_2m_’code
((
of_g®ois_f›ld_code_cb_t
*è
ofcb
,

220 (
gf
**)
’codšg_symbŞh—ds_b
,

221 (
gf
**)
’codšg_symbŞh—ds_b
[
esi_of_symbŞ_to_bud
],

222 
esi_of_symbŞ_to_bud
,

223 
ofcb
->
’codšg_symbŞh—d_Ëngth
è!ğ
OF_STATUS_OK
)

225 
	`OF_PRINT_ERROR
(("of_rs_build_repair_symbol: head Error, of_rs_encode failed"))

226 
”rÜ
;

228 
OF_EXIT_FUNCTION


229  
OF_STATUS_OK
;

231 
”rÜ
:

232 
OF_EXIT_FUNCTION


233  
OF_STATUS_ERROR
;

234 
	}
}

238 #ifdeà
OF_USE_DECODER


239 
of_¡©us_t
 
	$of_rs_2_m_decode_w™h_Ãw_symbŞ
 (
of_rs_2_m_cb_t
* 
ofcb
,

240 * 
Ãw_symbŞ
,

241 * 
Ãw_symbŞh—d_buf
,

242 
UINT32
 
Ãw_symbŞ_esi
)

244 
OF_ENTER_FUNCTION


245 ià(
ofcb
->
decodšg_fšished
)

247 
	`OF_TRACE_LVL
(2, ("%s: decodšg‡Ì—dy dÚe\n", 
__FUNCTION__
));

248  
OF_STATUS_OK
;

250 ià(
ofcb
->
avaabË_symbŞs_b
[
Ãw_symbŞ_esi
] !ğ
NULL
)

253 
	`OF_TRACE_LVL
(2, ("%s: symbŞ (esi=%dèdu¶iÿ‹d\n", 
__FUNCTION__
, 
Ãw_symbŞ_esi
));

254 
’d
;

256 
ofcb
->
avaabË_symbŞs_b
[
Ãw_symbŞ_esi
] = 
Ãw_symbŞ
;

257 
ofcb
->
avaabË_symbŞh—ds_b
[
Ãw_symbŞ_esi
] = 
Ãw_symbŞh—d_buf
;

258 
ofcb
->
nb_avaabË_symbŞs
++;

259 ià(
Ãw_symbŞ_esi
 < 
ofcb
->
nb_sourû_symbŞs
)

262 
ofcb
->
nb_avaabË_sourû_symbŞs
++;

265 ià(
ofcb
->
nb_avaabË_sourû_symbŞs
 =ğofcb->
nb_sourû_symbŞs
)

268 
ofcb
->
decodšg_fšished
 = 
Œue
;

269 
	`OF_TRACE_LVL
(2, ("%s: dÚe,‡Î sourû symbŞ havb“À»ûived\n", 
__FUNCTION__
));

270 
OF_EXIT_FUNCTION


271  
OF_STATUS_OK
;

273 ià(
ofcb
->
nb_avaabË_symbŞs
 >ğofcb->
nb_sourû_symbŞs
)

276 ià(
	`of_rs_2_m_fšish_decodšg
(
ofcb
è!ğ
OF_STATUS_OK
)

278 
	`OF_PRINT_ERROR
(("ERROR: of_rs_decode failure\n"))

279 
”rÜ
;

281 
	`ASSERT
(
ofcb
->
decodšg_fšished
 =ğ
Œue
);

282 
	`OF_TRACE_LVL
(2, ("%s: dÚe, decodšg sucûssful\n", 
__FUNCTION__
));

283 
OF_EXIT_FUNCTION


284  
OF_STATUS_OK
;

286 
’d
:

287 
	`OF_TRACE_LVL
(2, ("%s: okay, buˆnÙ y‘ fšished\n", 
__FUNCTION__
));

288 
OF_EXIT_FUNCTION


289  
OF_STATUS_OK
;

290 
”rÜ
:

291 
OF_EXIT_FUNCTION


292  
OF_STATUS_ERROR
;

293 
	}
}

296 
of_¡©us_t
 
	$of_rs_2_m_£t_avaabË_symbŞs
 (
of_rs_2_m_cb_t
* 
ofcb
,

297 * cÚ¡ 
’codšg_symbŞs_b
[],

298 * cÚ¡ 
’codšg_symbŞh—ds_b
[])

300 
UINT32
 
i
;

302 
OF_ENTER_FUNCTION


303 
ofcb
->
nb_avaabË_symbŞs
 = 0;

304 
ofcb
->
nb_avaabË_sourû_symbŞs
 = 0;

305 
i
 = 0; i < 
ofcb
->
nb_’codšg_symbŞs
; i++)

307 
ofcb
->
avaabË_symbŞh—ds_b
[
i
] = 
’codšg_symbŞh—ds_b
[i];

308 ià((
ofcb
->
avaabË_symbŞs_b
[
i
] = 
’codšg_symbŞs_b
[i]è=ğ
NULL
)

312 ià(
i
 < 
ofcb
->
nb_sourû_symbŞs
)

314 
ofcb
->
nb_avaabË_sourû_symbŞs
++;

316 
ofcb
->
nb_avaabË_symbŞs
++;

318 
OF_EXIT_FUNCTION


319  
OF_STATUS_OK
;

320 
	}
}

324 
of_¡©us_t
 
	$of_rs_2_m_fšish_decodšg
 (
of_rs_2_m_cb_t
* 
ofcb
)

326 
UINT32
 
k
;

327 
UINT32
 
n
;

328 *
tmp_buf
[
ofcb
->
nb_sourû_symbŞs
];

329 
tmp_esi
[
ofcb
->
nb_sourû_symbŞs
];

333 
INT32
 
tmp_idx
;

334 **
ass_buf
;

335 
UINT32
 
ass_esi
;

336 **
¬s_buf
;

337 
UINT32
 
¬s_esi
;

339 
OF_ENTER_FUNCTION


340 ià(
ofcb
->
decodšg_fšished
)

342  
OF_STATUS_OK
;

344 
k
 = 
ofcb
->
nb_sourû_symbŞs
;

345 
n
 = 
ofcb
->
nb_’codšg_symbŞs
;

346 ià(
ofcb
->
nb_avaabË_symbŞs
 < 
k
)

348 
	`OF_PRINT_ERROR
(("ERROR:‚b„eceived symbols <‚b source symbols\n"))

349 
OF_EXIT_FUNCTION


350  
OF_STATUS_FAILURE
;

352 ià(
ofcb
->
nb_avaabË_sourû_symbŞs
 =ğ
k
)

355 
ofcb
->
decodšg_fšished
 = 
Œue
;

356 
OF_EXIT_FUNCTION


357  
OF_STATUS_OK
;

363 
ass_esi
 = 0;

364 
¬s_esi
 = 
k
;

365 
ass_buf
 = 
ofcb
->
avaabË_symbŞs_b
;

366 
¬s_buf
 = 
ofcb
->
avaabË_symbŞs_b
 + 
k
;

367 
tmp_idx
 = 0;mp_idx < 
k
;mp_idx++)

369 ià(*
ass_buf
 =ğ
NULL
)

372 *
¬s_buf
 =ğ
NULL
)

374 
¬s_esi
++;

375 
¬s_buf
++;

377 
	`OF_TRACE_LVL
(2, ("of_rs_finish_decoding: copy„epair withƒsi=%d inmp_buf[%d]\n",

378 
¬s_esi
, 
tmp_idx
))

379 
tmp_buf
[
tmp_idx
] = *
¬s_buf
;

380 
tmp_esi
[
tmp_idx
] = 
¬s_esi
;

381 
¬s_esi
++;

382 
¬s_buf
++;

386 
	`OF_TRACE_LVL
(2, ("of_rs_finish_decoding: copy source withƒsi=%d inmp_buf[%d]\n",

387 
¬s_esi
, 
tmp_idx
))

388 
tmp_buf
[
tmp_idx
] = *
ass_buf
;

389 
tmp_esi
[
tmp_idx
] = 
ass_esi
;

391 
ass_esi
++;

392 
ass_buf
++;

395 
tmp_idx
 = 0;mp_idx < 
k
;mp_idx++)

397 
	`OF_TRACE_LVL
(2, ("BefÜof_rs_decode:ƒsi=%d, k=%d,mp_idx=%d\n", 
tmp_esi
[
tmp_idx
], 
k
,mp_idx))

400 ià(
ofcb
->
’c_m©rix
 =ğ
NULL
)

402 ià(
	`of_rs_2m_bud_’codšg_m©rix
((
of_g®ois_f›ld_code_cb_t
*)
ofcb
è!ğ
OF_STATUS_OK
)

404 
	`OF_PRINT_ERROR
(("ERROR: creatingƒncoding matrix failed"))

405 
”rÜ
;

408 ià(
	`of_rs_2m_decode
((
of_g®ois_f›ld_code_cb_t
*)
ofcb
, (
gf
**)
tmp_buf
, (*)
tmp_esi
, ofcb->
’codšg_symbŞ_Ëngth
è!ğ
OF_STATUS_OK
)

410 
	`OF_PRINT_ERROR
(("ERROR: of_rs_decode failure\n"))

411 
”rÜ
;

413 
ofcb
->
decodšg_fšished
 = 
Œue
;

415 
tmp_idx
 = 0;mp_idx < 
k
;mp_idx++)

417 
	`OF_TRACE_LVL
(2, ("Aá” of_rs_decode:ƒsi=%d, k=%d,mp_idx=%d\n", 
tmp_esi
[
tmp_idx
], 
k
,mp_idx))

420 
OF_EXIT_FUNCTION


421  
OF_STATUS_OK
;

423 
”rÜ
:

424 
OF_EXIT_FUNCTION


425  
OF_STATUS_ERROR
;

426 
	}
}

430 
of_¡©us_t
 
	$of_rs_2_m_fšish_decodšg
 (
of_rs_2_m_cb_t
* 
ofcb
)

432 
UINT32
 
k
;

433 
UINT32
 
n
;

434 *
tmp_buf
[
ofcb
->
nb_sourû_symbŞs
];

435 
tmp_esi
[
ofcb
->
nb_sourû_symbŞs
];

436 *
tmp_h—dbuf
[
ofcb
->
nb_sourû_symbŞs
];

440 
INT32
 
tmp_idx
;

441 *
Ïrge_buf
 = 
NULL
;

442 
UINT32
 
off
;

443 **
ass_buf
;

444 **
ass_h—dbuf
;

445 
UINT32
 
ass_esi
;

446 **
¬s_buf
;

447 **
¬s_h—dbuf
;

448 
UINT32
 
¬s_esi
;

450 
OF_ENTER_FUNCTION


451 ià(
ofcb
->
decodšg_fšished
)

453  
OF_STATUS_OK
;

455 
k
 = 
ofcb
->
nb_sourû_symbŞs
;

456 
n
 = 
ofcb
->
nb_’codšg_symbŞs
;

459 ià(
ofcb
->
nb_avaabË_symbŞs
 < 
k
)

461 
	`OF_PRINT_ERROR
(("ERROR:‚b„eceived symbols <‚b source symbols\n"))

462 
OF_EXIT_FUNCTION


463  
OF_STATUS_FAILURE
;

465 ià(
ofcb
->
nb_avaabË_sourû_symbŞs
 =ğ
k
)

468 
ofcb
->
decodšg_fšished
 = 
Œue
;

469 
OF_EXIT_FUNCTION


470  
OF_STATUS_OK
;

478 
Ïrge_buf
 = (*è
	`of_m®loc
(
k
 * 
ofcb
->
’codšg_symbŞ_Ëngth
);

479 ià(
Ïrge_buf
 =ğ
NULL
)

481 
no_mem
;

484 
tmp_idx
 = 0, 
off
 = 0;mp_idx < 
k
;mp_idx++, ofà+ğ
ofcb
->
’codšg_symbŞ_Ëngth
) {

485 
tmp_buf
[
tmp_idx
] = 
Ïrge_buf
 + 
off
;

487 
tmp_idx
 = 0;

496 
ass_esi
 = 0;

497 
¬s_esi
 = 
k
;

498 
ass_buf
 = 
ofcb
->
avaabË_symbŞs_b
;

499 
¬s_buf
 = 
ofcb
->
avaabË_symbŞs_b
 + 
k
;

500 
ass_h—dbuf
 = 
ofcb
->
avaabË_symbŞh—ds_b
;

501 
¬s_h—dbuf
 = 
ofcb
->
avaabË_symbŞh—ds_b
 + 
k
;

502 
tmp_idx
 = 0;mp_idx < 
k
;mp_idx++)

504 ià(*
ass_buf
 =ğ
NULL
)

507 *
¬s_buf
 =ğ
NULL
)

509 
¬s_esi
++;

510 
¬s_buf
++;

511 
¬s_h—dbuf
++;

513 
	`OF_TRACE_LVL
(2, ("of_rs_finish_decoding: copy„epair withƒsi=%d inmp_buf[%d]\n",

514 
¬s_esi
, 
tmp_idx
))

516 
tmp_buf
[
tmp_idx
] = *
¬s_buf
;

517 
tmp_h—dbuf
[
tmp_idx
] =*
¬s_h—dbuf
;

518 
tmp_esi
[
tmp_idx
] = 
¬s_esi
;

519 
¬s_esi
++;

520 
¬s_buf
++;

521 
¬s_h—dbuf
++;

525 
	`OF_TRACE_LVL
(2, ("of_rs_finish_decoding: copy source withƒsi=%d inmp_buf[%d]\n",

526 
¬s_esi
, 
tmp_idx
))

529 
tmp_buf
[
tmp_idx
] = *
ass_buf
;

530 
tmp_h—dbuf
[
tmp_idx
] =*
ass_h—dbuf
;

531 
tmp_esi
[
tmp_idx
] = 
ass_esi
;

533 
ass_esi
++;

534 
ass_buf
++;

535 
ass_h—dbuf
++;

538 
tmp_idx
 = 0;mp_idx < 
k
;mp_idx++)

540 
	`OF_TRACE_LVL
(2, ("BefÜof_rs_decode:ƒsi=%d, k=%d,mp_idx=%d\n", 
tmp_esi
[
tmp_idx
], 
k
,mp_idx))

543 ià(
ofcb
->
’c_m©rix
 =ğ
NULL
)

545 ià(
	`of_rs_2m_bud_’codšg_m©rix
((
of_g®ois_f›ld_code_cb_t
*)
ofcb
è!ğ
OF_STATUS_OK
)

547 
	`OF_PRINT_ERROR
(("ERROR: creatingƒncoding matrix failed\n"))

548 
”rÜ
;

551 ià(
	`of_rs_2m_decode
 ((
of_g®ois_f›ld_code_cb_t
*)
ofcb
,

552 (
gf
**)
tmp_buf
, (gf**)
tmp_h—dbuf
,

553 (*)
tmp_esi
, 
ofcb
->
’codšg_symbŞ_Ëngth
,

554 
ofcb
->
’codšg_symbŞh—d_Ëngth
è!ğ
OF_STATUS_OK
)

556 
	`OF_PRINT_ERROR
(("ERROR: of_rs_decode failure\n"))

557 
”rÜ
;

559 
ofcb
->
decodšg_fšished
 = 
Œue
;

561 
tmp_idx
 = 0;mp_idx < 
k
;mp_idx++)

563 
	`OF_TRACE_LVL
(2, ("Aá” of_rs_decode:ƒsi=%d, k=%d,mp_idx=%d\n", 
tmp_esi
[
tmp_idx
], 
k
,mp_idx))

570 
tmp_idx
 = 0;mp_idx < 
k
;mp_idx++)

572 
	`ASSERT
(
tmp_idx
 < 
k
);

573 
ass_buf
 = &(
ofcb
->
avaabË_symbŞs_b
[
tmp_idx
]);

574 ià(*
ass_buf
 !ğ
NULL
)

585 ià(
ofcb
->
decoded_sourû_symbŞ_ÿÎback
 !ğ
NULL
)

587 *
ass_buf
 = 
ofcb
->
	`decoded_sourû_symbŞ_ÿÎback
 (ofcb->
cÚ‹xt_4_ÿÎback
,

588 
ofcb
->
’codšg_symbŞ_Ëngth
, 
tmp_idx
);

592 *
ass_buf
 = (*è
	`of_m®loc
 (
ofcb
->
’codšg_symbŞ_Ëngth
);

594 ià(*
ass_buf
 =ğ
NULL
)

596 
no_mem
;

598 
	`memıy
(*
ass_buf
, 
tmp_buf
[
tmp_idx
], 
ofcb
->
’codšg_symbŞ_Ëngth
);

599 
	`OF_TRACE_LVL
(2, ("of_rs_finish_decoding: decoded source symbolƒsi=%d frommp_buf[%d]\n",

600 
tmp_idx
,mp_idx))

602 
	`of_ä“
(
Ïrge_buf
);

604 
OF_EXIT_FUNCTION


605  
OF_STATUS_OK
;

607 
no_mem
:

608 
	`OF_PRINT_ERROR
(("ERROR: out of memory.\n"))

610 
”rÜ
:

611 
OF_EXIT_FUNCTION


612  
OF_STATUS_ERROR
;

613 
	}
}

616 
of_¡©us_t
 
	$of_rs_2_m_»£t_decodšg_¡©u
(
of_rs_2_m_cb_t
* 
ofcb
){

617 
OF_ENTER_FUNCTION


618 
OF_EXIT_FUNCTION


619 
i
 =0;

620 
ofcb
->
decodšg_fšished
 = 
çl£
;

621 
ofcb
->
nb_avaabË_symbŞs
 = 0;

622 
ofcb
->
nb_avaabË_sourû_symbŞs
 = 0;

623 
i
 =0 ; i < 
ofcb
->
nb_’codšg_symbŞs
; i++){

624 
ofcb
->
avaabË_symbŞs_b
[
i
] = 
NULL
;

625 
ofcb
->
avaabË_symbŞh—ds_b
[
i
] = 
NULL
;

627  
OF_STATUS_OK
;

628 
	}
}

630 
boŞ
 
	$of_rs_2_m_is_decodšg_com¶‘e
 (
of_rs_2_m_cb_t
* 
ofcb
)

632 
OF_ENTER_FUNCTION


633 
OF_EXIT_FUNCTION


634  
ofcb
->
decodšg_fšished
;

635 
	}
}

638 
of_¡©us_t
 
	$of_rs_2_m_g‘_sourû_symbŞs_b
 (
of_rs_2_m_cb_t
* 
ofcb
,

639 * 
sourû_symbŞs_b
[])

641 
OF_ENTER_FUNCTION


642 ià(
	`of_rs_2_m_is_decodšg_com¶‘e
(
ofcb
è=ğ
çl£
)

644 
	`OF_PRINT_ERROR
(("ERROR: decoding‚ot complete.\n"))

645 
OF_EXIT_FUNCTION


646  
OF_STATUS_ERROR
;

649 
UINT32
 
i
;

650 
i
 = 0; i < 
ofcb
->
nb_sourû_symbŞs
; i++)

652 ià(
sourû_symbŞs_b
[
i
] =ğ
NULL
)

654 
sourû_symbŞs_b
[
i
] = 
ofcb
->
avaabË_symbŞs_b
[i];

658 
	`memıy
(
sourû_symbŞs_b
, 
ofcb
->
avaabË_symbŞs_b
, ofcb->
nb_sourû_symbŞs
 * (*));

660 
OF_EXIT_FUNCTION


661  
OF_STATUS_OK
;

662 
	}
}

667 
of_¡©us_t
 
	$of_rs_2_m_£t_cÚŒŞ_·¿m‘”
 (
of_rs_2_m_cb_t
* 
ofcb
,

668 
UINT32
 
ty³
,

669 * 
v®ue
,

670 
UINT32
 
Ëngth
)

672 
UINT16
 
m
;

674 
OF_ENTER_FUNCTION


675 
ty³
) {

676 
OF_RS_CTRL_SET_FIELD_SIZE
:

677 ià(
v®ue
 =ğ
NULL
 || 
Ëngth
 !ğ(
UINT16
)) {

678 
	`OF_PRINT_ERROR
(("OF_CTRL_SET_FIELD_SIZE ERROR:‚uÎ v®uÜ bad†’gth (gÙ %d,ƒx³ùed %ld)\n", 
Ëngth
, (
UINT16
)))

679 
”rÜ
;

681 
m
 = *(
UINT16
*)
v®ue
;

682 ià(
m
 != 4 && m != 8) {

683 
	`OF_PRINT_ERROR
(("ERROR: inv®id m=%d…¬am‘” (mu¡ b4 o¸8)\n", 
m
));

684 
”rÜ
;

686 
ofcb
->
m
 = m;

687 
ofcb
->
f›ld_size
 = (1 << ofcb->
m
) - 1;

688 
ofcb
->
max_nb_’codšg_symbŞs
 = ofcb->
max_nb_sourû_symbŞs
 = ofcb->
f›ld_size
;

692 
	`OF_PRINT_ERROR
(("ERROR: unknowÀty³ (%d)\n", 
ty³
))

695 
OF_EXIT_FUNCTION


696  
OF_STATUS_OK
;

698 
”rÜ
:

699 
OF_EXIT_FUNCTION


700  
OF_STATUS_ERROR
;

701 
	}
}

704 
of_¡©us_t
 
	$of_rs_2_m_g‘_cÚŒŞ_·¿m‘”
 (
of_rs_2_m_cb_t
* 
ofcb
,

705 
UINT32
 
ty³
,

706 * 
v®ue
,

707 
UINT32
 
Ëngth
)

709 
OF_ENTER_FUNCTION


710 
ty³
) {

711 
OF_CTRL_GET_MAX_K
:

712 ià(
v®ue
 =ğ
NULL
 || 
Ëngth
 !ğ(
UINT32
)) {

713 
	`OF_PRINT_ERROR
(("OF_CTRL_GET_MAX_K ERROR:‚uÎ v®uÜ bad†’gth (gÙ %d,ƒx³ùed %ld)\n", 
Ëngth
, (
UINT32
)))

714 
”rÜ
;

716 ià(
ofcb
->
max_nb_sourû_symbŞs
 == 0) {

717 
	`OF_PRINT_ERROR
(("OF_CTRL_GET_MAX_K ERROR:his…arameter is‚ot initialized. Usehe of_rs_2_m_set_fec_parameters functiono initialize it or of_rs_2_m_set_control_parameter.\n"))

718 
”rÜ
;

720 *(
UINT32
*)
v®ue
 = 
ofcb
->
max_nb_sourû_symbŞs
;

721 
	`OF_TRACE_LVL
(1, ("%s: OF_CTRL_GET_MAX_K (%d)\n", 
__FUNCTION__
, *(
UINT32
*)
v®ue
))

724 
OF_CTRL_GET_MAX_N
:

725 ià(
v®ue
 =ğ
NULL
 || 
Ëngth
 !ğ(
UINT32
)) {

726 
	`OF_PRINT_ERROR
(("OF_CTRL_GET_MAX_N ERROR:‚uÎ v®uÜ bad†’gth (gÙ %d,ƒx³ùed %ld)\n", 
Ëngth
, (
UINT32
)))

727 
”rÜ
;

729 ià(
ofcb
->
max_nb_’codšg_symbŞs
 == 0) {

730 
	`OF_PRINT_ERROR
(("OF_CTRL_GET_MAX_N ERROR:his…arameter is‚ot initialized. Usehe of_rs_2_m_set_fec_parameters functiono initialize it or of_rs_2_m_set_control_parameter.\n"))

731 
”rÜ
;

733 *(
UINT32
*)
v®ue
 = 
ofcb
->
max_nb_’codšg_symbŞs
;

734 
	`OF_TRACE_LVL
(1, ("%s: OF_CTRL_GET_MAX_N (%d)\n", 
__FUNCTION__
, *(
UINT32
*)
v®ue
))

738 
	`OF_PRINT_ERROR
(("ERROR: unknowÀty³ (%d)\n", 
ty³
))

739 
”rÜ
;

741 
OF_EXIT_FUNCTION


742  
OF_STATUS_OK
;

744 
”rÜ
:

745 
OF_EXIT_FUNCTION


746  
OF_STATUS_ERROR
;

747 
	}
}

	@src/lib_stable/reed-solomon_gf_2_m/of_reed-solomon_gf_2_m_api.h

34 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


36 #iâdeà
OF_REED_SOLOMON_GF_2_M_API_H


37 
	#OF_REED_SOLOMON_GF_2_M_API_H


	)

46 
	sof_rs_2_m_·¿m‘”s


48 
UINT32
 
	mnb_sourû_symbŞs
;

49 
UINT32
 
	mnb_»·œ_symbŞs
;

50 
UINT32
 
	m’codšg_symbŞ_Ëngth
;

51 
UINT32
 
	m’codšg_h—d_Ëngth
;

55 
UINT16
 
	mm
;

57 } 
	tof_rs_2_m_·¿m‘”s_t
;

	@src/lib_stable/reed-solomon_gf_2_m/of_reed-solomon_gf_2_m_includes.h

34 #iâdeà
OF_REED_SOLOMON_2M_INCLUDES_H


35 
	#OF_REED_SOLOMON_2M_INCLUDES_H


	)

37 
	~<¡dio.h
>

38 
	~<¡dlib.h
>

39 
	~<¡dšt.h
>

40 
	~<¡ršg.h
>

42 
	~"../../lib_commÚ/of_İ’ãc_­i.h
"

48 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


50 
	~"../../lib_commÚ/lš—r_bš¬y_codes_uts/of_lš—r_bš¬y_code.h
"

52 
	~"of_»ed-sŞomÚ_gf_2_m_­i.h
"

53 
	~"of_»ed-sŞomÚ_gf_2_m.h
"

54 
	~"g®ois_f›ld_codes_uts/of_g®ois_f›ld_code.h
"

55 
	~"g®ois_f›ld_codes_uts/®geb¿_2_4.h
"

56 
	~"g®ois_f›ld_codes_uts/®geb¿_2_8.h
"

	@tests/callback_test.c

39 
	#OF_USE_ENCODER


	)

40 
	#OF_USE_DECODER


	)

41 
	~"../¤c/lib_commÚ/of_İ’ãc_­i.h
"

42 
	~"../¤c/lib_¡abË/ldpc_¡aœÿ£/of_ldpc_¡aœÿ£_­i.h
"

43 
	~"../¤c/lib_¡abË/»ed-sŞomÚ_gf_2_8/of_»ed-sŞomÚ_gf_2_8_­i.h
"

44 
	~"../¤c/lib_commÚ/of_debug.h
"

46 
	~<¡dio.h
>

47 
	~<¡dlib.h
>

48 
	#CODEC_MAX
 10

	)

50 
	gnb_sourû
=0,
	gnb_»·œ
=0;

52 * 
	$sourû_cb
(*
cÚ‹xt
,
UINT32
 
size
,UINT32 
esi
)

54 
nb_sourû
++;

55 
	`´štf
 ("source\n");

56  
	`m®loc
(1024);

57 
	}
}

59 * 
	$»·œ_cb
(*
cÚ‹xt
,
UINT32
 
size
,UINT32 
esi
)

61 
nb_»·œ
++;

62 
	`´štf
 ("repair\n");

63 
	}
}

65 
	$maš
()

67 
cÚ‹xt
;

68 
i
,
j
,
k
=
OF_CODEC_LDPC_STAIRCASE_STABLE
;

69 
of_£ssiÚ_t
 *
£s
;

70 
of_¡©us_t
 
»t
;

72 
of_ldpc_·¿m‘”s_t
 
·¿ms
;

73 
·¿ms
.
nb_sourû_symbŞs
 = 1000;

74 
·¿ms
.
nb_»·œ_symbŞs
 = 500;

75 
·¿ms
.
’codšg_symbŞ_Ëngth
 = 1024;

76 
·¿ms
.
´ng_£ed
 = 
	`¿nd
();

77 
·¿ms
.
N1
 = 5;

80 **
Üig_symb_b
;

81 **
’codšg_symb_b
;

85 ià((
»t
 = 
	`of_ü—‹_codec_š¡ªû
(&
£s
,
k
,
OF_ENCODER
,1)è!ğ
OF_STATUS_OK
)

87 
	`´štf
("error in of_create_codec_instance\n");

88 
”rÜ
;

91 ià(
	`of_£t_ãc_·¿m‘”s
(
£s
, (
of_·¿m‘”s_t
*)&
·¿ms
è!ğ
OF_STATUS_OK
) {

92 
	`´štf
("error in of_set_fec_parameters\n");

93 
”rÜ
;

95 ifĞ
	`of_£t_ÿÎback_funùiÚs
(
£s
,
sourû_cb
,
»·œ_cb
,&
cÚ‹xt
è!ğ
OF_STATUS_OK
) {

96 
	`´štf
 ("error in of_set_fec_parameters\n");

99 
Üig_symb_b
 = (**)
	`ÿÎoc
(
·¿ms
.
nb_sourû_symbŞs
,(*));

100 
’codšg_symb_b
 = (*)
	`ÿÎoc
(
·¿ms
.
nb_sourû_symbŞs
+·¿ms.
nb_»·œ_symbŞs
,(*));

101 
i
=0;i<
·¿ms
.
nb_sourû_symbŞs
;i++)

103 
Üig_symb_b
[
i
] = (*)
	`ÿÎoc
(1,
·¿ms
.
’codšg_symbŞ_Ëngth
);

104 
’codšg_symb_b
[
i
] = (*)
Üig_symb_b
[i];

105 
j
=0;j<
·¿ms
.
’codšg_symbŞ_Ëngth
;j++)

107 
Üig_symb_b
[
i
][
j
] = 
	`¿nd
();

111 
i
=
·¿ms
.
nb_sourû_symbŞs
;i<·¿ms.nb_sourû_symbŞs+·¿ms.
nb_»·œ_symbŞs
;i++)

113 
’codšg_symb_b
[
i
] = (*)
	`ÿÎoc
(1,
·¿ms
.
’codšg_symbŞ_Ëngth
);

114 ià(
	`of_bud_»·œ_symbŞ
(
£s
,
’codšg_symb_b
, 
NULL
, 
i
, 
·¿ms
.
’codšg_symbŞ_Ëngth
, 0è!ğ
OF_STATUS_OK
)

116 
	`´štf
("of_build_repair_symbol: ");;

120 ià((
»t
 = 
	`of_»Ëa£_codec_š¡ªû
(
£s
)è!ğ
OF_STATUS_OK
)

122 
	`´štf
("of_release_codec_instance: ");;

127 ià((
»t
 = 
	`of_ü—‹_codec_š¡ªû
(&
£s
,
k
,
OF_DECODER
,1)è!ğ
OF_STATUS_OK
)

129 
	`´štf
("of_create_codec_instance: ");

134 ià(
	`of_£t_ãc_·¿m‘”s
(
£s
, (
of_·¿m‘”s_t
*)&
·¿ms
è!ğ
OF_STATUS_OK
) {

135 
	`´štf
(("of_set_fec_parameters(): "));;

138 ifĞ
	`of_£t_ÿÎback_funùiÚs
(
£s
,
sourû_cb
,
»·œ_cb
,&
cÚ‹xt
è!ğ
OF_STATUS_OK
) {

139 
	`´štf
 (("of_set_fec_parameters(): "));;

141 
i
=380;i<1400;i++)

143 
	`of_decode_w™h_Ãw_symbŞ
(
£s
,
’codšg_symb_b
[
i
], 
NULL
, i);

146 
	`of_fšish_decodšg
(
£s
);

147 
	`´štf
("fini\n");

149 ià((
»t
 = 
	`of_»Ëa£_codec_š¡ªû
(
£s
)è!ğ
OF_STATUS_OK
)

151 
	`´štf
("of_release_codec_instance: ");;

154 
	`ä“
(
’codšg_symb_b
);

155 
	`ä“
(
Üig_symb_b
);

157 
	`´štf
 ("nb : %i,%i\n",
nb_sourû
,
nb_»·œ
);

158 
	`´štf
("OK\n");

161 
”rÜ
:

162 
	`´štf
("error\n");

164 
	}
}

	@tests/code_params_test.c

49 
	#OF_USE_ENCODER


	)

50 
	#OF_USE_DECODER


	)

51 
	~<¡dio.h
>

52 
	~<¡dlib.h
>

53 
	~<¡ršg.h
>

55 
	~"../¤c/lib_commÚ/of_İ’ãc_­i.h
"

56 
	~"../¤c/lib_commÚ/of_debug.h
"

58 
	#MIN
(
a
,
b
è(×è<ğ(bè? (aè: (b))

	)

60 
	#MAX_CODEC_ID
 11

	)

61 
	#MAX_ITER
 100

	)

62 
	#SYMBOL_LEN
 1024

	)

64 
	$maš
()

66 
of_codec_id_t
 
codec_id
;

67 
UINT32
 
i
, 
j
;

68 
UINT32
 
k
, 
n
;

69 
UINT32
 
max_k
, 
max_n
;

70 
UINT32
 
™”
;

71 
UINT32
 
esi
;

72 
of_£ssiÚ_t
 *
£s
;

73 
of_¡©us_t
 
»t
;

74 **
Üig_symb_b
;

75 **
’codšg_symb_b
;

76 
of_·¿m‘”s_t
 *
·¿ms
 = 
NULL
;

78 
codec_id
 = 1; codec_id <ğ
MAX_CODEC_ID
; codec_id++)

80 
	`´štf
("\nCodeø%d ", 
codec_id
);

81 ()
codec_id
)

83 #ifdeà
OF_USE_REED_SOLOMON_CODEC


84 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
: {

85 
	`´štf
("(OF_CODEC_REED_SOLOMON_GF_2_8_STABLE):\n\t");

89 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


90 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
: {

91 
	`´štf
("(OF_CODEC_REED_SOLOMON_GF_2_M_STABLE):\n\t");

95 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


96 
OF_CODEC_LDPC_STAIRCASE_STABLE
: {

97 
	`´štf
("(OF_CODEC_LDPC_STAIRCASE_STABLE):\n\t");

101 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


102 
OF_CODEC_2D_PARITY_MATRIX_STABLE
: {

103 
	`´štf
("(OF_CODEC_2D_PARITY_MATRIX_STABLE):\n\t");

107 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


108 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

111 
	`´štf
("(OF_CODEC_LDPC_FROM_FILE_ADVANCED):\n\tSkipped...\n");

115 
	`´štf
("unknown codec:\n\tIgnored...\n");

120 
™”
 = 0; i‹¸<ğ
MAX_ITER
; iter++)

122 
	`´štf
("%d ", 
™”
);

123 
	`fæush
(
¡dout
);

124 ià((
»t
 = 
	`of_ü—‹_codec_š¡ªû
(&
£s
, 
codec_id
, 
OF_ENCODER
, 0)è!ğ
OF_STATUS_OK
)

126 
	`´štf
("of_ü—‹_codec_š¡ªû: ERROR fÜ codeø%d\n", 
codec_id
);

127 
”rÜ
;

129 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


130 ià(
codec_id
 =ğ
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
)

132 
UINT16
 
fs
 = 8;

134 ià(
	`of_£t_cÚŒŞ_·¿m‘”
(
£s
, 
OF_RS_CTRL_SET_FIELD_SIZE
, (*)&
fs
, (fs)è!ğ
OF_STATUS_OK
)

136 
	`´štf
("of_£t_cÚŒŞ_·¿m‘”(): ERROR fÜ codeø%d, OF_RS_CTRL_SET_FIELD_SIZE faed\n", 
codec_id
);

137 
”rÜ
;

141 ià(
	`of_g‘_cÚŒŞ_·¿m‘”
(
£s
, 
OF_CTRL_GET_MAX_K
, (*)&
max_k
, (max_k)è!ğ
OF_STATUS_OK
)

143 
	`´štf
("of_g‘_cÚŒŞ_·¿m‘”(): ERROR fÜ codeø%d\n", 
codec_id
);

144 
”rÜ
;

146 ià(
	`of_g‘_cÚŒŞ_·¿m‘”
(
£s
, 
OF_CTRL_GET_MAX_N
, (*)&
max_n
, (max_n)è!ğ
OF_STATUS_OK
)

148 
	`´štf
("of_g‘_cÚŒŞ_·¿m‘”(): ERROR fÜ codeø%d\n", 
codec_id
);

149 
”rÜ
;

152 ()
codec_id
)

154 #ifdeà
OF_USE_REED_SOLOMON_CODEC


155 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
: {

156 
of_rs_·¿m‘”s_t
 *
my_·¿ms
;

158 
n
 = 
max_n
;

159 
k
 = 
	`MIN
(
max_k
, 
n
 * 0.5);

160 
my_·¿ms
 = (
of_rs_·¿m‘”s_t
 *)
	`ÿÎoc
(1, (* my_params));

161 ià(
my_·¿ms
 =ğ
NULL
)

163 
	`´štf
("ÿÎoc: ERROR,‚ØmemÜy fÜ codeø%d\n", 
codec_id
);

164 
”rÜ
;

166 
·¿ms
 = (
of_·¿m‘”s_t
 *è
my_·¿ms
;

170 #ifdeà
OF_USE_REED_SOLOMON_2_M_CODEC


171 
OF_CODEC_REED_SOLOMON_GF_2_M_STABLE
: {

172 
of_rs_2_m_·¿m‘”s_t
 *
my_·¿ms
;

174 
n
 = 
max_n
;

175 
k
 = 
	`MIN
(
max_k
, 
n
 * 0.5);

176 
my_·¿ms
 = (
of_rs_2_m_·¿m‘”s_t
 *)
	`ÿÎoc
(1, (* my_params));

177 ià(
my_·¿ms
 =ğ
NULL
)

179 
	`´štf
("ÿÎoc: ERROR,‚ØmemÜy fÜ codeø%d\n", 
codec_id
);

180 
”rÜ
;

182 
my_·¿ms
->
m
 = 8;

183 
·¿ms
 = (
of_·¿m‘”s_t
 *è
my_·¿ms
;

187 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


188 
OF_CODEC_LDPC_STAIRCASE_STABLE
: {

189 
of_ldpc_·¿m‘”s_t
 *
my_·¿ms
;

191 
n
 = 
max_n
;

192 
k
 = 
	`MIN
(
max_k
, 
n
 * 0.5);

193 
my_·¿ms
 = (
of_ldpc_·¿m‘”s_t
 *)
	`ÿÎoc
(1, (* my_params));

194 ià(
my_·¿ms
 =ğ
NULL
)

196 
	`´štf
("ÿÎoc: ERROR,‚ØmemÜy fÜ codeø%d\n", 
codec_id
);

197 
”rÜ
;

199 
my_·¿ms
->
´ng_£ed
 = 
	`¿nd
();

200 
my_·¿ms
->
N1
 = 5;

201 
·¿ms
 = (
of_·¿m‘”s_t
 *è
my_·¿ms
;

205 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


206 
OF_CODEC_2D_PARITY_MATRIX_STABLE
: {

207 
of_2d_·r™y_·¿m‘”s_t
 *
my_·¿ms
;

210 
n
 = 
max_n
;

211 
k
 = 
max_k
;

212 
my_·¿ms
 = (
of_2d_·r™y_·¿m‘”s_t
 *)
	`ÿÎoc
(1, (* my_params));

213 ià(
my_·¿ms
 =ğ
NULL
)

215 
	`´štf
("ÿÎoc: ERROR,‚ØmemÜy fÜ codeø%d\n", 
codec_id
);

216 
”rÜ
;

218 
·¿ms
 = (
of_·¿m‘”s_t
 *è
my_·¿ms
;

223 
	`´štf
("ERROR, unknowÀcodeø%d", 
codec_id
);

224 
”rÜ
;

226 
·¿ms
->
nb_sourû_symbŞs
 = 
k
;

227 
·¿ms
->
nb_»·œ_symbŞs
 = 
n
 - 
k
;

228 
·¿ms
->
’codšg_symbŞ_Ëngth
 = 
SYMBOL_LEN
;

229 ià((
»t
 = 
	`of_£t_ãc_·¿m‘”s
(
£s
, 
·¿ms
)è!ğ
OF_STATUS_OK
)

231 
	`´štf
("ERROR, of_£t_ãc_·¿m‘”s(èçed fÜ codec=%d \n", 
codec_id
);

232 
”rÜ
;

237 ià((
»t
 = 
	`of_»Ëa£_codec_š¡ªû
(
£s
)è!ğ
OF_STATUS_OK
)

239 
	`´štf
("ERROR, of_»Ëa£_codec_š¡ªû(èçed fÜ codec=%d \n", 
codec_id
);

240 
”rÜ
;

242 
	`ä“
(
·¿ms
);

245 
	`´štf
("code_params_test: OK\n");

247 
”rÜ
:

248 
	`´štf
("code_params_test: ERROR\n");

250 
	}
}

	@tests/create_instance_test.c

39 
	#OF_USE_ENCODER


	)

40 
	#OF_USE_DECODER


	)

41 
	~<¡dio.h
>

43 
	~"../¤c/lib_commÚ/of_İ’ãc_­i.h
"

44 
	~"../¤c/lib_commÚ/of_debug.h
"

46 
	#MAX_CODEC_ID
 11

	)

48 
	$maš
()

50 
of_codec_id_t
 
codec_id
;

51 
of_£ssiÚ_t
 *
£s
;

52 
of_¡©us_t
 
»t
;

54 
codec_id
 = 1; codec_id <ğ
MAX_CODEC_ID
; codec_id++)

56 ()
codec_id
)

58 #ifdeà
OF_USE_REED_SOLOMON_CODEC


59 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
: {

60 
	`´štf
("(OF_CODEC_REED_SOLOMON_GF_2_8_STABLE):\n\t");

64 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


65 
OF_CODEC_LDPC_STAIRCASE_STABLE
: {

66 
	`´štf
("(OF_CODEC_LDPC_STAIRCASE_STABLE):\n\t");

70 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


71 
OF_CODEC_2D_PARITY_MATRIX_STABLE
: {

72 
	`´štf
("(OF_CODEC_2D_PARITY_MATRIX_STABLE):\n\t");

76 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


77 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

80 
	`´štf
("(OF_CODEC_LDPC_FROM_FILE_ADVANCED):\n\tSkipped...\n");

83 #ifdeà
OF_USE_LDPC_STAIRCASE_ADVANCED_CODEC


84 
OF_CODEC_LDPC_STAIRCASE_ADVANCED
: {

85 
	`´štf
("(OF_CODEC_LDPC_STAIRCASE_ADVANCED):\n\t");

90 
	`´štf
("unknown codec:\n\tIgnored...\n");

93 ià((
»t
 = 
	`of_ü—‹_codec_š¡ªû
(&
£s
, 
codec_id
, 
OF_ENCODER
, 1)è!ğ
OF_STATUS_OK
)

95 
	`´štf
("ERROR: of_create_codec_instance()");

98 ià((
»t
 = 
	`of_»Ëa£_codec_š¡ªû
(
£s
)è!ğ
OF_STATUS_OK
)

100 
	`´štf
("ERROR: of_release_codec_instance()");

104 
	`´štf
("OK\n");

107 
”rÜ
:

108 
	`´štf
("error\n");

110 
	}
}

	@tests/encoder_instance_test.c

49 
	#OF_USE_ENCODER


	)

50 
	#OF_USE_DECODER


	)

51 
	~<¡dio.h
>

52 
	~<¡dlib.h
>

53 
	~<¡ršg.h
>

55 
	~"../¤c/lib_commÚ/of_İ’ãc_­i.h
"

56 
	~"../¤c/lib_commÚ/of_debug.h
"

59 
	#MAX_CODEC_ID
 11

	)

60 
	#MAX_K
 1000

	)

61 
	#MAX_N
 1500

	)

62 
	#SYMBOL_LEN
 1024

	)

63 
	#MAX_ITER
 500

	)

66 
	$maš
()

68 
of_codec_id_t
 
codec_id
;

69 
UINT32
 
i
, 
j
;

70 
UINT32
 
k
, 
n
;

71 
UINT32
 
™”
;

72 
UINT32
 
esi
;

73 
of_£ssiÚ_t
 *
£s
;

74 
of_¡©us_t
 
»t
;

75 **
Üig_symb_b
;

76 **
’codšg_symb_b
;

77 
of_·¿m‘”s_t
 *
·¿ms
 = 
NULL
;

82 
Üig_symb_b
 = (**è
	`ÿÎoc
(
MAX_K
, (*));

83 
’codšg_symb_b
 = (*è
	`ÿÎoc
(
MAX_N
, (*));

84 ià(
Üig_symb_b
 =ğ
NULL
 || 
’codšg_symb_b
 == NULL)

86 
	`´štf
("ERROR:‚ØmemÜy fÜ codeø%d \n", 
codec_id
);

87 
”rÜ
;

89 
i
 = 0; i < 
MAX_K
; i++)

91 
Üig_symb_b
[
i
] = (*)
	`ÿÎoc
(1, 
SYMBOL_LEN
);

92 
’codšg_symb_b
[
i
] = (*)
Üig_symb_b
[i];

93 
j
 = 0; j < 
SYMBOL_LEN
; j++)

95 
Üig_symb_b
[
i
][
j
] = 
	`¿nd
();

98 
i
 = 
MAX_K
; i < 
MAX_N
; i++)

100 
’codšg_symb_b
[
i
] = (*)
	`ÿÎoc
(1, 
SYMBOL_LEN
);

105 
codec_id
 = 1; codec_id <ğ
MAX_CODEC_ID
; codec_id++)

107 
	`´štf
("\nCodeø%d ", 
codec_id
);

108 ()
codec_id
)

110 #ifdeà
OF_USE_REED_SOLOMON_CODEC


111 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
: {

112 
	`´štf
("(OF_CODEC_REED_SOLOMON_GF_2_8_STABLE):\n\t");

116 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


117 
OF_CODEC_LDPC_STAIRCASE_STABLE
: {

118 
	`´štf
("(OF_CODEC_LDPC_STAIRCASE_STABLE):\n\t");

122 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


123 
OF_CODEC_2D_PARITY_MATRIX_STABLE
: {

124 
	`´štf
("(OF_CODEC_2D_PARITY_MATRIX_STABLE):\n\t");

128 #ifdeà
OF_USE_LDPC_FROM_FILE_CODEC


129 
OF_CODEC_LDPC_FROM_FILE_ADVANCED
:

132 
	`´štf
("(OF_CODEC_LDPC_FROM_FILE_ADVANCED):\n\tSkipped...\n");

136 
	`´štf
("unknown codec:\n\tIgnored...\n");

139 
™”
 = 0; i‹¸<ğ
MAX_ITER
; iter++)

141 
	`´štf
("%d ", 
™”
);

142 
	`fæush
(
¡dout
);

143 ià((
»t
 = 
	`of_ü—‹_codec_š¡ªû
(&
£s
, 
codec_id
, 
OF_ENCODER
, 0)è!ğ
OF_STATUS_OK
)

145 
	`´štf
("of_ü—‹_codec_š¡ªû: ERROR fÜ codeø%d\n", 
codec_id
);

146 
”rÜ
;

149 ()
codec_id
)

151 #ifdeà
OF_USE_REED_SOLOMON_CODEC


152 
OF_CODEC_REED_SOLOMON_GF_2_8_STABLE
: {

153 
of_rs_·¿m‘”s_t
 *
my_·¿ms
;

155 
k
 = 100;

156 
n
 = 150;

157 
my_·¿ms
 = (
of_rs_·¿m‘”s_t
 *)
	`ÿÎoc
(1, (* my_params));

158 ià(
my_·¿ms
 =ğ
NULL
)

160 
	`´štf
("ÿÎoc: ERROR,‚ØmemÜy fÜ codeø%d\n", 
codec_id
);

161 
”rÜ
;

163 
·¿ms
 = (
of_·¿m‘”s_t
 *è
my_·¿ms
;

167 #ifdeà
OF_USE_LDPC_STAIRCASE_CODEC


168 
OF_CODEC_LDPC_STAIRCASE_STABLE
: {

169 
of_ldpc_·¿m‘”s_t
 *
my_·¿ms
;

171 
k
 = 500;

172 
n
 = 750;

173 
my_·¿ms
 = (
of_ldpc_·¿m‘”s_t
 *)
	`ÿÎoc
(1, (* my_params));

174 ià(
my_·¿ms
 =ğ
NULL
)

176 
	`´štf
("ÿÎoc: ERROR,‚ØmemÜy fÜ codeø%d\n", 
codec_id
);

177 
”rÜ
;

179 
my_·¿ms
->
´ng_£ed
 = 
	`¿nd
();

180 
my_·¿ms
->
N1
 = 5;

181 
·¿ms
 = (
of_·¿m‘”s_t
 *è
my_·¿ms
;

185 #ifdeà
OF_USE_2D_PARITY_MATRIX_CODEC


186 
OF_CODEC_2D_PARITY_MATRIX_STABLE
: {

187 
of_2d_·r™y_·¿m‘”s_t
 *
my_·¿ms
;

189 
k
 = 16;

190 
n
 = 24;

191 
my_·¿ms
 = (
of_2d_·r™y_·¿m‘”s_t
 *)
	`ÿÎoc
(1, (* my_params));

192 ià(
my_·¿ms
 =ğ
NULL
)

194 
	`´štf
("ÿÎoc: ERROR,‚ØmemÜy fÜ codeø%d\n", 
codec_id
);

195 
”rÜ
;

197 
·¿ms
 = (
of_·¿m‘”s_t
 *è
my_·¿ms
;

203 
	`´štf
("ERROR, unknowÀcodeø%d", 
codec_id
);

204 
”rÜ
;

206 
·¿ms
->
nb_sourû_symbŞs
 = 
k
;

207 
·¿ms
->
nb_»·œ_symbŞs
 = 
n
 - 
k
;

208 
·¿ms
->
’codšg_symbŞ_Ëngth
 = 
SYMBOL_LEN
;

210 ià((
»t
 = 
	`of_£t_ãc_·¿m‘”s
(
£s
, 
·¿ms
)è!ğ
OF_STATUS_OK
)

212 
	`´štf
("of_£t_ãc_·¿m‘”s(): ERROR fÜ codeø%d \n", 
codec_id
);

213 
”rÜ
;

218 
esi
 = 
·¿ms
->
nb_sourû_symbŞs
;

219 
esi
 < 
·¿ms
->
nb_sourû_symbŞs
 +…¬ams->
nb_»·œ_symbŞs
;

220 
esi
++)

222 
	`mem£t
(
’codšg_symb_b
[
esi
], 0, 
·¿ms
->
’codšg_symbŞ_Ëngth
);

223 ià(
	`of_bud_»·œ_symbŞ
(
£s
, 
’codšg_symb_b
, 
NULL
, 
esi
, 
·¿ms
->
’codšg_symbŞ_Ëngth
, 0è!ğ
OF_STATUS_OK
)

225 
	`´štf
("of_build_repair_symbol(): ERROR for codec=%d/esi=%d\n",

226 
codec_id
, 
esi
);

227 
”rÜ
;

233 ià((
»t
 = 
	`of_»Ëa£_codec_š¡ªû
(
£s
)è!ğ
OF_STATUS_OK
)

235 
	`´štf
("of_release_codec_instance: ");;

236 
”rÜ
;

239 
	`´štf
("\n");

242 
i
 = 0; i < 
MAX_N
; i++)

244 
	`ä“
(
’codšg_symb_b
[
i
]);

248 
	`ä“
(
’codšg_symb_b
);

249 
	`ä“
(
Üig_symb_b
);

250 
	`´štf
("encoder_instance_test: OK\n");

253 
”rÜ
:

254 
	`´štf
("encoder_instance_test: ERROR\n");

256 
	}
}

	@tools/descr_stats_v1.2/descr_stats.c

26 
	~<¡dlib.h
>

27 
	~<¡dio.h
>

28 
	~<uni¡d.h
>

29 
	~<¡ršg.h
>

30 
	~<”ºo.h
>

31 
	~<m©h.h
>

33 #ifdeà
DEBUG


34 
	#TRACE
(
m
è
´štf
 
	)
m

36 
	#TRACE
(
m
)

	)

39 
	#mš
(
a
,
b
è(×è< (bè? (aè: (b))

	)

40 
	#max
(
a
,
b
è(×è> (bè? (aè: (b))

	)

43 
	#STEPVAL
 0.01

	)

45 
	#MAXNAMELEN
 256

	)

46 
	#MAXCMDLEN
 4096

	)

47 
	#MAXVAL
 1000000

	)

53 
	gv®
[
MAXVAL
];

54 
	gv®nb
;

55 
	gmiddË
;

56 
	gš‹r_mode
 = 1;

58 
	gÜigiâ
[
MAXNAMELEN
];

59 
	gtmpâ
[
MAXNAMELEN
];

60 
	g¡©sâ
[
MAXNAMELEN
];

61 
FILE
 *
	g¡©så
;

62 
	ghd©â
[
MAXNAMELEN
];

63 
	gshÜthd©â
[
MAXNAMELEN
];

64 
	ghdemâ
[
MAXNAMELEN
];

70 
u§ge
 (
¬gc
, *
¬gv
[]);

71 
cÚfid’û_št
 (
cÚfid’û
, 
ûÁ”
);

72 
compf
 (cÚ¡ *
å1
, cÚ¡ *
å2
);

73 
š™Ÿlize_fe_Çmes
 ();

77 
	$u§ge
 (
¬gc
,

78 *
¬gv
[])

80 
	`´štf
("\n\
_¡© - v”siÚ 1.2 - July 23rd, 2003\n\
 (c) 2003 INRIA - All„ights„eserved\n\
: vincent.roca@inrialpes.fr\n\
 site: http://www.inrialpes.fr/planete/people/roca/\n\
\n\
_¡© come w™h ABSOLUTELY NO WARRANTY; Thi i ä“ soáw¬e,\n\
 you‡re welcomeo„edistribute it under certain conditions;\n\
he GNU General Public License‡s…ublished byhe Free\n\
 Foundation, version 2 or†ater, for more details.\n\
\n\
: descr_stats col if [noninter]\n\
 columno consider inhe input file (first column is 1).\n\
he input file.\n\
„un descr_stats in‚on-interactive mode (false by default).\n\
 set,‚o user interaction is„equired,‡ndhe statistics\n\
 histogram files‡re…roduced usinghe default\n\
. Files‡re writtenohe same directory‡s if.\n\
\n\
ool calculates various descriptive statistics on‡ set of\n\
 stored in‡ext file: mean, median, variance, standard\n\
, confidence interval‡roundhe mean‡nd median. It can\n\
…roduce‡n histogram ofhe samples. Inhat case, be careful\n\
he step value used, sincehis…arameter may dramatically\n\
he„esults.\n\
\n\
 contributors:\n\
 M. Lebo\n\
 Machens\n\
\n");

110 
	`ex™
(-1);

111 
	}
}

118 
	$cÚfid’û_št
 (
cÚfid’û
,

119 
ûÁ”
)

121 
i_ûÁ”
;

122 
šf
, 
sup
;

123 
Ãed
;

124 
nb
;

125 
d–_šf
;

126 
d–_sup
;

127 
found
 = 0;

129 
i_ûÁ”
 = 0; i_ûÁ” < 
v®nb
 - 1; i_center++) {

130 ià(
v®
[
i_ûÁ”
] < 
ûÁ”
 && val[i_center+1] >= center) {

131 
found
++;

135 ià(!
found
) {

138 
Ãed
 = ()
	`æoÜ
(()(
v®nb
 * 
cÚfid’û
));

139 
nb
 = 0;

140 
šf
 = 
sup
 = 
i_ûÁ”
;

141 
nb
 < 
Ãed
) {

142 ià(
šf
 == 0)

143 
sup
++;

144 ià(
sup
 =ğ
v®nb
 -1)

145 
šf
--;

146 ià((
ûÁ”
 - 
v®
[
šf
 - 1]è< (v®[
sup
 + 1] - center))

147 
šf
--;

149 
sup
++;

150 
nb
++;

152 
d–_šf
 = 
ûÁ”
 - 
v®
[
šf
];

153 
d–_sup
 = 
v®
[
sup
] - 
ûÁ”
;

154 
	`TRACE
(("delta_inf=%f, delta_sup=%f, inf=%d, sup=%d,‚eed=%d\n",

155 
d–_šf
, 
d–_sup
, 
šf
, 
sup
, 
Ãed
));

156  (
	`max
(
d–_šf
, 
d–_sup
));

157 
	}
}

168 
	$compf
 (cÚ¡ *
å1
,

169 cÚ¡ *
å2
)

171 
a
 = *((*)
å1
);

172 
b
 = *((*)
å2
);

173 
diff
 = 
a
 - 
b
;

175 ià(
diff
 < 0)

177 ià(
diff
 > 0)

181 
	}
}

185 
	$maš
 (
¬gc
,

186 *
¬gv
[])

188 
FILE
 *
iå
;

189 
FILE
 *
hd©å
;

190 #ià
DEBUG


191 
siâ
[
MAXNAMELEN
];

193 
cŞ
;

194 
cmd
[
MAXCMDLEN
];

195 
i
;

196 
sum
, 
m—n
, 
medŸn
, 
v¬Ÿnû
, 
¡d_devŸtiÚ
, 
¿nge
;

197 
ªsw”
;

198 
u±o
, 
¡•
, 
h®f_¡•
;

199 
nb_³r_št
;

200 
št_90_m—n
;

201 
št_90_medŸn
;

202 
št_95_m—n
;

203 
št_95_medŸn
;

204 
št_99_m—n
;

205 
št_99_medŸn
;

207 ià(
¬gc
 != 3 &&‡rgc != 4) {

208 ià(
¬gc
 == 2 &&

209 Ğ(
	`¡rcmp
(
¬gv
[1], "-h") == 0) || (strcmp(argv[1], "-help") == 0)) ) {

210 
	`u§ge
(
¬gc
, 
¬gv
);

212 
	`årštf
(
¡d”r
,

213 "ERROR, bad‚umb” oà¬gum’ts: 3 o¸4ƒx³ùed, gÙ %d\n", 
¬gc
);

214 
	`u§ge
(
¬gc
, 
¬gv
);

217 
cŞ
 = 
	`©oi
(
¬gv
[1]);

218 
	`¡ºıy
(
Üigiâ
, 
¬gv
[2], 
MAXNAMELEN
);

219 ià(
¬gc
 == 4) {

220 ià(
	`¡rcmp
(
¬gv
[3], "noninter") == 0) {

221 
š‹r_mode
 = 0;

223 
	`årštf
(
¡d”r
, "ERROR, bad‡rgum’ˆ%s\n", 
¬gv
[3]);

224 
	`u§ge
(
¬gc
, 
¬gv
);

229 
	`š™Ÿlize_fe_Çmes
();

232 
	`¥rštf
(
cmd
, "ÿˆ% |‡wk '{…ršˆ$%d }' > %s", 
Üigiâ
, 
cŞ
, 
tmpâ
);

233 
	`TRACE
(("--> k“°righˆcŞumÀcmd: \"%s\"\n", 
cmd
));

234 
	`sy¡em
(
cmd
);

237 ià((
iå
 = 
	`fİ’
(
tmpâ
, "r")) < 0) {

238 
	`³¼Ü
("open");

239 
	`u§ge
(
¬gc
, 
¬gv
);

241 
v®nb
 = 0;

242 
	`fsÿnf
(
iå
, "%lf", &
v®
[
v®nb
]) == 1) {

243 
v®nb
++;

244 ià(
v®nb
 >ğ
MAXVAL
) {

245 
	`´štf
("WARNING:†im™edØ%d v®ues,„emaššg†še ignÜed\n", 
MAXVAL
);

249 ià(
v®nb
 <= 1) {

250 
	`´štf
("ERROR:‚Øv®u»ad iÀ%s\n", 
tmpâ
);

251 
	`ex™
(-1);

253 
	`fşo£
(
iå
);

256 
	`qsÜt
(
v®
, 
v®nb
, (*v®), 
compf
);

258 #ifdeà
DEBUG


260 
	`¥rštf
(
siâ
, "/tmp/desü_¡©s_tmp_%d", 
	`g‘pid
()+1);

261 ià((
iå
 = 
	`fİ’
(
siâ
, "w")) < 0) {

262 
	`³¼Ü
("open");

263 
	`u§ge
(
¬gc
, 
¬gv
);

265 
	`årštf
(
iå
, "SÜ‹d v®ue (%dƒÁr›s):\n", 
v®nb
);

266 
i
 = 0; i < 
v®nb
; i++) {

267 
	`årštf
(
iå
, " %f\n", 
v®
[
i
]);

269 
	`fşo£
(
iå
);

273 
sum
 = 0.0;

274 
i
 = 0; i < 
v®nb
; i++) {

275 
sum
 +ğ
v®
[
i
];

278 
m—n
 = 
sum
 / 
v®nb
;

280 ià(
v®nb
 % 2) {

286 
middË
 = ()
	`æoÜ
(()
v®nb
 / 2.0);

287 
medŸn
 = 
v®
[
middË
];

298 
middË
 = ()
	`æoÜ
(()(
v®nb
 - 1) / 2.0);

299 
medŸn
 = (
v®
[
middË
] + val[middle+1]) / 2.0;

302 
v¬Ÿnû
 = 0.0;

303 
i
 = 0; i < 
v®nb
; i++) {

304 
v¬Ÿnû
 +ğ(
v®
[
i
] - 
m—n
) * (val[i] - mean);

306 
v¬Ÿnû
 = v¬Ÿnû / (
v®nb
 - 1);

307 
¡d_devŸtiÚ
 = 
	`sq¹
(
v¬Ÿnû
);

309 
¿nge
 = 
v®
[
v®nb
 -1] - val[0];

311 
št_90_m—n
 = 
	`cÚfid’û_št
(0.90, 
m—n
);

312 
št_95_m—n
 = 
	`cÚfid’û_št
(0.95, 
m—n
);

313 
št_99_m—n
 = 
	`cÚfid’û_št
(0.99, 
m—n
);

314 
št_90_medŸn
 = 
	`cÚfid’û_št
(0.90, 
medŸn
);

315 
št_95_medŸn
 = 
	`cÚfid’û_št
(0.95, 
medŸn
);

316 
št_99_medŸn
 = 
	`cÚfid’û_št
(0.99, 
medŸn
);

321 
	`årštf
(
¡©så
,

329 
v®nb
, 
m—n
, 
medŸn
, 
v¬Ÿnû
, 
¡d_devŸtiÚ
, 
¿nge
,

330 
v®
[0], v®[
v®nb
 -1]);

332 
	`årštf
(
¡©så
, "\tcÚfid’û iÁ”v®‡round m—À%f:\n", 
m—n
);

333 ià(
št_90_m—n
 !ğ-1.0è
	`årštf
(
¡©så
, "\t\t90: +/- %lf\n", int_90_mean);

334 
	`årštf
(
¡©så
, "\t\t90: NOT FOUND\n");

335 ià(
št_95_m—n
 !ğ-1.0è
	`årštf
(
¡©så
, "\t\t95: +/- %lf\n", int_95_mean);

336 
	`årštf
(
¡©så
, "\t\t95: NOT FOUND\n");

337 ià(
št_99_m—n
 !ğ-1.0è
	`årštf
(
¡©så
, "\t\t99: +/- %lf\n", int_99_mean);

338 
	`årštf
(
¡©så
, "\t\t99: NOT FOUND\n");

340 
	`årštf
(
¡©så
, "\tcÚfid’û iÁ”v®‡round medŸÀ%lf:\n", 
medŸn
);

341 ià(
št_90_medŸn
 !ğ-1.0è
	`årštf
(
¡©så
, "\t\t90: +/- %lf\n", int_90_median);

342 
	`årštf
(
¡©så
, "\t\t90: NOT FOUND\n");

343 ià(
št_95_medŸn
 !ğ-1.0è
	`årštf
(
¡©så
, "\t\t95: +/- %lf\n", int_95_median);

344 
	`årštf
(
¡©så
, "\t\t95: NOT FOUND\n");

345 ià(
št_99_medŸn
 !ğ-1.0è
	`årštf
(
¡©så
, "\t\t99: +/- %lf\n", int_99_median);

346 
	`årštf
(
¡©så
, "\t\t99: NOT FOUND\n");

347 
	`årštf
(
¡©så
, "\t------------------------------------------------------\n");

348 ià(
š‹r_mode
 == 0) {

349 
	`fşo£
(
¡©så
);

354 
¡•
 = 
STEPVAL
;

355 
h®f_¡•
 = 
¡•
 * 0.5;

356 ià(
š‹r_mode
 == 1) {

357 
ªsw”
 = 'n';

358 
	`´štf
("Continue with histogram (produces‡ gnuplot .dem format) (y/n)[n] ? ");

359 
	`sÿnf
("%c", &
ªsw”
);

360 ià(
ªsw”
 != 'y')

361 
ş—nup
;

363 
	`´štf
("Enter sampling step (real‚umber > 0.0): ");

364 
	`sÿnf
("%lf", &
¡•
);

365 ià(
¡•
 <= 0.0) {

366 
	`´štf
("ERROR, s‹°v®u%àšv®id (mu¡ b> 0)\n", 
¡•
);

367 
ş—nup
;

369 
h®f_¡•
 = 
¡•
 * 0.5;

371 
	`´štf
("hi¡og¿m d©¨fis: %s\n", 
hd©â
);

372 
	`´štf
("hi¡og¿m gnu¶Ù fis: %s\n", 
hdemâ
);

374 ià((
hd©å
 = 
	`fİ’
(
hd©â
, "w")è=ğ
NULL
) {

375 
	`³¼Ü
("ERROR, fopen failed for hdatfn");

376 
	`ex™
(-1);

379 
u±o
 = 
v®
[0] + 
¡•
, 
i
 = 0, 
nb_³r_št
 = 0;

380 
i
 < 
v®nb
;

381 
i
++) {

382 ià(
v®
[
i
] < 
u±o
) {

383 
nb_³r_št
 ++;

386 
	`TRACE
(("hi¡o: %d sam¶e < %f\n", 
nb_³r_št
, 
u±o
));

387 
	`årštf
(
hd©å
, "%à%d\n", 
u±o
 - 
h®f_¡•
, 
nb_³r_št
);

388 
u±o
 = 
v®
[
i
] + 
¡•
;

389 
nb_³r_št
 = 1;

393 
	`TRACE
(("hi¡o: %d sam¶e < %f\n", 
nb_³r_št
, 
u±o
));

394 
	`årštf
(
hd©å
, "%à%d\n", 
u±o
 - 
h®f_¡•
, 
nb_³r_št
);

395 
	`fşo£
(
hd©å
);

398 
	`¥rštf
(
cmd
, "echo \'\
itle \"Histogram\"\n\
 xlabel \"value\"\n\
 ylabel \"number of samples…er %f interval\"\n\
‡utoscale\n\
‚olabel\n\
 grid\n\
 [] [0:] \"%s\" with impulses\n\
 -1 \"Hit„eturno continue\" \' > %s",

407 
¡•
, 
shÜthd©â
, 
hdemâ
);

408 
	`TRACE
(("--> hi¡o.dem c»©iÚ cmd: \"%s\"\n", 
cmd
));

409 
	`sy¡em
(
cmd
);

414 
	`¥rštf
(
cmd
, "gnu¶Ù %s", 
demâ
);

415 
	`TRACE
(("--> gnu¶Ù cmd: \"%s\"\n", 
cmd
));

416 
	`sy¡em
(
cmd
);

419 
ş—nup
:

420 #ifdeà
DEBUG


424 
	`¥rštf
(
cmd
, "rm /tmp/descr_stats_tmp_[0-9]*");

425 
	`sy¡em
(
cmd
);

428 
	}
}

437 
	$š™Ÿlize_fe_Çmes
 ()

439 
dœn
[
MAXNAMELEN
];

441 
ba£n
[
MAXNAMELEN
];

442 *
dÙ
;

443 
FILE
 *
fe
;

444 
cmd
[
MAXCMDLEN
];

448 
	`¥rštf
(
tmpâ
, "/tmp/desü_¡©s_tmp_%d", 
	`g‘pid
());

449 
	`TRACE
(("\‰em°fi %s\n", 
tmpâ
));

454 
	`¥rštf
(
cmd
, "dœÇm%s", 
Üigiâ
);

455 ià((
fe
 = 
	`pİ’
(
cmd
, "r")è!ğ
NULL
) {

456 
	`fg‘s
(
dœn
, 
MAXNAMELEN
, 
fe
);

458 
	`årštf
(
¡d”r
, "ERROR,…İ’(%sèçed.\n", 
cmd
);

459 
	`ex™
(-1);

461 
	`pşo£
(
fe
);

462 
dœn
[
	`¡¾’
(dirn) - 1] = '\0';

463 
	`TRACE
(("\tdœÇmi %s\n", 
dœn
));

466 
	`¥rštf
(
cmd
, "ba£Çm%s", 
Üigiâ
);

467 ià((
fe
 = 
	`pİ’
(
cmd
, "r")è!ğ
NULL
) {

468 
	`fg‘s
(
ba£n
, 
MAXNAMELEN
, 
fe
);

470 
	`årštf
(
¡d”r
, "ERROR,…İ’(%sèçed.\n", 
cmd
);

471 
	`ex™
(-1);

473 
	`pşo£
(
fe
);

474 
ba£n
[
	`¡¾’
(basen) - 1] = '\0';

476 
dÙ
 = 
	`¡¼chr
Ğ
ba£n
, '.' );

477 ià(
dÙ
 !ğ
NULL
) {

478 *
dÙ
 = '\0';

481 
	`¥rštf
(
hd©â
, "%s/%s_hi¡og¿m.d©", 
dœn
, 
ba£n
);

482 
	`¥rštf
(
shÜthd©â
, "%s_hi¡og¿m.d©", 
ba£n
);

483 
	`¥rštf
(
hdemâ
, "%s/%s_hi¡og¿m.dem", 
dœn
, 
ba£n
);

484 ià(
š‹r_mode
 == 0) {

486 
	`¥rštf
(
¡©sâ
, "%s/%s_¡©s.txt", 
dœn
, 
ba£n
);

487 
¡©så
 = 
	`fİ’
(
¡©sâ
, "w");

490 
¡©så
 = 
¡dout
;

492 ià(
¡©så
 =ğ
NULL
) {

493 
	`årštf
(
¡d”r
, "ERROR, opening statsfp failed.\n");

494 
	`ex™
(-1);

496 
	}
}

	@
1
.
0
105
4931
CMakeFiles/3.5.1/CompilerIdC/CMakeCCompilerId.c
CMakeFiles/feature_tests.c
applis/eperftool/blocking_struct.c
applis/eperftool/blocking_struct.h
applis/eperftool/callbacks.c
applis/eperftool/callbacks.h
applis/eperftool/codec_instance_mgmt.c
applis/eperftool/codec_instance_mgmt.h
applis/eperftool/command_line.c
applis/eperftool/defaults.h
applis/eperftool/eperftool.c
applis/eperftool/eperftool.h
applis/eperftool/globals.c
applis/eperftool/globals.h
applis/eperftool/receiver.c
applis/eperftool/sender.c
applis/eperftool/tx_simulator.c
applis/howto_examples/simple_client_server/simple_client.c
applis/howto_examples/simple_client_server/simple_client_server.h
applis/howto_examples/simple_client_server/simple_server.c
mytest/preredun.c
mytest/preredun.h
mytest/preredun_config.h
mytest/preredun_openfec_aud.c
mytest/queue.c
mytest/queue.h
mytest/redun.c
mytest/redun.h
mytest/redun_config.h
mytest/redun_interface.c
mytest/redun_interface.h
mytest/redun_openfec_aud.c
mytest/simple_server.c
src/lib_advanced/ldpc_from_file/of_codec_profile.h
src/lib_advanced/ldpc_from_file/of_ldpc_ff.h
src/lib_advanced/ldpc_from_file/of_ldpc_ff_api.c
src/lib_advanced/ldpc_from_file/of_ldpc_ff_api.h
src/lib_advanced/ldpc_from_file/of_ldpc_ff_includes.h
src/lib_advanced/ldpc_from_file/of_ldpc_includes.h
src/lib_common/linear_binary_codes_utils/binary_matrix/of_hamming_weight.c
src/lib_common/linear_binary_codes_utils/binary_matrix/of_hamming_weight.h
src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_convert.c
src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_convert.h
src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_dense.c
src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_dense.h
src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_sparse.c
src/lib_common/linear_binary_codes_utils/binary_matrix/of_matrix_sparse.h
src/lib_common/linear_binary_codes_utils/binary_matrix/of_tools.c
src/lib_common/linear_binary_codes_utils/binary_matrix/of_tools.h
src/lib_common/linear_binary_codes_utils/it_decoding/of_it_decoding.c
src/lib_common/linear_binary_codes_utils/it_decoding/of_it_decoding.h
src/lib_common/linear_binary_codes_utils/ml_decoding/of_ml_decoding.c
src/lib_common/linear_binary_codes_utils/ml_decoding/of_ml_decoding.h
src/lib_common/linear_binary_codes_utils/ml_decoding/of_ml_tool.c
src/lib_common/linear_binary_codes_utils/ml_decoding/of_ml_tool.h
src/lib_common/linear_binary_codes_utils/of_create_pchk.c
src/lib_common/linear_binary_codes_utils/of_create_pchk.h
src/lib_common/linear_binary_codes_utils/of_linear_binary_code.h
src/lib_common/linear_binary_codes_utils/of_symbol.c
src/lib_common/linear_binary_codes_utils/of_symbol.h
src/lib_common/of_cb.h
src/lib_common/of_debug.h
src/lib_common/of_mem.c
src/lib_common/of_mem.h
src/lib_common/of_openfec_api.c
src/lib_common/of_openfec_api.h
src/lib_common/of_openfec_profile.h
src/lib_common/of_rand.c
src/lib_common/of_rand.h
src/lib_common/of_types.h
src/lib_common/statistics/of_statistics.c
src/lib_common/statistics/of_statistics.h
src/lib_stable/2d_parity_matrix/of_2d_parity.h
src/lib_stable/2d_parity_matrix/of_2d_parity_api.c
src/lib_stable/2d_parity_matrix/of_2d_parity_api.h
src/lib_stable/2d_parity_matrix/of_2d_parity_includes.h
src/lib_stable/2d_parity_matrix/of_codec_profile.h
src/lib_stable/ldpc_staircase/of_codec_profile.h
src/lib_stable/ldpc_staircase/of_ldpc_includes.h
src/lib_stable/ldpc_staircase/of_ldpc_staircase.h
src/lib_stable/ldpc_staircase/of_ldpc_staircase_api.c
src/lib_stable/ldpc_staircase/of_ldpc_staircase_api.h
src/lib_stable/ldpc_staircase/of_ldpc_staircase_pchk.c
src/lib_stable/reed-solomon_gf_2_8/of_codec_profile.h
src/lib_stable/reed-solomon_gf_2_8/of_reed-solomon_gf_2_8.c
src/lib_stable/reed-solomon_gf_2_8/of_reed-solomon_gf_2_8.h
src/lib_stable/reed-solomon_gf_2_8/of_reed-solomon_gf_2_8_api.c
src/lib_stable/reed-solomon_gf_2_8/of_reed-solomon_gf_2_8_api.h
src/lib_stable/reed-solomon_gf_2_8/of_reed-solomon_gf_2_8_includes.h
src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/algebra_2_4.c
src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/algebra_2_4.h
src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/algebra_2_8.c
src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/algebra_2_8.h
src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/of_galois_field_code.c
src/lib_stable/reed-solomon_gf_2_m/galois_field_codes_utils/of_galois_field_code.h
src/lib_stable/reed-solomon_gf_2_m/of_codec_profile.h
src/lib_stable/reed-solomon_gf_2_m/of_reed-solomon_gf_2_m.h
src/lib_stable/reed-solomon_gf_2_m/of_reed-solomon_gf_2_m_api.c
src/lib_stable/reed-solomon_gf_2_m/of_reed-solomon_gf_2_m_api.h
src/lib_stable/reed-solomon_gf_2_m/of_reed-solomon_gf_2_m_includes.h
tests/callback_test.c
tests/code_params_test.c
tests/create_instance_test.c
tests/encoder_instance_test.c
tools/descr_stats_v1.2/descr_stats.c
